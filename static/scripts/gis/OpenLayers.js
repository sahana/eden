var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,c=document.getElementsByTagName("script"),d,e="",f=0,g=c.length;f<g;f++)if(d=c[f].getAttribute("src"))if(d=d.match(a)){e=d[1];break}return function(){return e}}(),ImgPath:"",Class:function(){var a=arguments.length,c=arguments[0],d=arguments[a-1],e="function"==typeof d.initialize?d.initialize:function(){c.prototype.initialize.apply(this,arguments)};1<a?(a=[e,
c].concat(Array.prototype.slice.call(arguments).slice(1,a-1),d),OpenLayers.inherit.apply(null,a)):e.prototype=d;return e},inherit:function(a,c){var d=function(){};d.prototype=c.prototype;a.prototype=new d;var e,f,d=2;for(e=arguments.length;d<e;d++)f=arguments[d],"function"===typeof f&&(f=f.prototype),OpenLayers.Util.extend(a.prototype,f)}};OpenLayers.Util=OpenLayers.Util||{};
OpenLayers.Util.extend=function(a,c){a=a||{};if(c){for(var d in c){var e=c[d];void 0!==e&&(a[d]=e)}!("function"==typeof window.Event&&c instanceof window.Event)&&c.hasOwnProperty&&c.hasOwnProperty("toString")&&(a.toString=c.toString)}return a};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],c=0,d=arguments.length;c<d;c++){var e=arguments[c];"string"==typeof e&&(e=document.getElementById(e));if(1==arguments.length)return e;a.push(e)}return a};
OpenLayers.Util.isElement=function(a){return!!(a&&1===a.nodeType)};OpenLayers.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};"undefined"===typeof window.$&&(window.$=OpenLayers.Util.getElement);OpenLayers.Util.removeItem=function(a,c){for(var d=a.length-1;d>=0;d--)a[d]==c&&a.splice(d,1);return a};OpenLayers.Util.indexOf=function(a,c){if(typeof a.indexOf=="function")return a.indexOf(c);for(var d=0,e=a.length;d<e;d++)if(a[d]==c)return d;return-1};
OpenLayers.Util.modifyDOMElement=function(a,c,d,e,f,g,h,i){if(c)a.id=c;if(d){a.style.left=d.x+"px";a.style.top=d.y+"px"}if(e){a.style.width=e.w+"px";a.style.height=e.h+"px"}if(f)a.style.position=f;if(g)a.style.border=g;if(h)a.style.overflow=h;if(parseFloat(i)>=0&&parseFloat(i)<1){a.style.filter="alpha(opacity="+i*100+")";a.style.opacity=i}else if(parseFloat(i)==1){a.style.filter="";a.style.opacity=""}};
OpenLayers.Util.createDiv=function(a,c,d,e,f,g,h,i){var j=document.createElement("div");if(e)j.style.backgroundImage="url("+e+")";a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));f||(f="absolute");OpenLayers.Util.modifyDOMElement(j,a,c,d,f,g,h,i);return j};
OpenLayers.Util.createImage=function(a,c,d,e,f,g,h,i){var j=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));f||(f="relative");OpenLayers.Util.modifyDOMElement(j,a,c,d,f,g,null,h);if(i){j.style.display="none";c=function(){j.style.display="";OpenLayers.Event.stopObservingElement(j)};OpenLayers.Event.observe(j,"load",c);OpenLayers.Event.observe(j,"error",c)}j.style.alt=a;j.galleryImg="no";if(e)j.src=e;return j};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;
OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),c=false;try{c=!!document.body.filters}catch(d){}OpenLayers.Util.alphaHackNeeded=c&&a>=5.5&&a<7}return OpenLayers.Util.alphaHackNeeded};
OpenLayers.Util.modifyAlphaImageDiv=function(a,c,d,e,f,g,h,i,j){OpenLayers.Util.modifyDOMElement(a,c,d,e,g,null,null,j);c=a.childNodes[0];if(f)c.src=f;OpenLayers.Util.modifyDOMElement(c,a.id+"_innerImage",null,e,"relative",h);if(OpenLayers.Util.alphaHack()){if(a.style.display!="none")a.style.display="inline-block";i==null&&(i="scale");a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c.src+"', sizingMethod='"+i+"')";if(parseFloat(a.style.opacity)>=0&&parseFloat(a.style.opacity)<
1)a.style.filter=a.style.filter+(" alpha(opacity="+a.style.opacity*100+")");c.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(a,c,d,e,f,g,h,i,j){var k=OpenLayers.Util.createDiv(),j=OpenLayers.Util.createImage(null,null,null,null,null,null,null,j);j.className="olAlphaImg";k.appendChild(j);OpenLayers.Util.modifyAlphaImageDiv(k,a,c,d,e,f,g,h,i);return k};OpenLayers.Util.upperCaseObject=function(a){var c={},d;for(d in a)c[d.toUpperCase()]=a[d];return c};
OpenLayers.Util.applyDefaults=function(a,c){var a=a||{},d=typeof window.Event=="function"&&c instanceof window.Event,e;for(e in c)if(a[e]===void 0||!d&&c.hasOwnProperty&&c.hasOwnProperty(e)&&!a.hasOwnProperty(e))a[e]=c[e];if(!d&&c&&c.hasOwnProperty&&c.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))a.toString=c.toString;return a};
OpenLayers.Util.getParameterString=function(a){var c=[],d;for(d in a){var e=a[d];if(e!=null&&typeof e!="function"){if(typeof e=="object"&&e.constructor==Array){for(var f=[],g,h=0,i=e.length;h<i;h++){g=e[h];f.push(encodeURIComponent(g===null||g===void 0?"":g))}e=f.join(",")}else e=encodeURIComponent(e);c.push(encodeURIComponent(d)+"="+e)}}return c.join("&")};OpenLayers.Util.urlAppend=function(a,c){var d=a;if(c)var e=(a+" ").split(/[?&]/),d=d+(e.pop()===" "?c:e.length?"&"+c:"?"+c);return d};
OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,c=0,d=arguments.length;c<d;c++){var e=arguments[c];try{a=e();break}catch(f){}}return a};
OpenLayers.Util.getXmlNodeValue=function(a){var c=null;OpenLayers.Util.Try(function(){c=a.text;if(!c)c=a.textContent;if(!c)c=a.firstChild.nodeValue},function(){c=a.textContent});return c};OpenLayers.Util.mouseLeft=function(a,c){for(var d=a.relatedTarget?a.relatedTarget:a.toElement;d!=c&&d!=null;)d=d.parentNode;return d!=c};OpenLayers.Util.DEFAULT_PRECISION=14;
OpenLayers.Util.toFloat=function(a,c){if(c==null)c=OpenLayers.Util.DEFAULT_PRECISION;typeof a!=="number"&&(a=parseFloat(a));return c===0?a:parseFloat(a.toPrecision(c))};OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return a*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};
OpenLayers.Util.distVincenty=function(a,c){for(var d=OpenLayers.Util.VincentyConstants,e=d.a,f=d.b,d=d.f,g=OpenLayers.Util.rad(c.lon-a.lon),h=Math.atan((1-d)*Math.tan(OpenLayers.Util.rad(a.lat))),i=Math.atan((1-d)*Math.tan(OpenLayers.Util.rad(c.lat))),j=Math.sin(h),h=Math.cos(h),k=Math.sin(i),i=Math.cos(i),l=g,m=2*Math.PI,n=20;Math.abs(l-m)>1.0E-12&&--n>0;){var o=Math.sin(l),p=Math.cos(l),q=Math.sqrt(i*o*i*o+(h*k-j*i*p)*(h*k-j*i*p));if(q==0)return 0;var p=j*k+h*i*p,r=Math.atan2(q,p),s=Math.asin(h*
i*o/q),t=Math.cos(s)*Math.cos(s),o=p-2*j*k/t,u=d/16*t*(4+d*(4-3*t)),m=l,l=g+(1-u)*d*Math.sin(s)*(r+u*q*(o+u*p*(-1+2*o*o)))}if(n==0)return NaN;e=t*(e*e-f*f)/(f*f);d=e/1024*(256+e*(-128+e*(74-47*e)));return(f*(1+e/16384*(4096+e*(-768+e*(320-175*e))))*(r-d*q*(o+d/4*(p*(-1+2*o*o)-d/6*o*(-3+4*q*q)*(-3+4*o*o))))).toFixed(3)/1E3};
OpenLayers.Util.destinationVincenty=function(a,c,d){for(var e=OpenLayers.Util,f=e.VincentyConstants,g=f.a,h=f.b,i=f.f,f=a.lon,a=a.lat,j=e.rad(c),c=Math.sin(j),j=Math.cos(j),a=(1-i)*Math.tan(e.rad(a)),k=1/Math.sqrt(1+a*a),l=a*k,m=Math.atan2(a,j),a=k*c,n=1-a*a,g=n*(g*g-h*h)/(h*h),o=1+g/16384*(4096+g*(-768+g*(320-175*g))),p=g/1024*(256+g*(-128+g*(74-47*g))),g=d/(h*o),q=2*Math.PI;Math.abs(g-q)>1.0E-12;)var r=Math.cos(2*m+g),s=Math.sin(g),t=Math.cos(g),u=p*s*(r+p/4*(t*(-1+2*r*r)-p/6*r*(-3+4*s*s)*(-3+4*
r*r))),q=g,g=d/(h*o)+u;d=l*s-k*t*j;h=Math.atan2(l*t+k*s*j,(1-i)*Math.sqrt(a*a+d*d));c=Math.atan2(s*c,k*t-l*s*j);j=i/16*n*(4+i*(4-3*n));r=c-(1-j)*i*a*(g+j*s*(r+j*t*(-1+2*r*r)));Math.atan2(a,-d);return new OpenLayers.LonLat(f+e.deg(r),e.deg(h))};
OpenLayers.Util.getParameters=function(a){var a=a===null||a===void 0?window.location.href:a,c="";if(OpenLayers.String.contains(a,"?"))var c=a.indexOf("?")+1,d=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length,c=a.substring(c,d);for(var a={},c=c.split(/[&;]/),d=0,e=c.length;d<e;++d){var f=c[d].split("=");if(f[0]){var g=f[0];try{g=decodeURIComponent(g)}catch(h){g=unescape(g)}f=(f[1]||"").replace(/\+/g," ");try{f=decodeURIComponent(f)}catch(i){f=unescape(f)}f=f.split(",");f.length==1&&(f=f[0]);
a[g]=f}}return a};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){a==null&&(a="id_");OpenLayers.Util.lastSeqID=OpenLayers.Util.lastSeqID+1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;
OpenLayers.METERS_PER_INCH=0.0254000508001016;
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH,
Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/
OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.0010/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,
Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,
SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/
OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH});
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1E3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,
"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return a>1?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,c){var d;if(a){c==null&&(c="degrees");d=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[c]*OpenLayers.DOTS_PER_INCH)}return d};
OpenLayers.Util.getScaleFromResolution=function(a,c){c==null&&(c="degrees");return a*OpenLayers.INCHES_PER_UNIT[c]*OpenLayers.DOTS_PER_INCH};
OpenLayers.Util.pagePosition=function(a){var c=[0,0],d=OpenLayers.Util.getViewportElement();if(!a||a==window||a==d)return c;var e=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(a,"position")=="absolute"&&(a.style.top==""||a.style.left==""),f=null;if(a.getBoundingClientRect){a=a.getBoundingClientRect();f=d.scrollTop;c[0]=a.left+d.scrollLeft;c[1]=a.top+f}else if(document.getBoxObjectFor&&!e){a=document.getBoxObjectFor(a);d=document.getBoxObjectFor(d);c[0]=a.screenX-d.screenX;
c[1]=a.screenY-d.screenY}else{c[0]=a.offsetLeft;c[1]=a.offsetTop;f=a.offsetParent;if(f!=a)for(;f;){c[0]=c[0]+f.offsetLeft;c[1]=c[1]+f.offsetTop;f=f.offsetParent}d=OpenLayers.BROWSER_NAME;if(d=="opera"||d=="safari"&&OpenLayers.Element.getStyle(a,"position")=="absolute")c[1]=c[1]-document.body.offsetTop;for(f=a.offsetParent;f&&f!=document.body;){c[0]=c[0]-f.scrollLeft;if(d!="opera"||f.tagName!="TR")c[1]=c[1]-f.scrollTop;f=f.offsetParent}}return c};
OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;if(a==void 0){a=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement;arguments.callee.viewportElement=a}return a};
OpenLayers.Util.isEquivalentUrl=function(a,c,d){d=d||{};OpenLayers.Util.applyDefaults(d,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var a=OpenLayers.Util.createUrlObject(a,d),c=OpenLayers.Util.createUrlObject(c,d),e;for(e in a)if(e!=="args"&&a[e]!=c[e])return false;for(e in a.args){if(a.args[e]!=c.args[e])return false;delete c.args[e]}for(e in c.args)return false;return true};
OpenLayers.Util.createUrlObject=function(a,c){c=c||{};if(!/^\w+:\/\//.test(a)){var d=window.location,e=d.port?":"+d.port:"",e=d.protocol+"//"+d.host.split(":").shift()+e;if(a.indexOf("/")===0)a=e+a;else{d=d.pathname.split("/");d.pop();a=e+d.join("/")+"/"+a}}c.ignoreCase&&(a=a.toLowerCase());d=document.createElement("a");d.href=a;e={};e.host=d.host.split(":").shift();e.protocol=d.protocol;e.port=c.ignorePort80?d.port=="80"||d.port=="0"?"":d.port:d.port==""||d.port=="0"?"80":d.port;e.hash=c.ignoreHash||
d.hash==="#"?"":d.hash;var f=d.search;if(!f){f=a.indexOf("?");f=f!=-1?a.substr(f):""}e.args=OpenLayers.Util.getParameters(f);e.pathname=d.pathname.charAt(0)=="/"?d.pathname:"/"+d.pathname;return e};OpenLayers.Util.removeTail=function(a){var c=null,c=a.indexOf("?"),d=a.indexOf("#");return c=c==-1?d!=-1?a.substr(0,d):a:d!=-1?a.substr(0,Math.min(c,d)):a.substr(0,c)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("webkit")==-1&&a.indexOf("gecko")!=-1}();
OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",c=navigator.userAgent.toLowerCase();c.indexOf("opera")!=-1?a="opera":c.indexOf("msie")!=-1?a="msie":c.indexOf("safari")!=-1?a="safari":c.indexOf("mozilla")!=-1&&(a=c.indexOf("firefox")!=-1?"firefox":"mozilla");return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};
OpenLayers.Util.getRenderedDimensions=function(a,c,d){var e,f,g=document.createElement("div");g.style.visibility="hidden";for(var h=d&&d.containerElement?d.containerElement:document.body,i=false,j=null,k=h;k&&k.tagName.toLowerCase()!="body";){var l=OpenLayers.Element.getStyle(k,"position");if(l=="absolute"){i=true;break}else if(l&&l!="static")break;k=k.parentNode}if(i&&(h.clientHeight===0||h.clientWidth===0)){j=document.createElement("div");j.style.visibility="hidden";j.style.position="absolute";
j.style.overflow="visible";j.style.width=document.body.clientWidth+"px";j.style.height=document.body.clientHeight+"px";j.appendChild(g)}g.style.position="absolute";if(c)if(c.w){e=c.w;g.style.width=e+"px"}else if(c.h){f=c.h;g.style.height=f+"px"}if(d&&d.displayClass)g.className=d.displayClass;c=document.createElement("div");c.innerHTML=a;c.style.overflow="visible";if(c.childNodes){a=0;for(d=c.childNodes.length;a<d;a++)if(c.childNodes[a].style)c.childNodes[a].style.overflow="visible"}g.appendChild(c);
j?h.appendChild(j):h.appendChild(g);if(!e){e=parseInt(c.scrollWidth);g.style.width=e+"px"}f||(f=parseInt(c.scrollHeight));g.removeChild(c);if(j){j.removeChild(g);h.removeChild(j)}else h.removeChild(g);return new OpenLayers.Size(e,f)};
OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(a==null){var c=null,d=null,c=a=0,c=document.createElement("div");c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";c.style.width="100px";c.style.height="50px";c.style.overflow="hidden";d=document.createElement("div");d.style.width="100%";d.style.height="200px";c.appendChild(d);document.body.appendChild(c);a=d.offsetWidth;c.style.overflow="scroll";c=d.offsetWidth;document.body.removeChild(document.body.lastChild);
OpenLayers.Util._scrollbarWidth=a-c;a=OpenLayers.Util._scrollbarWidth}return a};
OpenLayers.Util.getFormattedLonLat=function(a,c,d){d||(d="dms");var a=(a+540)%360-180,e=Math.abs(a),f=Math.floor(e),g=e=(e-f)/(1/60),e=Math.floor(e),g=Math.round((g-e)/(1/60)*10),g=g/10;if(g>=60){g=g-60;e=e+1;if(e>=60){e=e-60;f=f+1}}f<10&&(f="0"+f);f=f+"\u00b0";if(d.indexOf("dm")>=0){e<10&&(e="0"+e);f=f+(e+"'");if(d.indexOf("dms")>=0){g<10&&(g="0"+g);f=f+(g+'"')}}return f=c=="lon"?f+(a<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")):f+(a<0?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};
OpenLayers.Animation=function(a){var c=!(!a.requestAnimationFrame&&!a.webkitRequestAnimationFrame&&!a.mozRequestAnimationFrame&&!a.oRequestAnimationFrame&&!a.msRequestAnimationFrame),d=function(){var c=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(c){a.setTimeout(c,16)};return function(d,e){c.apply(a,[d,e])}}(),e=0,f={};return{isNative:c,requestFrame:d,start:function(a,c,i){var c=c>0?c:Number.POSITIVE_INFINITY,
j=++e,k=+new Date;f[j]=function(){if(f[j]&&+new Date-k<=c){a();f[j]&&d(f[j],i)}else delete f[j]};d(f[j],i);return j},stop:function(a){delete f[a]}}}(window);
OpenLayers.String={startsWith:function(a,c){return a.indexOf(c)==0},contains:function(a,c){return a.indexOf(c)!=-1},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){for(var a=a.split("-"),c=a[0],d=1,e=a.length;d<e;d++)var f=a[d],c=c+(f.charAt(0).toUpperCase()+f.substring(1));return c},format:function(a,c,d){c||(c=window);return a.replace(OpenLayers.String.tokenRegEx,function(a,f){for(var g,h=f.split(/\.+/),i=0;i<h.length;i++){i==0&&(g=c);g=g[h[i]]}typeof g==
"function"&&(g=d?g.apply(null,d):g());return typeof g=="undefined"?"undefined":g})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a){return OpenLayers.String.isNumeric(a)?parseFloat(a):a}};
OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,c){var d=0;c>0&&(d=parseFloat(a.toPrecision(c)));return d},format:function(a,c,d,e){c=typeof c!="undefined"?c:0;d=typeof d!="undefined"?d:OpenLayers.Number.thousandsSeparator;e=typeof e!="undefined"?e:OpenLayers.Number.decimalSeparator;c!=null&&(a=parseFloat(a.toFixed(c)));var f=a.toString().split(".");f.length==1&&c==null&&(c=0);a=f[0];if(d)for(var g=/(-?[0-9]+)([0-9]{3})/;g.test(a);)a=a.replace(g,"$1"+d+"$2");
if(c==0)c=a;else{d=f.length>1?f[1]:"0";c!=null&&(d=d+Array(c-d.length+1).join("0"));c=a+e+d}return c}};OpenLayers.Function={bind:function(a,c){var d=Array.prototype.slice.apply(arguments,[2]);return function(){var e=d.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(c,e)}},bindAsEventListener:function(a,c){return function(d){return a.call(c,d||window.event)}},False:function(){return false},True:function(){return true},Void:function(){}};
OpenLayers.Array={filter:function(a,c,d){var e=[];if(Array.prototype.filter)e=a.filter(c,d);else{var f=a.length;if(typeof c!="function")throw new TypeError;for(var g=0;g<f;g++)if(g in a){var h=a[g];c.call(d,h,g,a)&&e.push(h)}}return e}};
OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,c,d,e){if(OpenLayers.Util.isArray(a)){e=a[3];d=a[2];c=a[1];a=a[0]}if(a!=null)this.left=OpenLayers.Util.toFloat(a);if(c!=null)this.bottom=OpenLayers.Util.toFloat(c);if(d!=null)this.right=OpenLayers.Util.toFloat(d);if(e!=null)this.top=OpenLayers.Util.toFloat(e)},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var c=false;a!=
null&&(c=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return c},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return a===true?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,c){a==null&&(a=6);var d=Math.pow(10,a),e=Math.round(this.left*d)/d,f=Math.round(this.bottom*d)/d,g=Math.round(this.right*d)/d,d=Math.round(this.top*d)/d;return c===true?f+","+e+","+
d+","+g:e+","+f+","+g+","+d},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),
this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat)this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2);return this.centerLonLat},scale:function(a,c){c==null&&(c=this.getCenterLonLat());var d,e;if(c.CLASS_NAME=="OpenLayers.LonLat"){d=c.lon;e=c.lat}else{d=c.x;e=c.y}return new OpenLayers.Bounds((this.left-d)*a+d,(this.bottom-e)*a+e,(this.right-
d)*a+d,(this.top-e)*a+e)},add:function(a,c){if(a==null||c==null)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+c,this.right+a,this.top+c)},extend:function(a){var c=null;if(a){switch(a.CLASS_NAME){case "OpenLayers.LonLat":c=new OpenLayers.Bounds(a.lon,a.lat,a.lon,a.lat);break;case "OpenLayers.Geometry.Point":c=new OpenLayers.Bounds(a.x,a.y,a.x,a.y);break;case "OpenLayers.Bounds":c=a}if(c){this.centerLonLat=null;if(this.left==null||
c.left<this.left)this.left=c.left;if(this.bottom==null||c.bottom<this.bottom)this.bottom=c.bottom;if(this.right==null||c.right>this.right)this.right=c.right;if(this.top==null||c.top>this.top)this.top=c.top}}},containsLonLat:function(a,c){typeof c==="boolean"&&(c={inclusive:c});var c=c||{},d=this.contains(a.lon,a.lat,c.inclusive),e=c.worldBounds;if(e&&!d){d=e.getWidth();e=Math.round((a.lon-(e.left+e.right)/2)/d);d=this.containsLonLat({lon:a.lon-e*d,lat:a.lat},{inclusive:c.inclusive})}return d},containsPixel:function(a,
c){return this.contains(a.x,a.y,c)},contains:function(a,c,d){d==null&&(d=true);if(a==null||c==null)return false;var a=OpenLayers.Util.toFloat(a),c=OpenLayers.Util.toFloat(c),e=false;return e=d?a>=this.left&&a<=this.right&&c>=this.bottom&&c<=this.top:a>this.left&&a<this.right&&c>this.bottom&&c<this.top},intersectsBounds:function(a,c){typeof c==="boolean"&&(c={inclusive:c});c=c||{};if(c.worldBounds)var d=this.wrapDateLine(c.worldBounds),a=a.wrapDateLine(c.worldBounds);else d=this;if(c.inclusive==null)c.inclusive=
true;var e=false,f=d.left==a.right||d.right==a.left||d.top==a.bottom||d.bottom==a.top;if(c.inclusive||!f)var e=a.top>=d.bottom&&a.top<=d.top||d.top>a.bottom&&d.top<a.top,f=a.left>=d.left&&a.left<=d.right||d.left>=a.left&&d.left<=a.right,g=a.right>=d.left&&a.right<=d.right||d.right>=a.left&&d.right<=a.right,e=(a.bottom>=d.bottom&&a.bottom<=d.top||d.bottom>=a.bottom&&d.bottom<=a.top||e)&&(f||g);if(c.worldBounds&&!e){var h=c.worldBounds,f=h.getWidth(),g=!h.containsBounds(d),h=!h.containsBounds(a);if(g&&
!h){a=a.add(-f,0);e=d.intersectsBounds(a,{inclusive:c.inclusive})}else if(h&&!g){d=d.add(-f,0);e=a.intersectsBounds(d,{inclusive:c.inclusive})}}return e},containsBounds:function(a,c,d){c==null&&(c=false);d==null&&(d=true);var e=this.contains(a.left,a.bottom,d),f=this.contains(a.right,a.bottom,d),g=this.contains(a.left,a.top,d),a=this.contains(a.right,a.top,d);return c?e||f||g||a:e&&f&&g&&a},determineQuadrant:function(a){var c="",d=this.getCenterLonLat(),c=c+(a.lat<d.lat?"b":"t");return c=c+(a.lon<
d.lon?"l":"r")},transform:function(a,c){this.centerLonLat=null;var d=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,c),e=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,c),f=OpenLayers.Projection.transform({x:this.left,y:this.top},a,c),g=OpenLayers.Projection.transform({x:this.right,y:this.top},a,c);this.left=Math.min(d.x,f.x);this.bottom=Math.min(d.y,e.y);this.right=Math.max(e.x,g.x);this.top=Math.max(f.y,g.y);return this},wrapDateLine:function(a,c){var c=c||{},d=c.leftTolerance||
0,e=c.rightTolerance||0,f=this.clone();if(a){for(var g=a.getWidth();f.left<a.left&&f.right-e<=a.left;)f=f.add(g,0);for(;f.left+d>=a.right&&f.right>a.right;)f=f.add(-g,0);d=f.left+d;d<a.right&&d>a.left&&f.right-e>a.right&&(f=f.add(-g,0))}return f},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(a,c){var d=a.split(",");return OpenLayers.Bounds.fromArray(d,c)};
OpenLayers.Bounds.fromArray=function(a,c){return c===true?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var c;c=""+(a.charAt(0)=="t"?"b":"t");return c=c+(a.charAt(1)=="l"?"r":"l")};
OpenLayers.Date={toISOString:function(){if("toISOString"in Date.prototype)return function(a){return a.toISOString()};var a=function(a,d){for(var e=a+"";e.length<d;)e="0"+e;return e};return function(c){return isNaN(c.getTime())?"Invalid Date":c.getUTCFullYear()+"-"+a(c.getUTCMonth()+1,2)+"-"+a(c.getUTCDate(),2)+"T"+a(c.getUTCHours(),2)+":"+a(c.getUTCMinutes(),2)+":"+a(c.getUTCSeconds(),2)+"."+a(c.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var c;if((a=a.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/))&&
(a[1]||a[7])){c=parseInt(a[1],10)||0;var d=parseInt(a[2],10)-1||0,e=parseInt(a[3],10)||1;c=new Date(Date.UTC(c,d,e));if(d=a[7]){var e=parseInt(a[4],10),f=parseInt(a[5],10),g=parseFloat(a[6]),h=g|0,g=Math.round(1E3*(g-h));c.setUTCHours(e,f,h,g);if(d!=="Z"){d=parseInt(d,10);a=parseInt(a[8],10)||0;c=new Date(c.getTime()+-1E3*(60*d*60+a*60))}}}else c=new Date("invalid");return c}};
OpenLayers.Element={visible:function(a){return OpenLayers.Util.getElement(a).style.display!="none"},toggle:function(){for(var a=0,c=arguments.length;a<c;a++){var d=OpenLayers.Util.getElement(arguments[a]),e=OpenLayers.Element.visible(d)?"none":"";d.style.display=e}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,c){var d=a.className;return!!d&&RegExp("(^|\\s)"+c+"(\\s|$)").test(d)},
addClass:function(a,c){if(!OpenLayers.Element.hasClass(a,c))a.className=a.className+((a.className?" ":"")+c);return a},removeClass:function(a,c){var d=a.className;if(d)a.className=OpenLayers.String.trim(d.replace(RegExp("(^|\\s+)"+c+"(\\s+|$)")," "));return a},toggleClass:function(a,c){OpenLayers.Element.hasClass(a,c)?OpenLayers.Element.removeClass(a,c):OpenLayers.Element.addClass(a,c);return a},getStyle:function(a,c){var a=OpenLayers.Util.getElement(a),d=null;if(a&&a.style){d=a.style[OpenLayers.String.camelize(c)];
if(!d)if(document.defaultView&&document.defaultView.getComputedStyle)d=(d=document.defaultView.getComputedStyle(a,null))?d.getPropertyValue(c):null;else a.currentStyle&&(d=a.currentStyle[OpenLayers.String.camelize(c)]);var e=["left","top","right","bottom"];window.opera&&OpenLayers.Util.indexOf(e,c)!=-1&&OpenLayers.Element.getStyle(a,"position")=="static"&&(d="auto")}return d=="auto"?null:d}};
OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,c){if(OpenLayers.Util.isArray(a)){c=a[1];a=a[0]}this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(c)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,c){if(a==null||c==null)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+
OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(c))},equals:function(a){var c=false;a!=null&&(c=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return c},transform:function(a,c){var d=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,c);this.lon=d.x;this.lat=d.y;return this},wrapDateLine:function(a){var c=this.clone();if(a){for(;c.lon<a.left;)c.lon=c.lon+a.getWidth();for(;c.lon>a.right;)c.lon=c.lon-a.getWidth()}return c},CLASS_NAME:"OpenLayers.LonLat"});
OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var c=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(c&&a[0],c&&a[1])};
OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,c){this.x=parseFloat(a);this.y=parseFloat(c)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var c=false;a!=null&&(c=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return c},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,c){if(a==null||c==null)throw new TypeError("Pixel.add cannot receive null values");
return new OpenLayers.Pixel(this.x+a,this.y+c)},offset:function(a){var c=this.clone();a&&(c=this.add(a.x,a.y));return c},CLASS_NAME:"OpenLayers.Pixel"});
OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,c){this.w=parseFloat(a);this.h=parseFloat(c)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var c=false;a!=null&&(c=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return c},CLASS_NAME:"OpenLayers.Size"});
OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};
(function(){for(var a=document.getElementsByTagName("script"),c=0,d=a.length;c<d;++c)if(a[c].src.indexOf("firebug.js")!=-1&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();
OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,c,d,e){this.playing=true;this.begin=a;this.finish=c;this.duration=d;this.callbacks=e.callbacks;this.time=0;OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,
this))},stop:function(){if(this.playing){this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish);OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.playing=false}},play:function(){var a={},c;for(c in this.begin){var d=this.begin[c],e=this.finish[c];if(d==null||e==null||isNaN(d)||isNaN(e))throw new TypeError("invalid value for Tween");a[c]=this.easing.apply(this,[this.time,d,e-d,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,
a);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,c,d,e){return d*a/e+c},easeOut:function(a,c,d,e){return d*a/e+c},easeInOut:function(a,c,d,e){return d*a/e+c},CLASS_NAME:"OpenLayers.Easing.Linear"};
OpenLayers.Easing.Expo={easeIn:function(a,c,d,e){return a==0?c:d*Math.pow(2,10*(a/e-1))+c},easeOut:function(a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOut:function(a,c,d,e){return a==0?c:a==e?c+d:(a=a/(e/2))<1?d/2*Math.pow(2,10*(a-1))+c:d/2*(-Math.pow(2,-10*--a)+2)+c},CLASS_NAME:"OpenLayers.Easing.Expo"};
OpenLayers.Easing.Quad={easeIn:function(a,c,d,e){return d*(a=a/e)*a+c},easeOut:function(a,c,d,e){return-d*(a=a/e)*(a-2)+c},easeInOut:function(a,c,d,e){return(a=a/(e/2))<1?d/2*a*a+c:-d/2*(--a*(a-2)-1)+c},CLASS_NAME:"OpenLayers.Easing.Quad"};
OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var c,d=(new Date).getTime(),e=0,f=this.points.length,g;e<f;e++){g=this.points[e];if(d-
g.tick>this.delay)break;c=g}if(c){e=(new Date).getTime()-c.tick;d=Math.sqrt(Math.pow(a.x-c.xy.x,2)+Math.pow(a.y-c.xy.y,2));e=d/e;if(!(e==0||e<this.threshold)){d=Math.asin((a.y-c.xy.y)/d);c.xy.x<=a.x&&(d=Math.PI-d);return{speed:e,theta:d}}}},move:function(a,c){var d=a.speed,e=Math.cos(a.theta),f=-Math.sin(a.theta),g=(new Date).getTime(),h=0,i=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(this.timerId!=null){var a=(new Date).getTime()-g,k=-this.deceleration*Math.pow(a,
2)/2+d*a,l=k*e,k=k*f,m,n;m=false;if(-this.deceleration*a+d<=0){OpenLayers.Animation.stop(this.timerId);this.timerId=null;m=true}a=l-h;n=k-i;h=l;i=k;c(a,n,m)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});
OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&a.touches.length==1},isMultiTouch:function(a){return a.touches&&a.touches.length>1},isLeftClick:function(a){return a.which&&a.which==1||a.button&&a.button==1},isRightClick:function(a){return a.which&&a.which==3||a.button&&a.button==2},stop:function(a,
c){if(!c)a.preventDefault?a.preventDefault():a.returnValue=false;a.stopPropagation?a.stopPropagation():a.cancelBubble=true},findElement:function(a,c){for(var d=OpenLayers.Event.element(a);d.parentNode&&(!d.tagName||d.tagName.toUpperCase()!=c.toUpperCase());)d=d.parentNode;return d},observe:function(a,c,d,e){a=OpenLayers.Util.getElement(a);e=e||false;if(c=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))c="keydown";if(!this.observers)this.observers={};if(!a._eventCacheID){var f=
"eventCacheID_";a.id&&(f=a.id+"_"+f);a._eventCacheID=OpenLayers.Util.createUniqueID(f)}f=a._eventCacheID;this.observers[f]||(this.observers[f]=[]);this.observers[f].push({element:a,name:c,observer:d,useCapture:e});a.addEventListener?a.addEventListener(c,d,e):a.attachEvent&&a.attachEvent("on"+c,d)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])},_removeElementObservers:function(a){if(a)for(var c=a.length-1;c>=
0;c--){var d=a[c];OpenLayers.Event.stopObserving.apply(this,[d.element,d.name,d.observer,d.useCapture])}},stopObserving:function(a,c,d,e){var e=e||false,a=OpenLayers.Util.getElement(a),f=a._eventCacheID;if(c=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent))c="keydown";var g=false,h=OpenLayers.Event.observers[f];if(h)for(var i=0;!g&&i<h.length;){var j=h[i];if(j.name==c&&j.observer==d&&j.useCapture==e){h.splice(i,1);h.length==0&&delete OpenLayers.Event.observers[f];
g=true;break}i++}g&&(a.removeEventListener?a.removeEventListener(c,d,e):a&&a.detachEvent&&a.detachEvent("on"+c,d));return g},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover,mouseout,mousedown,mouseup,mousemove,click,dblclick,rightclick,dblrightclick,resize,focus,blur,touchstart,touchmove,touchend,keydown".split(","),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,c,d,e,f){OpenLayers.Util.extend(this,f);this.object=a;this.fallThrough=e;this.listeners={};this.extensions={};this.extensionCount=
{};c!=null&&this.attachToElement(c)},destroy:function(){for(var a in this.extensions)typeof this.extensions[a]!=="boolean"&&this.extensions[a].destroy();this.extensions=null;if(this.element){OpenLayers.Event.stopObservingElement(this.element);this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(a){if(this.element)OpenLayers.Event.stopObservingElement(this.element);
else{this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)}this.element=a;for(var c=0,d=this.BROWSER_EVENTS.length;c<d;c++)OpenLayers.Event.observe(a,this.BROWSER_EVENTS[c],this.eventHandler);OpenLayers.Event.observe(a,"dragstart",OpenLayers.Event.stop)},on:function(a){for(var c in a)c!="scope"&&a.hasOwnProperty(c)&&this.register(c,a.scope,a[c])},register:function(a,c,d,e){a in OpenLayers.Events&&
!this.extensions[a]&&(this.extensions[a]=new OpenLayers.Events[a](this));if(d!=null){if(c==null)c=this.object;var f=this.listeners[a];if(!f){f=[];this.listeners[a]=f;this.extensionCount[a]=0}c={obj:c,func:d};if(e){f.splice(this.extensionCount[a],0,c);typeof e==="object"&&e.extension&&this.extensionCount[a]++}else f.push(c)}},registerPriority:function(a,c,d){this.register(a,c,d,true)},un:function(a){for(var c in a)c!="scope"&&a.hasOwnProperty(c)&&this.unregister(c,a.scope,a[c])},unregister:function(a,
c,d){if(c==null)c=this.object;a=this.listeners[a];if(a!=null)for(var e=0,f=a.length;e<f;e++)if(a[e].obj==c&&a[e].func==d){a.splice(e,1);break}},remove:function(a){this.listeners[a]!=null&&(this.listeners[a]=[])},triggerEvent:function(a,c){var d=this.listeners[a];if(d&&d.length!=0){c==null&&(c={});c.object=this.object;c.element=this.element;if(!c.type)c.type=a;for(var d=d.slice(),e,f=0,g=d.length;f<g;f++){e=d[f];e=e.func.apply(e.obj,[c]);if(e!=void 0&&e==false)break}this.fallThrough||OpenLayers.Event.stop(c,
true);return e}},handleBrowserEvent:function(a){var c=a.type,d=this.listeners[c];if(d&&d.length!=0){if((d=a.touches)&&d[0]){for(var e=0,f=0,g=d.length,h,i=0;i<g;++i){h=d[i];e=e+h.clientX;f=f+h.clientY}a.clientX=e/g;a.clientY=f/g}if(this.includeXY)a.xy=this.getMousePosition(a);this.triggerEvent(c,a)}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var a=document.body;if(a&&(!(a.scrollTop!=0||a.scrollLeft!=0)||!navigator.userAgent.match(/iPhone/i)))this.element.offsets=
null},getMousePosition:function(a){if(this.includeXY){if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}}else this.clearMouseCache();if(!this.element.scrolls){var c=OpenLayers.Util.getViewportElement();this.element.scrolls=[c.scrollLeft,c.scrollTop]}if(!this.element.lefttop)this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0];if(!this.element.offsets)this.element.offsets=
OpenLayers.Util.pagePosition(this.element);return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});
OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown,mouseup,click,dblclick,touchstart,touchmove,touchend,keydown".split(","),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;a>=0;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:true})},destroy:function(){for(var a=this.events.length-1;a>=0;--a)this.target.unregister(this.events[a],this,this.buttonClick);
delete this.target},getPressedButton:function(a){var c=3,d;do{if(OpenLayers.Element.hasClass(a,"olButton")){d=a;break}a=a.parentNode}while(--c>0&&a);return d},buttonClick:function(a){var c=true,d=OpenLayers.Event.element(a);if(d&&(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(d=this.getPressedButton(d)){if(a.type==="keydown")switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:d});OpenLayers.Event.stop(a);
c=false}else if(this.startEvt){if(this.completeRegEx.test(a.type)){c=OpenLayers.Util.pagePosition(d);this.target.triggerEvent("buttonclick",{buttonElement:d,buttonXY:{x:this.startEvt.clientX-c[0],y:this.startEvt.clientY-c[1]}})}this.cancelRegEx.test(a.type)&&delete this.startEvt;OpenLayers.Event.stop(a);c=false}if(this.startRegEx.test(a.type)){this.startEvt=a;OpenLayers.Event.stop(a);c=false}}else delete this.startEvt;return c}});OpenLayers.ProxyHost="";
OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,c){var d=a.indexOf("http")!==0,e=!d&&a.match(this.URL_SPLIT_REGEX);if(e){var f=window.location,d=e[1]==f.protocol&&e[3]==f.hostname,e=e[4],
f=f.port;if(e!=80&&e!=""||f!="80"&&f!="")d=d&&e==f}d||(c?a=typeof c=="function"?c(a):c+encodeURIComponent(a):OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:a}));return a},issue:function(a){var c=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost}),a=OpenLayers.Util.applyDefaults(a,c),c=false,d;for(d in a.headers)a.headers.hasOwnProperty(d)&&d.toLowerCase()==="x-requested-with"&&(c=true);c===false&&(a.headers["X-Requested-With"]="XMLHttpRequest");var e=new OpenLayers.Request.XMLHttpRequest,
f=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{})),f=OpenLayers.Request.makeSameOrigin(f,a.proxy);e.open(a.method,f,a.async,a.user,a.password);for(var g in a.headers)e.setRequestHeader(g,a.headers[g]);var h=this.events,i=this;e.onreadystatechange=function(){e.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&h.triggerEvent("complete",{request:e,config:a,requestUrl:f})!==false&&i.runCallbacks({request:e,config:a,requestUrl:f})};a.async===false?e.send(a.data):window.setTimeout(function(){e.readyState!==
0&&e.send(a.data)},0);return e},runCallbacks:function(a){var c=a.request,d=a.config,e=d.scope?OpenLayers.Function.bind(d.callback,d.scope):d.callback,f;d.success&&(f=d.scope?OpenLayers.Function.bind(d.success,d.scope):d.success);var g;d.failure&&(g=d.scope?OpenLayers.Function.bind(d.failure,d.scope):d.failure);if(OpenLayers.Util.createUrlObject(d.url).protocol=="file:"&&c.responseText)c.status=200;e(c);if(!c.status||c.status>=200&&c.status<300){this.events.triggerEvent("success",a);f&&f(c)}if(c.status&&
(c.status<200||c.status>=300)){this.events.triggerEvent("failure",a);g&&g(c)}},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};
"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}};
(function(){function a(){this._object=g&&!j?new g:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function c(){return new a}function d(a){c.onreadystatechange&&c.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function e(a){try{a.responseText=a._object.responseText}catch(c){}try{var d=a._object,e=d.responseXML,f=d.responseText;if(i&&f&&e&&!e.documentElement&&d.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){e=
new window.ActiveXObject("Microsoft.XMLDOM");e.async=false;e.validateOnParse=false;e.loadXML(f)}a.responseXML=e&&(i&&e.parseError!=0||!e.documentElement||e.documentElement&&e.documentElement.tagName=="parsererror")?null:e}catch(g){}try{a.status=a._object.status}catch(h){}try{a.statusText=a._object.statusText}catch(j){}}function f(a){a._object.onreadystatechange=new window.Function}var g=window.XMLHttpRequest,h=!!window.controllers,i=window.document.all&&!window.opera,j=i&&window.navigator.userAgent.match(/MSIE 7.0/);
c.prototype=a.prototype;if(h&&g.wrapped)c.wrapped=g.wrapped;c.UNSENT=0;c.OPENED=1;c.HEADERS_RECEIVED=2;c.LOADING=3;c.DONE=4;c.prototype.readyState=c.UNSENT;c.prototype.responseText="";c.prototype.responseXML=null;c.prototype.status=0;c.prototype.statusText="";c.prototype.priority="NORMAL";c.prototype.onreadystatechange=null;c.onreadystatechange=null;c.onopen=null;c.onsend=null;c.onabort=null;c.prototype.open=function(a,g,j,n,o){delete this._headers;arguments.length<3&&(j=true);this._async=j;var p=
this,q=this.readyState,r;if(i&&j){r=function(){if(q!=c.DONE){f(p);p.abort()}};window.attachEvent("onunload",r)}c.onopen&&c.onopen.apply(this,arguments);arguments.length>4?this._object.open(a,g,j,n,o):arguments.length>3?this._object.open(a,g,j,n):this._object.open(a,g,j);this.readyState=c.OPENED;d(this);this._object.onreadystatechange=function(){if(!h||j){p.readyState=p._object.readyState;e(p);if(p._aborted)p.readyState=c.UNSENT;else{if(p.readyState==c.DONE){delete p._data;f(p);i&&j&&window.detachEvent("onunload",
r)}q!=p.readyState&&d(p);q=p.readyState}}}};c.prototype.send=function(a){c.onsend&&c.onsend.apply(this,arguments);arguments.length||(a=null);if(a&&a.nodeType){a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml;this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")}this._data=a;this._object.send(this._data);if(h&&!this._async){this.readyState=c.OPENED;for(e(this);this.readyState<c.DONE;){this.readyState++;d(this);if(this._aborted)break}}};
c.prototype.abort=function(){c.onabort&&c.onabort.apply(this,arguments);if(this.readyState>c.UNSENT)this._aborted=true;this._object.abort();f(this);this.readyState=c.UNSENT;delete this._data};c.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};c.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};c.prototype.setRequestHeader=function(a,c){if(!this._headers)this._headers={};this._headers[a]=c;return this._object.setRequestHeader(a,
c)};c.prototype.addEventListener=function(a,c,d){for(var e=0,f;f=this._listeners[e];e++)if(f[0]==a&&f[1]==c&&f[2]==d)return;this._listeners.push([a,c,d])};c.prototype.removeEventListener=function(a,c,d){for(var e=0,f;f=this._listeners[e];e++)if(f[0]==a&&f[1]==c&&f[2]==d)break;f&&this._listeners.splice(e,1)};c.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};a.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var c=0,d;d=this._listeners[c];c++)d[0]==a.type&&!d[2]&&(d[1].handleEvent||d[1]).apply(this,[a])};c.prototype.toString=function(){return"[object XMLHttpRequest]"};c.toString=function(){return"[XMLHttpRequest]"};if(!window.Function.prototype.apply)window.Function.prototype.apply=function(a,c){c||(c=[]);a.__func=this;a.__func(c[0],c[1],c[2],
c[3],c[4]);delete a.__func};OpenLayers.Request.XMLHttpRequest=c})();
OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,c){OpenLayers.Util.extend(this,c);this.projCode=a;if(typeof Proj4js=="object")this.proj=new Proj4js.Proj(a)},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var c=false;if(a){a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a));if(typeof Proj4js==
"object"&&this.proj.defData&&a.proj.defData)c=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,"");else if(a.getCode){c=this.getCode();a=a.getCode();c=c==a||!!OpenLayers.Projection.transforms[c]&&OpenLayers.Projection.transforms[c][a]===OpenLayers.Projection.nullTransform}}return c},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};
OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
OpenLayers.Projection.addTransform=function(a,c,d){if(d===OpenLayers.Projection.nullTransform){var e=OpenLayers.Projection.defaults[a];e&&!OpenLayers.Projection.defaults[c]&&(OpenLayers.Projection.defaults[c]=e)}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][c]=d};
OpenLayers.Projection.transform=function(a,c,d){if(c&&d){c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c));d instanceof OpenLayers.Projection||(d=new OpenLayers.Projection(d));if(c.proj&&d.proj)a=Proj4js.transform(c.proj,d.proj,a);else{var c=c.getCode(),d=d.getCode(),e=OpenLayers.Projection.transforms;if(e[c]&&e[c][d])e[c][d](a)}}return a};OpenLayers.Projection.nullTransform=function(a){return a};
(function(){function a(a){a.x=180*a.x/e;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/e*Math.PI))-Math.PI/2);return a}function c(a){a.x=a.x*e/180;a.y=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*e;return a}function d(d,e){var f=OpenLayers.Projection.addTransform,g=OpenLayers.Projection.nullTransform,h,n,o,p,q;h=0;for(n=e.length;h<n;++h){o=e[h];f(d,o,c);f(o,d,a);for(q=h+1;q<n;++q){p=e[q];f(o,p,g);f(p,o,g)}}}var e=2.003750834E7,f=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],g=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326",
"EPSG:4326"],h;for(h=f.length-1;h>=0;--h)d(f[h],g);for(h=g.length-1;h>=0;--h)d(g[h],f)})();
OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,
maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(a,c){if(arguments.length===1&&typeof a==="object")a=(c=a)&&c.div;this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+
"theme/default/style.css";this.options=OpenLayers.Util.extend({},c);OpenLayers.Util.extend(this,c);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);if(this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds))this.maxExtent=new OpenLayers.Bounds(this.maxExtent);if(this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds))this.minExtent=new OpenLayers.Bounds(this.minExtent);if(this.restrictedExtent&&
!(this.restrictedExtent instanceof OpenLayers.Bounds))this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent);if(this.center&&!(this.center instanceof OpenLayers.LonLat))this.center=new OpenLayers.LonLat(this.center);this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var d=this.id+
"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(d,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:true});d=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(d);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height=
"100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);if(parseFloat(navigator.appVersion.split("MSIE")[1])<9)this.events.register("resize",this,this.updateSize);else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){for(var d=true,e=document.getElementsByTagName("link"),
f=0,g=e.length;f<g;++f)if(OpenLayers.Util.isEquivalentUrl(e.item(f).href,this.theme)){d=false;break}if(d){d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(d)}}if(this.controls==null){this.controls=[];if(OpenLayers.Control!=null){OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation);
OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom);OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser);OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)}}f=0;for(g=this.controls.length;f<g;f++)this.addControlToMap(this.controls[f]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,
"unload",this.unloadDestroy);if(c&&c.layers){delete this.center;delete this.zoom;this.addLayers(c.layers);c.center&&!this.getCenter()&&this.setCenter(c.center,c.zoom)}},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return false;
if(this.panTween){this.panTween.stop();this.panTween=null}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize);this.paddingForPopups=null;if(this.controls!=null){for(var a=this.controls.length-1;a>=0;--a)this.controls[a].destroy();this.controls=null}if(this.layers!=null){for(a=this.layers.length-1;a>=0;--a)this.layers[a].destroy(false);
this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv);this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.options=this.events=null},setOptions:function(a){var c=this.minPx&&a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);c&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:true})},getTileSize:function(){return this.tileSize},getBy:function(a,c,d){var e=typeof d.test==
"function";return OpenLayers.Array.filter(this[a],function(a){return a[c]==d||e&&d.test(a[c])})},getLayersBy:function(a,c){return this.getBy("layers",a,c)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,c){return this.getBy("controls",a,c)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){for(var c=null,d=0,e=this.layers.length;d<e;d++){var f=
this.layers[d];if(f.id==a){c=f;break}}return c},setLayerZIndex:function(a,c){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+c*5)},resetLayersZIndex:function(){for(var a=0,c=this.layers.length;a<c;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var c=0,d=this.layers.length;c<d;c++)if(this.layers[c]==a)return false;if(this.events.triggerEvent("preaddlayer",{layer:a})===false)return false;if(this.allOverlays)a.isBaseLayer=false;a.div.className="olLayerDiv";a.div.style.overflow=
"";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&&!this.baseLayer?this.baseLayer==null?this.setBaseLayer(a):a.setVisibility(false):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return true},addLayers:function(a){for(var c=0,d=a.length;c<d;c++)this.addLayer(a[c])},removeLayer:function(a,
c){if(this.events.triggerEvent("preremovelayer",{layer:a})!==false){c==null&&(c=true);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a){this.baseLayer=null;if(c)for(var d=0,e=this.layers.length;d<e;d++){var f=this.layers[d];if(f.isBaseLayer||this.allOverlays){this.setBaseLayer(f);break}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",
{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,c){var d=this.getLayerIndex(a);if(c<0)c=0;else if(c>this.layers.length)c=this.layers.length;if(d!=c){this.layers.splice(d,1);this.layers.splice(c,0,a);for(var d=0,e=this.layers.length;d<e;d++)this.setLayerZIndex(this.layers[d],d);this.events.triggerEvent("changelayer",{layer:a,property:"order"});this.allOverlays&&(c===0?this.setBaseLayer(a):
this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,c){var d=this.getLayerIndex(a)+c;this.setLayerIndex(a,d)},setBaseLayer:function(a){if(a!=this.baseLayer&&OpenLayers.Util.indexOf(this.layers,a)!=-1){var c=this.getCachedCenter(),d=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);this.baseLayer!=null&&!this.allOverlays&&this.baseLayer.setVisibility(false);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(true);
this.baseLayer.inRange===false&&this.baseLayer.redraw()}if(c!=null){a=this.getZoomForResolution(d||this.resolution,true);this.setCenter(c,a,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,c){this.controls.push(a);this.addControlToMap(a,c)},addControls:function(a,c){for(var d=arguments.length===1?[]:c,e=0,f=a.length;e<f;e++)this.addControl(a[e],d[e]?d[e]:null)},addControlToMap:function(a,c){a.outsideViewport=a.div!=null;if(this.displayProjection&&
!a.displayProjection)a.displayProjection=this.displayProjection;a.setMap(this);var d=a.draw(c);if(d&&!a.outsideViewport){d.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;this.viewPortDiv.appendChild(d)}a.autoActivate&&a.activate()},getControl:function(a){for(var c=null,d=0,e=this.controls.length;d<e;d++){var f=this.controls[d];if(f.id==a){c=f;break}}return c},removeControl:function(a){if(a&&a==this.getControl(a.id)){a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div);
OpenLayers.Util.removeItem(this.controls,a)}},addPopup:function(a,c){if(c)for(var d=this.popups.length-1;d>=0;--d)this.removePopup(this.popups[d]);a.map=this;this.popups.push(a);if(d=a.draw()){d.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length;this.layerContainerDiv.appendChild(d)}},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(c){}a.map=null},getSize:function(){var a=null;this.size!=null&&(a=this.size.clone());
return a},updateSize:function(){var a=this.getCurrentSize();if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var c=this.getSize();if(c==null)this.size=c=a;if(!a.equals(c)){this.size=a;a=0;for(c=this.layers.length;a<c;a++)this.layers[a].onMapResize();a=this.getCachedCenter();if(this.baseLayer!=null&&a!=null){c=this.getZoom();this.zoom=null;this.setCenter(a,c)}}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);
if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=this.div.offsetWidth;a.h=this.div.offsetHeight}if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=parseInt(this.div.style.width);a.h=parseInt(this.div.style.height)}return a},calculateBounds:function(a,c){var d=null;a==null&&(a=this.getCachedCenter());c==null&&(c=this.getResolution());if(a!=null&&c!=null)var d=this.size.w*c/2,e=this.size.h*c/2,d=new OpenLayers.Bounds(a.lon-d,a.lat-e,a.lon+d,a.lat+e);return d},getCenter:function(){var a=null,c=this.getCachedCenter();
c&&(a=c.clone());return a},getCachedCenter:function(){if(!this.center&&this.size)this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2});return this.center},getZoom:function(){return this.zoom},pan:function(a,c,d){d=OpenLayers.Util.applyDefaults(d,{animate:true,dragging:false});if(d.dragging)(a!=0||c!=0)&&this.moveByPx(a,c);else{var e=this.getViewPortPxFromLonLat(this.getCachedCenter()),a=e.add(a,c);if(this.dragging||!a.equals(e)){e=this.getLonLatFromViewPortPx(a);if(d.animate)this.panTo(e);
else{this.moveTo(e);if(this.dragging){this.dragging=false;this.events.triggerEvent("moveend")}}}}},panTo:function(a){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(a)){if(!this.panTween)this.panTween=new OpenLayers.Tween(this.panMethod);var c=this.getCachedCenter();if(!a.equals(c)){var c=this.getPixelFromLonLat(c),d=this.getPixelFromLonLat(a),e=0,f=0;this.panTween.start({x:0,y:0},{x:d.x-c.x,y:d.y-c.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(a){this.moveByPx(a.x-
e,a.y-f);e=Math.round(a.x);f=Math.round(a.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(a);this.dragging=false;this.events.triggerEvent("moveend")},this)}})}}else this.setCenter(a)},setCenter:function(a,c,d,e){this.panTween&&this.panTween.stop();this.moveTo(a,c,{dragging:d,forceZoomChange:e})},moveByPx:function(a,c){var d=this.size.w/2,e=this.size.h/2,f=d+a,g=e+c,h=this.baseLayer.wrapDateLine,i=0,j=0;if(this.restrictedExtent){i=d;j=e;h=false}a=h||f<=this.maxPx.x-i&&f>=this.minPx.x+
i?Math.round(a):0;c=g<=this.maxPx.y-j&&g>=this.minPx.y+j?Math.round(c):0;if(a||c){if(!this.dragging){this.dragging=true;this.events.triggerEvent("movestart")}this.center=null;if(a){this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-a+"px";this.minPx.x=this.minPx.x-a;this.maxPx.x=this.maxPx.x-a}if(c){this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-c+"px";this.minPx.y=this.minPx.y-c;this.maxPx.y=this.maxPx.y-c}e=0;for(f=this.layers.length;e<f;++e){d=
this.layers[e];if(d.visibility&&(d===this.baseLayer||d.inRange)){d.moveByPx(a,c);d.events.triggerEvent("move")}}this.events.triggerEvent("move")}},adjustZoom:function(a){if(this.baseLayer&&this.baseLayer.wrapDateLine){var c=this.baseLayer.resolutions,d=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(a)>d)if(this.fractionalZoom)a=this.getZoomForResolution(d);else for(var e=a|0,f=c.length;e<f;++e)if(c[e]<=d){a=e;break}}return a},getMinZoom:function(){return this.adjustZoom(0)},
moveTo:function(a,c,d){a!=null&&!(a instanceof OpenLayers.LonLat)&&(a=new OpenLayers.LonLat(a));d||(d={});if(c!=null){c=parseFloat(c);this.fractionalZoom||(c=Math.round(c))}var e=c,c=this.adjustZoom(c);c!==e&&(a=this.getCenter());var e=d.dragging||this.dragging,f=d.forceZoomChange;if(!this.getCachedCenter()&&!this.isValidLonLat(a)){a=this.maxExtent.getCenterLonLat();this.center=a.clone()}if(this.restrictedExtent!=null){if(a==null)a=this.center;c==null&&(c=this.getZoom());var g=this.getResolutionForZoom(c),
g=this.calculateBounds(a,g);if(!this.restrictedExtent.containsBounds(g)){var h=this.restrictedExtent.getCenterLonLat();g.getWidth()>this.restrictedExtent.getWidth()?a=new OpenLayers.LonLat(h.lon,a.lat):g.left<this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-g.left,0):g.right>this.restrictedExtent.right&&(a=a.add(this.restrictedExtent.right-g.right,0));g.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,h.lat):g.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-
g.bottom):g.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-g.top))}}f=f||this.isValidZoomLevel(c)&&c!=this.getZoom();g=this.isValidLonLat(a)&&!a.equals(this.center);if(f||g||e){e||this.events.triggerEvent("movestart");if(g){!f&&this.center&&this.centerLayerContainer(a);this.center=a.clone()}a=f?this.getResolutionForZoom(c):this.getResolution();if(f||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top=
"0px";var g=this.getMaxExtent({restricted:true}),i=g.getCenterLonLat(),h=this.center.lon-i.lon,i=i.lat-this.center.lat,j=Math.round(g.getWidth()/a),k=Math.round(g.getHeight()/a);this.minPx={x:(this.size.w-j)/2-h/a,y:(this.size.h-k)/2-i/a};this.maxPx={x:this.minPx.x+Math.round(g.getWidth()/a),y:this.minPx.y+Math.round(g.getHeight()/a)}}if(f){this.zoom=c;this.resolution=a}a=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(a,f,d.dragging);d.dragging||this.baseLayer.events.triggerEvent("moveend",
{zoomChanged:f})}a=this.baseLayer.getExtent();for(c=this.layers.length-1;c>=0;--c){g=this.layers[c];if(g!==this.baseLayer&&!g.isBaseLayer){h=g.calculateInRange();if(g.inRange!=h){(g.inRange=h)||g.display(false);this.events.triggerEvent("changelayer",{layer:g,property:"visibility"})}if(h&&g.visibility){g.moveTo(a,f,d.dragging);d.dragging||g.events.triggerEvent("moveend",{zoomChanged:f})}}}this.events.triggerEvent("move");e||this.events.triggerEvent("moveend");if(f){c=0;for(d=this.popups.length;c<d;c++)this.popups[c].updatePosition();
this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var c=this.getViewPortPxFromLonLat(this.layerContainerOrigin),d=this.getViewPortPxFromLonLat(a);if(c!=null&&d!=null){var e=parseInt(this.layerContainerDiv.style.left),a=parseInt(this.layerContainerDiv.style.top),f=Math.round(c.x-d.x),c=Math.round(c.y-d.y);this.layerContainerDiv.style.left=f+"px";this.layerContainerDiv.style.top=c+"px";e=e-f;a=a-c;this.minPx.x=this.minPx.x-e;this.maxPx.x=this.maxPx.x-e;this.minPx.y=this.minPx.y-
a;this.maxPx.y=this.maxPx.y-a}},isValidZoomLevel:function(a){return a!=null&&a>=0&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var c=false;if(a!=null){c=this.getMaxExtent();c=c.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&c})}return c},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.projection;return a},getMaxResolution:function(){var a=null;if(this.baseLayer!=
null)a=this.baseLayer.maxResolution;return a},getMaxExtent:function(a){var c=null;if(a&&a.restricted&&this.restrictedExtent)c=this.restrictedExtent;else if(this.baseLayer!=null)c=this.baseLayer.maxExtent;return c},getNumZoomLevels:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.numZoomLevels;return a},getExtent:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;this.baseLayer!=null?a=this.baseLayer.getResolution():
this.allOverlays===true&&this.layers.length>0&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.units;return a},getScale:function(){var a=null;if(this.baseLayer!=null){a=this.getResolution();a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units)}return a},getZoomForExtent:function(a,c){var d=null;this.baseLayer!=null&&(d=this.baseLayer.getZoomForExtent(a,c));return d},getResolutionForZoom:function(a){var c=null;this.baseLayer&&
(c=this.baseLayer.getResolutionForZoom(a));return c},getZoomForResolution:function(a,c){var d=null;this.baseLayer!=null&&(d=this.baseLayer.getZoomForResolution(a,c));return d},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,c){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var d=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){d=this.getMaxExtent();
for(a=a.clone();a.right<a.left;)a.right=a.right+d.getWidth();d=a.getCenterLonLat().wrapDateLine(d)}this.setCenter(d,this.getZoomForExtent(a,c))},zoomToMaxExtent:function(a){this.zoomToExtent(this.getMaxExtent({restricted:a?a.restricted:true}))},zoomToScale:function(a,c){var d=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),e=this.size.w*d/2,d=this.size.h*d/2,f=this.getCachedCenter();this.zoomToExtent(new OpenLayers.Bounds(f.lon-e,f.lat-d,f.lon+e,f.lat+d),c)},getLonLatFromViewPortPx:function(a){var c=
null;this.baseLayer!=null&&(c=this.baseLayer.getLonLatFromViewPortPx(a));return c},getViewPortPxFromLonLat:function(a){var c=null;this.baseLayer!=null&&(c=this.baseLayer.getViewPortPxFromLonLat(a));return c},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var c=a?this.getLonLatFromPixel(a):this.getCachedCenter()||new OpenLayers.LonLat(0,
0),d=this.getResolution(),a=c.add(-d/2,0),e=c.add(d/2,0),f=c.add(0,-d/2),c=c.add(0,d/2),d=new OpenLayers.Projection("EPSG:4326"),g=this.getProjectionObject()||d;if(!g.equals(d)){a.transform(g,d);e.transform(g,d);f.transform(g,d);c.transform(g,d)}return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,e),OpenLayers.Util.distVincenty(f,c))},getViewPortPxFromLayerPx:function(a){var c=null;if(a!=null)var c=parseInt(this.layerContainerDiv.style.left),d=parseInt(this.layerContainerDiv.style.top),c=a.add(c,
d);return c},getLayerPxFromViewPortPx:function(a){var c=null;if(a!=null){var c=-parseInt(this.layerContainerDiv.style.left),d=-parseInt(this.layerContainerDiv.style.top),c=a.add(c,d);if(isNaN(c.x)||isNaN(c.y))c=null}return c},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(a))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;
OpenLayers.Map.TILE_HEIGHT=256;
OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales,resolutions,maxScale,minScale,maxResolution,minResolution,numZoomLevels,maxZoomLevel".split(","),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,
numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(a,c){this.metadata={};this.addOptions(c);this.name=a;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)}},
destroy:function(a){a==null&&(a=true);this.map!=null&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;if(this.events){this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy()}this.events=this.eventListeners=null},clone:function(a){a==null&&(a=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},getOptions:function(){var a={},c;for(c in this.options)a[c]=this[c];return a},setName:function(a){if(a!=
this.name){this.name=a;this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}},addOptions:function(a,c){if(this.options==null)this.options={};if(a){if(typeof a.projection=="string")a.projection=new OpenLayers.Projection(a.projection);a.projection&&OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]);if(a.maxExtent&&!(a.maxExtent instanceof OpenLayers.Bounds))a.maxExtent=new OpenLayers.Bounds(a.maxExtent);if(a.minExtent&&!(a.minExtent instanceof
OpenLayers.Bounds))a.minExtent=new OpenLayers.Bounds(a.minExtent)}OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);if(this.projection&&this.projection.getUnits())this.units=this.projection.getUnits();if(this.map){var d=this.map.getResolution(),e=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),f;for(f in a)if(a.hasOwnProperty(f)&&OpenLayers.Util.indexOf(e,f)>=0){this.initResolutions();if(c&&this.map.baseLayer===this){this.map.setCenter(this.map.getCenter(),
this.map.getZoomForResolution(d),false,true);this.map.events.triggerEvent("changebaselayer",{layer:this})}break}}},onMapResize:function(){},redraw:function(){var a=false;if(this.map){this.inRange=this.calculateInRange();var c=this.getExtent();if(c&&this.inRange&&this.visibility){this.moveTo(c,true,false);this.events.triggerEvent("moveend",{zoomChanged:true});a=true}}return a},moveTo:function(){var a=this.visibility;this.isBaseLayer||(a=a&&this.inRange);this.display(a)},moveByPx:function(){},setMap:function(a){if(this.map==
null){this.map=a;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if(typeof this.projection=="string")this.projection=new OpenLayers.Projection(this.projection);this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();this.div.style.display=this.visibility&&this.inRange?"":"none"}this.setTileSize()}},afterAdd:function(){},
removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();if(this.gutter)this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter)},getVisibility:function(){return this.visibility},setVisibility:function(a){if(a!=this.visibility){this.visibility=a;this.display(a);this.redraw();this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"});
this.events.triggerEvent("visibilitychanged")}},display:function(a){if(a!=(this.div.style.display!="none"))this.div.style.display=a&&this.calculateInRange()?"block":"none"},calculateInRange:function(){var a=false;if(this.alwaysInRange)a=true;else if(this.map){a=this.map.getResolution();a=a>=this.minResolution&&a<=this.maxResolution}return a},setIsBaseLayer:function(a){if(a!=this.isBaseLayer){this.isBaseLayer=a;this.map!=null&&this.map.events.triggerEvent("changebaselayer",{layer:this})}},initResolutions:function(){var a,
c,d,e={},f=true;a=0;for(c=this.RESOLUTION_PROPERTIES.length;a<c;a++){d=this.RESOLUTION_PROPERTIES[a];e[d]=this.options[d];f&&this.options[d]&&(f=false)}if(this.alwaysInRange==null)this.alwaysInRange=f;if(e.resolutions==null)e.resolutions=this.resolutionsFromScales(e.scales);if(e.resolutions==null)e.resolutions=this.calculateResolutions(e);if(e.resolutions==null){a=0;for(c=this.RESOLUTION_PROPERTIES.length;a<c;a++){d=this.RESOLUTION_PROPERTIES[a];e[d]=this.options[d]!=null?this.options[d]:this.map[d]}if(e.resolutions==
null)e.resolutions=this.resolutionsFromScales(e.scales);if(e.resolutions==null)e.resolutions=this.calculateResolutions(e)}var g;if(this.options.maxResolution&&this.options.maxResolution!=="auto")g=this.options.maxResolution;this.options.minScale&&(g=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var h;if(this.options.minResolution&&this.options.minResolution!=="auto")h=this.options.minResolution;this.options.maxScale&&(h=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,
this.units));if(e.resolutions){e.resolutions.sort(function(a,c){return c-a});g||(g=e.resolutions[0]);h||(h=e.resolutions[e.resolutions.length-1])}if(this.resolutions=e.resolutions){c=this.resolutions.length;this.scales=Array(c);for(a=0;a<c;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=c}if(this.minResolution=h)this.maxScale=OpenLayers.Util.getScaleFromResolution(h,this.units);if(this.maxResolution=g)this.minScale=OpenLayers.Util.getScaleFromResolution(g,
this.units)},resolutionsFromScales:function(a){if(a!=null){var c,d,e;e=a.length;c=Array(e);for(d=0;d<e;d++)c[d]=OpenLayers.Util.getResolutionFromScale(a[d],this.units);return c}},calculateResolutions:function(a){var c,d,e=a.maxResolution;if(a.minScale!=null)e=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units);else if(e=="auto"&&this.maxExtent!=null){c=this.map.getSize();d=this.maxExtent.getWidth()/c.w;c=this.maxExtent.getHeight()/c.h;e=Math.max(d,c)}d=a.minResolution;if(a.maxScale!=null)d=
OpenLayers.Util.getResolutionFromScale(a.maxScale,this.units);else if(a.minResolution=="auto"&&this.minExtent!=null){c=this.map.getSize();d=this.minExtent.getWidth()/c.w;c=this.minExtent.getHeight()/c.h;d=Math.max(d,c)}if(typeof e!=="number"&&typeof d!=="number"&&this.maxExtent!=null){e=this.map.getTileSize();e=Math.max(this.maxExtent.getWidth()/e.w,this.maxExtent.getHeight()/e.h)}c=a.maxZoomLevel;a=a.numZoomLevels;typeof d==="number"&&typeof e==="number"&&a===void 0?a=Math.floor(Math.log(e/d)/Math.log(2))+
1:a===void 0&&c!=null&&(a=c+1);if(!(typeof a!=="number"||a<=0||typeof e!=="number"&&typeof d!=="number")){c=Array(a);var f=2;typeof d=="number"&&typeof e=="number"&&(f=Math.pow(e/d,1/(a-1)));var g;if(typeof e==="number")for(g=0;g<a;g++)c[g]=e/Math.pow(f,g);else for(g=0;g<a;g++)c[a-1-g]=d*Math.pow(f,g);return c}},getResolution:function(){return this.getResolutionForZoom(this.map.getZoom())},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,c){var d=this.map.getSize();
return this.getZoomForResolution(Math.max(a.getWidth()/d.w,a.getHeight()/d.h),c)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom)var c=Math.floor(a),d=Math.ceil(a),a=this.resolutions[c]-(a-c)*(this.resolutions[c]-this.resolutions[d]);else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,c){var d,e;if(this.map.fractionalZoom){var f=0,g=this.resolutions[f],h=this.resolutions[this.resolutions.length-
1],i;d=0;for(e=this.resolutions.length;d<e;++d){i=this.resolutions[d];if(i>=a){g=i;f=d}if(i<=a){h=i;break}}d=g-h;d=d>0?f+(g-a)/d:f}else{g=Number.POSITIVE_INFINITY;d=0;for(e=this.resolutions.length;d<e;d++)if(c){f=Math.abs(this.resolutions[d]-a);if(f>g)break;g=f}else if(this.resolutions[d]<a)break;d=Math.max(0,d-1)}return d},getLonLatFromViewPortPx:function(a){var c=null,d=this.map;if(a!=null&&d.minPx){var c=d.getResolution(),e=d.getMaxExtent({restricted:true}),c=new OpenLayers.LonLat((a.x-d.minPx.x)*
c+e.left,(d.minPx.y-a.y)*c+e.top);this.wrapDateLine&&(c=c.wrapDateLine(this.maxExtent))}return c},getViewPortPxFromLonLat:function(a,c){var d=null;if(a!=null){c=c||this.map.getResolution();d=this.map.calculateBounds(null,c);d=new OpenLayers.Pixel(1/c*(a.lon-d.left),1/c*(d.top-a.lat))}return d},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var c=this.div.childNodes,d=0,e=c.length;d<e;++d){var f=c[d].firstChild||c[d],g=c[d].lastChild;if(g&&g.nodeName.toLowerCase()==="iframe")f=g.parentNode;
OpenLayers.Util.modifyDOMElement(f,null,null,null,null,null,null,a)}this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter)var c=this.gutter*this.map.getResolution(),a=new OpenLayers.Bounds(a.left-c,a.bottom-c,a.right+c,a.top+c);if(this.wrapDateLine){c={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};
a=a.wrapDateLine(this.maxExtent,c)}return a},CLASS_NAME:"OpenLayers.Layer"});
OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var c;a||(a=OpenLayers.BROWSER_NAME=="msie"?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();typeof OpenLayers.Lang[a[0]]=="object"&&(c=a[0]);if(a[1]){var d=a[0]+"-"+a[1].toUpperCase();typeof OpenLayers.Lang[d]=="object"&&(c=d)}if(!c){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language");
c=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=c},translate:function(a,c){var d=OpenLayers.Lang[OpenLayers.Lang.getCode()];(d=d&&d[a])||(d=a);c&&(d=OpenLayers.String.format(d,c));return d}};OpenLayers.i18n=OpenLayers.Lang.translate;
OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(){throw Error("Read not implemented.");},write:function(){throw Error("Write not implemented.");},CLASS_NAME:"OpenLayers.Format"});
OpenLayers.Format.CSWGetRecords=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS),c=OpenLayers.Format.CSWGetRecords["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported CSWGetRecords version: "+a.version;return new c(a)};OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"};
OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);if(this.id==null)this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+
"_")},destroy:function(){if(this.events){this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&typeof this.handlers[a].destroy=="function"&&this.handlers[a].destroy();this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}this.div=null},setMap:function(a){this.map=a;this.handler&&
this.handler.setMap(a)},draw:function(a){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className=this.div.className+" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=OpenLayers.Function.False}if(this.title!="")this.div.title=this.title}if(a!=null)this.position=a.clone();this.moveTo(this.position);return this.div},moveTo:function(a){if(a!=null&&this.div!=null){this.div.style.left=
a.x+"px";this.div.style.top=a.y+"px"}},activate:function(){if(this.active)return false;this.handler&&this.handler.activate();this.active=true;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){this.handler&&this.handler.deactivate();this.active=false;this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("deactivate");
return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;
OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){if(this.mapDiv){this.handlers.click&&this.handlers.click.destroy();this.handlers.drag&&this.handlers.drag.destroy();
this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle);this.extentRectangle=null;if(this.rectEvents){this.rectEvents.destroy();this.rectEvents=null}if(this.ovmap){this.ovmap.destroy();this.ovmap=null}this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null}if(this.minimizeDiv){this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null}this.map.events.un({buttonclick:this.onButtonClick,
moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length===0)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";
this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);
this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className=this.div.className+(" "+this.displayClass+"Container");var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");
this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",
this,this.baseLayerDraw)},rectDrag:function(a){var c=this.handlers.drag.last.x-a.x,d=this.handlers.drag.last.y-a.y;if(c!=0||d!=0){var e=this.rectPxBounds.top,f=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),g=this.rectPxBounds.getWidth(),d=Math.max(0,e-d),d=Math.min(d,this.ovmap.size.h-this.hComp-a),c=Math.max(0,f-c),c=Math.min(c,this.ovmap.size.w-this.wComp-g);this.setRectPxBounds(new OpenLayers.Bounds(c,d+a,c+g,d))}},mapDivClick:function(a){var c=this.rectPxBounds.getCenterPixel(),
d=a.xy.x-c.x,e=a.xy.y-c.y,f=this.rectPxBounds.top,g=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),c=this.rectPxBounds.getWidth(),e=Math.max(0,f+e),e=Math.min(e,this.ovmap.size.h-a),d=Math.max(0,g+d),d=Math.min(d,this.ovmap.size.w-c);this.setRectPxBounds(new OpenLayers.Bounds(d,e+a,d+c,e));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display=
"";this.showToggle(false);a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(true);a!=null&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":""},update:function(){this.ovmap==null&&this.createMap();(this.autoPan||!this.isSuitableOverview())&&this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),c=this.map.maxExtent,
a=new OpenLayers.Bounds(Math.max(a.left,c.left),Math.max(a.bottom,c.bottom),Math.min(a.right,c.right),Math.min(a.top,c.top));this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));c=this.ovmap.getResolution()/this.map.getResolution();return c>this.minRatio&&c<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),c=this.ovmap.getResolution(),d=c/a;d>this.maxRatio?
c=this.minRatio*a:d<=this.minRatio&&(c=this.maxRatio*a);if(this.ovmap.getProjection()!=this.map.getProjection()){a=this.map.center.clone();a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else a=this.map.center;this.ovmap.setCenter(a,this.ovmap.getZoomForResolution(c*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,
a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,
"border-bottom-width")))?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:true,"double":false,stopSingle:true,stopDouble:true,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register("mouseover",this,function(){!this.handlers.drag.active&&
!this.map.dragging&&this.handlers.drag.activate()});this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,c=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&c?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[c]:1}},updateRectToMap:function(){var a=
this.getRectBoundsFromMapBounds(this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent());a&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var c=
Math.max(a.top,0),d=Math.max(a.left,0),e=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp),f=Math.max(a-d,0),g=Math.max(e-c,0);if(f<this.minRectSize||g<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;f=d+f/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(c+g/2-this.minRectSize/2)+"px";this.extentRectangle.style.left=Math.round(f)+"px";this.extentRectangle.style.height=
this.minRectSize+"px";this.extentRectangle.style.width=this.minRectSize+"px"}else{this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.extentRectangle.style.top=Math.round(c)+"px";this.extentRectangle.style.left=Math.round(d)+"px";this.extentRectangle.style.height=Math.round(g)+"px";this.extentRectangle.style.width=Math.round(f)+"px"}this.rectPxBounds=new OpenLayers.Bounds(Math.round(d),Math.round(e),Math.round(a),Math.round(c))},getRectBoundsFromMapBounds:function(a){var c=this.getOverviewPxFromLonLat({lon:a.left,
lat:a.bottom}),a=this.getOverviewPxFromLonLat({lon:a.right,lat:a.top}),d=null;c&&a&&(d=new OpenLayers.Bounds(c.x,c.y,a.x,a.y));return d},getMapBoundsFromRectBounds:function(a){var c=this.getLonLatFromOverviewPx({x:a.left,y:a.bottom}),a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(c.lon,c.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var c=this.ovmap.size,d=this.ovmap.getResolution(),e=this.ovmap.getExtent().getCenterLonLat();return{lon:e.lon+(a.x-c.w/2)*d,
lat:e.lat-(a.y-c.h/2)*d}},getOverviewPxFromLonLat:function(a){var c=this.ovmap.getResolution(),d=this.ovmap.getExtent();if(d)return{x:Math.round(1/c*(a.lon-d.left)),y:Math.round(1/c*(d.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});
OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;return a=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var a=0;a<=this.MAX_ZOOM_LEVEL;++a)this.RESOLUTIONS[a]=
156543.03390625/Math.pow(2,a);this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),c=new OpenLayers.Projection("EPSG:900913");return function(d,e){var f=OpenLayers.Projection.transform({x:d,y:e},a,c);return new OpenLayers.LonLat(f.x,f.y)}}(),inverseMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),c=new OpenLayers.Projection("EPSG:900913");return function(d,e){var f=OpenLayers.Projection.transform({x:d,
y:e},c,a);return new OpenLayers.LonLat(f.x,f.y)}}()};
OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,c){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null)this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane")},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=
parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";if(OpenLayers.BROWSER_NAME=="msie")this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")";this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();this.mapObject==null&&this.loadWarningMessage()},removeMap:function(a){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane);
OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),c=Math.min(a.w,300),d=Math.min(a.h,200),c=new OpenLayers.Size(c,d),a=(new OpenLayers.Pixel(a.w/2,a.h/2)).add(-c.w/2,-c.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",a,c,null,null,null,"auto");a.style.padding="7px";a.style.backgroundColor="yellow";a.innerHTML=this.getWarningHTML();this.div.appendChild(a)},getWarningHTML:function(){return""},
display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(a,c){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(a,-c):this.moveTo(this.map.getCachedCenter())},moveTo:function(a,c,d){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(this.mapObject!=null){var e=this.map.getCenter(),f=this.map.getZoom();if(e!=null){var g=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectCenter()),h=this.getOLZoomFromMapObjectZoom(this.getMapObjectZoom());if(!e.equals(g)||f!=h)if(!c&&g&&this.dragPanMapObject&&this.smoothDragPan){f=this.map.getViewPortPxFromLonLat(g);e=this.map.getViewPortPxFromLonLat(e);this.dragPanMapObject(e.x-f.x,f.y-e.y)}else{e=this.getMapObjectLonLatFromOLLonLat(e);f=this.getMapObjectZoomFromOLZoom(f);this.setMapObjectCenter(e,
f,d)}}}},getLonLatFromViewPortPx:function(a){var c=null;this.mapObject!=null&&this.getMapObjectCenter()!=null&&(c=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectLonLatFromMapObjectPixel(this.getMapObjectPixelFromOLPixel(a))));return c},getViewPortPxFromLonLat:function(a){var c=null;this.mapObject!=null&&this.getMapObjectCenter()!=null&&(c=this.getOLPixelFromMapObjectPixel(this.getMapObjectPixelFromMapObjectLonLat(this.getMapObjectLonLatFromOLLonLat(a))));return c},getOLLonLatFromMapObjectLonLat:function(a){var c=
null;if(a!=null){c=this.getLongitudeFromMapObjectLonLat(a);a=this.getLatitudeFromMapObjectLonLat(a);c=new OpenLayers.LonLat(c,a)}return c},getMapObjectLonLatFromOLLonLat:function(a){var c=null;a!=null&&(c=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return c},getOLPixelFromMapObjectPixel:function(a){var c=null;if(a!=null){c=this.getXFromMapObjectPixel(a);a=this.getYFromMapObjectPixel(a);c=new OpenLayers.Pixel(c,a)}return c},getMapObjectPixelFromOLPixel:function(a){var c=null;a!=null&&(c=this.getMapObjectPixelFromXY(a.x,
a.y));return c},CLASS_NAME:"OpenLayers.Layer.EventPane"});
OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var a=["minZoomLevel","maxZoomLevel","numZoomLevels"],c=0,d=a.length;c<d;c++){var e=a[c];this[e]=this.options[e]!=null?this.options[e]:this.map[e]}if(this.minZoomLevel==null||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;a=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;c=this.options.numZoomLevels==null&&this.options.maxZoomLevel!=null||this.numZoomLevels==null&&this.maxZoomLevel!=
null?this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=c!=null?Math.min(c,a):a;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){a=0;this.resolutions=[];for(c=this.minZoomLevel;c<=this.maxZoomLevel;c++)this.resolutions[a++]=this.RESOLUTIONS[c];this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null)return OpenLayers.Layer.prototype.getResolution.apply(this,
arguments);var a=null,c=this.map.getSize(),d=this.getExtent();c!=null&&d!=null&&(a=Math.max(d.getWidth()/c.w,d.getHeight()/c.h));return a},getExtent:function(){var a=this.map.getSize(),c=this.getLonLatFromViewPortPx({x:0,y:0}),a=this.getLonLatFromViewPortPx({x:a.w,y:a.h});return c!=null&&a!=null?new OpenLayers.Bounds(c.lon,a.lat,a.lon,c.lat):null},getZoomForResolution:function(a){return this.resolutions!=null?OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments):this.getZoomForExtent(OpenLayers.Layer.prototype.getExtent.apply(this,
[]))},getOLZoomFromMapObjectZoom:function(a){var c=null;if(a!=null){c=a-this.minZoomLevel;this.map.baseLayer!==this&&(c=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(c)))}return c},getMapObjectZoomFromOLZoom:function(a){var c=null;if(a!=null){c=a+this.minZoomLevel;this.map.baseLayer!==this&&(c=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(c)))}return c},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});
OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6,6.705522537231445E-7],
type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(a,c){c=c||{};if(!c.version)c.version=typeof GMap2==="function"?"2":"3";var d=OpenLayers.Layer.Google["v"+c.version.replace(/\./g,"_")];if(d)OpenLayers.Util.applyDefaults(c,d);else throw"Unsupported Google Maps API version: "+c.version;OpenLayers.Util.applyDefaults(c,d.DEFAULTS);if(c.maxExtent)c.maxExtent=c.maxExtent.clone();OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[a,c]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,
[a,c]);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(a){var c=this.opacity==null?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(c)},display:function(a){this._dragging||this.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},
moveTo:function(a,c,d){this._dragging=d;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(a){if(a!==this.opacity){this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"});this.opacity=a}if(this.getVisibility()){var c=this.getMapContainer();OpenLayers.Util.modifyDOMElement(c,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(false);var a=OpenLayers.Layer.Google.cache[this.map.id];
a&&a.count<=1&&this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var c=this.mapObject&&this.getMapContainer();c&&c.parentNode&&c.parentNode.removeChild(c);(c=a.termsOfUse)&&c.parentNode&&c.parentNode.removeChild(c);(a=a.poweredBy)&&a.parentNode&&a.parentNode.removeChild(a)}},removeMap:function(a){this.visibility&&this.mapObject&&this.setGMapVisibility(false);var c=OpenLayers.Layer.Google.cache[a.id];
if(c)if(c.count<=1){this.removeGMapElements();delete OpenLayers.Layer.Google.cache[a.id]}else--c.count;delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var c=null;if(a!=null){c=a.getSouthWest();a=a.getNorthEast();if(this.sphericalMercator){c=this.forwardMercator(c.lng(),c.lat());a=this.forwardMercator(a.lng(),a.lat())}else{c=new OpenLayers.LonLat(c.lng(),
c.lat());a=new OpenLayers.LonLat(a.lng(),a.lat())}c=new OpenLayers.Bounds(c.lon,c.lat,a.lon,a.lat)}return c},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),
a.lat()).lat:a.lat()},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};
OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){if(!this.type)this.type=G_NORMAL_MAP;var a,c,d,e=OpenLayers.Layer.Google.cache[this.map.id];if(e){a=e.mapObject;c=e.termsOfUse;d=e.poweredBy;++e.count}else{var e=this.map.viewPortDiv,f=document.createElement("div");f.id=this.map.id+"_GMap2Container";f.style.position="absolute";f.style.width="100%";f.style.height="100%";e.appendChild(f);try{a=new GMap2(f);c=f.lastChild;e.appendChild(c);c.style.zIndex=
"1100";c.style.right="";c.style.bottom="";c.className="olLayerGoogleCopyright";d=f.lastChild;e.appendChild(d);d.style.zIndex="1100";d.style.right="";d.style.bottom="";d.className="olLayerGooglePoweredBy gmnoprint"}catch(g){throw g;}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:c,poweredBy:d,count:1}}this.mapObject=a;this.termsOfUse=c;this.poweredBy=d;OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)===-1&&this.mapObject.addMapType(this.type);typeof a.getDragObject==
"function"?this.dragObject=a.getDragObject():this.dragPanMapObject=null;this.isBaseLayer===false&&this.setGMapVisibility(this.div.style.display!=="none")},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,c=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(c);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=true}},setGMapVisibility:function(a){var c=
OpenLayers.Layer.Google.cache[this.map.id];if(c){var d=this.mapObject.getContainer();if(a===true){this.mapObject.setMapType(this.type);d.style.display="";this.termsOfUse.style.left="";this.termsOfUse.style.display="";this.poweredBy.style.display="";c.displayed=this.id}else{c.displayed===this.id&&delete c.displayed;if(!c.displayed){d.style.display="none";this.termsOfUse.style.display="none";this.termsOfUse.style.left="-9999px";this.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getContainer()},
getMapObjectBoundsFromOLBounds:function(a){var c=null;if(a!=null){c=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left);a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right);c=new GLatLngBounds(new GLatLng(c.lat,c.lon),new GLatLng(a.lat,a.lon))}return c},setMapObjectCenter:function(a,c){this.mapObject.setCenter(a,c)},dragPanMapObject:function(a,c){this.dragObject.moveBy(new GSize(-a,c))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},
getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,c){var d;if(this.sphericalMercator){d=this.inverseMercator(a,c);d=new GLatLng(d.lat,d.lon)}else d=new GLatLng(c,a);return d},getMapObjectPixelFromXY:function(a,c){return new GPoint(a,c)}};
OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,c,d){this.layer=a;this.lonlat=c;this.data=d!=null?d:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.layer!=null&&this.layer.map!=null&&this.popup!=null&&this.layer.map.removePopup(this.popup);this.layer!=null&&this.marker!=null&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;if(this.marker!=
null){this.destroyMarker(this.marker);this.marker=null}if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null}},onScreen:function(){var a=false;this.layer!=null&&this.layer.map!=null&&(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){if(this.lonlat!=null)this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon);return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){if(this.lonlat!=null){if(!this.popup)this.popup=
new (this.popupClass?this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,a);if(this.data.overflow!=null)this.popup.contentDiv.style.overflow=this.data.overflow;this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null}},CLASS_NAME:"OpenLayers.Feature"});
OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};
OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,c,d){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,c]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};if(c)this.attributes=OpenLayers.Util.extend(this.attributes,c);this.style=d?d:null},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=
null}this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var c=false;if(this.layer&&this.layer.map){c=this.layer.map.getExtent();if(a){a=this.geometry.getBounds();c=c.intersectsBounds(a)}else c=c.toGeometry().intersects(this.geometry)}return c},getVisibility:function(){return!(this.style&&this.style.display=="none"||
!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,c,d){var e=false;this.geometry&&(e=this.geometry.atPoint(a,c,d));return e},destroyPopup:function(){},move:function(a){if(this.layer&&this.geometry.move){var a=a.CLASS_NAME=="OpenLayers.LonLat"?this.layer.getViewPortPxFromLonLat(a):
a,c=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),d=this.layer.map.getResolution();this.geometry.move(d*(a.x-c.x),d*(c.y-a.y));this.layer.drawFeature(this);return c}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=
a}else if(a==OpenLayers.State.UNKNOWN)this.state=a},CLASS_NAME:"OpenLayers.Feature.Vector"});
OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4,
hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,
strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};
OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,c){OpenLayers.Util.extend(this,c);this.rules=[];c&&c.rules&&this.addRules(c.rules);this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,c=this.rules.length;a<c;a++){this.rules[a].destroy();
this.rules[a]=null}this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var c=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),d=this.rules,e,f=[],g=false,h=0,i=d.length;h<i;h++){e=d[h];if(e.evaluate(a))if(e instanceof OpenLayers.Rule&&e.elseFilter)f.push(e);else{g=true;this.applySymbolizer(e,c,a)}}if(g==false&&f.length>0){g=true;h=0;for(i=f.length;h<i;h++)this.applySymbolizer(f[h],c,a)}if(d.length>0&&g==false)c.display="none";if(c.label!=
null&&typeof c.label!=="string")c.label=""+c.label;return c},applySymbolizer:function(a,c,d){var e=d.geometry?this.getSymbolizerPrefix(d.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],a=a.symbolizer[e]||a.symbolizer;if(this.defaultsPerSymbolizer===true){e=this.defaultStyle;OpenLayers.Util.applyDefaults(a,{pointRadius:e.pointRadius});(a.stroke===true||a.graphic===true)&&OpenLayers.Util.applyDefaults(a,{strokeWidth:e.strokeWidth,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeDashstyle:e.strokeDashstyle,
strokeLinecap:e.strokeLinecap});(a.fill===true||a.graphic===true)&&OpenLayers.Util.applyDefaults(a,{fillColor:e.fillColor,fillOpacity:e.fillOpacity});a.graphic===true&&OpenLayers.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,
graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(c,a),d)},createLiterals:function(a,c){var d=OpenLayers.Util.extend({},c.attributes||c.data);OpenLayers.Util.extend(d,this.context);for(var e in this.propertyStyles)a[e]=OpenLayers.Style.createLiteral(a[e],d,c,e);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var c=this.rules,d,e,f=0,g=c.length;f<g;f++){d=c[f].symbolizer;for(var h in d){e=d[h];if(typeof e==
"object")this.addPropertyStyles(a,e);else{this.addPropertyStyles(a,d);break}}}return a},addPropertyStyles:function(a,c){var d,e;for(e in c){d=c[e];typeof d=="string"&&d.match(/\$\{\w+\}/)&&(a[e]=true)}return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var c=OpenLayers.Style.SYMBOLIZER_PREFIXES,d=0,e=c.length;d<
e;d++)if(a.CLASS_NAME.indexOf(c[d])!=-1)return c[d]},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var c=0,d=this.rules.length;c<d;++c)a.rules.push(this.rules[c].clone())}a.context=this.context&&OpenLayers.Util.extend({},this.context);c=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(c,a)},CLASS_NAME:"OpenLayers.Style"});
OpenLayers.Style.createLiteral=function(a,c,d,e){if(typeof a=="string"&&a.indexOf("${")!=-1){a=OpenLayers.String.format(a,c,[d,e]);a=isNaN(a)||!a?a:parseFloat(a)}return a};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];
OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);this.symbolizers&&delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var c=
this.getContext(a),d=true;if(this.minScaleDenominator||this.maxScaleDenominator)var e=a.layer.map.getScale();this.minScaleDenominator&&(d=e>=OpenLayers.Style.createLiteral(this.minScaleDenominator,c));d&&this.maxScaleDenominator&&(d=e<OpenLayers.Style.createLiteral(this.maxScaleDenominator,c));d&&this.filter&&(d=this.filter.CLASS_NAME=="OpenLayers.Filter.FeatureId"?this.filter.evaluate(a):this.filter.evaluate(c));return d},getContext:function(a){var c=this.context;c||(c=a.attributes||a.data);typeof this.context==
"function"&&(c=this.context(a));return c},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.symbolizers){var c=this.symbolizers.length;a.symbolizers=Array(c);for(var d=0;d<c;++d)a.symbolizers[d]=this.symbolizers[d].clone()}else{a.symbolizer={};for(var e in this.symbolizer){c=this.symbolizer[e];d=typeof c;d==="object"?a.symbolizer[e]=OpenLayers.Util.extend({},c):d==="string"&&(a.symbolizer[e]=c)}}a.filter=this.filter&&this.filter.clone();a.context=this.context&&OpenLayers.Util.extend({},
this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"});
OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){if(window.ActiveXObject)this.xmldom=new ActiveXObject("Microsoft.XMLDOM");OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var c in this.namespaces)this.namespaceAlias[this.namespaces[c]]=c},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,
arguments)},setNamespace:function(a,c){this.namespaces[a]=c;this.namespaceAlias[c]=a},read:function(a){var c=a.indexOf("<");c>0&&(a=a.substring(c));c=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var c;c=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;c.loadXML(a);return c},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var c=new XMLHttpRequest;c.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),false);
c.overrideMimeType&&c.overrideMimeType("text/xml");c.send(null);return c.responseXML});if(this.keepData)this.data=c;return c},write:function(a){if(this.xmldom)a=a.xml;else{var c=new XMLSerializer;if(a.nodeType==1){var d=document.implementation.createDocument("","",null);d.importNode&&(a=d.importNode(a,true));d.appendChild(a);a=c.serializeToString(d)}else a=c.serializeToString(a)}return a},createElementNS:function(a,c){return this.xmldom?typeof a=="string"?this.xmldom.createNode(1,c,a):this.xmldom.createNode(1,
c,""):document.createElementNS(a,c)},createTextNode:function(a){typeof a!=="string"&&(a=""+a);return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,c,d){var e=[];if(a.getElementsByTagNameNS)e=a.getElementsByTagNameNS(c,d);else for(var a=a.getElementsByTagName("*"),f,g,h=0,i=a.length;h<i;++h){f=a[h];g=f.prefix?f.prefix+":"+d:d;if(d=="*"||g==f.nodeName)(c=="*"||c==f.namespaceURI)&&e.push(f)}return e},getAttributeNodeNS:function(a,c,d){var e=null;
if(a.getAttributeNodeNS)e=a.getAttributeNodeNS(c,d);else for(var a=a.attributes,f,g,h=0,i=a.length;h<i;++h){f=a[h];if(f.namespaceURI==c){g=f.prefix?f.prefix+":"+d:d;if(g==f.nodeName){e=f;break}}}return e},getAttributeNS:function(a,c,d){var e="";if(a.getAttributeNS)e=a.getAttributeNS(c,d)||"";else if(a=this.getAttributeNodeNS(a,c,d))e=a.nodeValue;return e},getChildValue:function(a,c){var d=c||"";if(a)for(var e=a.firstChild;e;e=e.nextSibling)switch(e.nodeType){case 3:case 4:d=d+e.nodeValue}return d},
isSimpleContent:function(a){for(var c=true,a=a.firstChild;a;a=a.nextSibling)if(a.nodeType===1){c=false;break}return c},contentType:function(a){for(var c=false,d=false,e=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:d=true;break;case 8:break;default:c=true}if(d&&c)break}if(d&&c)e=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(d)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(c)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return e},hasAttributeNS:function(a,
c,d){var e=false;return e=a.hasAttributeNS?a.hasAttributeNS(c,d):!!this.getAttributeNodeNS(a,c,d)},setAttributeNS:function(a,c,d,e){if(a.setAttributeNS)a.setAttributeNS(c,d,e);else if(this.xmldom)if(c){c=a.ownerDocument.createNode(2,d,c);c.nodeValue=e;a.setAttributeNode(c)}else a.setAttribute(d,e);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,c){var c=c||{},d=c.uri||this.namespaces[c.prefix];if(!d){d=a.indexOf(":");d=this.namespaces[a.substring(0,d)]}d||(d=this.namespaces[this.defaultPrefix]);
d=this.createElementNS(d,a);c.attributes&&this.setAttributes(d,c.attributes);var e=c.value;e!=null&&d.appendChild(this.createTextNode(e));return d},setAttributes:function(a,c){var d,e,f;for(f in c)if(c[f]!=null&&c[f].toString){d=c[f].toString();e=this.namespaces[f.substring(0,f.indexOf(":"))]||null;this.setAttributeNS(a,e,f,d)}},readNode:function(a,c){c||(c={});var d=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(d){var e=a.localName||a.nodeName.split(":").pop();
(d=d[e]||d["*"])&&d.apply(this,[a,c])}return c},readChildNodes:function(a,c){c||(c={});for(var d=a.childNodes,e,f=0,g=d.length;f<g;++f){e=d[f];e.nodeType==1&&this.readNode(e,c)}return c},writeNode:function(a,c,d){var e,f=a.indexOf(":");if(f>0){e=a.substring(0,f);a=a.substring(f+1)}else e=d?this.namespaceAlias[d.namespaceURI]:this.defaultPrefix;c=this.writers[e][a].apply(this,[c]);d&&d.appendChild(c);return c},getChildEl:function(a,c,d){return a&&this.getThisOrNextEl(a.firstChild,c,d)},getNextEl:function(a,
c,d){return a&&this.getThisOrNextEl(a.nextSibling,c,d)},getThisOrNextEl:function(a,c,d){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if((!c||c===(a.localName||a.nodeName.split(":").pop()))&&(!d||d===a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,c){var d=null;if(a)if(a.lookupNamespaceURI)d=a.lookupNamespaceURI(c);else a:switch(a.nodeType){case 1:if(a.namespaceURI!==
null&&a.prefix===c){d=a.namespaceURI;break a}if(d=a.attributes.length)for(var e,f=0;f<d;++f){e=a.attributes[f];if(e.prefix==="xmlns"&&e.name==="xmlns:"+c){d=e.value||null;break a}else if(e.name==="xmlns"&&c===null){d=e.value||null;break a}}d=this.lookupNamespaceURI(a.parentNode,c);break a;case 2:d=this.lookupNamespaceURI(a.ownerElement,c);break a;case 9:d=this.lookupNamespaceURI(a.documentElement,c);break a;case 6:case 12:case 10:case 11:break a;default:d=this.lookupNamespaceURI(a.parentNode,c)}return d},
getXMLDoc:function(){if(!OpenLayers.Format.XML.document&&!this.xmldom)if(document.implementation&&document.implementation.createDocument)OpenLayers.Format.XML.document=document.implementation.createDocument("","",null);else if(!this.xmldom&&window.ActiveXObject)this.xmldom=new ActiveXObject("Microsoft.XMLDOM");return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};
OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=null;
OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c={exceptionReport:null};if(a.documentElement){this.readChildNodes(a,c);c.exceptionReport===null&&(c=(new OpenLayers.Format.OWSCommon).read(a))}return c},readers:{ogc:{ServiceExceptionReport:function(a,
c){c.exceptionReport={exceptions:[]};this.readChildNodes(a,c.exceptionReport)},ServiceException:function(a,c){var d={code:a.getAttribute("code"),locator:a.getAttribute("locator"),text:this.getChildValue(a)};c.exceptions.push(d)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});
OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,errorProperty:null,name:null,stringifyOutput:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);a=this.CLASS_NAME;this.name=a.substring(a.lastIndexOf(".")+1)},getVersion:function(a,c){var d;if(a){d=this.version;if(!d){d=a.getAttribute("version");if(!d)d=this.defaultVersion}}else d=c&&c.version||this.version||this.defaultVersion;return d},
getParser:function(a){var a=a||this.defaultVersion,c=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=a){var d=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")+c];if(!d)throw"Can't find a "+this.name+" parser for version "+a+c;this.parser=new d(this.options)}return this.parser},write:function(a,c){this.parser=this.getParser(this.getVersion(null,c));var d=this.parser.write(a,c);return this.stringifyOutput===false?d:OpenLayers.Format.XML.prototype.write.apply(this,[d])},read:function(a,
c){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var d=this.getVersion(a.documentElement);this.parser=this.getParser(d);var e=this.parser.read(a,c);if(this.errorProperty!==null&&e[this.errorProperty]===void 0){var f=new OpenLayers.Format.OGCExceptionReport;e.error=f.read(a)}e.version=d;return e},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});
OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(){return true},clone:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});
OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var c=0,d=this.fids.length;c<d;c++)if((a.fid||a.id)==this.fids[c])return true;return false},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});
OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){var c,d;switch(this.type){case OpenLayers.Filter.Logical.AND:c=0;for(d=this.filters.length;c<d;c++)if(this.filters[c].evaluate(a)==false)return false;return true;case OpenLayers.Filter.Logical.OR:c=0;for(d=this.filters.length;c<
d;c++)if(this.filters[c].evaluate(a)==true)return true;return false;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],c=0,d=this.filters.length;c<d;++c)a.push(this.filters[c].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";
OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a]);if(this.type===OpenLayers.Filter.Comparison.LIKE&&a.matchCase===void 0)this.matchCase=null},evaluate:function(a){if(a instanceof OpenLayers.Feature.Vector)a=a.attributes;var c=false,a=a[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:c=this.value;
c=!this.matchCase&&typeof a=="string"&&typeof c=="string"?a.toUpperCase()==c.toUpperCase():a==c;break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:c=this.value;c=!this.matchCase&&typeof a=="string"&&typeof c=="string"?a.toUpperCase()!=c.toUpperCase():a!=c;break;case OpenLayers.Filter.Comparison.LESS_THAN:c=a<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:c=a>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:c=a<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:c=
a>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:c=a>=this.lowerBoundary&&a<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:c=RegExp(this.value,"gi").test(a)}return c},value2regex:function(a,c,d){if(a==".")throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");a=a?a:"*";c=c?c:".";this.value=this.value.replace(RegExp("\\"+(d?d:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+c,"g"),".");this.value=this.value.replace(RegExp("\\"+
a,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+a);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+c)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,d){return d?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,d){return d?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});
OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";
OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var c=false;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var d=this.value;this.value.CLASS_NAME=="OpenLayers.Bounds"&&(d=this.value.toGeometry());a.geometry.intersects(d)&&(c=true)}break;default:throw Error("evaluate is not implemented for this filter type.");}return c},clone:function(){var a=
OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";
OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"});
OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){if(a)this.bounds=a.clone()},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){this.bounds==null&&this.calculateBounds();
return this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(a,c,d){var e=false;if(this.getBounds()!=null&&a!=null){c=c!=null?c:0;d=d!=null?d:0;e=(new OpenLayers.Bounds(this.bounds.left-c,this.bounds.bottom-d,this.bounds.right+c,this.bounds.top+d)).containsLonLat(a)}return e},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):
Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(a){var c;if(OpenLayers.Format&&OpenLayers.Format.WKT){var d=OpenLayers.Geometry.fromWKT.format;if(!d){d=new OpenLayers.Format.WKT;OpenLayers.Geometry.fromWKT.format=d}a=d.read(a);if(a instanceof OpenLayers.Feature.Vector)c=a.geometry;else if(OpenLayers.Util.isArray(a)){c=a.length;for(var d=Array(c),e=0;e<c;++e)d[e]=a[e].geometry;c=new OpenLayers.Geometry.Collection(d)}}return c};
OpenLayers.Geometry.segmentsIntersect=function(a,c,d){var e=d&&d.point,d=d&&d.tolerance,f=false,g=a.x1-c.x1,h=a.y1-c.y1,i=a.x2-a.x1,j=a.y2-a.y1,k=c.y2-c.y1,l=c.x2-c.x1,m=k*i-l*j,k=l*h-k*g,h=i*h-j*g;if(m==0)k==0&&h==0&&(f=true);else{g=k/m;m=h/m;if(g>=0&&g<=1&&m>=0&&m<=1)if(e){i=a.x1+g*i;m=a.y1+g*j;f=new OpenLayers.Geometry.Point(i,m)}else f=true}if(d)if(f){if(e){a=[a,c];c=0;a:for(;c<2;++c){g=a[c];for(j=1;j<3;++j){i=g["x"+j];m=g["y"+j];e=Math.sqrt(Math.pow(i-f.x,2)+Math.pow(m-f.y,2));if(e<d){f.x=i;
f.y=m;break a}}}}}else{a=[a,c];c=0;a:for(;c<2;++c){i=a[c];m=a[(c+1)%2];for(j=1;j<3;++j){g={x:i["x"+j],y:i["y"+j]};h=OpenLayers.Geometry.distanceToSegment(g,m);if(h.distance<d){f=e?new OpenLayers.Geometry.Point(g.x,g.y):true;break a}}}}return f};
OpenLayers.Geometry.distanceToSegment=function(a,c){var d=a.x,e=a.y,f=c.x1,g=c.y1,h=c.x2,i=c.y2,j=h-f,k=i-g,l=(j*(d-f)+k*(e-g))/(Math.pow(j,2)+Math.pow(k,2));if(!(l<=0))if(l>=1){f=h;g=i}else{f=f+l*j;g=g+l*k}return{distance:Math.sqrt(Math.pow(f-d,2)+Math.pow(g-e,2)),x:f,y:g}};
OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,c){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(c)},clone:function(a){a==null&&(a=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,c){var d=!(c&&c.edge===false)&&c&&c.details,e,f,g,h,i;if(a instanceof
OpenLayers.Geometry.Point){f=this.x;g=this.y;h=a.x;i=a.y;e=Math.sqrt(Math.pow(f-h,2)+Math.pow(g-i,2));e=!d?e:{x0:f,y0:g,x1:h,y1:i,distance:e}}else{e=a.distanceTo(this,c);d&&(e={x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0,distance:e.distance})}return e},equals:function(a){var c=false;a!=null&&(c=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return c},toShortString:function(){return this.x+", "+this.y},move:function(a,c){this.x=this.x+a;this.y=this.y+c;this.clearBounds()},rotate:function(a,
c){var a=a*(Math.PI/180),d=this.distanceTo(c),e=a+Math.atan2(this.y-c.y,this.x-c.x);this.x=c.x+d*Math.cos(e);this.y=c.y+d*Math.sin(e);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,c,d){this.x=c.x+a*(d==void 0?1:d)*(this.x-c.x);this.y=c.y+a*(this.y-c.y);this.clearBounds();return this},intersects:function(a){var c=false;return c=a.CLASS_NAME=="OpenLayers.Geometry.Point"?this.equals(a):a.intersects(this)},transform:function(a,c){if(a&&
c){OpenLayers.Projection.transform(this,a,c);this.bounds=null}return this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});
OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];a!=null&&this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),c=0,d=this.components.length;c<d;c++)a.addComponent(this.components[c].clone());
OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var a=[],c=0,d=this.components.length;c<d;c++)a.push(this.components[c].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new OpenLayers.Bounds,c=this.components;if(c)for(var d=0,e=c.length;d<e;d++)a.extend(c[d].getBounds());a.left!=null&&a.bottom!=null&&a.right!=null&&a.top!=null&&this.setBounds(a)},addComponents:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0,d=a.length;c<
d;c++)this.addComponent(a[c])},addComponent:function(a,c){var d=false;if(a&&(this.componentTypes==null||OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME)>-1)){if(c!=null&&c<this.components.length){var d=this.components.slice(0,c),e=this.components.slice(c,this.components.length);d.push(a);this.components=d.concat(e)}else this.components.push(a);a.parent=this;this.clearBounds();d=true}return d},removeComponents:function(a){var c=false;OpenLayers.Util.isArray(a)||(a=[a]);for(var d=a.length-
1;d>=0;--d)c=this.removeComponent(a[d])||c;return c},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds();return true},getLength:function(){for(var a=0,c=0,d=this.components.length;c<d;c++)a=a+this.components[c].getLength();return a},getArea:function(){for(var a=0,c=0,d=this.components.length;c<d;c++)a=a+this.components[c].getArea();return a},getGeodesicArea:function(a){for(var c=0,d=0,e=this.components.length;d<e;d++)c=c+this.components[d].getGeodesicArea(a);
return c},getCentroid:function(a){if(!a)return this.components.length&&this.components[0].getCentroid();a=this.components.length;if(!a)return false;for(var c=[],d=[],e=0,f=Number.MAX_VALUE,g,h=0;h<a;++h){g=this.components[h];var i=g.getArea();g=g.getCentroid(true);if(!isNaN(i)&&!isNaN(g.x)&&!isNaN(g.y)){c.push(i);e=e+i;f=i<f&&i>0?i:f;d.push(g)}}a=c.length;if(e===0){for(h=0;h<a;++h)c[h]=1;e=c.length}else{for(h=0;h<a;++h)c[h]=c[h]/f;e=e/f}for(var j=f=0,h=0;h<a;++h){g=d[h];i=c[h];f=f+g.x*i;j=j+g.y*i}return new OpenLayers.Geometry.Point(f/
e,j/e)},getGeodesicLength:function(a){for(var c=0,d=0,e=this.components.length;d<e;d++)c=c+this.components[d].getGeodesicLength(a);return c},move:function(a,c){for(var d=0,e=this.components.length;d<e;d++)this.components[d].move(a,c)},rotate:function(a,c){for(var d=0,e=this.components.length;d<e;++d)this.components[d].rotate(a,c)},resize:function(a,c,d){for(var e=0;e<this.components.length;++e)this.components[e].resize(a,c,d);return this},distanceTo:function(a,c){for(var d=!(c&&c.edge===false)&&c&&
c.details,e,f,g,h=Number.POSITIVE_INFINITY,i=0,j=this.components.length;i<j;++i){e=this.components[i].distanceTo(a,c);g=d?e.distance:e;if(g<h){h=g;f=e;if(h==0)break}}return f},equals:function(a){var c=true;if(!a||!a.CLASS_NAME||this.CLASS_NAME!=a.CLASS_NAME)c=false;else if(!OpenLayers.Util.isArray(a.components)||a.components.length!=this.components.length)c=false;else for(var d=0,e=this.components.length;d<e;++d)if(!this.components[d].equals(a.components[d])){c=false;break}return c},transform:function(a,
c){if(a&&c){for(var d=0,e=this.components.length;d<e;d++)this.components[d].transform(a,c);this.bounds=null}return this},intersects:function(a){for(var c=false,d=0,e=this.components.length;d<e;++d)if(c=a.intersects(this.components[d]))break;return c},getVertices:function(a){for(var c=[],d=0,e=this.components.length;d<e;++d)Array.prototype.push.apply(c,this.components[d].getVertices(a));return c},CLASS_NAME:"OpenLayers.Geometry.Collection"});
OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(a,c){this.addComponent(a,c)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});
OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var a=0;if(this.components&&this.components.length>1)for(var c=1,d=this.components.length;c<d;c++)a=a+this.components[c-1].distanceTo(this.components[c]);return a},getGeodesicLength:function(a){var c=this;if(a){var d=new OpenLayers.Projection("EPSG:4326");d.equals(a)||(c=this.clone().transform(a,d))}a=0;if(c.components&&c.components.length>1)for(var e,f=1,g=
c.components.length;f<g;f++){d=c.components[f-1];e=c.components[f];a=a+OpenLayers.Util.distVincenty({lon:d.x,lat:d.y},{lon:e.x,lat:e.y})}return a*1E3},CLASS_NAME:"OpenLayers.Geometry.Curve"});
OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(a){var c=this.components&&this.components.length>2;c&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return c},intersects:function(a){var c=false,d=a.CLASS_NAME;if(d=="OpenLayers.Geometry.LineString"||d=="OpenLayers.Geometry.LinearRing"||d=="OpenLayers.Geometry.Point"){var e=this.getSortedSegments(),a=d=="OpenLayers.Geometry.Point"?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments(),
f,g,h,i,j,k,l,m=0,n=e.length;a:for(;m<n;++m){d=e[m];f=d.x1;g=d.x2;h=d.y1;i=d.y2;var o=0,p=a.length;for(;o<p;++o){j=a[o];if(j.x1>g)break;if(!(j.x2<f)){k=j.y1;l=j.y2;if(!(Math.min(k,l)>Math.max(h,i))&&!(Math.max(k,l)<Math.min(h,i))&&OpenLayers.Geometry.segmentsIntersect(d,j)){c=true;break a}}}}}else c=a.intersects(this);return c},getSortedSegments:function(){for(var a=this.components.length-1,c=Array(a),d,e,f=0;f<a;++f){d=this.components[f];e=this.components[f+1];c[f]=d.x<e.x?{x1:d.x,y1:d.y,x2:e.x,
y2:e.y}:{x1:e.x,y1:e.y,x2:d.x,y2:d.y}}return c.sort(function(a,c){return a.x1-c.x1})},splitWithSegment:function(a,c){for(var d=!(c&&c.edge===false),e=c&&c.tolerance,f=[],g=this.getVertices(),h=[],i=[],j=false,k,l,m,n={point:true,tolerance:e},o=null,p=0,q=g.length-2;p<=q;++p){e=g[p];h.push(e.clone());k=g[p+1];l={x1:e.x,y1:e.y,x2:k.x,y2:k.y};l=OpenLayers.Geometry.segmentsIntersect(a,l,n);if(l instanceof OpenLayers.Geometry.Point)if((m=l.x===a.x1&&l.y===a.y1||l.x===a.x2&&l.y===a.y2||l.equals(e)||l.equals(k)?
true:false)||d){l.equals(i[i.length-1])||i.push(l.clone());if(!(p===0&&l.equals(e))&&!l.equals(k)){j=true;l.equals(e)||h.push(l);f.push(new OpenLayers.Geometry.LineString(h));h=[l.clone()]}}}if(j){h.push(k.clone());f.push(new OpenLayers.Geometry.LineString(h))}if(i.length>0)var r=a.x1<a.x2?1:-1,s=a.y1<a.y2?1:-1,o={lines:f,points:i.sort(function(a,c){return r*a.x-r*c.x||s*a.y-s*c.y})};return o},split:function(a,c){var d=null,e=c&&c.mutual,f,g,h,i;if(a instanceof OpenLayers.Geometry.LineString){var j=
this.getVertices(),k,l,m,n,o,p=[];h=[];for(var q=0,r=j.length-2;q<=r;++q){k=j[q];l=j[q+1];m={x1:k.x,y1:k.y,x2:l.x,y2:l.y};i=i||[a];e&&p.push(k.clone());for(var s=0;s<i.length;++s)if(n=i[s].splitWithSegment(m,c)){o=n.lines;if(o.length>0){o.unshift(s,1);Array.prototype.splice.apply(i,o);s=s+(o.length-2)}if(e)for(var t=0,u=n.points.length;t<u;++t){o=n.points[t];if(!o.equals(k)){p.push(o);h.push(new OpenLayers.Geometry.LineString(p));p=o.equals(l)?[]:[o.clone()]}}}}if(e&&h.length>0&&p.length>0){p.push(l.clone());
h.push(new OpenLayers.Geometry.LineString(p))}}else d=a.splitWith(this,c);i&&i.length>1?g=true:i=[];h&&h.length>1?f=true:h=[];if(g||f)d=e?[h,i]:i;return d},splitWith:function(a,c){return a.split(this,c)},getVertices:function(a){return a===true?[this.components[0],this.components[this.components.length-1]]:a===false?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,c){var d=!(c&&c.edge===false)&&c&&c.details,e,f={},g=Number.POSITIVE_INFINITY;if(a instanceof
OpenLayers.Geometry.Point){for(var h=this.getSortedSegments(),i=a.x,j=a.y,k,l=0,m=h.length;l<m;++l){k=h[l];e=OpenLayers.Geometry.distanceToSegment(a,k);if(e.distance<g){g=e.distance;f=e;if(g===0)break}else if(k.x2>i&&(j>k.y1&&j<k.y2||j<k.y1&&j>k.y2))break}f=d?{distance:f.distance,x0:f.x,y0:f.y,x1:i,y1:j}:f.distance}else if(a instanceof OpenLayers.Geometry.LineString){var h=this.getSortedSegments(),i=a.getSortedSegments(),n,o,p=i.length,q={point:true},l=0,m=h.length;a:for(;l<m;++l){j=h[l];k=j.x1;o=
j.y1;for(var r=0;r<p;++r){e=i[r];if(n=OpenLayers.Geometry.segmentsIntersect(j,e,q)){g=0;f={distance:0,x0:n.x,y0:n.y,x1:n.x,y1:n.y};break a}else{e=OpenLayers.Geometry.distanceToSegment({x:k,y:o},e);if(e.distance<g){g=e.distance;f={distance:g,x0:k,y0:o,x1:e.x,y1:e.y}}}}}if(!d)f=f.distance;if(g!==0&&j){e=a.distanceTo(new OpenLayers.Geometry.Point(j.x2,j.y2),c);l=d?e.distance:e;l<g&&(f=d?{distance:g,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0}:l)}}else{f=a.distanceTo(this,c);d&&(f={distance:f.distance,x0:f.x1,y0:f.y1,
x1:f.x0,y1:f.y0})}return f},simplify:function(a){if(this&&this!==null){var c=this.getVertices();if(c.length<3)return this;var d=function(a,c,e,j){for(var k=0,l=0,m=c,n;m<e;m++){n=a[c];var o=a[e],p=a[m],p=Math.abs(0.5*(n.x*o.y+o.x*p.y+p.x*n.y-o.x*n.y-p.x*o.y-n.x*p.y));n=Math.sqrt(Math.pow(n.x-o.x,2)+Math.pow(n.y-o.y,2));n=p/n*2;if(n>k){k=n;l=m}}if(k>j&&l!=c){f.push(l);d(a,c,l,j);d(a,l,e,j)}},e=c.length-1,f=[];f.push(0);for(f.push(e);c[0].equals(c[e]);){e--;f.push(e)}d(c,0,e,a);a=[];f.sort(function(a,
c){return a-c});for(e=0;e<f.length;e++)a.push(c[f[e]]);return new OpenLayers.Geometry.LineString(a)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"});
OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(a,c){for(var d=null,e=c&&c.mutual,f,g,h,i,j=[],k=[a],l=0,m=this.components.length;l<m;++l){g=this.components[l];h=false;for(var n=0;n<k.length;++n)if(f=g.split(k[n],c)){if(e){h=f[0];for(var o=0,p=h.length;o<p;++o)o===0&&j.length?j[j.length-1].addComponent(h[o]):j.push(new OpenLayers.Geometry.MultiLineString([h[o]]));h=true;f=f[1]}if(f.length){f.unshift(n,
1);Array.prototype.splice.apply(k,f);break}}h||(j.length?j[j.length-1].addComponent(g.clone()):j=[new OpenLayers.Geometry.MultiLineString(g.clone())])}j&&j.length>1?h=true:j=[];k&&k.length>1?i=true:k=[];if(h||i)d=e?[j,k]:k;return d},splitWith:function(a,c){var d=null,e=c&&c.mutual,f,g,h,i,j,k;if(a instanceof OpenLayers.Geometry.LineString){k=[];j=[a];for(var l=0,m=this.components.length;l<m;++l){h=false;g=this.components[l];for(var n=0;n<j.length;++n)if(f=j[n].split(g,c)){if(e){h=f[0];if(h.length){h.unshift(n,
1);Array.prototype.splice.apply(j,h);n=n+(h.length-2)}f=f[1];f.length===0&&(f=[g.clone()])}h=0;for(var o=f.length;h<o;++h)h===0&&k.length?k[k.length-1].addComponent(f[h]):k.push(new OpenLayers.Geometry.MultiLineString([f[h]]));h=true}h||(k.length?k[k.length-1].addComponent(g.clone()):k=[new OpenLayers.Geometry.MultiLineString([g.clone()])])}}else d=a.split(this);j&&j.length>1?i=true:j=[];k&&k.length>1?h=true:k=[];if(i||h)d=e?[j,k]:k;return d},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});
OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(a,c){var d=false,e=this.components.pop();if(c!=null||!a.equals(e))d=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return d},removeComponent:function(a){var c=this.components&&this.components.length>3;if(c){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,
arguments);OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]])}return c},move:function(a,c){for(var d=0,e=this.components.length;d<e-1;d++)this.components[d].move(a,c)},rotate:function(a,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].rotate(a,c)},resize:function(a,c,d){for(var e=0,f=this.components.length;e<f-1;++e)this.components[e].resize(a,c,d);return this},transform:function(a,c){if(a&&c){for(var d=0,e=this.components.length;d<e-1;d++)this.components[d].transform(a,
c);this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){for(var a=0,c=0,d=0;d<this.components.length-1;d++)var e=this.components[d],f=this.components[d+1],a=a+(e.x+f.x)*(e.x*f.y-f.x*e.y),c=c+(e.y+f.y)*(e.x*f.y-f.x*e.y);d=-1*this.getArea();return new OpenLayers.Geometry.Point(a/(6*d),c/(6*d))}return null},getArea:function(){var a=0;if(this.components&&this.components.length>2){for(var c=a=0,d=this.components.length;c<d-1;c++)var e=this.components[c],f=
this.components[c+1],a=a+(e.x+f.x)*(f.y-e.y);a=-a/2}return a},getGeodesicArea:function(a){var c=this;if(a){var d=new OpenLayers.Projection("EPSG:4326");d.equals(a)||(c=this.clone().transform(a,d))}a=0;d=c.components&&c.components.length;if(d>2){for(var e,f,g=0;g<d-1;g++){e=c.components[g];f=c.components[g+1];a=a+OpenLayers.Util.rad(f.x-e.x)*(2+Math.sin(OpenLayers.Util.rad(e.y))+Math.sin(OpenLayers.Util.rad(f.y)))}a=a*40680631590769/2}return a},containsPoint:function(a){for(var c=OpenLayers.Number.limitSigDigs,
d=c(a.x,14),a=c(a.y,14),e=this.components.length-1,f,g,h,i,j,k=0,l=0;l<e;++l){f=this.components[l];h=c(f.x,14);f=c(f.y,14);g=this.components[l+1];i=c(g.x,14);g=c(g.y,14);if(f==g){if(a==f&&(h<=i&&d>=h&&d<=i||h>=i&&d<=h&&d>=i)){k=-1;break}}else{j=c((a-g)*((i-h)/(g-f))+i,14);if(j==d&&(f<g&&a>=f&&a<=g||f>g&&a<=f&&a>=g)){k=-1;break}j<=d||h!=i&&(j<Math.min(h,i)||j>Math.max(h,i))||(f<g&&a>=f&&a<g||f>g&&a<f&&a>=g)&&++k}}return k==-1?1:!!(k&1)},intersects:function(a){var c=false;if(a.CLASS_NAME=="OpenLayers.Geometry.Point")c=
this.containsPoint(a);else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString")c=a.intersects(this);else if(a.CLASS_NAME=="OpenLayers.Geometry.LinearRing")c=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var d=0,e=a.components.length;d<e;++d)if(c=a.components[d].intersects(this))break;return c},getVertices:function(a){return a===true?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});
OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&&this.components.length>0)for(var a=a+Math.abs(this.components[0].getArea()),c=1,d=this.components.length;c<d;c++)a=a-Math.abs(this.components[c].getArea());return a},getGeodesicArea:function(a){var c=0;if(this.components&&this.components.length>0)for(var c=c+Math.abs(this.components[0].getGeodesicArea(a)),d=1,e=this.components.length;d<
e;d++)c=c-Math.abs(this.components[d].getGeodesicArea(a));return c},containsPoint:function(a){var c=this.components.length,d=false;if(c>0){d=this.components[0].containsPoint(a);if(d!==1&&d&&c>1)for(var e,f=1;f<c;++f)if(e=this.components[f].containsPoint(a)){d=e===1?1:false;break}}return d},intersects:function(a){var c=false,d,e;if(a.CLASS_NAME=="OpenLayers.Geometry.Point")c=this.containsPoint(a);else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString"||a.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){d=
0;for(e=this.components.length;d<e;++d)if(c=a.intersects(this.components[d]))break;if(!c){d=0;for(e=a.components.length;d<e;++d)if(c=this.containsPoint(a.components[d]))break}}else{d=0;for(e=a.components.length;d<e;++d)if(c=this.intersects(a.components[d]))break}if(!c&&a.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var f=this.components[0];d=0;for(e=f.components.length;d<e;++d)if(c=a.containsPoint(f.components[d]))break}return c},distanceTo:function(a,c){return c&&c.edge===false&&this.intersects(a)?
0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[a,c])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,c,d,e){var f=Math.PI*(1/d-0.5);e&&(f=f+e/180*Math.PI);for(var g,h=[],i=0;i<d;++i){g=f+i*2*Math.PI/d;e=a.x+c*Math.cos(g);g=a.y+c*Math.sin(g);h.push(new OpenLayers.Geometry.Point(e,g))}a=new OpenLayers.Geometry.LinearRing(h);return new OpenLayers.Geometry.Polygon([a])};
OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});
OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a==
"string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var a=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName),c=[],d=0;d<a.length;d++){var e=this.parseFeature(a[d]);e&&c.push(e)}return c},parseFeature:function(a){for(var c=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"],d,e,f,g=0;g<c.length;++g){d=c[g];e=this.getElementsByTagNameNS(a,this.gmlns,d);if(e.length>0){if(f=this.parseGeometry[d.toLowerCase()]){f=f.apply(this,
[e[0]]);this.internalProjection&&this.externalProjection&&f.transform(this.externalProjection,this.internalProjection)}else throw new TypeError("Unsupported geometry type: "+d);break}}var h;d=this.getElementsByTagNameNS(a,this.gmlns,"Box");for(g=0;g<d.length;++g){c=d[g];e=this.parseGeometry.box.apply(this,[c]);c=c.parentNode;(c.localName||c.nodeName.split(":").pop())==="boundedBy"?h=e:f=e.toGeometry()}var i;this.extractAttributes&&(i=this.parseAttributes(a));i=new OpenLayers.Feature.Vector(f,i);i.bounds=
h;i.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};for(var a=a.firstChild,j;a;){if(a.nodeType==1)if(j=a.getAttribute("fid")||a.getAttribute("id"))break;a=a.nextSibling}i.fid=j;return i},parseGeometry:{point:function(a){var c,d;d=[];c=this.getElementsByTagNameNS(a,this.gmlns,"pos");if(c.length>0){d=c[0].firstChild.nodeValue;d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace)}if(d.length==0){c=this.getElementsByTagNameNS(a,
this.gmlns,"coordinates");if(c.length>0){d=c[0].firstChild.nodeValue;d=d.replace(this.regExes.removeSpace,"");d=d.split(",")}}if(d.length==0){c=this.getElementsByTagNameNS(a,this.gmlns,"coord");if(c.length>0){a=this.getElementsByTagNameNS(c[0],this.gmlns,"X");c=this.getElementsByTagNameNS(c[0],this.gmlns,"Y");a.length>0&&c.length>0&&(d=[a[0].firstChild.nodeValue,c[0].firstChild.nodeValue])}}d.length==2&&(d[2]=null);return this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],
d[0],d[2])},multipoint:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Point"),c=[];if(a.length>0)for(var d,e=0;e<a.length;++e)(d=this.parseGeometry.point.apply(this,[a[e]]))&&c.push(d);return new OpenLayers.Geometry.MultiPoint(c)},linestring:function(a,c){var d,e;e=[];var f=[];d=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(d.length>0){e=this.getChildValue(d[0]);e=e.replace(this.regExes.trimSpace,"");e=e.split(this.regExes.splitSpace);var g=parseInt(d[0].getAttribute("dimension")),
h,i,j;for(d=0;d<e.length/g;++d){h=d*g;i=e[h];j=e[h+1];h=g==2?null:e[h+2];this.xy?f.push(new OpenLayers.Geometry.Point(i,j,h)):f.push(new OpenLayers.Geometry.Point(j,i,h))}}if(e.length==0){d=this.getElementsByTagNameNS(a,this.gmlns,"coordinates");if(d.length>0){e=this.getChildValue(d[0]);e=e.replace(this.regExes.trimSpace,"");e=e.replace(this.regExes.trimComma,",");g=e.split(this.regExes.splitSpace);for(d=0;d<g.length;++d){e=g[d].split(",");e.length==2&&(e[2]=null);this.xy?f.push(new OpenLayers.Geometry.Point(e[0],
e[1],e[2])):f.push(new OpenLayers.Geometry.Point(e[1],e[0],e[2]))}}}e=null;f.length!=0&&(e=c?new OpenLayers.Geometry.LinearRing(f):new OpenLayers.Geometry.LineString(f));return e},multilinestring:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LineString"),c=[];if(a.length>0)for(var d,e=0;e<a.length;++e)(d=this.parseGeometry.linestring.apply(this,[a[e]]))&&c.push(d);return new OpenLayers.Geometry.MultiLineString(c)},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing"),
c=[];if(a.length>0)for(var d,e=0;e<a.length;++e)(d=this.parseGeometry.linestring.apply(this,[a[e],true]))&&c.push(d);return new OpenLayers.Geometry.Polygon(c)},multipolygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Polygon"),c=[];if(a.length>0)for(var d,e=0;e<a.length;++e)(d=this.parseGeometry.polygon.apply(this,[a[e]]))&&c.push(d);return new OpenLayers.Geometry.MultiPolygon(c)},envelope:function(a){var c=[],d,e,f=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(f.length>
0){d=[];if(f.length>0){d=f[0].firstChild.nodeValue;d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace)}d.length==2&&(d[2]=null);var g=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2])}a=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(a.length>0){d=[];if(a.length>0){d=a[0].firstChild.nodeValue;d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace)}d.length==2&&(d[2]=null);var h=this.xy?new OpenLayers.Geometry.Point(d[0],
d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2])}if(g&&h){c.push(new OpenLayers.Geometry.Point(g.x,g.y));c.push(new OpenLayers.Geometry.Point(h.x,g.y));c.push(new OpenLayers.Geometry.Point(h.x,h.y));c.push(new OpenLayers.Geometry.Point(g.x,h.y));c.push(new OpenLayers.Geometry.Point(g.x,g.y));c=new OpenLayers.Geometry.LinearRing(c);e=new OpenLayers.Geometry.Polygon([c])}return e},box:function(a){var c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),d=a=null;if(c.length>0){c=c[0].firstChild.nodeValue;
c=c.split(" ");if(c.length==2){a=c[0].split(",");d=c[1].split(",")}}if(a!==null&&d!==null)return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(d[0]),parseFloat(d[1]))}},parseAttributes:function(a){for(var c={},a=a.firstChild,d,e,f;a;){if(a.nodeType==1){a=a.childNodes;for(d=0;d<a.length;++d){e=a[d];if(e.nodeType==1){f=e.childNodes;if(f.length==1){f=f[0];if(f.nodeType==3||f.nodeType==4){e=e.prefix?e.nodeName.split(":")[1]:e.nodeName;f=f.nodeValue.replace(this.regExes.trimSpace,
"");c[e]=f}}else c[e.nodeName.split(":").pop()]=null}}break}a=a.nextSibling}return c},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var c=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),d=0;d<a.length;d++)c.appendChild(this.createFeatureXML(a[d]));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createFeatureXML:function(a){var c=this.buildGeometryNode(a.geometry),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);
d.appendChild(c);var c=this.createElementNS(this.gmlns,"gml:"+this.featureName),e=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);e.setAttribute("fid",a.fid||a.id);e.appendChild(d);for(var f in a.attributes){var d=this.createTextNode(a.attributes[f]),g=this.createElementNS(this.featureNS,this.featurePrefix+":"+f.substring(f.lastIndexOf(":")+1));g.appendChild(d);e.appendChild(g)}c.appendChild(e);return c},buildGeometryNode:function(a){if(this.externalProjection&&this.internalProjection){a=
a.clone();a.transform(this.internalProjection,this.externalProjection)}var c=a.CLASS_NAME;return this.buildGeometry[c.substring(c.lastIndexOf(".")+1).toLowerCase()].apply(this,[a])},buildGeometry:{point:function(a){var c=this.createElementNS(this.gmlns,"gml:Point");c.appendChild(this.buildCoordinatesNode(a));return c},multipoint:function(a){for(var c=this.createElementNS(this.gmlns,"gml:MultiPoint"),a=a.components,d,e,f=0;f<a.length;f++){d=this.createElementNS(this.gmlns,"gml:pointMember");e=this.buildGeometry.point.apply(this,
[a[f]]);d.appendChild(e);c.appendChild(d)}return c},linestring:function(a){var c=this.createElementNS(this.gmlns,"gml:LineString");c.appendChild(this.buildCoordinatesNode(a));return c},multilinestring:function(a){for(var c=this.createElementNS(this.gmlns,"gml:MultiLineString"),a=a.components,d,e,f=0;f<a.length;++f){d=this.createElementNS(this.gmlns,"gml:lineStringMember");e=this.buildGeometry.linestring.apply(this,[a[f]]);d.appendChild(e);c.appendChild(d)}return c},linearring:function(a){var c=this.createElementNS(this.gmlns,
"gml:LinearRing");c.appendChild(this.buildCoordinatesNode(a));return c},polygon:function(a){for(var c=this.createElementNS(this.gmlns,"gml:Polygon"),a=a.components,d,e,f=0;f<a.length;++f){d=f==0?"outerBoundaryIs":"innerBoundaryIs";d=this.createElementNS(this.gmlns,"gml:"+d);e=this.buildGeometry.linearring.apply(this,[a[f]]);d.appendChild(e);c.appendChild(d)}return c},multipolygon:function(a){for(var c=this.createElementNS(this.gmlns,"gml:MultiPolygon"),a=a.components,d,e,f=0;f<a.length;++f){d=this.createElementNS(this.gmlns,
"gml:polygonMember");e=this.buildGeometry.polygon.apply(this,[a[f]]);d.appendChild(e);c.appendChild(d)}return c},bounds:function(a){var c=this.createElementNS(this.gmlns,"gml:Box");c.appendChild(this.buildCoordinatesNode(a));return c}},buildCoordinatesNode:function(a){var c=this.createElementNS(this.gmlns,"gml:coordinates");c.setAttribute("decimal",".");c.setAttribute("cs",",");c.setAttribute("ts"," ");var d=[];if(a instanceof OpenLayers.Bounds){d.push(a.left+","+a.bottom);d.push(a.right+","+a.top)}else for(var a=
a.components?a.components:[a],e=0;e<a.length;e++)d.push(a[e].x+","+a[e].y);d=this.createTextNode(d.join(" "));c.appendChild(d);return c},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GML||(OpenLayers.Format.GML={});
OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},
initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();a&&a.featureNS&&this.setNamespace("feature",a.featureNS);this.singleFeatureType=!a||typeof a.featureType==="string"},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c=[];this.readNode(a,{features:c},true);if(c.length==0){var d=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(d.length)for(var a=
0,e=d.length;a<e;++a)this.readNode(d[a],{features:c},true);else{d=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers");d.length&&this.readNode(d[0],{features:c},true)}}return c},readNode:function(a,c,d){if(d===true&&this.autoConfig===true){this.featureType=null;delete this.namespaceAlias[this.featureNS];delete this.namespaces.feature;this.featureNS=null}if(!this.featureNS&&!(a.prefix in this.namespaces)&&a.parentNode.namespaceURI==this.namespaces.gml&&this.regExes.featureMember.test(a.parentNode.nodeName)){this.featureType=
a.nodeName.split(":").pop();this.setNamespace("feature",a.namespaceURI);this.featureNS=a.namespaceURI;this.autoConfig=true}return OpenLayers.Format.XML.prototype.readNode.apply(this,[a,c])},readers:{gml:{_inherit:function(){},featureMember:function(a,c){this.readChildNodes(a,c)},featureMembers:function(a,c){this.readChildNodes(a,c)},name:function(a,c){c.name=this.getChildValue(a)},boundedBy:function(a,c){var d={};this.readChildNodes(a,d);if(d.components&&d.components.length>0)c.bounds=d.components[0]},
Point:function(a,c){var d={points:[]};this.readChildNodes(a,d);if(!c.components)c.components=[];c.components.push(d.points[0])},coordinates:function(a,c){for(var d=this.getChildValue(a).replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),d=d.split(this.regExes.splitSpace),e,f=d.length,g=Array(f),h=0;h<f;++h){e=d[h].split(",");g[h]=this.xy?new OpenLayers.Geometry.Point(e[0],e[1],e[2]):new OpenLayers.Geometry.Point(e[1],e[0],e[2])}c.points=g},coord:function(a,c){var d={};this.readChildNodes(a,
d);if(!c.points)c.points=[];c.points.push(new OpenLayers.Geometry.Point(d.x,d.y,d.z))},X:function(a,c){c.x=this.getChildValue(a)},Y:function(a,c){c.y=this.getChildValue(a)},Z:function(a,c){c.z=this.getChildValue(a)},MultiPoint:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);c.components=[new OpenLayers.Geometry.MultiPoint(d.components)]},pointMember:function(a,c){this.readChildNodes(a,c)},LineString:function(a,c){var d={};this.readers.gml._inherit.apply(this,
[a,d,c]);this.readChildNodes(a,d);if(!c.components)c.components=[];c.components.push(new OpenLayers.Geometry.LineString(d.points))},MultiLineString:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);c.components=[new OpenLayers.Geometry.MultiLineString(d.components)]},lineStringMember:function(a,c){this.readChildNodes(a,c)},Polygon:function(a,c){var d={outer:null,inner:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);
d.inner.unshift(d.outer);if(!c.components)c.components=[];c.components.push(new OpenLayers.Geometry.Polygon(d.inner))},LinearRing:function(a,c){var d={};this.readers.gml._inherit.apply(this,[a,d]);this.readChildNodes(a,d);c.components=[new OpenLayers.Geometry.LinearRing(d.points)]},MultiPolygon:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);c.components=[new OpenLayers.Geometry.MultiPolygon(d.components)]},polygonMember:function(a,c){this.readChildNodes(a,
c)},GeometryCollection:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);c.components=[new OpenLayers.Geometry.Collection(d.components)]},geometryMember:function(a,c){this.readChildNodes(a,c)}},feature:{"*":function(a,c){var d,e=a.localName||a.nodeName.split(":").pop();c.features?!this.singleFeatureType&&OpenLayers.Util.indexOf(this.featureType,e)!==-1?d="_typeName":e===this.featureType&&(d="_typeName"):a.childNodes.length==0||a.childNodes.length==
1&&a.firstChild.nodeType==3?this.extractAttributes&&(d="_attribute"):d="_geometry";d&&this.readers.feature[d].apply(this,[a,c])},_typeName:function(a,c){var d={components:[],attributes:{}};this.readChildNodes(a,d);if(d.name)d.attributes.name=d.name;var e=new OpenLayers.Feature.Vector(d.components[0],d.attributes);if(!this.singleFeatureType){e.type=a.nodeName.split(":").pop();e.namespace=a.namespaceURI}var f=a.getAttribute("fid")||this.getAttributeNS(a,this.namespaces.gml,"id");if(f)e.fid=f;this.internalProjection&&
this.externalProjection&&e.geometry&&e.geometry.transform(this.externalProjection,this.internalProjection);if(d.bounds)e.bounds=d.bounds;c.features.push(e)},_geometry:function(a,c){if(!this.geometryName)this.geometryName=a.nodeName.split(":").pop();this.readChildNodes(a,c)},_attribute:function(a,c){var d=a.localName||a.nodeName.split(":").pop(),e=this.getChildValue(a);c.attributes[d]=e}},wfs:{FeatureCollection:function(a,c){this.readChildNodes(a,c)}}},write:function(a){a=this.writeNode("gml:"+(OpenLayers.Util.isArray(a)?
"featureMembers":"featureMember"),a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var c=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,c);return c},MultiPoint:function(a){for(var c=this.createElementNSPlus("gml:MultiPoint"),a=a.components||[a],d=0,e=a.length;d<e;++d)this.writeNode("pointMember",a[d],c);return c},pointMember:function(a){var c=
this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,c);return c},MultiLineString:function(a){for(var c=this.createElementNSPlus("gml:MultiLineString"),a=a.components||[a],d=0,e=a.length;d<e;++d)this.writeNode("lineStringMember",a[d],c);return c},lineStringMember:function(a){var c=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",a,c);return c},MultiPolygon:function(a){for(var c=this.createElementNSPlus("gml:MultiPolygon"),a=a.components||[a],d=0,e=a.length;d<
e;++d)this.writeNode("polygonMember",a[d],c);return c},polygonMember:function(a){var c=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,c);return c},GeometryCollection:function(a){for(var c=this.createElementNSPlus("gml:GeometryCollection"),d=0,e=a.components.length;d<e;++d)this.writeNode("geometryMember",a.components[d],c);return c},geometryMember:function(a){var c=this.createElementNSPlus("gml:geometryMember"),a=this.writeNode("feature:_geometry",a);c.appendChild(a.firstChild);
return c}},feature:{_typeName:function(a){var c=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&&this.writeNode("feature:_geometry",a.geometry,c);for(var d in a.attributes){var e=a.attributes[d];e!=null&&this.writeNode("feature:_attribute",{name:d,value:e},c)}return c},_geometry:function(a){this.externalProjection&&this.internalProjection&&(a=a.clone().transform(this.internalProjection,this.externalProjection));var c=this.createElementNSPlus("feature:"+this.geometryName),
a=this.writeNode("gml:"+this.geometryTypes[a.CLASS_NAME],a,c);this.srsName&&a.setAttribute("srsName",this.srsName);return c},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){for(var c=this.createElementNSPlus("wfs:FeatureCollection"),d=0,e=a.length;d<e;++d)this.writeNode("gml:featureMember",a[d],c);return c}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint",
"OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});
OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,c){var d={};this.readChildNodes(a,d);c.outer=d.components[0]},innerBoundaryIs:function(a,c){var d={};this.readChildNodes(a,d);c.inner.push(d.components[0])},Box:function(a,c){var d=
{};this.readChildNodes(a,d);if(!c.components)c.components=[];var e=d.points[0],d=d.points[1];c.components.push(new OpenLayers.Bounds(e.x,e.y,d.x,d.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){a=this.writeNode(OpenLayers.Util.isArray(a)?"wfs:FeatureCollection":"gml:featureMember",a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);
return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var c=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],c);return c},coordinates:function(a){for(var c=a.length,d=Array(c),e,f=0;f<c;++f){e=a[f];d[f]=this.xy?e.x+","+e.y:e.y+","+e.x;e.z!=void 0&&(d[f]=d[f]+(","+e.z))}return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:c==1?d[0]:d.join(" ")})},LineString:function(a){var c=
this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,c);return c},Polygon:function(a){var c=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],c);for(var d=1;d<a.components.length;++d)this.writeNode("innerBoundaryIs",a.components[d],c);return c},outerBoundaryIs:function(a){var c=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,c);return c},innerBoundaryIs:function(a){var c=this.createElementNSPlus("gml:innerBoundaryIs");
this.writeNode("LinearRing",a,c);return c},LinearRing:function(a){var c=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,c);return c},Box:function(a){var c=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],c);this.srsName&&c.setAttribute("srsName",this.srsName);return c}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},
CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});
OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var c={};this.readers.ogc.Filter.apply(this,[a,c]);return c.filter},readers:{ogc:{_expression:function(a){for(var c="",d=a.firstChild;d;d=
d.nextSibling)switch(d.nodeType){case 1:a=this.readNode(d);a.property?c=c+("${"+a.property+"}"):a.value!==void 0&&(c=c+a.value);break;case 3:case 4:c=c+d.nodeValue}return c},Filter:function(a,c){var d={fids:[],filters:[]};this.readChildNodes(a,d);if(d.fids.length>0)c.filter=new OpenLayers.Filter.FeatureId({fids:d.fids});else if(d.filters.length>0)c.filter=d.filters[0]},FeatureId:function(a,c){var d=a.getAttribute("fid");d&&c.fids.push(d)},And:function(a,c){var d=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});
this.readChildNodes(a,d);c.filters.push(d)},Or:function(a,c){var d=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,d);c.filters.push(d)},Not:function(a,c){var d=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsLessThan:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsGreaterThan:function(a,
c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsLessThanOrEqualTo:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsGreaterThanOrEqualTo:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,d);c.filters.push(d)},
PropertyIsBetween:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,d);c.filters.push(d)},Literal:function(a,c){c.value=OpenLayers.String.numericIf(this.getChildValue(a))},PropertyName:function(a,c){c.property=this.getChildValue(a)},LowerBoundary:function(a,c){c.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,a))},UpperBoundary:function(a,c){c.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,
a))},Intersects:function(a,c){this.readSpatial(a,c,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,c){this.readSpatial(a,c,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,c){this.readSpatial(a,c,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,c){this.readSpatial(a,c,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,c){c.distance=parseInt(this.getChildValue(a));c.distanceUnits=a.getAttribute("units")},Function:function(){}}},readSpatial:function(a,c,d){d=new OpenLayers.Filter.Spatial({type:d});
this.readChildNodes(a,d);d.value=d.components[0];delete d.components;c.filters.push(d)},writeOgcExpression:function(a,c){if(a instanceof OpenLayers.Filter.Function){var d=this.writeNode("Function",a,c);c.appendChild(d)}else this.writeNode("Literal",a,c);return c},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},writeFeatureIdNodes:function(a,c){for(var d=0,e=a.fids.length;d<e;++d)this.writeNode("FeatureId",a.fids[d],c)},writers:{ogc:{Filter:function(a){var c=this.createElementNSPlus("ogc:Filter");
a.type==="FID"?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,a,c):this.writeNode(this.getFilterType(a),a,c);return c},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){for(var c=this.createElementNSPlus("ogc:And"),d,e=0,f=a.filters.length;e<f;++e){d=a.filters[e];d.type==="FID"?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,d,c):this.writeNode(this.getFilterType(d),d,c)}return c},Or:function(a){for(var c=
this.createElementNSPlus("ogc:Or"),d,e=0,f=a.filters.length;e<f;++e){d=a.filters[e];d.type==="FID"?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,d,c):this.writeNode(this.getFilterType(d),d,c)}return c},Not:function(a){var c=this.createElementNSPlus("ogc:Not"),a=a.filters[0];a.type==="FID"?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,a,c):this.writeNode(this.getFilterType(a),a,c);return c},PropertyIsLessThan:function(a){var c=this.createElementNSPlus("ogc:PropertyIsLessThan");
this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsGreaterThan:function(a){var c=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsLessThanOrEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsGreaterThanOrEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");
this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsBetween:function(a){var c=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,c);this.writeNode("LowerBoundary",a,c);this.writeNode("UpperBoundary",a,c);return c},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:a})},LowerBoundary:function(a){var c=this.createElementNSPlus("ogc:LowerBoundary");
this.writeOgcExpression(a.lowerBoundary,c);return c},UpperBoundary:function(a){var c=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,c);return c},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var c=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,c);return c},Distance:function(a){return this.createElementNSPlus("ogc:Distance",
{attributes:{units:a.distanceUnits},value:a.distance})},Function:function(a){for(var c=this.createElementNSPlus("ogc:Function",{attributes:{name:a.name}}),a=a.params,d=0,e=a.length;d<e;d++)this.writeOgcExpression(a[d],c);return c}}},getFilterType:function(a){var c=this.filterMap[a.type];if(!c)throw"Filter writing not supported for rule type: "+a.type;return c},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan",
"<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"FeatureId"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});
OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsNotEqualTo:function(a,
c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsLike:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,d);var e=a.getAttribute("wildCard"),f=a.getAttribute("singleChar"),g=a.getAttribute("escape");d.value2regex(e,f,g);c.filters.push(d)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,
feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsNotEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsLike:function(a){var c=this.createElementNSPlus("ogc:PropertyIsLike",
{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,c);this.writeNode("Literal",a.regex2value(),c);return c},BBOX:function(a){var c=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,c);var d=this.writeNode("gml:Box",a.value,c);a.projection&&d.setAttribute("srsName",a.projection);return c}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},
writeSpatial:function(a,c){var d=this.createElementNSPlus("ogc:"+c);this.writeNode("PropertyName",a,d);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,d);else{var e;e=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Box",a.value);a.projection&&e.setAttribute("srsName",a.projection);d.appendChild(e)}return d},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});
OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(a){OpenLayers.Util.extend(this,a)},clone:function(){return new (eval(this.CLASS_NAME))(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});
OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});
OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});
OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,
graphicName:"square"},read:function(a,c){var c=OpenLayers.Util.applyDefaults(c,this.options),d={namedLayers:c.namedLayersAsArray===true?[]:{}};this.readChildNodes(a,d);return d},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,c){c.version=a.getAttribute("version");this.readChildNodes(a,c)},Name:function(a,c){c.name=this.getChildValue(a)},Title:function(a,c){c.title=this.getChildValue(a)},Abstract:function(a,c){c.description=this.getChildValue(a)},NamedLayer:function(a,
c){var d={userStyles:[],namedStyles:[]};this.readChildNodes(a,d);for(var e=0,f=d.userStyles.length;e<f;++e)d.userStyles[e].layerName=d.name;OpenLayers.Util.isArray(c.namedLayers)?c.namedLayers.push(d):c.namedLayers[d.name]=d},NamedStyle:function(a,c){c.namedStyles.push(this.getChildName(a.firstChild))},UserStyle:function(a,c){var d={defaultsPerSymbolizer:true,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(a,d);if(this.multipleSymbolizers){delete d.defaultsPerSymbolizer;d=new OpenLayers.Style2(d)}else d=
new OpenLayers.Style(this.defaultSymbolizer,d);c.userStyles.push(d)},IsDefault:function(a,c){if(this.getChildValue(a)=="1")c.isDefault=true},FeatureTypeStyle:function(a,c){++this.featureTypeCounter;var d={rules:this.multipleSymbolizers?c.rules:[]};this.readChildNodes(a,d);if(!this.multipleSymbolizers)c.rules=d.rules},Rule:function(a,c){var d;this.multipleSymbolizers&&(d={symbolizers:[]});d=new OpenLayers.Rule(d);this.readChildNodes(a,d);c.rules.push(d)},ElseFilter:function(a,c){c.elseFilter=true},
MinScaleDenominator:function(a,c){c.minScaleDenominator=parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,c){c.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(a,c){var d={};this.readChildNodes(a,d);if(this.multipleSymbolizers){d.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Text(d))}else c.symbolizer.Text=OpenLayers.Util.applyDefaults(d,c.symbolizer.Text)},LabelPlacement:function(a,c){this.readChildNodes(a,c)},PointPlacement:function(a,
c){var d={};this.readChildNodes(a,d);d.labelRotation=d.rotation;delete d.rotation;var e,f=c.labelAnchorPointX,g=c.labelAnchorPointY;f<=1/3?e="l":f>1/3&&f<2/3?e="c":f>=2/3&&(e="r");g<=1/3?e=e+"b":g>1/3&&g<2/3?e=e+"m":g>=2/3&&(e=e+"t");d.labelAlign=e;OpenLayers.Util.applyDefaults(c,d)},AnchorPoint:function(a,c){this.readChildNodes(a,c)},AnchorPointX:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.labelAnchorPointX=d},AnchorPointY:function(a,c){var d=this.readers.ogc._expression.call(this,
a);if(d)c.labelAnchorPointY=d},Displacement:function(a,c){this.readChildNodes(a,c)},DisplacementX:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.labelXOffset=d},DisplacementY:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.labelYOffset=d},LinePlacement:function(a,c){this.readChildNodes(a,c)},PerpendicularOffset:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.labelPerpendicularOffset=d},Label:function(a,c){var d=this.readers.ogc._expression.call(this,
a);if(d)c.label=d},Font:function(a,c){this.readChildNodes(a,c)},Halo:function(a,c){var d={};this.readChildNodes(a,d);c.haloRadius=d.haloRadius;c.haloColor=d.fillColor;c.haloOpacity=d.fillOpacity},Radius:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d!=null)c.haloRadius=d},RasterSymbolizer:function(a,c){var d={};this.readChildNodes(a,d);if(this.multipleSymbolizers){d.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Raster(d))}else c.symbolizer.Raster=OpenLayers.Util.applyDefaults(d,
c.symbolizer.Raster)},Geometry:function(a,c){c.geometry={};this.readChildNodes(a,c.geometry)},ColorMap:function(a,c){c.colorMap=[];this.readChildNodes(a,c.colorMap)},ColorMapEntry:function(a,c){var d=a.getAttribute("quantity"),e=a.getAttribute("opacity");c.push({color:a.getAttribute("color"),quantity:d!==null?parseFloat(d):void 0,label:a.getAttribute("label")||void 0,opacity:e!==null?parseFloat(e):void 0})},LineSymbolizer:function(a,c){var d={};this.readChildNodes(a,d);if(this.multipleSymbolizers){d.zIndex=
this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Line(d))}else c.symbolizer.Line=OpenLayers.Util.applyDefaults(d,c.symbolizer.Line)},PolygonSymbolizer:function(a,c){var d={fill:false,stroke:false};this.multipleSymbolizers||(d=c.symbolizer.Polygon||d);this.readChildNodes(a,d);if(this.multipleSymbolizers){d.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Polygon(d))}else c.symbolizer.Polygon=d},PointSymbolizer:function(a,c){var d={fill:false,stroke:false,
graphic:false};this.multipleSymbolizers||(d=c.symbolizer.Point||d);this.readChildNodes(a,d);if(this.multipleSymbolizers){d.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Point(d))}else c.symbolizer.Point=d},Stroke:function(a,c){c.stroke=true;this.readChildNodes(a,c)},Fill:function(a,c){c.fill=true;this.readChildNodes(a,c)},CssParameter:function(a,c){var d=a.getAttribute("name"),e=this.cssMap[d];c.label&&(d==="fill"?e="fontColor":d==="fill-opacity"&&(e="fontOpacity"));
if(e)(d=this.readers.ogc._expression.call(this,a))&&(c[e]=d)},Graphic:function(a,c){c.graphic=true;var d={};this.readChildNodes(a,d);for(var e=["stroke","strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fill","fillColor","fillOpacity","graphicName","rotation","graphicFormat"],f,g,h=0,i=e.length;h<i;++h){f=e[h];g=d[f];g!=void 0&&(c[f]=g)}if(d.opacity!=void 0)c.graphicOpacity=d.opacity;if(d.size!=void 0)isNaN(d.size/2)?c.graphicWidth=d.size:c.pointRadius=d.size/2;if(d.href!=void 0)c.externalGraphic=
d.href;if(d.rotation!=void 0)c.rotation=d.rotation},ExternalGraphic:function(a,c){this.readChildNodes(a,c)},Mark:function(a,c){this.readChildNodes(a,c)},WellKnownName:function(a,c){c.graphicName=this.getChildValue(a)},Opacity:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.opacity=d},Size:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.size=d},Rotation:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.rotation=d},OnlineResource:function(a,
c){c.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,c){c.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var c=
null,d;for(d in this.cssMap)if(this.cssMap[d]==a){c=d;break}return c},getGraphicFormat:function(a){var c,d;for(d in this.graphicFormats)if(this.graphicFormats[d].test(a)){c=d;break}return c||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(a,c){var d=this.createElementNSPlus(a),
e=typeof c=="string"?c.split("${"):[c];d.appendChild(this.createTextNode(e[0]));for(var f,g,h=1,i=e.length;h<i;h++){f=e[h];g=f.indexOf("}");if(g>0){this.writeNode("ogc:PropertyName",{property:f.substring(0,g)},d);d.appendChild(this.createTextNode(f.substring(++g)))}else d.appendChild(this.createTextNode("${"+f))}return d},StyledLayerDescriptor:function(a){var c=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});c.setAttribute("xmlns:ogc",
this.namespaces.ogc);c.setAttribute("xmlns:gml",this.namespaces.gml);a.name&&this.writeNode("Name",a.name,c);a.title&&this.writeNode("Title",a.title,c);a.description&&this.writeNode("Abstract",a.description,c);if(OpenLayers.Util.isArray(a.namedLayers))for(var d=0,e=a.namedLayers.length;d<e;++d)this.writeNode("NamedLayer",a.namedLayers[d],c);else for(d in a.namedLayers)this.writeNode("NamedLayer",a.namedLayers[d],c);return c},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},
Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(a){var c=this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",a.name,c);if(a.namedStyles)for(var d=0,e=a.namedStyles.length;d<e;++d)this.writeNode("NamedStyle",a.namedStyles[d],c);if(a.userStyles){d=0;for(e=a.userStyles.length;d<e;++d)this.writeNode("UserStyle",a.userStyles[d],c)}return c},NamedStyle:function(a){var c=
this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,c);return c},UserStyle:function(a){var c=this.createElementNSPlus("sld:UserStyle");a.name&&this.writeNode("Name",a.name,c);a.title&&this.writeNode("Title",a.title,c);a.description&&this.writeNode("Abstract",a.description,c);a.isDefault&&this.writeNode("IsDefault",a.isDefault,c);if(this.multipleSymbolizers&&a.rules){for(var d={"0":[]},e=[0],f,g,h,i,j,k=0,l=a.rules.length;k<l;++k){f=a.rules[k];if(f.symbolizers){g={};for(var m=0,n=f.symbolizers.length;m<
n;++m){h=f.symbolizers[m];i=h.zIndex;if(!(i in g)){j=f.clone();j.symbolizers=[];g[i]=j}g[i].symbolizers.push(h.clone())}for(i in g){if(!(i in d)){e.push(i);d[i]=[]}d[i].push(g[i])}}else d[0].push(f.clone())}e.sort();k=0;for(l=e.length;k<l;++k){f=d[e[k]];if(f.length>0){j=a.clone();j.rules=d[e[k]];this.writeNode("FeatureTypeStyle",j,c)}}}else this.writeNode("FeatureTypeStyle",a,c);return c},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:a?"1":"0"})},FeatureTypeStyle:function(a){for(var c=
this.createElementNSPlus("sld:FeatureTypeStyle"),d=0,e=a.rules.length;d<e;++d)this.writeNode("Rule",a.rules[d],c);return c},Rule:function(a){var c=this.createElementNSPlus("sld:Rule");a.name&&this.writeNode("Name",a.name,c);a.title&&this.writeNode("Title",a.title,c);a.description&&this.writeNode("Abstract",a.description,c);a.elseFilter?this.writeNode("ElseFilter",null,c):a.filter&&this.writeNode("ogc:Filter",a.filter,c);a.minScaleDenominator!=void 0&&this.writeNode("MinScaleDenominator",a.minScaleDenominator,
c);a.maxScaleDenominator!=void 0&&this.writeNode("MaxScaleDenominator",a.maxScaleDenominator,c);var d,e;if(this.multipleSymbolizers&&a.symbolizers)for(var f=0,g=a.symbolizers.length;f<g;++f){e=a.symbolizers[f];d=e.CLASS_NAME.split(".").pop();this.writeNode(d+"Symbolizer",e,c)}else for(var g=OpenLayers.Style.SYMBOLIZER_PREFIXES,f=0,h=g.length;f<h;++f){d=g[f];(e=a.symbolizer[d])&&this.writeNode(d+"Symbolizer",e,c)}return c},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",
{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:a})},LineSymbolizer:function(a){var c=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,c);return c},Stroke:function(a){var c=this.createElementNSPlus("sld:Stroke");a.strokeColor!=void 0&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},c);a.strokeOpacity!=void 0&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},c);a.strokeWidth!=void 0&&
this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},c);a.strokeDashstyle!=void 0&&a.strokeDashstyle!=="solid"&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},c);a.strokeLinecap!=void 0&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},c);return c},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var c=this.createElementNSPlus("sld:TextSymbolizer");
a.label!=null&&this.writeNode("Label",a.label,c);(a.fontFamily!=null||a.fontSize!=null||a.fontWeight!=null||a.fontStyle!=null)&&this.writeNode("Font",a,c);(a.labelAnchorPointX!=null||a.labelAnchorPointY!=null||a.labelAlign!=null||a.labelXOffset!=null||a.labelYOffset!=null||a.labelRotation!=null||a.labelPerpendicularOffset!=null)&&this.writeNode("LabelPlacement",a,c);(a.haloRadius!=null||a.haloColor!=null||a.haloOpacity!=null)&&this.writeNode("Halo",a,c);(a.fontColor!=null||a.fontOpacity!=null)&&this.writeNode("Fill",
{fillColor:a.fontColor,fillOpacity:a.fontOpacity},c);return c},LabelPlacement:function(a){var c=this.createElementNSPlus("sld:LabelPlacement");(a.labelAnchorPointX!=null||a.labelAnchorPointY!=null||a.labelAlign!=null||a.labelXOffset!=null||a.labelYOffset!=null||a.labelRotation!=null)&&a.labelPerpendicularOffset==null&&this.writeNode("PointPlacement",a,c);a.labelPerpendicularOffset!=null&&this.writeNode("LinePlacement",a,c);return c},LinePlacement:function(a){var c=this.createElementNSPlus("sld:LinePlacement");
this.writeNode("PerpendicularOffset",a.labelPerpendicularOffset,c);return c},PerpendicularOffset:function(a){return this.createElementNSPlus("sld:PerpendicularOffset",{value:a})},PointPlacement:function(a){var c=this.createElementNSPlus("sld:PointPlacement");(a.labelAnchorPointX!=null||a.labelAnchorPointY!=null||a.labelAlign!=null)&&this.writeNode("AnchorPoint",a,c);(a.labelXOffset!=null||a.labelYOffset!=null)&&this.writeNode("Displacement",a,c);a.labelRotation!=null&&this.writeNode("Rotation",a.labelRotation,
c);return c},AnchorPoint:function(a){var c=this.createElementNSPlus("sld:AnchorPoint"),d=a.labelAnchorPointX,e=a.labelAnchorPointY;d!=null&&this.writeNode("AnchorPointX",d,c);e!=null&&this.writeNode("AnchorPointY",e,c);if(d==null&&e==null){var f=a.labelAlign.substr(0,1),a=a.labelAlign.substr(1,1);f==="l"?d=0:f==="c"?d=0.5:f==="r"&&(d=1);a==="b"?e=0:a==="m"?e=0.5:a==="t"&&(e=1);this.writeNode("AnchorPointX",d,c);this.writeNode("AnchorPointY",e,c)}return c},AnchorPointX:function(a){return this.createElementNSPlus("sld:AnchorPointX",
{value:a})},AnchorPointY:function(a){return this.createElementNSPlus("sld:AnchorPointY",{value:a})},Displacement:function(a){var c=this.createElementNSPlus("sld:Displacement");a.labelXOffset!=null&&this.writeNode("DisplacementX",a.labelXOffset,c);a.labelYOffset!=null&&this.writeNode("DisplacementY",a.labelYOffset,c);return c},DisplacementX:function(a){return this.createElementNSPlus("sld:DisplacementX",{value:a})},DisplacementY:function(a){return this.createElementNSPlus("sld:DisplacementY",{value:a})},
Font:function(a){var c=this.createElementNSPlus("sld:Font");a.fontFamily&&this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},c);a.fontSize&&this.writeNode("CssParameter",{symbolizer:a,key:"fontSize"},c);a.fontWeight&&this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},c);a.fontStyle&&this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},c);return c},Label:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Label",a)},Halo:function(a){var c=this.createElementNSPlus("sld:Halo");
a.haloRadius&&this.writeNode("Radius",a.haloRadius,c);(a.haloColor||a.haloOpacity)&&this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},c);return c},Radius:function(a){return this.createElementNSPlus("sld:Radius",{value:a})},RasterSymbolizer:function(a){var c=this.createElementNSPlus("sld:RasterSymbolizer");a.geometry&&this.writeNode("Geometry",a.geometry,c);a.opacity&&this.writeNode("Opacity",a.opacity,c);a.colorMap&&this.writeNode("ColorMap",a.colorMap,c);return c},Geometry:function(a){var c=
this.createElementNSPlus("sld:Geometry");a.property&&this.writeNode("ogc:PropertyName",a,c);return c},ColorMap:function(a){for(var c=this.createElementNSPlus("sld:ColorMap"),d=0,e=a.length;d<e;++d)this.writeNode("ColorMapEntry",a[d],c);return c},ColorMapEntry:function(a){var c=this.createElementNSPlus("sld:ColorMapEntry");c.setAttribute("color",a.color);a.opacity!==void 0&&c.setAttribute("opacity",parseFloat(a.opacity));a.quantity!==void 0&&c.setAttribute("quantity",parseFloat(a.quantity));a.label!==
void 0&&c.setAttribute("label",a.label);return c},PolygonSymbolizer:function(a){var c=this.createElementNSPlus("sld:PolygonSymbolizer");a.fill!==false&&this.writeNode("Fill",a,c);a.stroke!==false&&this.writeNode("Stroke",a,c);return c},Fill:function(a){var c=this.createElementNSPlus("sld:Fill");a.fillColor&&this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},c);a.fillOpacity!=null&&this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},c);return c},PointSymbolizer:function(a){var c=
this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,c);return c},Graphic:function(a){var c=this.createElementNSPlus("sld:Graphic");a.externalGraphic!=void 0?this.writeNode("ExternalGraphic",a,c):this.writeNode("Mark",a,c);a.graphicOpacity!=void 0&&this.writeNode("Opacity",a.graphicOpacity,c);a.pointRadius!=void 0?this.writeNode("Size",a.pointRadius*2,c):a.graphicWidth!=void 0&&this.writeNode("Size",a.graphicWidth,c);a.rotation!=void 0&&this.writeNode("Rotation",a.rotation,c);
return c},ExternalGraphic:function(a){var c=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,c);this.writeNode("Format",a.graphicFormat||this.getGraphicFormat(a.externalGraphic),c);return c},Mark:function(a){var c=this.createElementNSPlus("sld:Mark");a.graphicName&&this.writeNode("WellKnownName",a.graphicName,c);a.fill!==false&&this.writeNode("Fill",a,c);a.stroke!==false&&this.writeNode("Stroke",a,c);return c},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",
{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Size",a)},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),
CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Format.WFST=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS),c=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported WFST version: "+a.version;return new c(a)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};
OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]=
"wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,c){var d=c&&c.srsName;d||(d=a&&a.layer?a.layer.projection.getCode():this.srsName);return d},read:function(a,c){c=c||{};OpenLayers.Util.applyDefaults(c,{output:"features"});typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var d={};a&&this.readNode(a,d,true);if(d.features&&c.output==="features")d=
d.features;return d},readers:{wfs:{FeatureCollection:function(a,c){c.features=[];this.readChildNodes(a,c)}}},write:function(a,c){var d=this.writeNode("wfs:Transaction",{features:a,options:c}),e=this.schemaLocationAttr();e&&this.setAttributeNS(d,this.namespaces.xsi,"xsi:schemaLocation",e);return OpenLayers.Format.XML.prototype.write.apply(this,[d])},writers:{wfs:{GetFeature:function(a){var c=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:a&&a.handle,
outputFormat:a&&a.outputFormat,maxFeatures:a&&a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});if(typeof this.featureType=="string")this.writeNode("Query",a,c);else for(var d=0,e=this.featureType.length;d<e;d++){a.featureType=this.featureType[d];this.writeNode("Query",a,c)}return c},Transaction:function(a){var a=a||{},c=a.options||{},d=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:c.handle}}),e,f=a.features;if(f){c.multi===true&&
OpenLayers.Util.extend(this.geometryTypes,{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":this.multiCurve===true?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":this.multiSurface===true?"MultiSurface":"MultiPolygon"});var g,h,a=0;for(e=f.length;a<e;++a){h=f[a];(g=this.stateName[h.state])&&this.writeNode(g,{feature:h,options:c},d)}c.multi===true&&this.setGeometryTypes()}if(c.nativeElements){a=0;for(e=c.nativeElements.length;a<e;++a)this.writeNode("wfs:Native",
c.nativeElements[a],d)}return d},Native:function(a){return this.createElementNSPlus("wfs:Native",{attributes:{vendorId:a.vendorId,safeToIgnore:a.safeToIgnore},value:a.value})},Insert:function(a){var c=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Insert",{attributes:{handle:a&&a.handle}});this.srsName=this.getSrsName(c);this.writeNode("feature:_typeName",c,a);return a},Update:function(a){var c=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Update",{attributes:{handle:a&&a.handle,typeName:(this.featureNS?
this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var d=c.modified;if(this.geometryName!==null&&(!d||d.geometry!==void 0)){this.srsName=this.getSrsName(c);this.writeNode("Property",{name:this.geometryName,value:c.geometry},a)}for(var e in c.attributes)c.attributes[e]!==void 0&&(!d||!d.attributes||d.attributes&&d.attributes[e]!==void 0)&&this.writeNode("Property",{name:e,value:c.attributes[e]},a);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[c.fid]}),
a);return a},Property:function(a){var c=this.createElementNSPlus("wfs:Property");this.writeNode("Name",a.name,c);a.value!==null&&this.writeNode("Value",a.value,c);return c},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var c;if(a instanceof OpenLayers.Geometry){c=this.createElementNSPlus("wfs:Value");a=this.writeNode("feature:_geometry",a).firstChild;c.appendChild(a)}else c=this.createElementNSPlus("wfs:Value",{value:a});return c},Delete:function(a){var c=
a.feature,a=a.options,a=this.createElementNSPlus("wfs:Delete",{attributes:{handle:a&&a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[c.fid]}),a);return a}}},schemaLocationAttr:function(a){var a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a),c=OpenLayers.Util.extend({},this.schemaLocations);if(a.schema)c[a.featurePrefix]=
a.schema;var a=[],d,e;for(e in c)(d=this.namespaces[e])&&a.push(d+" "+c[e]);return a.join(" ")||void 0},setFilterProperty:function(a){if(a.filters)for(var c=0,d=a.filters.length;c<d;++c)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,a.filters[c]);else if(a instanceof OpenLayers.Filter.Spatial&&!a.property)a.property=this.geometryName},CLASS_NAME:"OpenLayers.Format.WFST.v1"});
OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(a,c,d){if(a=parseInt(a.getAttribute("srsDimension"),10)||d&&d.srsDimension)c.srsDimension=a},featureMembers:function(a,
c){this.readChildNodes(a,c)},Curve:function(a,c){var d={points:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);if(!c.components)c.components=[];c.components.push(new OpenLayers.Geometry.LineString(d.points))},segments:function(a,c){this.readChildNodes(a,c)},LineStringSegment:function(a,c){var d={};this.readChildNodes(a,d);d.points&&Array.prototype.push.apply(c.points,d.points)},pos:function(a,c){var d=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),
d=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2]);c.points=[d]},posList:function(a,c){for(var d=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),e=c.srsDimension||parseInt(a.getAttribute("srsDimension")||a.getAttribute("dimension"),10)||2,f,g,h,i=Array(d.length/e),j=0,k=d.length;j<k;j=j+e){f=d[j];g=d[j+1];h=e==2?void 0:d[j+2];i[j/e]=this.xy?new OpenLayers.Geometry.Point(f,g,h):new OpenLayers.Geometry.Point(g,
f,h)}c.points=i},Surface:function(a,c){this.readChildNodes(a,c)},patches:function(a,c){this.readChildNodes(a,c)},PolygonPatch:function(a,c){this.readers.gml.Polygon.apply(this,[a,c])},exterior:function(a,c){var d={};this.readChildNodes(a,d);c.outer=d.components[0]},interior:function(a,c){var d={};this.readChildNodes(a,d);c.inner.push(d.components[0])},MultiCurve:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);if(d.components.length>0)c.components=
[new OpenLayers.Geometry.MultiLineString(d.components)]},curveMember:function(a,c){this.readChildNodes(a,c)},MultiSurface:function(a,c){var d={components:[]};this.readers.gml._inherit.apply(this,[a,d,c]);this.readChildNodes(a,d);if(d.components.length>0)c.components=[new OpenLayers.Geometry.MultiPolygon(d.components)]},surfaceMember:function(a,c){this.readChildNodes(a,c)},surfaceMembers:function(a,c){this.readChildNodes(a,c)},pointMembers:function(a,c){this.readChildNodes(a,c)},lineStringMembers:function(a,
c){this.readChildNodes(a,c)},polygonMembers:function(a,c){this.readChildNodes(a,c)},geometryMembers:function(a,c){this.readChildNodes(a,c)},Envelope:function(a,c){var d={points:Array(2)};this.readChildNodes(a,d);if(!c.components)c.components=[];var e=d.points[0],d=d.points[1];c.components.push(new OpenLayers.Bounds(e.x,e.y,d.x,d.y))},lowerCorner:function(a,c){var d={};this.readers.gml.pos.apply(this,[a,d]);c.points[0]=d.points[0]},upperCorner:function(a,c){var d={};this.readers.gml.pos.apply(this,
[a,d]);c.points[1]=d.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){a=this.writeNode("gml:"+(OpenLayers.Util.isArray(a)?"featureMembers":"featureMember"),a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){for(var c=
this.createElementNSPlus("gml:featureMembers"),d=0,e=a.length;d<e;++d)this.writeNode("feature:_typeName",a[d],c);return c},Point:function(a){var c=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,c);return c},pos:function(a){return this.createElementNSPlus("gml:pos",{value:this.xy?a.x+" "+a.y:a.y+" "+a.x})},LineString:function(a){var c=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,c);return c},Curve:function(a){var c=this.createElementNSPlus("gml:Curve");
this.writeNode("segments",a,c);return c},segments:function(a){var c=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,c);return c},LineStringSegment:function(a){var c=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,c);return c},posList:function(a){for(var c=a.length,d=Array(c),e,f=0;f<c;++f){e=a[f];d[f]=this.xy?e.x+" "+e.y:e.y+" "+e.x}return this.createElementNSPlus("gml:posList",{value:d.join(" ")})},Surface:function(a){var c=this.createElementNSPlus("gml:Surface");
this.writeNode("patches",a,c);return c},patches:function(a){var c=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,c);return c},PolygonPatch:function(a){var c=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",a.components[0],c);for(var d=1,e=a.components.length;d<e;++d)this.writeNode("interior",a.components[d],c);return c},Polygon:function(a){var c=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0],
c);for(var d=1,e=a.components.length;d<e;++d)this.writeNode("interior",a.components[d],c);return c},exterior:function(a){var c=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,c);return c},interior:function(a){var c=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,c);return c},LinearRing:function(a){var c=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,c);return c},MultiCurve:function(a){for(var c=this.createElementNSPlus("gml:MultiCurve"),
a=a.components||[a],d=0,e=a.length;d<e;++d)this.writeNode("curveMember",a[d],c);return c},curveMember:function(a){var c=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,c):this.writeNode("LineString",a,c);return c},MultiSurface:function(a){for(var c=this.createElementNSPlus("gml:MultiSurface"),a=a.components||[a],d=0,e=a.length;d<e;++d)this.writeNode("surfaceMember",a[d],c);return c},surfaceMember:function(a){var c=this.createElementNSPlus("gml:surfaceMember");this.surface?
this.writeNode("Surface",a,c):this.writeNode("Polygon",a,c);return c},Envelope:function(a){var c=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,c);this.writeNode("upperCorner",a,c);this.srsName&&c.setAttribute("srsName",this.srsName);return c},lowerCorner:function(a){return this.createElementNSPlus("gml:lowerCorner",{value:this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left})},upperCorner:function(a){return this.createElementNSPlus("gml:upperCorner",{value:this.xy?a.right+" "+
a.top:a.top+" "+a.right})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":this.curve===true?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":this.multiCurve===false?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":this.surface===
true?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":this.multiSurface===false?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});
OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,c){var d=a.getAttribute("matchCase"),d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!(d==="false"||d==="0")});this.readChildNodes(a,
d);c.filters.push(d)},PropertyIsNotEqualTo:function(a,c){var d=a.getAttribute("matchCase"),d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!(d==="false"||d==="0")});this.readChildNodes(a,d);c.filters.push(d)},PropertyIsLike:function(a,c){var d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,d);var e=a.getAttribute("wildCard"),f=a.getAttribute("singleChar"),g=a.getAttribute("escapeChar");d.value2regex(e,f,
g);c.filters.push(d)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsNotEqualTo:function(a){var c=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",
{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,c);this.writeOgcExpression(a.value,c);return c},PropertyIsLike:function(a){var c=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:a.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,c);this.writeNode("Literal",a.regex2value(),c);return c},BBOX:function(a){var c=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,c);var d=this.writeNode("gml:Envelope",
a.value);a.projection&&d.setAttribute("srsName",a.projection);c.appendChild(d);return c},SortBy:function(a){for(var c=this.createElementNSPlus("ogc:SortBy"),d=0,e=a.length;d<e;d++)this.writeNode("ogc:SortProperty",a[d],c);return c},SortProperty:function(a){var c=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",a,c);this.writeNode("ogc:SortOrder",a.order=="DESC"?"DESC":"ASC",c);return c},SortOrder:function(a){return this.createElementNSPlus("ogc:SortOrder",{value:a})}},
OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,c){var d=this.createElementNSPlus("ogc:"+c);this.writeNode("PropertyName",a,d);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,d);else{var e;e=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Envelope",a.value);a.projection&&
e.setAttribute("srsName",a.projection);d.appendChild(e)}return d},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(a){var c=this.version;if(!c){(a=a.getAttribute("xmlns:ows"))&&a.substring(a.lastIndexOf("/")+1)==="1.1"&&(c="1.1.0");if(!c)c=this.defaultVersion}return c},CLASS_NAME:"OpenLayers.Format.OWSCommon"});
OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a,c){OpenLayers.Util.applyDefaults(c,this.options);var d={};this.readChildNodes(a,d);return d},readers:{ows:{Exception:function(a,c){var d={code:a.getAttribute("exceptionCode"),locator:a.getAttribute("locator"),texts:[]};c.exceptions.push(d);this.readChildNodes(a,d)},ExceptionText:function(a,c){var d=this.getChildValue(a);c.texts.push(d)},
ServiceIdentification:function(a,c){c.serviceIdentification={};this.readChildNodes(a,c.serviceIdentification)},Title:function(a,c){c.title=this.getChildValue(a)},Abstract:function(a,c){c["abstract"]=this.getChildValue(a)},Keywords:function(a,c){c.keywords={};this.readChildNodes(a,c.keywords)},Keyword:function(a,c){c[this.getChildValue(a)]=true},ServiceType:function(a,c){c.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,c){c.serviceTypeVersion=
this.getChildValue(a)},Fees:function(a,c){c.fees=this.getChildValue(a)},AccessConstraints:function(a,c){c.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,c){c.serviceProvider={};this.readChildNodes(a,c.serviceProvider)},ProviderName:function(a,c){c.providerName=this.getChildValue(a)},ProviderSite:function(a,c){c.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,c){c.serviceContact={};this.readChildNodes(a,c.serviceContact)},IndividualName:function(a,
c){c.individualName=this.getChildValue(a)},PositionName:function(a,c){c.positionName=this.getChildValue(a)},ContactInfo:function(a,c){c.contactInfo={};this.readChildNodes(a,c.contactInfo)},Phone:function(a,c){c.phone={};this.readChildNodes(a,c.phone)},Voice:function(a,c){c.voice=this.getChildValue(a)},Address:function(a,c){c.address={};this.readChildNodes(a,c.address)},DeliveryPoint:function(a,c){c.deliveryPoint=this.getChildValue(a)},City:function(a,c){c.city=this.getChildValue(a)},AdministrativeArea:function(a,
c){c.administrativeArea=this.getChildValue(a)},PostalCode:function(a,c){c.postalCode=this.getChildValue(a)},Country:function(a,c){c.country=this.getChildValue(a)},ElectronicMailAddress:function(a,c){c.electronicMailAddress=this.getChildValue(a)},Role:function(a,c){c.role=this.getChildValue(a)},OperationsMetadata:function(a,c){c.operationsMetadata={};this.readChildNodes(a,c.operationsMetadata)},Operation:function(a,c){var d=a.getAttribute("name");c[d]={};this.readChildNodes(a,c[d])},DCP:function(a,
c){c.dcp={};this.readChildNodes(a,c.dcp)},HTTP:function(a,c){c.http={};this.readChildNodes(a,c.http)},Get:function(a,c){if(!c.get)c.get=[];var d={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,d);c.get.push(d)},Post:function(a,c){if(!c.post)c.post=[];var d={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,d);c.post.push(d)},Parameter:function(a,c){if(!c.parameters)c.parameters={};var d=a.getAttribute("name");c.parameters[d]={};this.readChildNodes(a,
c.parameters[d])},Constraint:function(a,c){if(!c.constraints)c.constraints={};var d=a.getAttribute("name");c.constraints[d]={};this.readChildNodes(a,c.constraints[d])},Value:function(a,c){c[this.getChildValue(a)]=true},OutputFormat:function(a,c){c.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,c)},WGS84BoundingBox:function(a,c){var d={};d.crs=a.getAttribute("crs");if(c.BoundingBox)c.BoundingBox.push(d);else{c.projection=d.crs;d=c}this.readChildNodes(a,d)},BoundingBox:function(a,
c){this.readers.ows.WGS84BoundingBox.apply(this,[a,c])},LowerCorner:function(a,c){var d=this.getChildValue(a).replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),d=d.split(this.regExes.splitSpace);c.left=d[0];c.bottom=d[1]},UpperCorner:function(a,c){var d=this.getChildValue(a).replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),d=d.split(this.regExes.splitSpace);c.right=d[0];c.top=d[1];c.bounds=new OpenLayers.Bounds(c.left,c.bottom,c.right,c.top);delete c.left;
delete c.bottom;delete c.right;delete c.top},Language:function(a,c){c.language=this.getChildValue(a)}}},writers:{ows:{BoundingBox:function(a){var c=this.createElementNSPlus("ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,c);this.writeNode("ows:UpperCorner",a,c);return c},LowerCorner:function(a){return this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom})},UpperCorner:function(a){return this.createElementNSPlus("ows:UpperCorner",
{value:a.bounds.right+" "+a.bounds.top})},Identifier:function(a){return this.createElementNSPlus("ows:Identifier",{value:a})},Title:function(a){return this.createElementNSPlus("ows:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("ows:Abstract",{value:a})},OutputFormat:function(a){return this.createElementNSPlus("ows:OutputFormat",{value:a})}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});
OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,c){c.success=false;c.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("language"),exceptions:[]};this.readChildNodes(a,c.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},
CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});
OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,c){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,[a,c])},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,c){c.numberOfFeatures=
parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(a,c){c.insertIds=[];c.success=false;this.readChildNodes(a,c)},TransactionSummary:function(a,c){c.success=true},InsertResults:function(a,c){this.readChildNodes(a,c)},Feature:function(a,c){var d={fids:[]};this.readChildNodes(a,d);c.insertIds.push(d.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,
feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var c=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);a&&this.setAttributes(c,{resultType:a.resultType,startIndex:a.startIndex,count:a.count});return c},Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,
featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a),c=a.featurePrefix,d=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(c?c+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&&d.setAttribute("xmlns:"+c,a.featureNS);if(a.propertyNames)for(var c=0,e=a.propertyNames.length;c<e;c++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[c]},d);if(a.filter){OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,a.filter);this.writeNode("ogc:Filter",
a.filter,d)}return d},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});
OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",errorProperty:"service",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});
OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);return c},readers:{wfs:{WFS_Capabilities:function(a,c){this.readChildNodes(a,c)},
FeatureTypeList:function(a,c){c.featureTypeList={featureTypes:[]};this.readChildNodes(a,c.featureTypeList)},FeatureType:function(a,c){var d={};this.readChildNodes(a,d);c.featureTypes.push(d)},Name:function(a,c){var d=this.getChildValue(a);if(d){d=d.split(":");c.name=d.pop();if(d.length>0)c.featureNS=this.lookupNamespaceURI(a,d[0])}},Title:function(a,c){var d=this.getChildValue(a);if(d)c.title=d},Abstract:function(a,c){var d=this.getChildValue(a);d&&(c["abstract"]=d)}}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});
OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a,c=this.controls.length-1;c>=0;c--){a=this.controls[c];a.events&&
a.events.un({activate:this.iconOn,deactivate:this.iconOff});a.panel_div=null}this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var a,c=0,d=this.controls.length;c<d;c++){a=this.controls[c];(a===this.defaultControl||this.saveState&&this.activeState[a.id])&&a.activate()}if(this.saveState===true)this.defaultControl=null;this.redraw();return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var a,
c=0,d=this.controls.length;c<d;c++){a=this.controls[c];this.activeState[a.id]=a.deactivate()}this.redraw();return true}return false},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.outsideViewport){this.events.attachToElement(this.div);this.events.register("buttonclick",this,this.onButtonClick)}else this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var a=this.div.childNodes.length-
1;a>=0;a--)this.div.removeChild(this.div.childNodes[a]);this.div.innerHTML="";if(this.active)for(var a=0,c=this.controls.length;a<c;a++)this.div.appendChild(this.controls[a].panel_div)},activateControl:function(a){if(!this.active)return false;if(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger();else if(a.type==OpenLayers.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();else if(this.allowDepress&&a.active)a.deactivate();else{for(var c,d=0,e=this.controls.length;d<e;d++){c=this.controls[d];
c!=a&&(c.type===OpenLayers.Control.TYPE_TOOL||c.type==null)&&c.deactivate()}a.activate()}},addControls:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.controls=this.controls.concat(a);for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this.createControlMarkup(e);OpenLayers.Element.addClass(f,e.displayClass+"ItemInactive");OpenLayers.Element.addClass(f,"olButton");if(e.title!=""&&!f.title)f.title=e.title;e.panel_div=f}if(this.map){this.addControlsToMap(a);this.redraw()}},createControlMarkup:function(){return document.createElement("div")},
addControlsToMap:function(a){for(var c,d=0,e=a.length;d<e;d++){c=a[d];if(c.autoActivate===true){c.autoActivate=false;this.map.addControl(c);c.autoActivate=true}else{this.map.addControl(c);c.deactivate()}c.events.on({activate:this.iconOn,deactivate:this.iconOff})}},iconOn:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+
"Item)Active\\b"),"$1Inactive")},onButtonClick:function(a){for(var c=this.controls,a=a.buttonElement,d=c.length-1;d>=0;--d)if(c[d].panel_div===a){this.activateControl(c[d]);break}},getControlsBy:function(a,c){var d=typeof c.test=="function";return OpenLayers.Array.filter(this.controls,function(e){return e[a]==c||d&&c.test(e[a])})},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"});
OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});
OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});
OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,c){c.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(a,c.exceptionReport)},AllowedValues:function(a,c){c.allowedValues={};this.readChildNodes(a,c.allowedValues)},AnyValue:function(a,c){c.anyValue=
true},DataType:function(a,c){c.dataType=this.getChildValue(a)},Range:function(a,c){c.range={};this.readChildNodes(a,c.range)},MinimumValue:function(a,c){c.minValue=this.getChildValue(a)},MaximumValue:function(a,c){c.maxValue=this.getChildValue(a)},Identifier:function(a,c){c.identifier=this.getChildValue(a)},SupportedCRS:function(a,c){c.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(a){var c=this.createElementNSPlus("ows:Range",
{attributes:{"ows:rangeClosure":a.closure}});this.writeNode("ows:MinimumValue",a.minValue,c);this.writeNode("ows:MaximumValue",a.maxValue,c);return c},MinimumValue:function(a){return this.createElementNSPlus("ows:MinimumValue",{value:a})},MaximumValue:function(a){return this.createElementNSPlus("ows:MaximumValue",{value:a})},Value:function(a){return this.createElementNSPlus("ows:Value",{value:a})}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});
OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(a){a=this.writeNode("wcs:GetCoverage",
a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{wcs:{GetCoverage:function(a){var c=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:a.version||this.VERSION,service:"WCS"}});this.writeNode("ows:Identifier",a.identifier,c);this.writeNode("wcs:DomainSubset",a.domainSubset,c);this.writeNode("wcs:Output",a.output,c);return c},DomainSubset:function(a){var c=this.createElementNSPlus("wcs:DomainSubset",
{});this.writeNode("ows:BoundingBox",a.boundingBox,c);a.temporalSubset&&this.writeNode("wcs:TemporalSubset",a.temporalSubset,c);return c},TemporalSubset:function(a){for(var c=this.createElementNSPlus("wcs:TemporalSubset",{}),d=0,e=a.timePeriods.length;d<e;++d)this.writeNode("wcs:TimePeriod",a.timePeriods[d],c);return c},TimePeriod:function(a){var c=this.createElementNSPlus("wcs:TimePeriod",{});this.writeNode("wcs:BeginPosition",a.begin,c);this.writeNode("wcs:EndPosition",a.end,c);a.resolution&&this.writeNode("wcs:TimeResolution",
a.resolution,c);return c},BeginPosition:function(a){return this.createElementNSPlus("wcs:BeginPosition",{value:a})},EndPosition:function(a){return this.createElementNSPlus("wcs:EndPosition",{value:a})},TimeResolution:function(a){return this.createElementNSPlus("wcs:TimeResolution",{value:a})},Output:function(a){var c=this.createElementNSPlus("wcs:Output",{attributes:{format:a.format,store:a.store}});a.gridCRS&&this.writeNode("wcs:GridCRS",a.gridCRS,c);return c},GridCRS:function(a){var c=this.createElementNSPlus("wcs:GridCRS",
{});this.writeNode("wcs:GridBaseCRS",a.baseCRS,c);a.type&&this.writeNode("wcs:GridType",a.type,c);a.origin&&this.writeNode("wcs:GridOrigin",a.origin,c);this.writeNode("wcs:GridOffsets",a.offsets,c);a.CS&&this.writeNode("wcs:GridCS",a.CS,c);return c},GridBaseCRS:function(a){return this.createElementNSPlus("wcs:GridBaseCRS",{value:a})},GridOrigin:function(a){return this.createElementNSPlus("wcs:GridOrigin",{value:a})},GridType:function(a){return this.createElementNSPlus("wcs:GridType",{value:a})},GridOffsets:function(a){return this.createElementNSPlus("wcs:GridOffsets",
{value:a})},GridCS:function(a){return this.createElementNSPlus("wcs:GridCS",{value:a})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"});
OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",
schemaLocationAttr:function(){},write:function(a){var c;if(window.ActiveXObject)this.xmldom=c=new ActiveXObject("Microsoft.XMLDOM");else c=document.implementation.createDocument("","",null);a=this.writeNode("wps:Execute",a,c);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;
var c={};this.readNode(a,c);return c},writers:{wps:{Execute:function(a){var c=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});this.writeNode("ows:Identifier",a.identifier,c);this.writeNode("wps:DataInputs",a.dataInputs,c);this.writeNode("wps:ResponseForm",a.responseForm,c);return c},ResponseForm:function(a){var c=this.createElementNSPlus("wps:ResponseForm",{});a.rawDataOutput&&this.writeNode("wps:RawDataOutput",a.rawDataOutput,c);a.responseDocument&&this.writeNode("wps:ResponseDocument",
a.responseDocument,c);return c},ResponseDocument:function(a){var c=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:a.storeExecuteResponse,lineage:a.lineage,status:a.status}});if(a.outputs)for(var d=0,e=a.outputs.length;d<e;d++)this.writeNode("wps:Output",a.outputs[d],c);return c},Output:function(a){var c=this.createElementNSPlus("wps:Output",{attributes:{asReference:a.asReference,mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",
a.identifier,c);this.writeNode("ows:Title",a.title,c);this.writeNode("ows:Abstract",a["abstract"],c);return c},RawDataOutput:function(a){var c=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",a.identifier,c);return c},DataInputs:function(a){for(var c=this.createElementNSPlus("wps:DataInputs",{}),d=0,e=a.length;d<e;++d)this.writeNode("wps:Input",a[d],c);return c},Input:function(a){var c=this.createElementNSPlus("wps:Input",
{});this.writeNode("ows:Identifier",a.identifier,c);a.title&&this.writeNode("ows:Title",a.title,c);a.data&&this.writeNode("wps:Data",a.data,c);a.reference&&this.writeNode("wps:Reference",a.reference,c);a.boundingBoxData&&this.writeNode("wps:BoundingBoxData",a.boundingBoxData,c);return c},Data:function(a){var c=this.createElementNSPlus("wps:Data",{});a.literalData?this.writeNode("wps:LiteralData",a.literalData,c):a.complexData?this.writeNode("wps:ComplexData",a.complexData,c):a.boundingBoxData&&this.writeNode("ows:BoundingBox",
a.boundingBoxData,c);return c},LiteralData:function(a){return this.createElementNSPlus("wps:LiteralData",{attributes:{uom:a.uom},value:a.value})},ComplexData:function(a){var c=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}}),d=a.value;typeof d==="string"?c.appendChild(this.getXMLDoc().createCDATASection(a.value)):c.appendChild(d);return c},Reference:function(a){var c=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:a.mimeType,
"xlink:href":a.href,method:a.method,encoding:a.encoding,schema:a.schema}});a.body&&this.writeNode("wps:Body",a.body,c);return c},BoundingBoxData:function(a,c){this.writers.ows.BoundingBox.apply(this,[a,c,"wps:BoundingBoxData"])},Body:function(a){var c=this.createElementNSPlus("wps:Body",{});if(a.wcs)this.writeNode("wcs:GetCoverage",a.wcs,c);else if(a.wfs){this.featureType=a.wfs.featureType;this.version=a.wfs.version;this.writeNode("wfs:GetFeature",a.wfs,c)}else this.writeNode("wps:Execute",a,c);return c}},
wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},readers:{wps:{ExecuteResponse:function(a,c){c.executeResponse={lang:a.getAttribute("lang"),statusLocation:a.getAttribute("statusLocation"),serviceInstance:a.getAttribute("serviceInstance"),service:a.getAttribute("service")};this.readChildNodes(a,c.executeResponse)},
Process:function(a,c){c.process={};this.readChildNodes(a,c.process)},Status:function(a,c){c.status={creationTime:a.getAttribute("creationTime")};this.readChildNodes(a,c.status)},ProcessSucceeded:function(a,c){c.processSucceeded=true},ProcessOutputs:function(a,c){c.processOutputs=[];this.readChildNodes(a,c.processOutputs)},Output:function(a,c){var d={};this.readChildNodes(a,d);c.push(d)},Reference:function(a,c){c.reference={href:a.getAttribute("href"),mimeType:a.getAttribute("mimeType"),encoding:a.getAttribute("encoding"),
schema:a.getAttribute("schema")}},Data:function(a,c){c.data={};this.readChildNodes(a,c)},LiteralData:function(a,c){c.literalData={dataType:a.getAttribute("dataType"),uom:a.getAttribute("uom"),value:this.getChildValue(a)}},ComplexData:function(a,c){c.complexData={mimeType:a.getAttribute("mimeType"),schema:a.getAttribute("schema"),encoding:a.getAttribute("encoding"),value:""};if(this.isSimpleContent(a)){var d;for(d=a.firstChild;d;d=d.nextSibling)switch(d.nodeType){case 3:case 4:c.complexData.value=
c.complexData.value+d.nodeValue}}else for(d=a.firstChild;d;d=d.nextSibling)if(d.nodeType==1)c.complexData.value=d},BoundingBox:function(a,c){c.boundingBoxData={dimensions:a.getAttribute("dimensions"),crs:a.getAttribute("crs")};this.readChildNodes(a,c.boundingBoxData)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"});
OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=false},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){if(!this.active)return this.active=true;return false},deactivate:function(){if(this.active){this.active=false;return true}return false},CLASS_NAME:"OpenLayers.Strategy"});
OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(a){this.cache=[];this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this})}return a},deactivate:function(){this.cache=null;this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});
return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(a){if(!this.caching&&this.filter){var c=a.features;a.features=[];for(var d,e=0,f=c.length;e<f;++e){d=c[e];this.filter.evaluate(d)?a.features.push(d):this.cache.push(d)}}},handleRemove:function(){if(!this.caching)this.cache=[]},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});if(this.cache.length>0){this.caching=true;this.layer.removeFeatures(this.cache.slice());
this.caching=false}if(a.length>0){a={features:a};this.handleAdd(a);if(a.features.length>0){this.caching=true;this.layer.addFeatures(a.features);this.caching=false}}},CLASS_NAME:"OpenLayers.Strategy.Filter"});
OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(a,c){var d=this.getChildValue(a);if(d)c.srs=d}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});
OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,c,d,e,f,g){this.layer=a;this.position=c.clone();this.setBounds(d);this.url=e;if(f)this.size=f.clone();this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,g);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){if(this.isLoading){this.isLoading=
false;this.events.triggerEvent("unload")}},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var c=this.shouldDraw();c&&!a&&(c=this.events.triggerEvent("beforedraw")!==false);return c},shouldDraw:function(){var a=false,c=this.layer.maxExtent;if(c){var d=this.layer.map,d=d.baseLayer.wrapDateLine&&d.getMaxExtent();this.bounds.intersectsBounds(c,
{inclusive:false,worldBounds:d})&&(a=true)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine)var c=this.layer.map.getMaxExtent(),d=this.layer.map.getResolution(),a=a.wrapDateLine(c,{leftTolerance:d,rightTolerance:d});this.bounds=a},moveTo:function(a,c,d){d==null&&(d=true);this.setBounds(a);this.position=c.clone();d&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"});
OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,c,d,e,f,g){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=e;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=
null||this.layer.gutter||this.layerAlphaHack){this.frame=document.createElement("div");this.frame.style.position="absolute";this.frame.style.overflow="hidden"}this.maxGetUrlLength!=null&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){if(this.imgDiv){this.clear();this.frame=this.imgDiv=null}this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a){if(this.layer!=this.layer.map.baseLayer&&
this.layer.reproject)this.bounds=this.getBoundsFromBaseLayer(this.position);if(this.isLoading)this._loadEvent="reload";else{this.isLoading=true;this._loadEvent="loadstart"}this.positionTile();this.renderTile()}else this.unload();return a},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(c){if(a==this.asyncRequestId){this.url=c;this.initImage()}},this)}else{this.url=
this.layer.getURL(this.bounds);this.initImage()}},positionTile:function(){var a=this.getTile().style,c=this.frame?this.size:this.layer.getImageSize(this.bounds);a.left=this.position.x+"%";a.top=this.position.y+"%";a.width=c.w+"%";a.height=c.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){OpenLayers.Event.stopObservingElement(a);var c=this.getTile();c.parentNode===this.layer.div&&this.layer.div.removeChild(c);this.setImgSrc();if(this.layerAlphaHack===
true)a.style.filter="";OpenLayers.Element.removeClass(a,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var a=this.imgDiv.style;if(this.frame){var c=0,d=0;if(this.layer.gutter){c=this.layer.gutter/this.layer.tileSize.w*100;d=this.layer.gutter/this.layer.tileSize.h*100}a.left=-c+"%";a.top=-d+"%";a.width=2*c+100+"%";a.height=2*d+100+"%"}a.visibility="hidden";a.opacity=
0;if(this.layer.opacity<1)a.filter="alpha(opacity="+this.layer.opacity*100+")";a.position="absolute";if(this.layerAlphaHack){a.paddingTop=a.height;a.height="0";a.width="100%"}this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var a=this.getImage();if(this.url&&a.getAttribute("src")==this.url)this.onImageLoad();else{var c=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(a);OpenLayers.Event.observe(a,
"load",OpenLayers.Function.bind(this.onImageLoad,this));OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);if(a.getAttribute("src")==this.blankImageUrl)c();else{OpenLayers.Event.observe(a,"load",c);OpenLayers.Event.observe(a,"error",c);this.crossOriginKeyword&&a.removeAttribute("crossorigin");a.src=this.blankImageUrl}}},setImgSrc:function(a){var c=this.imgDiv;c.style.visibility="hidden";c.style.opacity=0;
if(a){this.crossOriginKeyword&&(a.substr(0,5)!=="data:"?c.setAttribute("crossorigin",this.crossOriginKeyword):c.removeAttribute("crossorigin"));c.src=a}},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var a;if(this.frame){a=this.frame.cloneNode(false);a.appendChild(this.imgDiv)}else a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;OpenLayers.Event.stopObservingElement(a);a.style.visibility=
"inherit";a.style.opacity=this.layer.opacity;this.isLoading=false;this.canvasContext=null;this.events.triggerEvent("loadend");if(parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var c=document.createElement("span");c.style.display="none";var d=this.layer.div;d.appendChild(c);window.setTimeout(function(){c.parentNode===d&&c.parentNode.removeChild(c)},0)}if(this.layerAlphaHack===true)a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')"},
onImageError:function(){var a=this.imgDiv;if(a.src!=null){this.imageReloadAttempts++;if(this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS)this.setImgSrc(this.layer.getURL(this.bounds));else{OpenLayers.Element.addClass(a,"olImageLoadError");this.events.triggerEvent("loaderror");this.onImageLoad()}}},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;
this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});
OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,c,d,e,f){this.url=c;this.maxExtent=this.extent=d;this.size=e;OpenLayers.Layer.prototype.initialize.apply(this,[a,f]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(a){if(this.options.maxResolution==null)this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w;OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,c,d){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var e=this.tile==null;if(c||e){this.setTileSize();
var f=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});if(e){this.tile=new OpenLayers.Tile.Image(this,f,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=f.clone()}this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),c=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,c)},addTileMonitoringHooks:function(a){a.onLoadStart=
function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});
OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);this.events=new OpenLayers.Events(this)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a&&this.auto)if(typeof this.auto==="number")this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1E3);else this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,
scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.auto&&(typeof this.auto==="number"?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this}));return a},triggerSave:function(a){var c=a.feature;(c.state===OpenLayers.State.INSERT||c.state===OpenLayers.State.UPDATE||c.state===OpenLayers.State.DELETE)&&this.save([a.feature])},save:function(a){if(!a)a=this.layer.features;
this.events.triggerEvent("start",{features:a});var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c)){for(var e=a.length,f=Array(e),g,h,i=0;i<e;++i){g=a[i];h=g.clone();h.fid=g.fid;h.state=g.state;if(g.url)h.url=g.url;h._original=g;h.geometry.transform(d,c);f[i]=h}a=f}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var c={response:a};if(a.success()){for(var d=a.reqFeatures,e,f=[],g=a.insertIds||[],h=0,i=0,j=d.length;i<j;++i){e=d[i];
e=e._original||e;if(a=e.state){if(a==OpenLayers.State.DELETE)f.push(e);else if(a==OpenLayers.State.INSERT){e.fid=g[h];++h}e.state=null}}f.length>0&&this.layer.destroyFeatures(f);this.events.triggerEvent("success",c)}else this.events.triggerEvent("fail",c)},CLASS_NAME:"OpenLayers.Strategy.Save"});
OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,
[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=[];if(this.extractTracks)for(var d=a.getElementsByTagName("trk"),e=0,f=d.length;e<f;e++){var g={};this.extractAttributes&&(g=this.parseAttributes(d[e]));for(var h=this.getElementsByTagNameNS(d[e],d[e].namespaceURI,"trkseg"),i=0,j=h.length;i<j;i++){var k=this.extractSegment(h[i],"trkpt");c.push(new OpenLayers.Feature.Vector(k,g))}}if(this.extractRoutes){f=a.getElementsByTagName("rte");d=0;for(e=
f.length;d<e;d++){g={};this.extractAttributes&&(g=this.parseAttributes(f[d]));h=this.extractSegment(f[d],"rtept");c.push(new OpenLayers.Feature.Vector(h,g))}}if(this.extractWaypoints){a=a.getElementsByTagName("wpt");d=0;for(f=a.length;d<f;d++){g={};this.extractAttributes&&(g=this.parseAttributes(a[d]));e=new OpenLayers.Geometry.Point(a[d].getAttribute("lon"),a[d].getAttribute("lat"));c.push(new OpenLayers.Feature.Vector(e,g))}}if(this.internalProjection&&this.externalProjection){g=0;for(a=c.length;g<
a;g++)c[g].geometry.transform(this.externalProjection,this.internalProjection)}return c},extractSegment:function(a,c){for(var d=this.getElementsByTagNameNS(a,a.namespaceURI,c),e=[],f=0,g=d.length;f<g;f++)e.push(new OpenLayers.Geometry.Point(d[f].getAttribute("lon"),d[f].getAttribute("lat")));return new OpenLayers.Geometry.LineString(e)},parseAttributes:function(a){for(var c={},a=a.firstChild,d,e;a;){if(a.nodeType==1&&a.firstChild){d=a.firstChild;if(d.nodeType==3||d.nodeType==4){e=a.prefix?a.nodeName.split(":")[1]:
a.nodeName;if(e!="trkseg"&&e!="rtept")c[e]=d.nodeValue}}a=a.nextSibling}return c},write:function(a,c){var a=OpenLayers.Util.isArray(a)?a:[a],d=this.createElementNS(this.namespaces.gpx,"gpx");d.setAttribute("version","1.1");d.setAttribute("creator",this.creator);this.setAttributes(d,{"xsi:schemaLocation":this.schemaLocation});c&&typeof c=="object"&&d.appendChild(this.buildMetadataNode(c));for(var e=0,f=a.length;e<f;e++)d.appendChild(this.buildFeatureNode(a[e]));return OpenLayers.Format.XML.prototype.write.apply(this,
[d])},buildMetadataNode:function(a){for(var c=["name","desc","author"],d=this.createElementNSPlus("gpx:metadata"),e=0;e<c.length;e++){var f=c[e];if(a[f]){var g=this.createElementNSPlus("gpx:"+f);g.appendChild(this.createTextNode(a[f]));d.appendChild(g)}}return d},buildFeatureNode:function(a){var c=a.geometry,c=c.clone();this.internalProjection&&this.externalProjection&&c.transform(this.internalProjection,this.externalProjection);if(c.CLASS_NAME=="OpenLayers.Geometry.Point"){var d=this.buildWptNode(c);
this.appendAttributesNode(d,a);return d}d=this.createElementNSPlus("gpx:trk");this.appendAttributesNode(d,a);for(var a=this.buildTrkSegNode(c),a=OpenLayers.Util.isArray(a)?a:[a],c=0,e=a.length;c<e;c++)d.appendChild(a[c]);return d},buildTrkSegNode:function(a){var c,d,e,f;if(a.CLASS_NAME=="OpenLayers.Geometry.LineString"||a.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){c=this.createElementNSPlus("gpx:trkseg");d=0;for(e=a.components.length;d<e;d++){f=a.components[d];c.appendChild(this.buildTrkPtNode(f))}return c}c=
[];d=0;for(e=a.components.length;d<e;d++)c.push(this.buildTrkSegNode(a.components[d]));return c},buildTrkPtNode:function(a){var c=this.createElementNSPlus("gpx:trkpt");c.setAttribute("lon",a.x);c.setAttribute("lat",a.y);return c},buildWptNode:function(a){var c=this.createElementNSPlus("gpx:wpt");c.setAttribute("lon",a.x);c.setAttribute("lat",a.y);return c},appendAttributesNode:function(a,c){var d=this.createElementNSPlus("gpx:name");d.appendChild(this.createTextNode(c.attributes.name||c.id));a.appendChild(d);
d=this.createElementNSPlus("gpx:desc");d.appendChild(this.createTextNode(c.attributes.description||this.defaultDesc));a.appendChild(d)},CLASS_NAME:"OpenLayers.Format.GPX"});
OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(a,c){var d=[],e={};this.readChildNodes(a,{complexTypes:d,customTypes:e});for(var f=a.attributes,g,h,i=0,j=f.length;i<j;++i){g=f[i];h=g.name;h.indexOf("xmlns")==0?this.setNamespace(h.split(":")[1]||"",g.value):c[h]=g.value}c.featureTypes=d;c.targetPrefix=this.namespaceAlias[c.targetNamespace];i=0;for(j=d.length;i<j;++i){f=d[i];g=e[f.typeName];
if(e[f.typeName])f.typeName=g.name}},complexType:function(a,c){var d={typeName:a.getAttribute("name")};this.readChildNodes(a,d);c.complexTypes.push(d)},complexContent:function(a,c){this.readChildNodes(a,c)},extension:function(a,c){this.readChildNodes(a,c)},sequence:function(a,c){var d={elements:[]};this.readChildNodes(a,d);c.properties=d.elements},element:function(a,c){if(c.elements){for(var d={},e=a.attributes,f,g=0,h=e.length;g<h;++g){f=e[g];d[f.name]=f.value}e=d.type;if(!e){e={};this.readChildNodes(a,
e);d.restriction=e;d.type=e.base}d.localType=(e.base||e).split(":").pop();c.elements.push(d)}if(c.complexTypes){e=a.getAttribute("type");d=e.split(":").pop();c.customTypes[d]={name:a.getAttribute("name"),type:e}}},simpleType:function(a,c){this.readChildNodes(a,c)},restriction:function(a,c){c.base=a.getAttribute("base");this.readRestriction(a,c)}}},readRestriction:function(a,c){for(var d=a.childNodes,e,f,g=0,h=d.length;g<h;++g){e=d[g];if(e.nodeType==1){f=e.nodeName.split(":").pop();e=e.getAttribute("value");
if(c[f]){typeof c[f]=="string"&&(c[f]=[c[f]]);c[f].push(e)}else c[f]=e}}},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};if(a.nodeName.split(":").pop()==="ExceptionReport"){var d=new OpenLayers.Format.OGCExceptionReport;c.error=d.read(a)}else this.readNode(a,c);return c},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});
OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,c){this.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(this,c)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return false},setExtent:function(a,c){this.extent=a.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var d=a.getWidth()/this.map.getExtent().getWidth(),
a=a.scale(1/d);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(d)}if(c)this.resolution=null;return true},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,c){if(c==null)c=a.style;if(a.geometry){var d=a.geometry.getBounds();if(d){var e;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(e=this.map.getMaxExtent());d.intersectsBounds(this.extent,{worldBounds:e})?this.calculateFeatureDx(d,
e):c={display:"none"};d=this.drawGeometry(a.geometry,c,a.id);if(c.display!="none"&&c.label&&d!==false){e=a.geometry.getCentroid();if(c.labelXOffset||c.labelYOffset){var f=isNaN(c.labelXOffset)?0:c.labelXOffset,g=isNaN(c.labelYOffset)?0:c.labelYOffset,h=this.getResolution();e.move(f*h,g*h)}this.drawText(a.id,c,e)}else this.removeText(a.id);return d}}},calculateFeatureDx:function(a,c){this.featureDx=0;if(c){var d=c.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/
2)/d)*d}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0,d=a.length;c<d;++c){var e=a[c];this.eraseGeometry(e.geometry,e.id);this.removeText(e.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var c=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);
if(a.stroke===false){delete c.strokeWidth;delete c.strokeColor}a.fill===false&&delete c.fillColor;OpenLayers.Util.extend(c,a);return c},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};
OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};
OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,c){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};if(this.hitDetection){this.hitCanvas=document.createElement("canvas");this.hitContext=this.hitCanvas.getContext("2d")}},
setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return false},eraseGeometry:function(a,c){this.eraseFeatures(this.features[c][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var c=this.root;c.style.width=a.w+"px";c.style.height=a.h+"px";c.width=a.w;c.height=a.h;this.resolution=null;if(this.hitDetection){c=this.hitCanvas;c.style.width=a.w+"px";c.style.height=a.h+"px";c.width=a.w;c.height=a.h}},drawFeature:function(a,
c){var d;if(a.geometry){c=this.applyDefaultSymbolizer(c||a.style);d=a.geometry.getBounds();var e;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(e=this.map.getMaxExtent());e=d&&d.intersectsBounds(this.extent,{worldBounds:e});(d=c.display!=="none"&&!!d&&e)?this.features[a.id]=[a,c]:delete this.features[a.id];this.pendingRedraw=true}if(this.pendingRedraw&&!this.locked){this.redraw();this.pendingRedraw=false}return d},drawGeometry:function(a,c,d){var e=a.CLASS_NAME;if(e=="OpenLayers.Geometry.Collection"||
e=="OpenLayers.Geometry.MultiPoint"||e=="OpenLayers.Geometry.MultiLineString"||e=="OpenLayers.Geometry.MultiPolygon")for(e=0;e<a.components.length;e++)this.drawGeometry(a.components[e],c,d);else switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":this.drawPoint(a,c,d);break;case "OpenLayers.Geometry.LineString":this.drawLineString(a,c,d);break;case "OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,c,d);break;case "OpenLayers.Geometry.Polygon":this.drawPolygon(a,c,d)}},drawExternalGraphic:function(a,
c,d){var e=new Image;if(c.graphicTitle)e.title=c.graphicTitle;var f=c.graphicWidth||c.graphicHeight,g=c.graphicHeight||c.graphicWidth,f=f?f:c.pointRadius*2,g=g?g:c.pointRadius*2,h=c.graphicXOffset!=void 0?c.graphicXOffset:-(0.5*f),i=c.graphicYOffset!=void 0?c.graphicYOffset:-(0.5*g),j=c.graphicOpacity||c.fillOpacity;e.onload=OpenLayers.Function.bind(function(){if(this.features[d]){var c=this.getLocalXY(a),l=c[0],c=c[1];if(!isNaN(l)&&!isNaN(c)){var l=l+h|0,c=c+i|0,m=this.canvas;m.globalAlpha=j;var n=
OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);m.drawImage(e,l*n,c*n,f*n,g*n);if(this.hitDetection){this.setHitContextStyle("fill",d);this.hitContext.fillRect(l,c,f,g)}}}},this);e.src=c.externalGraphic},drawNamedSymbol:function(a,c,d){var e,f,g,h;g=Math.PI/180;var i=OpenLayers.Renderer.symbol[c.graphicName];if(!i)throw Error(c.graphicName+" is not a valid symbol name");
if(i.length&&!(i.length<2)){a=this.getLocalXY(a);f=a[0];h=a[1];if(!isNaN(f)&&!isNaN(h)){this.canvas.lineCap="round";this.canvas.lineJoin="round";if(this.hitDetection){this.hitContext.lineCap="round";this.hitContext.lineJoin="round"}if(c.graphicName in this.cachedSymbolBounds)e=this.cachedSymbolBounds[c.graphicName];else{e=new OpenLayers.Bounds;for(a=0;a<i.length;a=a+2)e.extend(new OpenLayers.LonLat(i[a],i[a+1]));this.cachedSymbolBounds[c.graphicName]=e}this.canvas.save();this.hitDetection&&this.hitContext.save();
this.canvas.translate(f,h);this.hitDetection&&this.hitContext.translate(f,h);a=g*c.rotation;if(!isNaN(a)){this.canvas.rotate(a);this.hitDetection&&this.hitContext.rotate(a)}g=2*c.pointRadius/Math.max(e.getWidth(),e.getHeight());this.canvas.scale(g,g);this.hitDetection&&this.hitContext.scale(g,g);a=e.getCenterLonLat().lon;e=e.getCenterLonLat().lat;this.canvas.translate(-a,-e);this.hitDetection&&this.hitContext.translate(-a,-e);h=c.strokeWidth;c.strokeWidth=h/g;if(c.fill!==false){this.setCanvasStyle("fill",
c);this.canvas.beginPath();for(a=0;a<i.length;a=a+2){e=i[a];f=i[a+1];a==0&&this.canvas.moveTo(e,f);this.canvas.lineTo(e,f)}this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",d,c);this.hitContext.beginPath();for(a=0;a<i.length;a=a+2){e=i[a];f=i[a+1];a==0&&this.canvas.moveTo(e,f);this.hitContext.lineTo(e,f)}this.hitContext.closePath();this.hitContext.fill()}}if(c.stroke!==false){this.setCanvasStyle("stroke",c);this.canvas.beginPath();for(a=0;a<i.length;a=
a+2){e=i[a];f=i[a+1];a==0&&this.canvas.moveTo(e,f);this.canvas.lineTo(e,f)}this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",d,c,g);this.hitContext.beginPath();for(a=0;a<i.length;a=a+2){e=i[a];f=i[a+1];a==0&&this.hitContext.moveTo(e,f);this.hitContext.lineTo(e,f)}this.hitContext.closePath();this.hitContext.stroke()}}c.strokeWidth=h;this.canvas.restore();this.hitDetection&&this.hitContext.restore();this.setCanvasStyle("reset")}}},setCanvasStyle:function(a,
c){if(a==="fill"){this.canvas.globalAlpha=c.fillOpacity;this.canvas.fillStyle=c.fillColor}else if(a==="stroke"){this.canvas.globalAlpha=c.strokeOpacity;this.canvas.strokeStyle=c.strokeColor;this.canvas.lineWidth=c.strokeWidth}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1}},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;if(a>=16777216){this.hitOverflow=a-16777215;a=a%16777216+1}var a="000000"+a.toString(16),c=a.length;return a="#"+a.substring(c-6,c)},setHitContextStyle:function(a,
c,d,e){c=this.featureIdToHex(c);if(a=="fill"){this.hitContext.globalAlpha=1;this.hitContext.fillStyle=c}else if(a=="stroke"){this.hitContext.globalAlpha=1;this.hitContext.strokeStyle=c;if(typeof e==="undefined")this.hitContext.lineWidth=d.strokeWidth+2;else if(!isNaN(e))this.hitContext.lineWidth=d.strokeWidth+2/e}else{this.hitContext.globalAlpha=0;this.hitContext.lineWidth=1}},drawPoint:function(a,c,d){if(c.graphic!==false)if(c.externalGraphic)this.drawExternalGraphic(a,c,d);else if(c.graphicName&&
c.graphicName!="circle")this.drawNamedSymbol(a,c,d);else{var e=this.getLocalXY(a),a=e[0],e=e[1];if(!isNaN(a)&&!isNaN(e)){var f=Math.PI*2,g=c.pointRadius;if(c.fill!==false){this.setCanvasStyle("fill",c);this.canvas.beginPath();this.canvas.arc(a,e,g,0,f,true);this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",d,c);this.hitContext.beginPath();this.hitContext.arc(a,e,g,0,f,true);this.hitContext.fill()}}if(c.stroke!==false){this.setCanvasStyle("stroke",c);this.canvas.beginPath();this.canvas.arc(a,
e,g,0,f,true);this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",d,c);this.hitContext.beginPath();this.hitContext.arc(a,e,g,0,f,true);this.hitContext.stroke()}this.setCanvasStyle("reset")}}}},drawLineString:function(a,c,d){c=OpenLayers.Util.applyDefaults({fill:false},c);this.drawLinearRing(a,c,d)},drawLinearRing:function(a,c,d){if(c.fill!==false){this.setCanvasStyle("fill",c);this.renderPath(this.canvas,a,c,d,"fill");if(this.hitDetection){this.setHitContextStyle("fill",d,
c);this.renderPath(this.hitContext,a,c,d,"fill")}}if(c.stroke!==false){this.setCanvasStyle("stroke",c);this.renderPath(this.canvas,a,c,d,"stroke");if(this.hitDetection){this.setHitContextStyle("stroke",d,c);this.renderPath(this.hitContext,a,c,d,"stroke")}}this.setCanvasStyle("reset")},renderPath:function(a,c,d,e,f){c=c.components;d=c.length;a.beginPath();var e=this.getLocalXY(c[0]),g=e[1];if(!isNaN(e[0])&&!isNaN(g)){a.moveTo(e[0],e[1]);for(e=1;e<d;++e){g=this.getLocalXY(c[e]);a.lineTo(g[0],g[1])}f===
"fill"?a.fill():a.stroke()}},drawPolygon:function(a,c,d){var a=a.components,e=a.length;this.drawLinearRing(a[0],c,d);for(var f=1;f<e;++f){this.canvas.globalCompositeOperation="destination-out";if(this.hitDetection)this.hitContext.globalCompositeOperation="destination-out";this.drawLinearRing(a[f],OpenLayers.Util.applyDefaults({stroke:false,fillOpacity:1},c),d);this.canvas.globalCompositeOperation="source-over";if(this.hitDetection)this.hitContext.globalCompositeOperation="source-over";this.drawLinearRing(a[f],
OpenLayers.Util.applyDefaults({fill:false},c),d)}},drawText:function(a,c){var d=this.getLocalXY(a);this.setCanvasStyle("reset");this.canvas.fillStyle=c.fontColor;this.canvas.globalAlpha=c.fontOpacity||1;var e=[c.fontStyle?c.fontStyle:"normal","normal",c.fontWeight?c.fontWeight:"normal",c.fontSize?c.fontSize:"1em",c.fontFamily?c.fontFamily:"sans-serif"].join(" "),f=c.label.split("\n"),g=f.length;if(this.canvas.fillText){this.canvas.font=e;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[c.labelAlign[0]]||
"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[c.labelAlign[1]]||"middle";var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[c.labelAlign[1]];h==null&&(h=-0.5);e=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;d[1]=d[1]+e*h*(g-1);for(h=0;h<g;h++){if(c.labelOutlineWidth){this.canvas.save();this.canvas.strokeStyle=c.labelOutlineColor;this.canvas.lineWidth=c.labelOutlineWidth;this.canvas.strokeText(f[h],d[0],d[1]+e*h+1);this.canvas.restore()}this.canvas.fillText(f[h],
d[0],d[1]+e*h)}}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=e;var i=OpenLayers.Renderer.Canvas.LABEL_FACTOR[c.labelAlign[0]];i==null&&(i=-0.5);h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[c.labelAlign[1]];h==null&&(h=-0.5);e=this.canvas.mozMeasureText("xx");d[1]=d[1]+e*(1+h*g);for(h=0;h<g;h++){var j=d[0]+i*this.canvas.mozMeasureText(f[h]),k=d[1]+h*e;this.canvas.translate(j,k);this.canvas.mozDrawText(f[h]);this.canvas.translate(-j,-k)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var c=
this.getResolution(),d=this.extent;return[(a.x-this.featureDx)/c+-d.left/c,d.top/c-a.y/c]},clear:function(){var a=this.root.height,c=this.root.width;this.canvas.clearRect(0,0,c,a);this.features={};this.hitDetection&&this.hitContext.clearRect(0,0,c,a)},getFeatureIdFromEvent:function(a){var c;if(this.hitDetection&&this.root.style.display!=="none"&&!this.map.dragging){a=a.xy;a=this.hitContext.getImageData(a.x|0,a.y|0,1,1).data;if(a[3]===255)if(a=a[2]+256*(a[1]+256*a[0])){a="OpenLayers.Feature.Vector_"+
(a-1+this.hitOverflow);try{c=this.features[a][0]}catch(d){}}}return c},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0;c<a.length;++c)delete this.features[a[c].id];this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,c=this.root.width;this.canvas.clearRect(0,0,c,a);this.hitDetection&&this.hitContext.clearRect(0,0,c,a);var a=[],d,e,f=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent(),g;for(g in this.features)if(this.features.hasOwnProperty(g)){c=
this.features[g][0];d=c.geometry;this.calculateFeatureDx(d.getBounds(),f);e=this.features[g][1];this.drawGeometry(d,e,c.id);e.label&&a.push([c,e])}c=0;for(d=a.length;c<d;++c){g=a[c];this.drawText(g[0].geometry.getCentroid(),g[1])}}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;
OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(a){for(var c={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]},c=OpenLayers.Util.extend(c,a),d={},a=0;a<c.interestingTagsExclude.length;a++)d[c.interestingTagsExclude[a]]=true;c.interestingTagsExclude=d;d={};
for(a=0;a<c.areaTags.length;a++)d[c.areaTags[a]]=true;c.areaTags=d;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[c])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var c=this.getNodes(a),d=this.getWays(a),a=Array(d.length),e=0;e<d.length;e++){for(var f=Array(d[e].nodes.length),g=this.isWayArea(d[e])?1:0,h=0;h<d[e].nodes.length;h++){var i=c[d[e].nodes[h]],j=new OpenLayers.Geometry.Point(i.lon,
i.lat);j.osm_id=parseInt(d[e].nodes[h]);f[h]=j;i.used=true}i=null;i=g?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(f)):new OpenLayers.Geometry.LineString(f);this.internalProjection&&this.externalProjection&&i.transform(this.externalProjection,this.internalProjection);f=new OpenLayers.Feature.Vector(i,d[e].tags);f.osm_id=parseInt(d[e].id);f.fid="way."+f.osm_id;a[e]=f}for(var k in c){i=c[k];if(!i.used||this.checkTags){d=null;if(this.checkTags){d=this.getTags(i.node,true);if(i.used&&
!d[1])continue;d=d[0]}else d=this.getTags(i.node);f=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(i.lon,i.lat),d);this.internalProjection&&this.externalProjection&&f.geometry.transform(this.externalProjection,this.internalProjection);f.osm_id=parseInt(k);f.fid="node."+f.osm_id;a.push(f)}i.node=null}return a},getNodes:function(a){for(var a=a.getElementsByTagName("node"),c={},d=0;d<a.length;d++){var e=a[d],f=e.getAttribute("id");c[f]={lat:e.getAttribute("lat"),lon:e.getAttribute("lon"),
node:e}}return c},getWays:function(a){for(var a=a.getElementsByTagName("way"),c=[],d=0;d<a.length;d++){var e=a[d],f={id:e.getAttribute("id")};f.tags=this.getTags(e);e=e.getElementsByTagName("nd");f.nodes=Array(e.length);for(var g=0;g<e.length;g++)f.nodes[g]=e[g].getAttribute("ref");c.push(f)}return c},getTags:function(a,c){for(var d=a.getElementsByTagName("tag"),e={},f=false,g=0;g<d.length;g++){var h=d[g].getAttribute("k");e[h]=d[g].getAttribute("v");c&&(this.interestingTagsExclude[h]||(f=true))}return c?
[e,f]:e},isWayArea:function(a){var c=false,d=false;a.nodes[0]==a.nodes[a.nodes.length-1]&&(c=true);if(this.checkTags)for(var e in a.tags)if(this.areaTags[e]){d=true;break}return c&&(this.checkTags?d:true)},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.osm_id=1;this.created_nodes={};var c=this.createElementNS(null,"osm");c.setAttribute("version","0.5");c.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var d=a.length-1;d>=0;d--)for(var e=this.createFeatureNodes(a[d]),
f=0;f<e.length;f++)c.appendChild(e[f]);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createFeatureNodes:function(a){var c=[],d=a.geometry.CLASS_NAME,d=d.substring(d.lastIndexOf(".")+1),d=d.toLowerCase();(d=this.createXML[d])&&(c=d.apply(this,[a]));return c},createXML:{point:function(a){var c=null,d=a.geometry?a.geometry:a;if(this.internalProjection&&this.externalProjection){d=d.clone();d.transform(this.internalProjection,this.externalProjection)}var e=false;if(a.osm_id){c=a.osm_id;
this.created_nodes[c]&&(e=true)}else{c=-this.osm_id;this.osm_id++}var f=e?this.created_nodes[c]:this.createElementNS(null,"node");this.created_nodes[c]=f;f.setAttribute("id",c);f.setAttribute("lon",d.x);f.setAttribute("lat",d.y);a.attributes&&this.serializeTags(a,f);this.setState(a,f);return e?[]:[f]},linestring:function(a){var c,d=[],e=a.geometry;if(a.osm_id)c=a.osm_id;else{c=-this.osm_id;this.osm_id++}var f=this.createElementNS(null,"way");f.setAttribute("id",c);for(c=0;c<e.components.length;c++){var g=
this.createXML.point.apply(this,[e.components[c]]);if(g.length){var g=g[0],h=g.getAttribute("id");d.push(g)}else{h=e.components[c].osm_id;g=this.created_nodes[h]}this.setState(a,g);g=this.createElementNS(null,"nd");g.setAttribute("ref",h);f.appendChild(g)}this.serializeTags(a,f);d.push(f);return d},polygon:function(a){var c=OpenLayers.Util.extend({area:"yes"},a.attributes),c=new OpenLayers.Feature.Vector(a.geometry.components[0],c);c.osm_id=a.osm_id;return this.createXML.linestring.apply(this,[c])}},
serializeTags:function(a,c){for(var d in a.attributes){var e=this.createElementNS(null,"tag");e.setAttribute("k",d);e.setAttribute("v",a.attributes[d]);c.appendChild(e)}},setState:function(a,c){if(a.state){var d=null;switch(a.state){case OpenLayers.State.UPDATE:case OpenLayers.State.DELETE:d="delete"}d&&c.setAttribute("action",d)}},CLASS_NAME:"OpenLayers.Format.OSM"});
OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(a,c){var d=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(c&&c.map){this.context=d;if(c.map instanceof OpenLayers.Map)d=this.mergeContextToMap(d,c.map);else{var e=c.map;if(OpenLayers.Util.isElement(e)||typeof e=="string")e={div:e};d=this.contextToMap(d,e)}}return d},getLayerFromContext:function(a){var c,d,e={queryable:a.queryable,visibility:a.visibility,
maxExtent:a.maxExtent,metadata:OpenLayers.Util.applyDefaults(a.metadata,{styles:a.styles,formats:a.formats,"abstract":a["abstract"],dataURL:a.dataURL}),numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.tileSize?new OpenLayers.Size(a.tileSize.width,a.tileSize.height):void 0,minScale:a.minScale||a.maxScaleDenominator,maxScale:a.maxScale||a.minScaleDenominator,srs:a.srs,dimensions:a.dimensions,
metadataURL:a.metadataURL};this.layerOptions&&OpenLayers.Util.applyDefaults(e,this.layerOptions);var f={layers:a.name,transparent:a.transparent,version:a.version};if(a.formats&&a.formats.length>0){f.format=a.formats[0].value;c=0;for(d=a.formats.length;c<d;c++){var g=a.formats[c];if(g.current==true){f.format=g.value;break}}}if(a.styles&&a.styles.length>0){c=0;for(d=a.styles.length;c<d;c++){g=a.styles[c];if(g.current==true){g.href?f.sld=g.href:g.body?f.sld_body=g.body:f.styles=g.name;break}}}this.layerParams&&
OpenLayers.Util.applyDefaults(f,this.layerParams);c=null;d=a.service;if(d==OpenLayers.Format.Context.serviceTypes.WFS){e.strategies=[new OpenLayers.Strategy.BBOX];e.protocol=new OpenLayers.Protocol.WFS({url:a.url,featurePrefix:a.name.split(":")[0],featureType:a.name.split(":").pop()});c=new OpenLayers.Layer.Vector(a.title||a.name,e)}else if(d==OpenLayers.Format.Context.serviceTypes.KML){e.strategies=[new OpenLayers.Strategy.Fixed];e.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.KML});
c=new OpenLayers.Layer.Vector(a.title||a.name,e)}else if(d==OpenLayers.Format.Context.serviceTypes.GML){e.strategies=[new OpenLayers.Strategy.Fixed];e.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.GML});c=new OpenLayers.Layer.Vector(a.title||a.name,e)}else if(a.features){c=new OpenLayers.Layer.Vector(a.title||a.name,e);c.addFeatures(a.features)}else a.categoryLayer!==true&&(c=new OpenLayers.Layer.WMS(a.title||a.name,a.url,f,e));return c},getLayersFromContext:function(a){for(var c=
[],d=0,e=a.length;d<e;d++){var f=this.getLayerFromContext(a[d]);f!==null&&c.push(f)}return c},contextToMap:function(a,c){c=OpenLayers.Util.applyDefaults({maxExtent:a.maxExtent,projection:a.projection,units:a.units},c);if(c.maxExtent)c.maxResolution=c.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH;c.metadata={contactInformation:a.contactInformation,"abstract":a["abstract"],keywords:a.keywords,logo:a.logo,descriptionURL:a.descriptionURL};var d=new OpenLayers.Map(c);d.addLayers(this.getLayersFromContext(a.layersContext));
d.setCenter(a.bounds.getCenterLonLat(),d.getZoomForExtent(a.bounds,true));return d},mergeContextToMap:function(a,c){c.addLayers(this.getLayersFromContext(a.layersContext));return c},write:function(a,c){a=this.toContext(a);return OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"});
OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"};
OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,c,d,e){OpenLayers.Layer.prototype.initialize.apply(this,[a,e]);this.url=c;if(!this.params)this.params=OpenLayers.Util.extend({},d)},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,c){for(var d=1,e=0,f=a.length;e<f;e++){d=d*a.charCodeAt(e)*this.URL_HASH_FACTOR;
d=d-Math.floor(d)}return c[Math.floor(d*c.length)]},getFullRequestString:function(a,c){var d=c||this.url,e=OpenLayers.Util.extend({},this.params),e=OpenLayers.Util.extend(e,a),f=OpenLayers.Util.getParameterString(e);OpenLayers.Util.isArray(d)&&(d=this.selectUrl(f,d));var f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(d)),g;for(g in e)g.toUpperCase()in f&&delete e[g];f=OpenLayers.Util.getParameterString(e);return OpenLayers.Util.urlAppend(d,f)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});
OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,
className:null,initialize:function(a,c,d,e){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];if(this.removeBackBufferDelay===null)this.removeBackBufferDelay=this.singleTile?0:2500;if(this.className===null)this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid";if(!OpenLayers.Animation.isNative)this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(true);this.moveTimerId=null},this)},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,
a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){if(this.moveTimerId!==null){window.clearTimeout(this.moveTimerId);this.moveTimerId=null}this.clearTileQueue();if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var a=
0,c=this.grid.length;a<c;a++)for(var d=this.grid[a],e=0,f=d.length;e<f;e++)this.destroyTile(d[e]);this.grid=[];this.gridResolution=null}},clone:function(a){a==null&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]);if(this.tileSize!=null)a.tileSize=this.tileSize.clone();a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.tileQueue=[];a.tileQueueId=null;a.loading=false;a.moveTimerId=
null;return a},moveTo:function(a,c,d){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(a!=null){var e=!this.grid.length||c,f=this.getTilesBounds(),g=this.map.getResolution(),h=this.getServerResolution(g);if(this.singleTile){if(e||!d&&!f.containsBounds(a)){c&&this.transitionEffect!=="resize"&&this.removeBackBuffer();(!c||this.transitionEffect==="resize")&&this.applyBackBuffer(h);this.initSingleTile(a)}}else{e=e||!f.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&
this.map.getMaxExtent()});if(g!==h){a=this.map.calculateBounds(null,h);e&&this.transformDiv(h/g)}else{this.div.style.width="100%";this.div.style.height="100%";this.div.style.left="0%";this.div.style.top="0%"}if(e){c&&this.transitionEffect==="resize"&&this.applyBackBuffer(h);this.initGriddedTiles(a)}else this.moveGriddedTiles()}}},getTileData:function(a){var c=null,d=a.lon,e=a.lat,f=this.grid.length;if(this.map&&f){var g=this.map.getResolution(),a=this.tileSize.w,h=this.tileSize.h,i=this.grid[0][0].bounds,
j=i.left,i=i.top;if(d<j&&this.map.baseLayer.wrapDateLine)var k=this.map.getMaxExtent().getWidth(),l=Math.ceil((j-d)/k),d=d+k*l;d=(d-j)/(g*a);e=(i-e)/(g*h);g=Math.floor(d);j=Math.floor(e);if(j>=0&&j<f)(f=this.grid[j][g])&&(c={tile:f,i:Math.floor((d-g)*a),j:Math.floor((e-j)*h)})}return c},queueTileDraw:function(a){a=a.object;~OpenLayers.Util.indexOf(this.tileQueue,a)||this.tileQueue.push(a);if(!this.tileQueueId)this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,
this),null,this.div);return false},drawTileFromQueue:function(){this.tileQueue.length===0?this.clearTileQueue():this.tileQueue.shift().draw(true)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){a=a||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,a)===-1){var c,d;for(c=this.serverResolutions.length-
1;c>=0;c--){d=this.serverResolutions[c];if(d>a){a=d;break}}if(c===-1)throw"no appropriate resolution in serverResolutions";}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},transformDiv:function(a){this.div.style.width=100*a+"%";this.div.style.height=100*a+"%";var c=this.map.getSize(),d=parseInt(this.map.layerContainerDiv.style.left,10),e=(parseInt(this.map.layerContainerDiv.style.top,
10)-c.h/2)*(a-1);this.div.style.left=(d-c.w/2)*(a-1)+"%";this.div.style.top=e+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(a){this.backBufferTimerId!==null&&this.removeBackBuffer();var c=this.backBuffer;if(!c){c=this.createBackBuffer();if(!c)return;this.div.insertBefore(c,this.div.firstChild);this.backBuffer=c;var d=this.grid[0][0].bounds;this.backBufferLonLat={lon:d.left,lat:d.top};this.backBufferResolution=this.gridResolution}var d=c.style,
e=this.backBufferResolution/a;d.width=100*e+"%";d.height=100*e+"%";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);d=parseInt(this.map.layerContainerDiv.style.left,10);e=parseInt(this.map.layerContainerDiv.style.top,10);c.style.left=Math.round(a.x-d)+"%";c.style.top=Math.round(a.y-e)+"%"},createBackBuffer:function(){var a;if(this.grid.length>0){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";a.style.width="100%";a.style.height=
"100%";for(var c=0,d=this.grid.length;c<d;c++)for(var e=0,f=this.grid[c].length;e<f;e++){var g=this.grid[c][e].createBackBuffer();if(g){g.style.top=c*this.tileSize.h+"%";g.style.left=e*this.tileSize.w+"%";a.appendChild(g)}}}return a},removeBackBuffer:function(){if(this.backBuffer){this.div.removeChild(this.backBuffer);this.backBufferResolution=this.backBuffer=null;if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}}},moveByPx:function(){this.singleTile||
this.moveGriddedTiles()},setTileSize:function(a){if(this.singleTile){a=this.map.getSize();a.h=parseInt(a.h*this.ratio);a.w=parseInt(a.w*this.ratio)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=null,c=this.grid.length;if(c)var a=this.grid[c-1][0].bounds,c=this.grid[0].length*a.getWidth(),d=this.grid.length*a.getHeight(),a=new OpenLayers.Bounds(a.left,a.bottom,a.left+c,a.bottom+d);return a},initSingleTile:function(a){this.clearTileQueue();var c=
a.getCenterLonLat(),d=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio,c=new OpenLayers.Bounds(c.lon-d/2,c.lat-a/2,c.lon+d/2,c.lat+a/2),d=this.map.getLayerPxFromLonLat({lon:c.left,lat:c.top});this.grid.length||(this.grid[0]=[]);if(a=this.grid[0][0])a.moveTo(c,d);else{a=this.addTile(c,d);this.addTileMonitoringHooks(a);a.draw();this.grid[0][0]=a}this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,c,d){var e=d*this.tileSize.w,d=d*this.tileSize.h,
f=a.left-c.lon,g=Math.floor(f/e)-this.buffer,f=-(f/e-g)*this.tileSize.w,g=c.lon+g*e,a=a.top-(c.lat+d),h=Math.ceil(a/d)+this.buffer;return{tilelon:e,tilelat:d,tileoffsetlon:g,tileoffsetlat:c.lat+h*d,tileoffsetx:f,tileoffsety:-(h-a/d)*this.tileSize.h}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(),c={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new OpenLayers.LonLat(a[c[0]],a[c[1]]);return a},initGriddedTiles:function(a){this.clearTileQueue();
var c=this.map.getSize(),d=Math.ceil(c.h/this.tileSize.h)+Math.max(1,2*this.buffer),c=Math.ceil(c.w/this.tileSize.w)+Math.max(1,2*this.buffer),e=this.getTileOrigin(),f=this.getServerResolution(),e=this.calculateGridLayout(a,e,f),f=Math.round(e.tileoffsetx),g=Math.round(e.tileoffsety),h=e.tileoffsetlon,i=e.tileoffsetlat,j=e.tilelon,k=e.tilelat,l=f,m=h,n=0,o=parseInt(this.map.layerContainerDiv.style.left),p=parseInt(this.map.layerContainerDiv.style.top),e=[],q=this.map.getCenter();do{var r=this.grid[n++];
if(!r){r=[];this.grid.push(r)}var h=m,f=l,s=0;do{var t=new OpenLayers.Bounds(h,i,h+j,i+k),u=f,u=u-o,x=g,x=x-p,x=new OpenLayers.Pixel(u,x);if(u=r[s++])u.moveTo(t,x,false);else{u=this.addTile(t,x);this.addTileMonitoringHooks(u);r.push(u)}t=t.getCenterLonLat();e.push({tile:u,distance:Math.pow(t.lon-q.lon,2)+Math.pow(t.lat-q.lat,2)});h=h+j;f=f+this.tileSize.w}while(h<=a.right+j*this.buffer||s<c);i=i-k;g=g+this.tileSize.h}while(i>=a.bottom-k*this.buffer||n<d);this.removeExcessTiles(n,s);this.gridResolution=
this.getServerResolution();e.sort(function(a,c){return a.distance-c.distance});a=0;for(d=e.length;a<d;++a)e[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,c){var d=new this.tileClass(this,c,a,null,this.tileSize,this.tileOptions);d.events.register("beforedraw",this,this.queueTileDraw);return d},addTileMonitoringHooks:function(a){a.onLoadStart=function(){if(this.loading===false){this.loading=true;this.events.triggerEvent("loadstart")}this.events.triggerEvent("tileloadstart",
{tile:a});this.numLoadingTiles++};a.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:a});if(this.tileQueue.length===0&&this.numLoadingTiles===0){this.loading=false;this.events.triggerEvent("loadend");if(this.backBuffer)this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)}};a.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,
unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(a){if(!a&&!OpenLayers.Animation.isNative){this.moveTimerId!=null&&window.clearTimeout(this.moveTimerId);this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay)}else for(var a=this.buffer||1,c=this.getResolutionScale();;){var d=
this.grid[0][0].position.x*c+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),e=this.grid[0][0].position.y*c+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top),f=this.tileSize.w*c,g=this.tileSize.h*c;if(d>-f*(a-1))this.shiftColumn(true);else if(d<-f*a)this.shiftColumn(false);else if(e>-g*(a-1))this.shiftRow(true);else if(e<-g*a)this.shiftRow(false);else break}},shiftRow:function(a){for(var c=this.grid,d=c[a?0:this.grid.length-1],e=this.getServerResolution(),
f=a?-this.tileSize.h:this.tileSize.h,e=e*-f,g=a?c.pop():c.shift(),h=0,i=d.length;h<i;h++){var j=d[h],k=j.bounds.clone(),j=j.position.clone();k.bottom=k.bottom+e;k.top=k.top+e;j.y=j.y+f;g[h].moveTo(k,j)}a?c.unshift(g):c.push(g)},shiftColumn:function(a){for(var c=a?-this.tileSize.w:this.tileSize.w,d=this.getServerResolution()*c,e=0,f=this.grid.length;e<f;e++){var g=this.grid[e],h=g[a?0:g.length-1],i=h.bounds.clone(),h=h.position.clone();i.left=i.left+d;i.right=i.right+d;h.x=h.x+c;var j=a?this.grid[e].pop():
this.grid[e].shift();j.moveTo(i,h);a?g.unshift(j):g.push(j)}},removeExcessTiles:function(a,c){for(var d,e;this.grid.length>a;){var f=this.grid.pop();d=0;for(e=f.length;d<e;d++){var g=f[d];this.destroyTile(g)}}d=0;for(e=this.grid.length;d<e;d++)for(;this.grid[d].length>c;){f=this.grid[d];g=f.pop();this.destroyTile(g)}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(a){var c=this.maxExtent,d=this.getResolution(),e=d*this.tileSize.w,d=d*this.tileSize.h,
f=this.getLonLatFromViewPortPx(a),a=c.left+e*Math.floor((f.lon-c.left)/e),c=c.bottom+d*Math.floor((f.lat-c.bottom)/d);return new OpenLayers.Bounds(a,c,a+e,c+d)},CLASS_NAME:"OpenLayers.Layer.Grid"});
OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(a,c,d){if(d&&d.sphericalMercator||this.sphericalMercator)d=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a||this.name,c||this.url,{},d])},clone:function(a){a==null&&(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){var a=this.getXYZ(a),c=this.url;OpenLayers.Util.isArray(c)&&(c=this.selectUrl(""+a.x+a.y+a.z,c));return OpenLayers.String.format(c,a)},getXYZ:function(a){var c=this.getServerResolution(),d=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h)),c=this.getServerZoom();if(this.wrapDateLine)var e=Math.pow(2,c),d=(d%e+e)%e;return{x:d,y:a,z:c}},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,
arguments);if(!this.tileOrigin)this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom)},CLASS_NAME:"OpenLayers.Layer.XYZ"});
OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',
metadata:null,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,initialize:function(a){a=OpenLayers.Util.applyDefaults({sphericalMercator:true},a);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[a.name||"Bing "+(a.type||this.type),null,a]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,
this);var a=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),a="http://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(a),c=document.createElement("script");c.type="text/javascript";c.src=a;c.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(c)},initLayer:function(){var a=this.metadata.resourceSets[0].resources[0],c=a.imageUrl.replace("{quadkey}","${quadkey}"),
c=c.replace("{culture}",this.culture);this.url=[];for(var d=0;d<a.imageUrlSubdomains.length;++d)this.url.push(c.replace("{subdomain}",a.imageUrlSubdomains[d]));this.addOptions({maxResolution:Math.min(this.serverResolutions[a.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(a.zoomMax+1-a.zoomMin,this.numZoomLevels)},true)},getURL:function(a){if(this.url){for(var c=this.getXYZ(a),a=c.x,d=c.y,c=c.z,e=[],f=c;f>0;--f){var g="0",h=1<<f-1;(a&h)!=0&&g++;if((d&h)!=0){g++;g++}e.push(g)}e=
e.join("");a=this.selectUrl(""+a+d+c,this.url);return OpenLayers.String.format(a,{quadkey:e})}},updateAttribution:function(){var a=this.metadata;if(a.resourceSets&&this.map&&this.map.center){var c=a.resourceSets[0].resources[0],d=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),c=c.imageryProviders,e=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),f="",g,h,i,j,k,l,m;h=0;for(i=c.length;h<i;++h){g=c[h];j=0;for(k=g.coverageAreas.length;j<
k;++j){m=g.coverageAreas[j];l=OpenLayers.Bounds.fromArray(m.bbox,true);d.intersectsBounds(l)&&e<=m.zoomMax&&e>=m.zoomMin&&(f=f+(g.attribution+" "))}}this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:a.brandLogoUri,copyrights:f});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.updateAttribution();this.map.events.register("moveend",
this,this.updateAttribution)},clone:function(a){a==null&&(a=new OpenLayers.Layer.Bing(this.options));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});
OpenLayers.Layer.Bing.processMetadata=function(a){this.metadata=a;this.initLayer();a=document.getElementById(this._callbackId);a.parentNode.removeChild(a);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",getVersion:function(a,c){var d=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);if(d=="1.1.1"||d=="1.1.0")d="1.1";return d},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});
OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var a=a.documentElement.childNodes,c=[],d,e,f=0;f<a.length;++f){d=a[f];e=d.nodeName;if(e=="LayerDescription"){e=d.getAttribute("name");var g="",h="",i="";if(d.getAttribute("owsType")){g=d.getAttribute("owsType");h=
d.getAttribute("owsURL")}else if(d.getAttribute("wfs")!=""){g="WFS";h=d.getAttribute("wfs")}else if(d.getAttribute("wcs")!=""){g="WCS";h=d.getAttribute("wcs")}d=d.getElementsByTagName("Query");if(d.length>0)(i=d[0].getAttribute("typeName"))||(i=d[0].getAttribute("typename"));c.push({layerName:e,owsType:g,owsURL:h,typeName:i})}}return c},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"});
OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(a,c,d){OpenLayers.Util.extend(this,d);this.control=a;this.callbacks=c;(a=this.map||a.map)&&this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return this.keyMask==null?true:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:0))==
this.keyMask},activate:function(){if(this.active)return false;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,c=0,d=a.length;c<d;c++)this[a[c]]&&this.register(a[c],this[a[c]]);return this.active=true},deactivate:function(){if(!this.active)return false;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,c=0,d=a.length;c<d;c++)this[a[c]]&&this.unregister(a[c],this[a[c]]);this.active=false;return true},callback:function(a,c){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,c)},register:function(a,
c){this.map.events.registerPriority(a,this,c);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,c){this.map.events.unregister(a,this,c);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;
OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(a,c,d){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var c=false,d=false,e=
false,f=OpenLayers.Event.element(a);f!=null&&!e&&!c;){if(!c)try{var g=f.currentStyle?f.currentStyle.overflow:document.defaultView.getComputedStyle(f,null).getPropertyValue("overflow"),c=g&&g=="auto"||g=="scroll"}catch(h){}if(!d)for(var e=0,i=this.map.layers.length;e<i;e++)if(f==this.map.layers[e].div||f==this.map.layers[e].pane){d=true;break}e=f==this.map.div;f=f.parentNode}if(!c&&e){if(d){c=0;if(!a)a=window.event;if(a.wheelDelta){c=a.wheelDelta/120;window.opera&&window.opera.version()<9.2&&(c=-c)}else a.detail&&
(c=-a.detail/3);this.delta=this.delta+c;if(this.interval){window.clearTimeout(this._timeoutId);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(a)},this),this.interval)}else this.wheelZoom(a)}OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var c=this.delta;this.delta=0;if(c){if(this.mousePosition)a.xy=this.mousePosition;if(!a.xy)a.xy=this.map.getPixelFromLonLat(this.map.getCenter());c<0?this.callback("down",[a,this.cumulative?c:-1]):this.callback("up",[a,this.cumulative?
c:1])}},mousemove:function(a){this.mousePosition=a.xy},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var c=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",c);OpenLayers.Event.observe(window,"mousewheel",c);OpenLayers.Event.observe(document,"mousewheel",c);return true}return false},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var c=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",
c);OpenLayers.Event.stopObserving(window,"mousewheel",c);OpenLayers.Event.stopObserving(document,"mousewheel",c);return true}return false},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});
OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:"antialiasing,blockout,font,fontcolor,fontsize,fontstyle,glowing,interval,outline,printmode,shadow,transparency".split(","),request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request;this.response=new OpenLayers.Format.ArcXML.Response;if(a)if(a.requesttype=="feature"){this.request.get_image=null;var c=this.request.get_feature.query;this.addCoordSys(c.featurecoordsys,a.featureCoordSys);
this.addCoordSys(c.filtercoordsys,a.filterCoordSys);if(a.polygon){c.isspatial=true;c.spatialfilter.polygon=a.polygon}else if(a.envelope){c.isspatial=true;c.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0};this.parseEnvelope(c.spatialfilter.envelope,a.envelope)}}else if(a.requesttype=="image"){this.request.get_feature=null;c=this.request.get_image.properties;this.parseEnvelope(c.envelope,a.envelope);this.addLayers(c.layerlist,a.layers);this.addImageSize(c.imagesize,a.tileSize);this.addCoordSys(c.featurecoordsys,
a.featureCoordSys);this.addCoordSys(c.filtercoordsys,a.filterCoordSys)}else this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(a,c){if(c&&c.length==4){a.minx=c[0];a.miny=c[1];a.maxx=c[2];a.maxy=c[3]}},addLayers:function(a,c){for(var d=0,e=c.length;d<e;d++)a.push(c[d])},addImageSize:function(a,c){if(c!==null){a.width=c.w;a.height=c.h;a.printwidth=c.w;a.printheight=c.h}},addCoordSys:function(a,c){if(typeof c=="string"){a.id=parseInt(c);a.string=c}else if(typeof c==
"object"&&c.proj!==null){a.id=c.proj.srsProjNumber;a.string=c.proj.srsCode}},iserror:function(a){var c=null;if(a){a=OpenLayers.Format.XML.prototype.read.apply(this,[a]);a=a.documentElement.getElementsByTagName("ERROR");c=a!==null&&a.length>0}else c=this.response.error!=="";return c},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=null;a&&a.documentElement&&(c=a.documentElement.nodeName=="ARCXML"?a.documentElement:a.documentElement.getElementsByTagName("ARCXML")[0]);
if(!c||c.firstChild.nodeName==="parsererror"){var d,e;try{d=a.firstChild.nodeValue;e=a.firstChild.childNodes[1].firstChild.nodeValue}catch(f){}throw{message:"Error parsing the ArcXML request",error:d,source:e};}return this.parseResponse(c)},write:function(a){if(!a)a=this.request;var c=this.createElementNS("","ARCXML");c.setAttribute("version","1.1");var d=this.createElementNS("","REQUEST");if(a.get_image!=null){var e=this.createElementNS("","GET_IMAGE");d.appendChild(e);var f=this.createElementNS("",
"PROPERTIES");e.appendChild(f);a=a.get_image.properties;if(a.featurecoordsys!=null){e=this.createElementNS("","FEATURECOORDSYS");f.appendChild(e);a.featurecoordsys.id===0?e.setAttribute("string",a.featurecoordsys.string):e.setAttribute("id",a.featurecoordsys.id)}if(a.filtercoordsys!=null){e=this.createElementNS("","FILTERCOORDSYS");f.appendChild(e);a.filtercoordsys.id===0?e.setAttribute("string",a.filtercoordsys.string):e.setAttribute("id",a.filtercoordsys.id)}if(a.envelope!=null){e=this.createElementNS("",
"ENVELOPE");f.appendChild(e);e.setAttribute("minx",a.envelope.minx);e.setAttribute("miny",a.envelope.miny);e.setAttribute("maxx",a.envelope.maxx);e.setAttribute("maxy",a.envelope.maxy)}e=this.createElementNS("","IMAGESIZE");f.appendChild(e);e.setAttribute("height",a.imagesize.height);e.setAttribute("width",a.imagesize.width);if(a.imagesize.height!=a.imagesize.printheight||a.imagesize.width!=a.imagesize.printwidth){e.setAttribute("printheight",a.imagesize.printheight);e.setArrtibute("printwidth",a.imagesize.printwidth)}if(a.background!=
null){e=this.createElementNS("","BACKGROUND");f.appendChild(e);e.setAttribute("color",a.background.color.r+","+a.background.color.g+","+a.background.color.b);a.background.transcolor!==null&&e.setAttribute("transcolor",a.background.transcolor.r+","+a.background.transcolor.g+","+a.background.transcolor.b)}if(a.layerlist!=null&&a.layerlist.length>0){e=this.createElementNS("","LAYERLIST");f.appendChild(e);for(f=0;f<a.layerlist.length;f++){var g=this.createElementNS("","LAYERDEF");e.appendChild(g);g.setAttribute("id",
a.layerlist[f].id);g.setAttribute("visible",a.layerlist[f].visible);if(typeof a.layerlist[f].query=="object"){var h=a.layerlist[f].query;if(h.where.length<0)continue;var i=null,i=typeof h.spatialfilter=="boolean"&&h.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY");i.setAttribute("where",h.where);typeof h.accuracy=="number"&&h.accuracy>0&&i.setAttribute("accuracy",h.accuracy);typeof h.featurelimit=="number"&&h.featurelimit<2E3&&i.setAttribute("featurelimit",h.featurelimit);
typeof h.subfields=="string"&&h.subfields!="#ALL#"&&i.setAttribute("subfields",h.subfields);typeof h.joinexpression=="string"&&h.joinexpression.length>0&&i.setAttribute("joinexpression",h.joinexpression);typeof h.jointables=="string"&&h.jointables.length>0&&i.setAttribute("jointables",h.jointables);g.appendChild(i)}typeof a.layerlist[f].renderer=="object"&&this.addRenderer(g,a.layerlist[f].renderer)}}}else if(a.get_feature!=null){e=this.createElementNS("","GET_FEATURES");e.setAttribute("outputmode",
"newxml");e.setAttribute("checkesc","true");a.get_feature.geometry?e.setAttribute("geometry",a.get_feature.geometry):e.setAttribute("geometry","false");a.get_feature.compact&&e.setAttribute("compact",a.get_feature.compact);a.get_feature.featurelimit=="number"&&e.setAttribute("featurelimit",a.get_feature.featurelimit);e.setAttribute("globalenvelope","true");d.appendChild(e);if(a.get_feature.layer!=null&&a.get_feature.layer.length>0){f=this.createElementNS("","LAYER");f.setAttribute("id",a.get_feature.layer);
e.appendChild(f)}a=a.get_feature.query;if(a!=null){f=null;f=a.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY");e.appendChild(f);typeof a.accuracy=="number"&&f.setAttribute("accuracy",a.accuracy);if(a.featurecoordsys!=null){e=this.createElementNS("","FEATURECOORDSYS");a.featurecoordsys.id==0?e.setAttribute("string",a.featurecoordsys.string):e.setAttribute("id",a.featurecoordsys.id);f.appendChild(e)}if(a.filtercoordsys!=null){e=this.createElementNS("","FILTERCOORDSYS");
a.filtercoordsys.id===0?e.setAttribute("string",a.filtercoordsys.string):e.setAttribute("id",a.filtercoordsys.id);f.appendChild(e)}if(a.buffer>0){e=this.createElementNS("","BUFFER");e.setAttribute("distance",a.buffer);f.appendChild(e)}if(a.isspatial){e=this.createElementNS("","SPATIALFILTER");e.setAttribute("relation",a.spatialfilter.relation);f.appendChild(e);if(a.spatialfilter.envelope){g=this.createElementNS("","ENVELOPE");g.setAttribute("minx",a.spatialfilter.envelope.minx);g.setAttribute("miny",
a.spatialfilter.envelope.miny);g.setAttribute("maxx",a.spatialfilter.envelope.maxx);g.setAttribute("maxy",a.spatialfilter.envelope.maxy);e.appendChild(g)}else typeof a.spatialfilter.polygon=="object"&&e.appendChild(this.writePolygonGeometry(a.spatialfilter.polygon))}a.where!=null&&a.where.length>0&&f.setAttribute("where",a.where)}}c.appendChild(d);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},addGroupRenderer:function(a,c){var d=this.createElementNS("","GROUPRENDERER");a.appendChild(d);
for(var e=0;e<c.length;e++)this.addRenderer(d,c[e])},addRenderer:function(a,c){if(OpenLayers.Util.isArray(c))this.addGroupRenderer(a,c);else{var d=this.createElementNS("",c.type.toUpperCase()+"RENDERER");a.appendChild(d);d.tagName=="VALUEMAPRENDERER"?this.addValueMapRenderer(d,c):d.tagName=="VALUEMAPLABELRENDERER"?this.addValueMapLabelRenderer(d,c):d.tagName=="SIMPLELABELRENDERER"?this.addSimpleLabelRenderer(d,c):d.tagName=="SCALEDEPENDENTRENDERER"&&this.addScaleDependentRenderer(d,c)}},addScaleDependentRenderer:function(a,
c){(typeof c.lower=="string"||typeof c.lower=="number")&&a.setAttribute("lower",c.lower);(typeof c.upper=="string"||typeof c.upper=="number")&&a.setAttribute("upper",c.upper);this.addRenderer(a,c.renderer)},addValueMapLabelRenderer:function(a,c){a.setAttribute("lookupfield",c.lookupfield);a.setAttribute("labelfield",c.labelfield);if(typeof c.exacts=="object")for(var d=0,e=c.exacts.length;d<e;d++){var f=c.exacts[d],g=this.createElementNS("","EXACT");typeof f.value=="string"&&g.setAttribute("value",
f.value);typeof f.label=="string"&&g.setAttribute("label",f.label);typeof f.method=="string"&&g.setAttribute("method",f.method);a.appendChild(g);if(typeof f.symbol=="object"){var h=null;f.symbol.type=="text"&&(h=this.createElementNS("","TEXTSYMBOL"));if(h!=null){for(var i=this.fontStyleKeys,j=0,k=i.length;j<k;j++){var l=i[j];f.symbol[l]&&h.setAttribute(l,f.symbol[l])}g.appendChild(h)}}}},addValueMapRenderer:function(a,c){a.setAttribute("lookupfield",c.lookupfield);if(typeof c.ranges=="object")for(var d=
0,e=c.ranges.length;d<e;d++){var f=c.ranges[d],g=this.createElementNS("","RANGE");g.setAttribute("lower",f.lower);g.setAttribute("upper",f.upper);a.appendChild(g);if(typeof f.symbol=="object"){var h=null;f.symbol.type=="simplepolygon"&&(h=this.createElementNS("","SIMPLEPOLYGONSYMBOL"));if(h!=null){typeof f.symbol.boundarycolor=="string"&&h.setAttribute("boundarycolor",f.symbol.boundarycolor);typeof f.symbol.fillcolor=="string"&&h.setAttribute("fillcolor",f.symbol.fillcolor);typeof f.symbol.filltransparency==
"number"&&h.setAttribute("filltransparency",f.symbol.filltransparency);g.appendChild(h)}}}else if(typeof c.exacts=="object"){d=0;for(e=c.exacts.length;d<e;d++){f=c.exacts[d];g=this.createElementNS("","EXACT");typeof f.value=="string"&&g.setAttribute("value",f.value);typeof f.label=="string"&&g.setAttribute("label",f.label);typeof f.method=="string"&&g.setAttribute("method",f.method);a.appendChild(g);if(typeof f.symbol=="object"){h=null;f.symbol.type=="simplemarker"&&(h=this.createElementNS("","SIMPLEMARKERSYMBOL"));
if(h!=null){typeof f.symbol.antialiasing=="string"&&h.setAttribute("antialiasing",f.symbol.antialiasing);typeof f.symbol.color=="string"&&h.setAttribute("color",f.symbol.color);typeof f.symbol.outline=="string"&&h.setAttribute("outline",f.symbol.outline);typeof f.symbol.overlap=="string"&&h.setAttribute("overlap",f.symbol.overlap);typeof f.symbol.shadow=="string"&&h.setAttribute("shadow",f.symbol.shadow);typeof f.symbol.transparency=="number"&&h.setAttribute("transparency",f.symbol.transparency);
typeof f.symbol.usecentroid=="string"&&h.setAttribute("usecentroid",f.symbol.usecentroid);typeof f.symbol.width=="number"&&h.setAttribute("width",f.symbol.width);g.appendChild(h)}}}}},addSimpleLabelRenderer:function(a,c){a.setAttribute("field",c.field);for(var d=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"],e=0,f=d.length;e<f;e++){var g=d[e];c[g]&&a.setAttribute(g,c[g])}if(c.symbol.type=="text"){var h=c.symbol,i=this.createElementNS("",
"TEXTSYMBOL");a.appendChild(i);d=this.fontStyleKeys;e=0;for(f=d.length;e<f;e++){g=d[e];h[g]&&i.setAttribute(g,c[g])}}},writePolygonGeometry:function(a){if(!(a instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+a.CLASS_NAME+" object.",geometry:a};for(var c=this.createElementNS("","POLYGON"),d=0,e=a.components.length;d<e;d++){for(var f=a.components[d],g=this.createElementNS("","RING"),h=0,i=f.components.length;h<i;h++){var j=f.components[h],k=this.createElementNS("",
"POINT");k.setAttribute("x",j.x);k.setAttribute("y",j.y);g.appendChild(k)}c.appendChild(g)}return c},parseResponse:function(a){typeof a=="string"&&(a=(new OpenLayers.Format.XML).read(a));var c=new OpenLayers.Format.ArcXML.Response,d=a.getElementsByTagName("ERROR");if(d!=null&&d.length>0)c.error=this.getChildValue(d,"Unknown error.");else{d=a.getElementsByTagName("RESPONSE");if(d==null||d.length==0){c.error="No RESPONSE tag found in ArcXML response.";return c}var e=d[0].firstChild.nodeName;if(e=="#text")e=
d[0].firstChild.nextSibling.nodeName;if(e=="IMAGE"){d=a.getElementsByTagName("ENVELOPE");a=a.getElementsByTagName("OUTPUT");if(d==null||d.length==0)c.error="No ENVELOPE tag found in ArcXML response.";else if(a==null||a.length==0)c.error="No OUTPUT tag found in ArcXML response.";else{d=this.parseAttributes(d[0]);e=this.parseAttributes(a[0]);c.image=typeof e.type=="string"?{envelope:d,output:{type:e.type,data:this.getChildValue(a[0])}}:{envelope:d,output:e}}}else if(e=="FEATURES"){a=d[0].getElementsByTagName("FEATURES");
d=a[0].getElementsByTagName("FEATURECOUNT");c.features.featurecount=d[0].getAttribute("count");if(c.features.featurecount>0){d=a[0].getElementsByTagName("ENVELOPE");c.features.envelope=this.parseAttributes(d[0],"number");a=a[0].getElementsByTagName("FEATURE");for(d=0;d<a.length;d++){for(var e=new OpenLayers.Feature.Vector,f=a[d].getElementsByTagName("FIELD"),g=0;g<f.length;g++){var h=f[g].getAttribute("name"),i=f[g].getAttribute("value");e.attributes[h]=i}f=a[d].getElementsByTagName("POLYGON");if(f.length>
0){f=f[0].getElementsByTagName("RING");g=[];for(h=0;h<f.length;h++){i=[];i.push(this.parsePointGeometry(f[h]));for(var j=f[h].getElementsByTagName("HOLE"),k=0;k<j.length;k++)i.push(this.parsePointGeometry(j[k]));g.push(new OpenLayers.Geometry.Polygon(i))}e.geometry=g.length==1?g[0]:new OpenLayers.Geometry.MultiPolygon(g)}c.features.feature.push(e)}}}else c.error="Unidentified response type."}return c},parseAttributes:function(a,c){for(var d={},e=0;e<a.attributes.length;e++)d[a.attributes[e].nodeName]=
c=="number"?parseFloat(a.attributes[e].nodeValue):a.attributes[e].nodeValue;return d},parsePointGeometry:function(a){var c=[],d=a.getElementsByTagName("COORDS");if(d.length>0){a=this.getChildValue(d[0]);a=a.split(/;/);for(d=0;d<a.length;d++){var e=a[d].split(/ /);c.push(new OpenLayers.Geometry.Point(e[0],e[1]))}}else{a=a.getElementsByTagName("POINT");if(a.length>0)for(d=0;d<a.length;d++)c.push(new OpenLayers.Geometry.Point(parseFloat(a[d].getAttribute("x")),parseFloat(a[d].getAttribute("y"))))}return new OpenLayers.Geometry.LinearRing(c)},
CLASS_NAME:"OpenLayers.Format.ArcXML"});
OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(){return OpenLayers.Util.extend(this,{get_image:{properties:{background:null,draw:true,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:false},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",
legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:false,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]})},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});
OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(){return OpenLayers.Util.extend(this,{image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""})},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});
OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,c){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,[a,c])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,
c){c.insertIds=[];c.success=false;this.readChildNodes(a,c)},InsertResult:function(a,c){var d={fids:[]};this.readChildNodes(a,d);c.insertIds.push(d.fids[0])},TransactionResult:function(a,c){this.readChildNodes(a,c)},Status:function(a,c){this.readChildNodes(a,c)},SUCCESS:function(a,c){c.success=true}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},
writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a),c=a.featurePrefix,d=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(c?c+":":"")+a.featureType}});a.srsNameInQuery&&a.srsName&&d.setAttribute("srsName",a.srsName);a.featureNS&&d.setAttribute("xmlns:"+c,a.featureNS);if(a.propertyNames)for(var c=0,e=a.propertyNames.length;c<
e;c++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[c]},d);if(a.filter){this.setFilterProperty(a.filter);this.writeNode("ogc:Filter",a.filter,d)}return d}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});
OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&&this.remove(a);var c=a.id;this.determineZIndex(a);for(var d=-1,e=this.order.length,f;e-d>1;){f=parseInt((d+e)/2);this.compare(this,a,OpenLayers.Util.getElement(this.order[f]))>0?d=f:e=f}this.order.splice(e,
0,c);this.indices[c]=this.getZIndex(a);return this.getNextElement(e)},remove:function(a){var a=a.id,c=OpenLayers.Util.indexOf(this.order,a);if(c>=0){this.order.splice(c,1);delete this.indices[a];this.maxZIndex=this.order.length>0?this.indices[this.order[this.order.length-1]]:0}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return this.indices[a.id]!=null},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var c=a._style.graphicZIndex;
if(c==null){c=this.maxZIndex;a._style.graphicZIndex=c}else if(c>this.maxZIndex)this.maxZIndex=c},getNextElement:function(a){a=a+1;if(a<this.order.length){var c=OpenLayers.Util.getElement(this.order[a]);c==void 0&&(c=this.getNextElement(a));return c}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"});
OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,c,d){var c=a.getZIndex(c),e=0;if(d){a=a.getZIndex(d);e=c-a}return e},Z_ORDER_DRAWING_ORDER:function(a,c,d){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,c,d);d&&a==0&&(a=1);return a},Z_ORDER_Y_ORDER:function(a,c,d){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,c,d);if(d&&a===0){c=d._boundsBottom-c._boundsBottom;a=c===0?1:c}return a}};
OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,c){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);
this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(c&&(c.zIndexing||c.yOrdering))this.indexer=new OpenLayers.ElementsIndexer(c.yOrdering)},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,c=this.vectorRoot;if(c)for(;a=c.firstChild;)c.removeChild(a);if(c=this.textRoot)for(;a=c.firstChild;)c.removeChild(a);this.indexer&&
this.indexer.clear()},setExtent:function(a,c){var d=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),e=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var f,g=a.getWidth()/this.map.getExtent().getWidth(),a=a.scale(1/g),g=this.map.getMaxExtent();g.right>a.left&&g.right<a.right?f=true:g.left>a.left&&g.left<a.right&&(f=false);if(f!==this.rightOfDateLine||c){d=false;this.xOffset=f===true?g.getWidth()/e:0}this.rightOfDateLine=f}return d},getNodeType:function(){},
drawGeometry:function(a,c,d){var e=a.CLASS_NAME,f=true;if(e=="OpenLayers.Geometry.Collection"||e=="OpenLayers.Geometry.MultiPoint"||e=="OpenLayers.Geometry.MultiLineString"||e=="OpenLayers.Geometry.MultiPolygon"){for(var e=0,g=a.components.length;e<g;e++)f=this.drawGeometry(a.components[e],c,d)&&f;return f}e=f=false;if(c.display!="none"){c.backgroundGraphic?this.redrawBackgroundNode(a.id,a,c,d):e=true;f=this.redrawNode(a.id,a,c,d)}if(f==false)if(c=document.getElementById(a.id)){c._style.backgroundGraphic&&
(e=true);c.parentNode.removeChild(c)}if(e)(c=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&&c.parentNode.removeChild(c);return f},redrawNode:function(a,c,d,e){d=this.applyDefaultSymbolizer(d);a=this.nodeFactory(a,this.getNodeType(c,d));a._featureId=e;a._boundsBottom=c.getBounds().bottom;a._geometryClass=c.CLASS_NAME;a._style=d;c=this.drawGeometryNode(a,c,d);if(c===false)return false;a=c.node;if(this.indexer)(d=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,d):this.vectorRoot.appendChild(a);
else a.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(a);this.postDraw(a);return c.complete},redrawBackgroundNode:function(a,c,d){d=OpenLayers.Util.extend({},d);d.externalGraphic=d.backgroundGraphic;d.graphicXOffset=d.backgroundXOffset;d.graphicYOffset=d.backgroundYOffset;d.graphicZIndex=d.backgroundGraphicZIndex;d.graphicWidth=d.backgroundWidth||d.graphicWidth;d.graphicHeight=d.backgroundHeight||d.graphicHeight;d.backgroundGraphic=null;d.backgroundXOffset=null;d.backgroundYOffset=null;
d.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,c,d,null)},drawGeometryNode:function(a,c,d){var d=d||a._style,e={isFilled:d.fill===void 0?true:d.fill,isStroked:d.stroke===void 0?!!d.strokeWidth:d.stroke},f;switch(c.CLASS_NAME){case "OpenLayers.Geometry.Point":if(d.graphic===false){e.isFilled=false;e.isStroked=false}f=this.drawPoint(a,c);break;case "OpenLayers.Geometry.LineString":e.isFilled=false;f=this.drawLineString(a,c);break;case "OpenLayers.Geometry.LinearRing":f=
this.drawLinearRing(a,c);break;case "OpenLayers.Geometry.Polygon":f=this.drawPolygon(a,c);break;case "OpenLayers.Geometry.Rectangle":f=this.drawRectangle(a,c)}a._options=e;return f!=false?{node:this.setStyle(a,d,e,c),complete:f}:false},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(a){var c=document.getElementById(a+this.LABEL_ID_SUFFIX);c&&this.textRoot.removeChild(c);
(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&&this.textRoot.removeChild(a)},getFeatureIdFromEvent:function(a){var c=a.target,d=c&&c.correspondingUseElement;return(d?d:c||a.srcElement)._featureId},eraseGeometry:function(a,c){if(a.CLASS_NAME=="OpenLayers.Geometry.MultiPoint"||a.CLASS_NAME=="OpenLayers.Geometry.MultiLineString"||a.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon"||a.CLASS_NAME=="OpenLayers.Geometry.Collection")for(var d=0,e=a.components.length;d<e;d++)this.eraseGeometry(a.components[d],
c);else if((d=OpenLayers.Util.getElement(a.id))&&d.parentNode){if(d.geometry){d.geometry.destroy();d.geometry=null}d.parentNode.removeChild(d);this.indexer&&this.indexer.remove(d);if(d._style.backgroundGraphic)(d=OpenLayers.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&&d.parentNode&&d.parentNode.removeChild(d)}},nodeFactory:function(a,c){var d=OpenLayers.Util.getElement(a);if(d){if(!this.nodeTypeCompare(d,c)){d.parentNode.removeChild(d);d=this.nodeFactory(a,c)}}else d=this.createNode(c,a);return d},
nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(a){var c=this.root;if(a.root.parentNode==this.rendererRoot)c=a.root;c.parentNode.removeChild(c);a.rendererRoot.appendChild(c)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return a!="circle"&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});
OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(a){var a=a||window.location.href,c=OpenLayers.Util.getParameters(a),d=a.indexOf("#");if(d>0){a="?"+a.substring(d+1,a.length);OpenLayers.Util.extend(c,OpenLayers.Util.getParameters(a))}return c},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var c=0,d=this.map.controls.length;c<d;c++){var e=this.map.controls[c];if(e!=this&&
e.CLASS_NAME=="OpenLayers.Control.ArgParser"){if(e.displayProjection!=this.displayProjection)this.displayProjection=e.displayProjection;break}}if(c==this.map.controls.length){c=this.getParameters();if(c.layers){this.layers=c.layers;this.map.events.register("addlayer",this,this.configureLayers);this.configureLayers()}if(c.lat&&c.lon){this.center=new OpenLayers.LonLat(parseFloat(c.lon),parseFloat(c.lat));if(c.zoom)this.zoom=parseFloat(c.zoom);this.map.events.register("changebaselayer",this,this.setCenter);
this.setCenter()}}},setCenter:function(){if(this.map.baseLayer){this.map.events.unregister("changebaselayer",this,this.setCenter);this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject());this.map.setCenter(this.center,this.zoom)}},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,c=this.layers.length;a<c;a++){var d=this.map.layers[a],e=this.layers.charAt(a);
e=="B"?this.map.setBaseLayer(d):(e=="T"||e=="F")&&d.setVisibility(e=="T")}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});
OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(a,c,d){if(a!==null&&typeof a=="object"&&!OpenLayers.Util.isElement(a)){this.base=document.location.href;OpenLayers.Control.prototype.initialize.apply(this,[a]);if(this.element!=null)this.element=OpenLayers.Util.getElement(this.element)}else{OpenLayers.Control.prototype.initialize.apply(this,[d]);this.element=OpenLayers.Util.getElement(a);
this.base=c||document.location.href}},destroy:function(){if(this.element&&this.element.parentNode==this.div){this.div.removeChild(this.element);this.element=null}this.map&&this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var c=0,d=this.map.controls.length;c<d;c++){var e=this.map.controls[c];if(e.CLASS_NAME==this.argParserClass.CLASS_NAME){if(e.displayProjection!=
this.displayProjection)this.displayProjection=e.displayProjection;break}}c==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element&&!this.anchor){this.element=document.createElement("a");this.element.innerHTML=OpenLayers.i18n("Permalink");this.element.href="";this.div.appendChild(this.element)}this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,
changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var a=this.anchor?"#":"?",c=this.base;c.indexOf(a)!=-1&&(c=c.substring(0,c.indexOf(a)));c=c+(a+OpenLayers.Util.getParameterString(this.createParams()));this.anchor&&!this.element?window.location.href=c:this.element.href=c},createParams:function(a,c,d){var a=a||this.map.getCenter(),e=OpenLayers.Util.getParameters(this.base);if(a){e.zoom=c||this.map.getZoom();c=a.lat;a=a.lon;if(this.displayProjection){c=
OpenLayers.Projection.transform({x:a,y:c},this.map.getProjectionObject(),this.displayProjection);a=c.x;c=c.y}e.lat=Math.round(c*1E5)/1E5;e.lon=Math.round(a*1E5)/1E5;d=d||this.map.layers;e.layers="";a=0;for(c=d.length;a<c;a++){var f=d[a];e.layers=f.isBaseLayer?e.layers+(f==this.map.baseLayer?"B":"0"):e.layers+(f.getVisibility()?"T":"F")}}return e},CLASS_NAME:"OpenLayers.Control.Permalink"});
OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(a,c,d){var e=[];e.push(a,c,{},d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e)},clone:function(a){a==null&&(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),c=this.getServerResolution(),
d=Math.round((a.left-this.tileOrigin.lon)/(c*this.tileSize.w)),a=Math.round((a.bottom-this.tileOrigin.lat)/(c*this.tileSize.h)),d=this.serviceVersion+"/"+this.layername+"/"+this.getServerZoom()+"/"+d+"/"+a+"."+this.type,a=this.url;OpenLayers.Util.isArray(a)&&(a=this.selectUrl(d,a));return a+d},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin)this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom)},CLASS_NAME:"OpenLayers.Layer.TMS"});
OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(this.layer.visibility==true||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return true}return false},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,
scope:this});return a},load:function(a){var c=this.layer;c.events.triggerEvent("loadstart");c.protocol.read(OpenLayers.Util.applyDefaults({callback:OpenLayers.Function.bind(this.merge,this,c.map.getProjectionObject()),filter:c.filter},a));c.events.un({visibilitychanged:this.load,scope:this})},merge:function(a,c){var d=this.layer;d.destroyFeatures();var e=c.features;if(e&&e.length>0){if(!a.equals(d.projection))for(var f,g=0,h=e.length;g<h;++g)(f=e[g].geometry)&&f.transform(d.projection,a);d.addFeatures(e)}d.events.triggerEvent("loadend")},
CLASS_NAME:"OpenLayers.Strategy.Fixed"});
OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var a=OpenLayers.Control.prototype.draw.apply(this),c=this.getOrCreateLinks(a),d=c.zoomIn,c=c.zoomOut,e=this.map.events;if(c.parentNode!==a){e=this.events;e.attachToElement(c.parentNode)}e.register("buttonclick",this,this.onZoomClick);this.zoomInLink=d;this.zoomOutLink=c;return a},getOrCreateLinks:function(a){var c=document.getElementById(this.zoomInId),
d=document.getElementById(this.zoomOutId);if(!c){c=document.createElement("a");c.href="#zoomIn";c.appendChild(document.createTextNode(this.zoomInText));c.className="olControlZoomIn";a.appendChild(c)}OpenLayers.Element.addClass(c,"olButton");if(!d){d=document.createElement("a");d.href="#zoomOut";d.appendChild(document.createTextNode(this.zoomOutText));d.className="olControlZoomOut";a.appendChild(d)}OpenLayers.Element.addClass(d,"olButton");return{zoomIn:c,zoomOut:d}},onZoomClick:function(a){a=a.buttonElement;
a===this.zoomInLink?this.map.zoomIn():a===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});
OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,c){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style){this.styles["default"]=a;this.styles.select=a;this.styles.temporary=a;this.styles["delete"]=
a}else if(typeof a=="object")for(var d in a)if(a[d]instanceof OpenLayers.Style)this.styles[d]=a[d];else if(typeof a[d]=="object")this.styles[d]=new OpenLayers.Style(a[d]);else{this.styles["default"]=new OpenLayers.Style(a);this.styles.select=new OpenLayers.Style(a);this.styles.temporary=new OpenLayers.Style(a);this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,c)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,
c){a||(a=new OpenLayers.Feature.Vector);this.styles[c]||(c="default");a.renderIntent=c;var d={};this.extendDefault&&c!="default"&&(d=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(d,this.styles[c].createSymbolizer(a))},addUniqueValueRules:function(a,c,d,e){var f=[],g;for(g in d)f.push(new OpenLayers.Rule({symbolizer:d[g],context:e,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:c,value:g})}));this.styles[a].addRules(f)},CLASS_NAME:"OpenLayers.StyleMap"});
OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(a,c){OpenLayers.Layer.prototype.initialize.apply(this,arguments);(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||
!this.renderer.supported()){this.renderer=null;this.displayError()}if(!this.styleMap)this.styleMap=new OpenLayers.StyleMap;this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var d=0,e=this.strategies.length;d<e;d++)this.strategies[d].setLayer(this)},destroy:function(){if(this.strategies){var a,c,d;c=0;for(d=this.strategies.length;c<d;c++){a=this.strategies[c];a.autoDestroy&&a.destroy()}this.strategies=null}if(this.protocol){this.protocol.autoDestroy&&this.protocol.destroy();
this.protocol=null}this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.Vector(this.name,this.getOptions()));for(var a=OpenLayers.Layer.prototype.clone.apply(this,[a]),c=this.features,d=c.length,e=Array(d),f=0;f<d;++f)e[f]=c[f].clone();a.features=e;return a},refresh:function(a){this.calculateInRange()&&
this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,c=this.renderers.length;a<c;a++){var d=this.renderers[a];if((d=typeof d=="function"?d:OpenLayers.Renderer[d])&&d.prototype.supported()){this.renderer=new d(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,
arguments);if(this.renderer){this.renderer.map=this.map;var c=this.map.getSize();c.w=c.w*this.ratio;c.h=c.h*this.ratio;this.renderer.setSize(c)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,c,d;c=0;for(d=this.strategies.length;c<d;c++){a=this.strategies[c];a.autoActivate&&a.activate()}}},removeMap:function(){this.drawn=false;if(this.strategies){var a,c,d;c=0;for(d=this.strategies.length;c<d;c++){a=this.strategies[c];a.autoActivate&&a.deactivate()}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,
arguments);var a=this.map.getSize();a.w=a.w*this.ratio;a.h=a.h*this.ratio;this.renderer.setSize(a)},moveTo:function(a,c,d){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var e=true;if(!d){this.renderer.root.style.visibility="hidden";var e=this.map.getSize(),f=e.w,e=e.h,f=f/2*this.ratio-f/2,e=e/2*this.ratio-e/2,f=f+parseInt(this.map.layerContainerDiv.style.left,10),f=-Math.round(f),e=e+parseInt(this.map.layerContainerDiv.style.top,10),e=-Math.round(e);this.div.style.left=f+"px";this.div.style.top=
e+"px";e=this.renderer.setExtent(this.map.getExtent().scale(this.ratio),c);this.renderer.root.style.visibility="visible";if(OpenLayers.IS_GECKO===true)this.div.scrollLeft=this.div.scrollLeft;if(!c&&e)for(var g in this.unrenderedFeatures){f=this.unrenderedFeatures[g];this.drawFeature(f)}}if(!this.drawn||c||!e){this.drawn=true;g=0;for(e=this.features.length;g<e;g++){this.renderer.locked=g!==e-1;f=this.features[g];this.drawFeature(f)}}},display:function(a){OpenLayers.Layer.prototype.display.apply(this,
arguments);var c=this.div.style.display;if(c!=this.renderer.root.style.display)this.renderer.root.style.display=c},addFeatures:function(a,c){OpenLayers.Util.isArray(a)||(a=[a]);var d=!c||!c.silent;if(d){var e={features:a};if(this.events.triggerEvent("beforefeaturesadded",e)===false)return;a=e.features}for(var e=[],f=0,g=a.length;f<g;f++){this.renderer.locked=f!=a.length-1?true:false;var h=a[f];if(this.geometryType&&!(h.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+
this.geometryType.prototype.CLASS_NAME);h.layer=this;if(!h.style&&this.style)h.style=OpenLayers.Util.extend({},this.style);if(d){if(this.events.triggerEvent("beforefeatureadded",{feature:h})===false)continue;this.preFeatureInsert(h)}e.push(h);this.features.push(h);this.drawFeature(h);if(d){this.events.triggerEvent("featureadded",{feature:h});this.onFeatureInsert(h)}}d&&this.events.triggerEvent("featuresadded",{features:e})},removeFeatures:function(a,c){if(a&&a.length!==0){if(a===this.features)return this.removeAllFeatures(c);
OpenLayers.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&&(a=a.slice());var d=!c||!c.silent;d&&this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var e=a.length-1;e>=0;e--){this.renderer.locked=e!=0&&a[e-1].geometry?true:false;var f=a[e];delete this.unrenderedFeatures[f.id];d&&this.events.triggerEvent("beforefeatureremoved",{feature:f});this.features=OpenLayers.Util.removeItem(this.features,f);f.layer=null;f.geometry&&this.renderer.eraseFeatures(f);OpenLayers.Util.indexOf(this.selectedFeatures,
f)!=-1&&OpenLayers.Util.removeItem(this.selectedFeatures,f);d&&this.events.triggerEvent("featureremoved",{feature:f})}d&&this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){var a=!a||!a.silent,c=this.features;a&&this.events.triggerEvent("beforefeaturesremoved",{features:c});for(var d,e=c.length-1;e>=0;e--){d=c[e];a&&this.events.triggerEvent("beforefeatureremoved",{feature:d});d.layer=null;a&&this.events.triggerEvent("featureremoved",{feature:d})}this.renderer.clear();
this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];a&&this.events.triggerEvent("featuresremoved",{features:c})},destroyFeatures:function(a,c){if(a==void 0)a=this.features;if(a){this.removeFeatures(a,c);for(var d=a.length-1;d>=0;d--)a[d].destroy()}},drawFeature:function(a,c){if(this.drawn){if(typeof c!="object"){!c&&a.state===OpenLayers.State.DELETE&&(c="delete");var d=c||a.renderIntent;(c=a.style||this.style)||(c=this.styleMap.createSymbolizer(a,d))}d=this.renderer.drawFeature(a,
c);d===false||d===null?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}},eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var c=null;(a=this.renderer.getFeatureIdFromEvent(a))&&(c=typeof a==="string"?this.getFeatureById(a):a);return c},getFeatureBy:function(a,
c){for(var d=null,e=0,f=this.features.length;e<f;++e)if(this.features[e][a]==c){d=this.features[e];break}return d},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,c){var d,e,f=this.features.length,g=[];for(d=0;d<f;d++)(e=this.features[d])&&e.attributes&&e.attributes[a]===c&&g.push(e);return g},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var a=null,c=
this.features;if(c&&c.length>0)for(var d=null,e=0,f=c.length;e<f;e++)if(d=c[e].geometry){a===null&&(a=new OpenLayers.Bounds);a.extend(d.getBounds())}return a},CLASS_NAME:"OpenLayers.Layer.Vector"});
OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(a,c){if(a.length<2)throw Error("At least two point features have to be added to create a line from");for(var d=Array(a.length-1),e,f,g,h=0,i=a.length;h<i;h++){e=a[h];if(g=e.geometry){if(g.CLASS_NAME!="OpenLayers.Geometry.Point")throw new TypeError("Only features with point geometries are supported.");}else{g=e.lonlat;g=new OpenLayers.Geometry.Point(g.lon,g.lat)}if(h>0){e=this.dataFrom!=
null?a[h+this.dataFrom].data||a[h+this.dataFrom].attributes:null;var j=this.styleFrom!=null?a[h+this.styleFrom].style:null;f=new OpenLayers.Geometry.LineString([f,g]);d[h-1]=new OpenLayers.Feature.Vector(f,e,j)}f=g}this.addFeatures(d,c)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.SOURCE_NODE=-1;OpenLayers.Layer.PointTrack.TARGET_NODE=0;OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};
OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},
update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(a,c,d){return OpenLayers.Function.bind(function(){a.apply(this,[c,d])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"});
OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Protocol.WFS=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS),c=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported WFS version: "+a.version;return new c(a)};
OpenLayers.Protocol.WFS.fromWMSLayer=function(a,c){var d,e;d=a.params.LAYERS;d=(OpenLayers.Util.isArray(d)?d[0]:d).split(":");d.length>1&&(e=d[0]);d=d.pop();e={url:a.url,featureType:d,featurePrefix:e,srsName:a.projection&&a.projection.getCode()||a.map&&a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(c,e))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};
OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(a,c){this.direction=a;this.CLASS_NAME=this.CLASS_NAME+this.direction;OpenLayers.Control.prototype.initialize.apply(this,[c])},trigger:function(){var a=OpenLayers.Function.bind(function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,
-a("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,a("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-a("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(a("w"),0)}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";
OpenLayers.Format.CSWGetDomain=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS),c=OpenLayers.Format.CSWGetDomain["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported CSWGetDomain version: "+a.version;return new c(a)};OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"};
OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&
a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);return c},readers:{csw:{GetDomainResponse:function(a,c){this.readChildNodes(a,c)},DomainValues:function(a,c){if(!OpenLayers.Util.isArray(c.DomainValues))c.DomainValues=[];for(var d=a.attributes,e={},f=0,g=d.length;f<g;++f)e[d[f].name]=d[f].nodeValue;this.readChildNodes(a,e);c.DomainValues.push(e)},PropertyName:function(a,c){c.PropertyName=this.getChildValue(a)},ParameterName:function(a,c){c.ParameterName=this.getChildValue(a)},ListOfValues:function(a,
c){if(!OpenLayers.Util.isArray(c.ListOfValues))c.ListOfValues=[];this.readChildNodes(a,c.ListOfValues)},Value:function(a,c){for(var d=a.attributes,e={},f=0,g=d.length;f<g;++f)e[d[f].name]=d[f].nodeValue;e.value=this.getChildValue(a);c.push({Value:e})},ConceptualScheme:function(a,c){c.ConceptualScheme={};this.readChildNodes(a,c.ConceptualScheme)},Name:function(a,c){c.Name=this.getChildValue(a)},Document:function(a,c){c.Document=this.getChildValue(a)},Authority:function(a,c){c.Authority=this.getChildValue(a)},
RangeOfValues:function(a,c){c.RangeOfValues={};this.readChildNodes(a,c.RangeOfValues)},MinValue:function(a,c){for(var d=a.attributes,e={},f=0,g=d.length;f<g;++f)e[d[f].name]=d[f].nodeValue;e.value=this.getChildValue(a);c.MinValue=e},MaxValue:function(a,c){for(var d=a.attributes,e={},f=0,g=d.length;f<g;++f)e[d[f].name]=d[f].nodeValue;e.value=this.getChildValue(a);c.MaxValue=e}}},write:function(a){a=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{csw:{GetDomain:function(a){var c=
this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});if(a.PropertyName||this.PropertyName)this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,c);else if(a.ParameterName||this.ParameterName)this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,c);this.readChildNodes(c,a);return c},PropertyName:function(a){return this.createElementNSPlus("csw:PropertyName",{value:a})},ParameterName:function(a){return this.createElementNSPlus("csw:ParameterName",
{value:a})}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(a){return(new OpenLayers.Format.ArcXML).read(a).features.feature}});
OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes=
{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,c){typeof a=="string"&&
(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var d=["Link","NetworkLink","Style","StyleMap","Placemark"],e=0,f=d.length;e<f;++e){var g=d[e],h=this.getElementsByTagNameNS(a,"*",g);if(h.length!=0)switch(g.toLowerCase()){case "link":case "networklink":this.parseLinks(h,c);break;case "style":this.extractStyles&&this.parseStyles(h,c);break;case "stylemap":this.extractStyles&&this.parseStyleMaps(h,c);break;case "placemark":this.parseFeatures(h,c)}}return this.features},parseLinks:function(a,
c){if(c.depth>=this.maxDepth)return false;var d=OpenLayers.Util.extend({},c);d.depth++;for(var e=0,f=a.length;e<f;e++){var g=this.parseProperty(a[e],"*","href");if(g&&!this.fetched[g]){this.fetched[g]=true;(g=this.fetchLink(g))&&this.parseData(g,d)}}},fetchLink:function(a){if(a=OpenLayers.Request.GET({url:a,async:false}))return a.responseText},parseStyles:function(a,c){for(var d=0,e=a.length;d<e;d++){var f=this.parseStyle(a[d]);f&&(this.styles[(c.styleBaseUrl||"")+"#"+f.id]=f)}},parseKmlColor:function(a){var c=
null;if(a)(a=a.match(this.regExes.kmlColor))&&(c={color:"#"+a[4]+a[3]+a[2],opacity:parseInt(a[1],16)/255});return c},parseStyle:function(a){for(var c={},d=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],e,f,g=0,h=d.length;g<h;++g){e=d[g];if(f=this.getElementsByTagNameNS(a,"*",e)[0])switch(e.toLowerCase()){case "linestyle":e=this.parseProperty(f,"*","color");if(e=this.parseKmlColor(e)){c.strokeColor=e.color;c.strokeOpacity=e.opacity}(e=this.parseProperty(f,"*","width"))&&(c.strokeWidth=
e);break;case "polystyle":e=this.parseProperty(f,"*","color");if(e=this.parseKmlColor(e)){c.fillOpacity=e.opacity;c.fillColor=e.color}this.parseProperty(f,"*","fill")=="0"&&(c.fillColor="none");this.parseProperty(f,"*","outline")=="0"&&(c.strokeWidth="0");break;case "iconstyle":var i=parseFloat(this.parseProperty(f,"*","scale")||1);e=32*i;var j=32*i,k=this.getElementsByTagNameNS(f,"*","Icon")[0];if(k){var l=this.parseProperty(k,"*","href");if(l){var m=this.parseProperty(k,"*","w"),n=this.parseProperty(k,
"*","h");if(OpenLayers.String.startsWith(l,"http://maps.google.com/mapfiles/kml")&&!m&&!n){n=m=64;i=i/2}m=m||n;n=n||m;m&&(e=parseInt(m)*i);n&&(j=parseInt(n)*i);if(n=l.match(this.regExes.kmlIconPalette)){m=n[1];n=n[2];l=this.parseProperty(k,"*","x");k=this.parseProperty(k,"*","y");l="http://maps.google.com/mapfiles/kml/pal"+m+"/icon"+((k?7-k/32:7)*8+(l?l/32:0))+n}c.graphicOpacity=1;c.externalGraphic=l}}if(f=this.getElementsByTagNameNS(f,"*","hotSpot")[0]){l=parseFloat(f.getAttribute("x"));k=parseFloat(f.getAttribute("y"));
m=f.getAttribute("xunits");m=="pixels"?c.graphicXOffset=-l*i:m=="insetPixels"?c.graphicXOffset=-e+l*i:m=="fraction"&&(c.graphicXOffset=-e*l);f=f.getAttribute("yunits");f=="pixels"?c.graphicYOffset=-j+k*i+1:f=="insetPixels"?c.graphicYOffset=-(k*i)+1:f=="fraction"&&(c.graphicYOffset=-j*(1-k)+1)}c.graphicWidth=e;c.graphicHeight=j;break;case "balloonstyle":(f=OpenLayers.Util.getXmlNodeValue(f.getElementsByTagName("text")[0]))&&(c.balloonStyle=f.replace(this.regExes.straightBracket,"{$1}"));break;case "labelstyle":e=
this.parseProperty(f,"*","color");if(e=this.parseKmlColor(e)){c.fontColor=e.color;c.fontOpacity=e.opacity}}}!c.strokeColor&&c.fillColor&&(c.strokeColor=c.fillColor);if((a=a.getAttribute("id"))&&c)c.id=a;return c},parseStyleMaps:function(a,c){for(var d=0,e=a.length;d<e;d++)for(var f=a[d],g=this.getElementsByTagNameNS(f,"*","Pair"),f=f.getAttribute("id"),h=0,i=g.length;h<i;h++){var j=g[h],k=this.parseProperty(j,"*","key");(j=this.parseProperty(j,"*","styleUrl"))&&k=="normal"&&(this.styles[(c.styleBaseUrl||
"")+"#"+f]=this.styles[(c.styleBaseUrl||"")+j])}},parseFeatures:function(a,c){for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e],h=this.parseFeature.apply(this,[g]);if(h){if(this.extractStyles&&h.attributes&&h.attributes.styleUrl)h.style=this.getStyle(h.attributes.styleUrl,c);if(this.extractStyles){var i=this.getElementsByTagNameNS(g,"*","Style")[0];if(i)if(i=this.parseStyle(i))h.style=OpenLayers.Util.extend(h.style,i)}if(this.extractTracks){if((g=this.getElementsByTagNameNS(g,this.namespaces.gx,"Track"))&&
g.length>0){h={features:[],feature:h};this.readNode(g[0],h);h.features.length>0&&d.push.apply(d,h.features)}}else d.push(h)}else throw"Bad Placemark: "+e;}this.features=this.features.concat(d)},readers:{kml:{when:function(a,c){c.whens.push(OpenLayers.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,c){var d=a.nodeName.split(":").pop();c.attributes[d].push(this.getChildValue(a))}},gx:{Track:function(a,c){var d={whens:[],points:[],angles:[]};if(this.trackAttributes){var e;d.attributes=
{};for(var f=0,g=this.trackAttributes.length;f<g;++f){e=this.trackAttributes[f];d.attributes[e]=[];if(!(e in this.readers.kml))this.readers.kml[e]=this.readers.kml._trackPointAttribute}}this.readChildNodes(a,d);if(d.whens.length!==d.points.length)throw Error("gx:Track with unequal number of when ("+d.whens.length+") and gx:coord ("+d.points.length+") elements.");var h=d.angles.length>0;if(h&&d.whens.length!==d.angles.length)throw Error("gx:Track with unequal number of when ("+d.whens.length+") and gx:angles ("+
d.angles.length+") elements.");for(var i,f=0,g=d.whens.length;f<g;++f){i=c.feature.clone();i.fid=c.feature.fid||c.feature.id;e=d.points[f];i.geometry=e;if("z"in e)i.attributes.altitude=e.z;this.internalProjection&&this.externalProjection&&i.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes)for(var j=0,k=this.trackAttributes.length;j<k;++j){e=this.trackAttributes[j];i.attributes[e]=d.attributes[e][f]}i.attributes.when=d.whens[f];i.attributes.trackId=c.feature.id;
if(h){e=d.angles[f];i.attributes.heading=parseFloat(e[0]);i.attributes.tilt=parseFloat(e[1]);i.attributes.roll=parseFloat(e[2])}c.features.push(i)}},coord:function(a,c){var d=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/),e=new OpenLayers.Geometry.Point(d[0],d[1]);if(d.length>2)e.z=parseFloat(d[2]);c.points.push(e)},angles:function(a,c){var d=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);c.angles.push(d)}}},parseFeature:function(a){for(var c=["MultiGeometry",
"Polygon","LineString","Point"],d,e,f,g=0,h=c.length;g<h;++g){d=c[g];this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns;e=this.getElementsByTagNameNS(a,this.internalns,d);if(e.length>0){if(c=this.parseGeometry[d.toLowerCase()]){f=c.apply(this,[e[0]]);this.internalProjection&&this.externalProjection&&f.transform(this.externalProjection,this.internalProjection)}else throw new TypeError("Unsupported geometry type: "+d);break}}var i;this.extractAttributes&&(i=this.parseAttributes(a));d=new OpenLayers.Feature.Vector(f,
i);a=a.getAttribute("id")||a.getAttribute("name");if(a!=null)d.fid=a;return d},getStyle:function(a,c){var d=OpenLayers.Util.removeTail(a),e=OpenLayers.Util.extend({},c);e.depth++;e.styleBaseUrl=d;if(!this.styles[a]&&!OpenLayers.String.startsWith(a,"#")&&e.depth<=this.maxDepth&&!this.fetched[d])(d=this.fetchLink(d))&&this.parseData(d,e);return OpenLayers.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),a=[];if(c.length>
0)var d=c[0].firstChild.nodeValue,d=d.replace(this.regExes.removeSpace,""),a=d.split(",");c=null;if(a.length>1){a.length==2&&(a[2]=null);c=new OpenLayers.Geometry.Point(a[0],a[1],a[2])}else throw"Bad coordinate string: "+d;return c},linestring:function(a,c){var d=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),e=null;if(d.length>0){for(var d=this.getChildValue(d[0]),d=d.replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),e=d.split(this.regExes.splitSpace),f=e.length,
g=Array(f),h,i,j=0;j<f;++j){h=e[j].split(",");i=h.length;if(i>1){h.length==2&&(h[2]=null);g[j]=new OpenLayers.Geometry.Point(h[0],h[1],h[2])}else throw"Bad LineString point coordinates: "+e[j];}if(f)e=c?new OpenLayers.Geometry.LinearRing(g):new OpenLayers.Geometry.LineString(g);else throw"Bad LineString coordinates: "+d;}return e},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing"),c=a.length,d=Array(c);if(c>0)for(var e=0,f=a.length;e<f;++e)if(c=this.parseGeometry.linestring.apply(this,
[a[e],true]))d[e]=c;else throw"Bad LinearRing geometry: "+e;return new OpenLayers.Geometry.Polygon(d)},multigeometry:function(a){for(var c,d=[],e=a.childNodes,f=0,g=e.length;f<g;++f){a=e[f];if(a.nodeType==1)(c=this.parseGeometry[(a.prefix?a.nodeName.split(":")[1]:a.nodeName).toLowerCase()])&&d.push(c.apply(this,[a]))}return new OpenLayers.Geometry.Collection(d)}},parseAttributes:function(a){var c={},d=a.getElementsByTagName("ExtendedData");d.length&&(c=this.parseExtendedData(d[0]));for(var e,f,g,
a=a.childNodes,d=0;d<a.length;++d){e=a[d];if(e.nodeType==1){f=e.childNodes;e=e.prefix?e.nodeName.split(":")[1]:e.nodeName;if(f.length>=1){var h;switch(f.length){case 1:g=f[0];if(g.nodeType==3||g.nodeType==4)(h=OpenLayers.Util.getXmlNodeValue(g))&&(h=h.replace(this.regExes.trimSpace,""));break;case 2:g=f[0];f=f[1];g=g.nodeType==3||g.nodeType==4?g:f;if(g.nodeType==3||g.nodeType==4)(h=OpenLayers.Util.getXmlNodeValue(g))&&(h=h.replace(this.regExes.trimSpace,""));break;default:h="";for(var i=0;i<f.length;++i){g=
f[i];h=h+OpenLayers.Util.getXmlNodeValue(g)}}h&&(c[e]=h)}}}return c},parseExtendedData:function(a){var c={},d,e,f,g,h=a.getElementsByTagName("Data");d=0;for(e=h.length;d<e;d++){f=h[d];g=f.getAttribute("name");var i={},j=f.getElementsByTagName("value");j.length&&(i.value=this.getChildValue(j[0]));if(this.kvpAttributes)c[g]=i.value;else{f=f.getElementsByTagName("displayName");f.length&&(i.displayName=this.getChildValue(f[0]));c[g]=i}}a=a.getElementsByTagName("SimpleData");d=0;for(e=a.length;d<e;d++){i=
{};f=a[d];g=f.getAttribute("name");i.value=this.getChildValue(f);if(this.kvpAttributes)c[g]=i.value;else{i.displayName=g;c[g]=i}}return c},parseProperty:function(a,c,d){var e,a=this.getElementsByTagNameNS(a,c,d);try{e=OpenLayers.Util.getXmlNodeValue(a[0])}catch(f){e=null}return e},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var c=this.createElementNS(this.kmlns,"kml"),d=this.createFolderXML(),e=0,f=a.length;e<f;++e)d.appendChild(this.createPlacemarkXML(a[e]));c.appendChild(d);return OpenLayers.Format.XML.prototype.write.apply(this,
[c])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var c=this.createElementNS(this.kmlns,"name"),d=this.createTextNode(this.foldersName);c.appendChild(d);a.appendChild(c)}if(this.foldersDesc){c=this.createElementNS(this.kmlns,"description");d=this.createTextNode(this.foldersDesc);c.appendChild(d);a.appendChild(c)}return a},createPlacemarkXML:function(a){var c=this.createElementNS(this.kmlns,"name"),d=a.style&&a.style.label?a.style.label:a.id;c.appendChild(this.createTextNode(a.attributes.name||
d));var e=this.createElementNS(this.kmlns,"description");e.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));d=this.createElementNS(this.kmlns,"Placemark");a.fid!=null&&d.setAttribute("id",a.fid);d.appendChild(c);d.appendChild(e);c=this.buildGeometryNode(a.geometry);d.appendChild(c);if(a.attributes)(a=this.buildExtendedData(a.attributes))&&d.appendChild(a);return d},buildGeometryNode:function(a){var c=a.CLASS_NAME,c=this.buildGeometry[c.substring(c.lastIndexOf(".")+1).toLowerCase()],
d=null;c&&(d=c.apply(this,[a]));return d},buildGeometry:{point:function(a){var c=this.createElementNS(this.kmlns,"Point");c.appendChild(this.buildCoordinatesNode(a));return c},multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var c=this.createElementNS(this.kmlns,"LineString");c.appendChild(this.buildCoordinatesNode(a));return c},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var c=this.createElementNS(this.kmlns,
"LinearRing");c.appendChild(this.buildCoordinatesNode(a));return c},polygon:function(a){for(var c=this.createElementNS(this.kmlns,"Polygon"),a=a.components,d,e,f=0,g=a.length;f<g;++f){d=f==0?"outerBoundaryIs":"innerBoundaryIs";d=this.createElementNS(this.kmlns,d);e=this.buildGeometry.linearring.apply(this,[a[f]]);d.appendChild(e);c.appendChild(d)}return c},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){for(var c=this.createElementNS(this.kmlns,
"MultiGeometry"),d,e=0,f=a.components.length;e<f;++e)(d=this.buildGeometryNode.apply(this,[a.components[e]]))&&c.appendChild(d);return c}},buildCoordinatesNode:function(a){var c=this.createElementNS(this.kmlns,"coordinates"),d;if(d=a.components){for(var e=d.length,f=Array(e),g=0;g<e;++g){a=d[g];f[g]=this.buildCoordinates(a)}d=f.join(" ")}else d=this.buildCoordinates(a);d=this.createTextNode(d);c.appendChild(d);return c},buildCoordinates:function(a){if(this.internalProjection&&this.externalProjection){a=
a.clone();a.transform(this.internalProjection,this.externalProjection)}return a.x+","+a.y},buildExtendedData:function(a){var c=this.createElementNS(this.kmlns,"ExtendedData"),d;for(d in a)if(a[d]&&d!="name"&&d!="description"&&d!="styleUrl"){var e=this.createElementNS(this.kmlns,"Data");e.setAttribute("name",d);var f=this.createElementNS(this.kmlns,"value");if(typeof a[d]=="object"){a[d].value&&f.appendChild(this.createTextNode(a[d].value));if(a[d].displayName){var g=this.createElementNS(this.kmlns,
"displayName");g.appendChild(this.getXMLDoc().createCDATASection(a[d].displayName));e.appendChild(g)}}else f.appendChild(this.createTextNode(a[d]));e.appendChild(f);c.appendChild(e)}return this.isSimpleContent(c)?null:c},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});
OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=a;if(a&&a.nodeType==9)a=a.documentElement;var d={};this.readNode(a,d);if(d.service===void 0){a=new OpenLayers.Format.OGCExceptionReport;d.error=a.read(c)}return d},readers:{wms:{Service:function(a,
c){c.service={};this.readChildNodes(a,c.service)},Name:function(a,c){c.name=this.getChildValue(a)},Title:function(a,c){c.title=this.getChildValue(a)},Abstract:function(a,c){c["abstract"]=this.getChildValue(a)},BoundingBox:function(a){var c={};c.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];a={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};if(!isNaN(a.x)||!isNaN(a.y))c.res=
a;return c},OnlineResource:function(a,c){c.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,c){c.contactInformation={};this.readChildNodes(a,c.contactInformation)},ContactPersonPrimary:function(a,c){c.personPrimary={};this.readChildNodes(a,c.personPrimary)},ContactPerson:function(a,c){c.person=this.getChildValue(a)},ContactOrganization:function(a,c){c.organization=this.getChildValue(a)},ContactPosition:function(a,c){c.position=this.getChildValue(a)},ContactAddress:function(a,
c){c.contactAddress={};this.readChildNodes(a,c.contactAddress)},AddressType:function(a,c){c.type=this.getChildValue(a)},Address:function(a,c){c.address=this.getChildValue(a)},City:function(a,c){c.city=this.getChildValue(a)},StateOrProvince:function(a,c){c.stateOrProvince=this.getChildValue(a)},PostCode:function(a,c){c.postcode=this.getChildValue(a)},Country:function(a,c){c.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,c){c.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,
c){c.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,c){c.email=this.getChildValue(a)},Fees:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.fees=d},AccessConstraints:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.accessConstraints=d},Capability:function(a,c){c.capability={nestedLayers:[],layers:[]};this.readChildNodes(a,c.capability)},Request:function(a,c){c.request={};this.readChildNodes(a,c.request)},GetCapabilities:function(a,
c){c.getcapabilities={formats:[]};this.readChildNodes(a,c.getcapabilities)},Format:function(a,c){OpenLayers.Util.isArray(c.formats)?c.formats.push(this.getChildValue(a)):c.format=this.getChildValue(a)},DCPType:function(a,c){this.readChildNodes(a,c)},HTTP:function(a,c){this.readChildNodes(a,c)},Get:function(a,c){c.get={};this.readChildNodes(a,c.get);if(!c.href)c.href=c.get.href},Post:function(a,c){c.post={};this.readChildNodes(a,c.post);if(!c.href)c.href=c.get.href},GetMap:function(a,c){c.getmap={formats:[]};
this.readChildNodes(a,c.getmap)},GetFeatureInfo:function(a,c){c.getfeatureinfo={formats:[]};this.readChildNodes(a,c.getfeatureinfo)},Exception:function(a,c){c.exception={formats:[]};this.readChildNodes(a,c.exception)},Layer:function(a,c){var d,e;if(c.capability){e=c.capability;d=c}else e=c;var f=a.getAttributeNode("queryable"),g=f&&f.specified?a.getAttribute("queryable"):null,h=(f=a.getAttributeNode("cascaded"))&&f.specified?a.getAttribute("cascaded"):null,f=(f=a.getAttributeNode("opaque"))&&f.specified?
a.getAttribute("opaque"):null,i=a.getAttribute("noSubsets"),j=a.getAttribute("fixedWidth"),k=a.getAttribute("fixedHeight"),l=d||{},m=OpenLayers.Util.extend;d={nestedLayers:[],styles:d?[].concat(d.styles):[],srs:d?m({},l.srs):{},metadataURLs:[],bbox:d?m({},l.bbox):{},llbbox:l.llbbox,dimensions:d?m({},l.dimensions):{},authorityURLs:d?m({},l.authorityURLs):{},identifiers:{},keywords:[],queryable:g&&g!==""?g==="1"||g==="true":l.queryable||false,cascaded:h!==null?parseInt(h):l.cascaded||0,opaque:f?f===
"1"||f==="true":l.opaque||false,noSubsets:i!==null?i==="1"||i==="true":l.noSubsets||false,fixedWidth:j!=null?parseInt(j):l.fixedWidth||0,fixedHeight:k!=null?parseInt(k):l.fixedHeight||0,minScale:l.minScale,maxScale:l.maxScale,attribution:l.attribution};c.nestedLayers.push(d);d.capability=e;this.readChildNodes(a,d);delete d.capability;if(d.name){g=d.name.split(":");h=e.request;f=h.getfeatureinfo;if(g.length>0)d.prefix=g[0];e.layers.push(d);if(d.formats===void 0)d.formats=h.getmap.formats;if(d.infoFormats===
void 0&&f)d.infoFormats=f.formats}},Attribution:function(a,c){c.attribution={};this.readChildNodes(a,c.attribution)},LogoURL:function(a,c){c.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,c.logo)},Style:function(a,c){var d={};c.styles.push(d);this.readChildNodes(a,d)},LegendURL:function(a,c){var d={width:a.getAttribute("width"),height:a.getAttribute("height")};c.legend=d;this.readChildNodes(a,d)},MetadataURL:function(a,c){var d={type:a.getAttribute("type")};
c.metadataURLs.push(d);this.readChildNodes(a,d)},DataURL:function(a,c){c.dataURL={};this.readChildNodes(a,c.dataURL)},FeatureListURL:function(a,c){c.featureListURL={};this.readChildNodes(a,c.featureListURL)},AuthorityURL:function(a,c){var d=a.getAttribute("name"),e={};this.readChildNodes(a,e);c.authorityURLs[d]=e.href},Identifier:function(a,c){var d=a.getAttribute("authority");c.identifiers[d]=this.getChildValue(a)},KeywordList:function(a,c){this.readChildNodes(a,c)},SRS:function(a,c){c.srs[this.getChildValue(a)]=
true}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});
OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,c){this.readChildNodes(a,c)},Keyword:function(a,c){c.keywords&&c.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,c){c.describelayer={formats:[]};this.readChildNodes(a,c.describelayer)},GetLegendGraphic:function(a,c){c.getlegendgraphic={formats:[]};this.readChildNodes(a,c.getlegendgraphic)},GetStyles:function(a,c){c.getstyles=
{formats:[]};this.readChildNodes(a,c.getstyles)},PutStyles:function(a,c){c.putstyles={formats:[]};this.readChildNodes(a,c.putstyles)},UserDefinedSymbolization:function(a,c){var d={supportSLD:parseInt(a.getAttribute("SupportSLD"))==1,userLayer:parseInt(a.getAttribute("UserLayer"))==1,userStyle:parseInt(a.getAttribute("UserStyle"))==1,remoteWFS:parseInt(a.getAttribute("RemoteWFS"))==1};c.userSymbols=d},LatLonBoundingBox:function(a,c){c.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),
parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,c){var d=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,c]);d.srs=a.getAttribute("SRS");c.bbox[d.srs]=d},ScaleHint:function(a,c){var d=a.getAttribute("min"),e=a.getAttribute("max"),f=Math.pow(2,0.5),g=OpenLayers.INCHES_PER_UNIT.m;c.maxScale=parseFloat((d/f*g*OpenLayers.DOTS_PER_INCH).toPrecision(13));c.minScale=parseFloat((e/f*g*OpenLayers.DOTS_PER_INCH).toPrecision(13))},
Dimension:function(a,c){var d={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};c.dimensions[d.name]=d},Extent:function(a,c){var d=a.getAttribute("name").toLowerCase();if(d in c.dimensions){d=c.dimensions[d];d.nearestVal=a.getAttribute("nearestValue")==="1";d.multipleVal=a.getAttribute("multipleValues")==="1";d.current=a.getAttribute("current")==="1";d["default"]=a.getAttribute("default")||"";var e=this.getChildValue(a);d.values=e.split(",")}}},
OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,c){for(var d=this.getChildValue(a).split(/ +/),e=0,f=d.length;e<f;e++)c.srs[d[e]]=true}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});
OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);if(!a.format)this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,
geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions));!a.geometryName&&parseFloat(this.format.version)>1&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||{});var c=new OpenLayers.Protocol.Response({requestType:"read"}),
d=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers,data:d});return c},setFeatureType:function(a){this.featureType=a;this.format.featureType=a},setGeometryName:function(a){this.geometryName=a;this.format.geometryName=a},handleRead:function(a,c){c=OpenLayers.Util.extend({},c);OpenLayers.Util.applyDefaults(c,this.options);if(c.callback){var d=
a.priv;if(d.status>=200&&d.status<300)if((d=this.parseResponse(d,c.readOptions))&&d.success!==false){c.readOptions&&c.readOptions.output=="object"?OpenLayers.Util.extend(a,d):a.features=d;a.code=OpenLayers.Protocol.Response.SUCCESS}else{a.code=OpenLayers.Protocol.Response.FAILURE;a.error=d}else a.code=OpenLayers.Protocol.Response.FAILURE;c.callback.call(c.scope,a)}},parseResponse:function(a,c){var d=a.responseXML;if(!d||!d.documentElement)d=a.responseText;if(!d||d.length<=0)return null;d=this.readFormat!==
null?this.readFormat.read(d):this.format.read(d,c);if(!this.featureNS){var e=this.readFormat||this.format;this.featureNS=e.featureNS;e.autoConfig=false;this.geometryName||this.setGeometryName(e.geometryName)}return d},commit:function(a,c){c=OpenLayers.Util.extend({},c);OpenLayers.Util.applyDefaults(c,this.options);var d=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});d.priv=OpenLayers.Request.POST({url:c.url,headers:c.headers,data:this.format.write(a,c),callback:this.createCallback(this.handleCommit,
d,c)});return d},handleCommit:function(a,c){if(c.callback){var d=a.priv,e=d.responseXML;if(!e||!e.documentElement)e=d.responseText;d=this.format.read(e)||{};a.insertIds=d.insertIds||[];if(d.success)a.code=OpenLayers.Protocol.Response.SUCCESS;else{a.code=OpenLayers.Protocol.Response.FAILURE;a.error=d}c.callback.call(c.scope,a)}},filterDelete:function(a,c){c=OpenLayers.Util.extend({},c);OpenLayers.Util.applyDefaults(c,this.options);new OpenLayers.Protocol.Response({requestType:"commit"});var d=this.format.createElementNSPlus("wfs:Transaction",
{attributes:{service:"WFS",version:this.version}}),e=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(c.featureNS?this.featurePrefix+":":"")+c.featureType}});c.featureNS&&e.setAttribute("xmlns:"+this.featurePrefix,c.featureNS);var f=this.format.writeNode("ogc:Filter",a);e.appendChild(f);d.appendChild(e);d=OpenLayers.Format.XML.prototype.write.apply(this.format,[d]);return OpenLayers.Request.POST({url:this.url,callback:c.callback||function(){},data:d})},abort:function(a){a&&a.priv.abort()},
CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});
OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,c,d,e){OpenLayers.Handler.prototype.initialize.apply(this,[a,d,e]);this.layer=
c},touchstart:function(a){if(!this.touch){this.touch=true;this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})}return OpenLayers.Event.isMultiTouch(a)?true:this.mousedown(a)},touchmove:function(a){OpenLayers.Event.stop(a)},mousedown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.down=a.xy;return this.handle(a)?!this.stopDown:true},mouseup:function(a){this.up=a.xy;return this.handle(a)?
!this.stopUp:true},click:function(a){return this.handle(a)?!this.stopClick:true},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return true;this.handle(a);return true},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)>-1},handle:function(a){if(this.feature&&!this.feature.layer)this.feature=null;var c=a.type,d=false,e=!!this.feature,f=c=="click"||c=="dblclick"||
c=="touchstart";if((this.feature=this.layer.getFeatureFromEvent(a))&&!this.feature.layer)this.feature=null;if(this.lastFeature&&!this.lastFeature.layer)this.lastFeature=null;if(this.feature){c==="touchstart"&&OpenLayers.Event.stop(a);a=this.feature!=this.lastFeature;if(this.geometryTypeMatches(this.feature)){if(e&&a){this.lastFeature&&this.triggerCallback(c,"out",[this.lastFeature]);this.triggerCallback(c,"in",[this.feature])}else(!e||f)&&this.triggerCallback(c,"in",[this.feature]);this.lastFeature=
this.feature;d=true}else{this.lastFeature&&(e&&a||f)&&this.triggerCallback(c,"out",[this.lastFeature]);this.feature=null}}else this.lastFeature&&(e||f)&&this.triggerCallback(c,"out",[this.lastFeature]);return d},triggerCallback:function(a,c,d){(c=this.EVENTMAP[a][c])&&(a=="click"&&this.up&&this.down?Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(c,d):this.callback(c,d))},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,
arguments)){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.up=this.down=this.lastFeature=this.feature=null;this.touch=false;this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});a=true}return a},handleMapEvents:function(a){(a.type=="removelayer"||
a.property=="order")&&this.moveLayerToTop()},moveLayerToTop:function(){this.layer.setZIndex(Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});
OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var c=this.layers,d,e=0;e<c.length;e++)if(d=c[e].getFeatureFromEvent(a))return d},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);
this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,c=0;c<this.map.layers.length;++c){a=this.map.layers[c];OpenLayers.Util.indexOf(this.layers,a)!=-1&&a.renderer.moveRoot(this.renderer)}},resetRoots:function(){for(var a,c=0;c<this.layers.length;++c){a=this.layers[c];this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)}},handleChangeLayer:function(a){var c=a.layer;if(a.property=="order"&&OpenLayers.Util.indexOf(this.layers,
c)!=-1){this.resetRoots();this.collectRoots()}},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});
OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);if(this.scope===null)this.scope=this;this.initLayer(a);var d=
{click:this.clickFeature,clickout:this.clickoutFeature};if(this.hover){d.over=this.overFeature;d.out=this.outFeature}this.callbacks=OpenLayers.Util.extend(d,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box)this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"})},initLayer:function(a){if(OpenLayers.Util.isArray(a)){this.layers=a;this.layer=
new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})}else this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){if(!this.active){this.layers&&this.map.addLayer(this.layer);this.handlers.feature.activate();this.box&&this.handlers.box&&this.handlers.box.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},
deactivate:function(){if(this.active){this.handlers.feature.deactivate();this.handlers.box&&this.handlers.box.deactivate();this.layers&&this.map.removeLayer(this.layer)}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){for(var c=this.layers||[this.layer],d,e,f=0;f<c.length;++f){d=c[f];for(var g=d.selectedFeatures.length-1;g>=0;--g){e=d.selectedFeatures[g];(!a||a.except!=e)&&this.unselect(e)}}},clickFeature:function(a){if(!this.hover)if(OpenLayers.Util.indexOf(a.layer.selectedFeatures,
a)>-1)this.toggleSelect()?this.unselect(a):this.multipleSelect()||this.unselectAll({except:a});else{this.multipleSelect()||this.unselectAll({except:a});this.select(a)}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var c=
a.layer;this.hover&&(this.highlightOnly?this.highlight(a):OpenLayers.Util.indexOf(c.selectedFeatures,a)==-1&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var c=this.map.getControl(a._prevHighlighter);c&&c.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var c=a.layer;if(this.events.triggerEvent("beforefeaturehighlighted",{feature:a})!==
false){a._prevHighlighter=a._lastHighlighter;a._lastHighlighter=this.id;c.drawFeature(a,this.selectStyle||this.renderIntent);this.events.triggerEvent("featurehighlighted",{feature:a})}},unhighlight:function(a){var c=a.layer;if(a._prevHighlighter==void 0)delete a._lastHighlighter;else{if(a._prevHighlighter!=this.id)a._lastHighlighter=a._prevHighlighter;delete a._prevHighlighter}c.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var c=
this.onBeforeSelect.call(this.scope,a),d=a.layer;if(c!==false){c=d.events.triggerEvent("beforefeatureselected",{feature:a});if(c!==false){d.selectedFeatures.push(a);this.highlight(a);if(!this.handlers.feature.lastFeature)this.handlers.feature.lastFeature=d.selectedFeatures[0];d.events.triggerEvent("featureselected",{feature:a});this.onSelect.call(this.scope,a)}}},unselect:function(a){var c=a.layer;this.unhighlight(a);OpenLayers.Util.removeItem(c.selectedFeatures,a);c.events.triggerEvent("featureunselected",
{feature:a});this.onUnselect.call(this.scope,a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var c=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),c=new OpenLayers.Bounds(c.lon,c.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=true;var d=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:d});for(var e,f=0;f<d.length;++f){e=d[f];for(var g=0,h=e.features.length;g<h;++g){var i=
e.features[g];i.getVisibility()&&(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,i.geometry.CLASS_NAME)>-1)&&c.toGeometry().intersects(i.geometry)&&OpenLayers.Util.indexOf(e.selectedFeatures,i)==-1&&this.select(i)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:d})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&&this.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var c=this.active;this.unselectAll();
this.deactivate();if(this.layers){this.layer.destroy();this.layers=null}this.initLayer(a);this.handlers.feature.layer=this.layer;c&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});
OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,touch:!1,lastTouchPx:null,initialize:function(a,c,d){if(!d||!d.layerOptions||!d.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,
arguments))return false;var a=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return true},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();
this.layer.addFeatures([this.point],{silent:true})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return false;this.cancel();if(this.layer.map!=null){this.destroyFeature(true);this.layer.destroy(false)}this.layer=null;this.touch=false;return true},destroyFeature:function(a){this.layer&&(a||!this.persist)&&this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&&a.features.length>1&&this.layer.features[0].destroy()},
finalize:function(a){this.mouseDown=false;this.lastTouchPx=this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(true)},click:function(a){OpenLayers.Event.stop(a);return false},dblclick:function(a){OpenLayers.Event.stop(a);return false},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",
[this.point.geometry,this.point,false]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){if(!this.touch){this.touch=true;this.map.events.un({mousedown:this.mousedown,
mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})}this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy;return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=true;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){!this.touch&&
(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy);return true},up:function(a){this.mouseDown=false;this.stoppedDown=this.stopDown;if(this.checkModifiers(a)&&(!this.lastUp||!this.lastUp.equals(a.xy))&&this.lastDown&&this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)){this.touch&&this.modifyFeature(a.xy);this.persist&&this.destroyPersistedFeature();this.lastUp=a.xy;this.finalize();return!this.stopUp}return true},mouseout:function(a){if(OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)){this.stoppedDown=
this.stopDown;this.mouseDown=false}},passesTolerance:function(a,c,d){var e=true;d!=null&&a&&c&&a.distanceTo(c)>d&&(e=false);return e},CLASS_NAME:"OpenLayers.Handler.Point"});
OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);
this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:true})},destroyFeature:function(a){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&&a.features.length>2&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a.lon,
a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,c){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(a,c),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,c){var d=this.line.geometry.components[this.getCurrentPointIndex()-
1];d&&!isNaN(d.x)&&!isNaN(d.y)&&this.insertXY(d.x+a,d.y+c)},insertDirectionLength:function(a,c){var a=a*(Math.PI/180),d=c*Math.cos(a),e=c*Math.sin(a);this.insertDeltaXY(d,e)},insertDeflectionLength:function(a,c){var d=this.getCurrentPointIndex()-1;if(d>0){var e=this.line.geometry.components[d],d=this.line.geometry.components[d-1];this.insertDirectionLength(Math.atan2(e.y-d.y,e.x-d.x)*180/Math.PI+a,c)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var a=
this.line.geometry,c=a.components,d=this.getCurrentPointIndex()-1,c=c[d];if(a=a.removeComponent(c)){if(!this.redoStack)this.redoStack=[];this.redoStack.push(c);this.drawFeature()}return a},redo:function(){var a=this.redoStack&&this.redoStack.pop();if(a){this.line.geometry.addComponent(a,this.getCurrentPointIndex());this.drawFeature()}return!!a},freehandMode:function(a){return this.freehandToggle&&a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,c){this.line||this.createFeature(a);
var d=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=d.lon;this.point.geometry.y=d.lat;this.callback("modify",[this.point.geometry,this.getSketch(),c]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=this.line&&this.line.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiLineString([a]));return a},
touchstart:function(a){if(this.timerId&&this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance)){this.finishGeometry();window.clearTimeout(this.timerId);this.timerId=null;return false}if(this.timerId){window.clearTimeout(this.timerId);this.timerId=null}this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this,a)},down:function(a){var c=this.stopDown;if(this.freehandMode(a)){c=true;if(this.touch){this.modifyFeature(a.xy,
!!this.lastUp);OpenLayers.Event.stop(a)}}!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))&&this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=true;this.lastDown=a.xy;this.stoppedDown=c;return!c},move:function(a){if(this.stoppedDown&&this.freehandMode(a)){this.persist&&this.destroyPersistedFeature();if(this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices){this.removePoint();this.finalize()}else this.addPoint(a.xy);return false}!this.touch&&
(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy,!!this.lastUp);return true},up:function(a){if(this.mouseDown&&(!this.lastUp||!this.lastUp.equals(a.xy)))if(this.stoppedDown&&this.freehandMode(a)){this.persist&&this.destroyPersistedFeature();this.removePoint();this.finalize()}else if(this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)){this.touch&&this.modifyFeature(a.xy);this.lastUp==null&&this.persist&&this.destroyPersistedFeature();this.addPoint(a.xy);this.lastUp=a.xy;this.line.geometry.components.length===
this.maxVertices+1&&this.finishGeometry()}this.stoppedDown=this.stopDown;this.mouseDown=false;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return false},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Spherical=OpenLayers.Spherical||{};OpenLayers.Spherical.DEFAULT_RADIUS=6378137;
OpenLayers.Spherical.computeDistanceBetween=function(a,c,d){var d=d||OpenLayers.Spherical.DEFAULT_RADIUS,e=Math.sin(Math.PI*(c.lon-a.lon)/360),f=Math.sin(Math.PI*(c.lat-a.lat)/360),a=f*f+e*e*Math.cos(Math.PI*a.lat/180)*Math.cos(Math.PI*c.lat/180);return 2*d*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};
OpenLayers.Spherical.computeHeading=function(a,c){var d=Math.sin(Math.PI*(a.lon-c.lon)/180)*Math.cos(Math.PI*c.lat/180),e=Math.cos(Math.PI*a.lat/180)*Math.sin(Math.PI*c.lat/180)-Math.sin(Math.PI*a.lat/180)*Math.cos(Math.PI*c.lat/180)*Math.cos(Math.PI*(a.lon-c.lon)/180);return 180*Math.atan2(d,e)/Math.PI};
OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var c,d=this.layers||a.layers;for(c=d.length-1;c>=0;--c)this.addLayer({layer:d[c]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.cache,scope:this})},removeLayer:function(a){a.layer.events.un({tileloadstart:this.makeSameOrigin,
tileloaded:this.cache,scope:this})},makeSameOrigin:function(a){if(this.active){a=a.tile;if(a instanceof OpenLayers.Tile.Image&&!a.crossOriginKeyword&&a.url.substr(0,5)!=="data:"){var c=OpenLayers.Request.makeSameOrigin(a.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[c]=a.url;a.url=c}}},cache:function(a){if(this.active&&window.localStorage){a=a.tile;if(a instanceof OpenLayers.Tile.Image&&a.url.substr(0,5)!=="data:")try{var c=a.getCanvasContext();if(c){var d=OpenLayers.Control.CacheWrite.urlMap;
window.localStorage.setItem("olCache_"+(d[a.url]||a.url),c.canvas.toDataURL(this.imageFormat));delete d[a.url]}}catch(e){(c=e.name||e.message)&&this.quotaRegEx.test(c)?this.events.triggerEvent("cachefull",{tile:a}):OpenLayers.Console.error(e.toString())}}},destroy:function(){if(this.layers||this.map){var a,c=this.layers||this.map.layers;for(a=c.length-1;a>=0;--a)this.removeLayer({layer:c[a]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,
arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"});OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var a,c;for(a=window.localStorage.length-1;a>=0;--a){c=window.localStorage.key(a);c.substr(0,8)==="olCache_"&&window.localStorage.removeItem(c)}}};OpenLayers.Control.CacheWrite.urlMap={};
OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);a={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,a)])},
CLASS_NAME:"OpenLayers.Control.PanPanel"});
OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,
addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&&this.map.layers){for(var c=0,d=this.map.layers.length;c<d;c++){var e=this.map.layers[c];e.attribution&&e.getVisibility()&&OpenLayers.Util.indexOf(a,e.attribution)===-1&&a.push(e.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});
OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,c){this.readChildNodes(a,c)},LayerLimit:function(a,c){c.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,c){c.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,c){c.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,c){var d=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,
[a,c]);d.srs=a.getAttribute("CRS");c.bbox[d.srs]=d},CRS:function(a,c){this.readers.wms.SRS.apply(this,[a,c])},EX_GeographicBoundingBox:function(a,c){c.llbbox=[];this.readChildNodes(a,c.llbbox)},westBoundLongitude:function(a,c){c[0]=this.getChildValue(a)},eastBoundLongitude:function(a,c){c[2]=this.getChildValue(a)},southBoundLatitude:function(a,c){c[1]=this.getChildValue(a)},northBoundLatitude:function(a,c){c[3]=this.getChildValue(a)},MinScaleDenominator:function(a,c){c.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},
MaxScaleDenominator:function(a,c){c.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,c){var d={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:a.getAttribute("nearestValue")==="1",multipleVal:a.getAttribute("multipleValues")==="1","default":a.getAttribute("default")||"",current:a.getAttribute("current")==="1",values:this.getChildValue(a).split(",")};c.dimensions[d.name]=d},Keyword:function(a,
c){var d={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};c.keywords&&c.keywords.push(d)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,c){this.readers.wms.UserDefinedSymbolization.apply(this,[a,c]);c.userSymbols.inlineFeature=parseInt(a.getAttribute("InlineFeature"))==1;c.userSymbols.remoteWCS=parseInt(a.getAttribute("RemoteWCS"))==1},DescribeLayer:function(a,c){this.readers.wms.DescribeLayer.apply(this,[a,c])},GetLegendGraphic:function(a,
c){this.readers.wms.GetLegendGraphic.apply(this,[a,c])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});
OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,c,d,e){var f=[],d=OpenLayers.Util.upperCaseObject(d);if(parseFloat(d.VERSION)>=1.3&&!d.EXCEPTIONS)d.EXCEPTIONS="INIMAGE";f.push(a,c,d,e);OpenLayers.Layer.Grid.prototype.initialize.apply(this,f);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));
if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(e==null||!e.isBaseLayer)this.isBaseLayer=false;if(this.params.FORMAT=="image/jpeg")this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}},clone:function(a){a==null&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return parseFloat(this.params.VERSION)>=
1.3&&!(!this.yx[a]&&!OpenLayers.Projection.defaults[a].yx)},getURL:function(a){var a=this.adjustBounds(a),c=this.getImageSize(),d={},e=this.reverseAxisOrder();d.BBOX=this.encodeBBOX?a.toBBOX(null,e):a.toArray(e);d.WIDTH=c.w;d.HEIGHT=c.h;return this.getFullRequestString(d)},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,c){var d=this.map.getProjectionObject(),d=this.projection&&this.projection.equals(d)?
this.projection.getCode():d.getCode(),d=d=="none"?null:d;parseFloat(this.params.VERSION)>=1.3?this.params.CRS=d:this.params.SRS=d;if(typeof this.params.TRANSPARENT=="boolean")a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE";return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});
OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(a){var c=this.getParser(),d={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,"abstract":a.metadata["abstract"],dataURL:a.metadata.dataURL,metadataURL:a.metadataURL,server:{version:a.params.VERSION,url:a.url},maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity==1?void 0:
a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.singleTile||!a.tileSize?void 0:{width:a.tileSize.w,height:a.tileSize.h},minScale:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:void 0,maxScale:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:void 0,formats:[],styles:[],srs:a.srs,dimensions:a.dimensions};if(a.metadata.servertitle)d.server.title=a.metadata.servertitle;
if(a.metadata.formats&&a.metadata.formats.length>0)for(var e=0,f=a.metadata.formats.length;e<f;e++){var g=a.metadata.formats[e];d.formats.push({value:g.value,current:g.value==a.params.FORMAT})}else d.formats.push({value:a.params.FORMAT,current:true});if(a.metadata.styles&&a.metadata.styles.length>0){e=0;for(f=a.metadata.styles.length;e<f;e++){c=a.metadata.styles[e];c.current=c.href==a.params.SLD||c.body==a.params.SLD_BODY||c.name==a.params.STYLES?true:false;d.styles.push(c)}}else d.styles.push({href:a.params.SLD,
body:a.params.SLD_BODY,name:a.params.STYLES||c.defaultStyleName,title:c.defaultStyleTitle,current:true});return d},toContext:function(a){var c={},d=a.layers;if(a.CLASS_NAME=="OpenLayers.Map"){var e=a.metadata||{};c.size=a.getSize();c.bounds=a.getExtent();c.projection=a.projection;c.title=a.title;c.keywords=e.keywords;c["abstract"]=e["abstract"];c.logo=e.logo;c.descriptionURL=e.descriptionURL;c.contactInformation=e.contactInformation;c.maxExtent=a.maxExtent}else{OpenLayers.Util.applyDefaults(c,a);
c.layers!=void 0&&delete c.layers}if(c.layersContext==void 0)c.layersContext=[];if(d!=void 0&&OpenLayers.Util.isArray(d)){a=0;for(e=d.length;a<e;a++){var f=d[a];f instanceof OpenLayers.Layer.WMS&&c.layersContext.push(this.layerToContext(f))}}return c},CLASS_NAME:"OpenLayers.Format.WMC"});
OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var c=null;if(a==null)c=this.namespaces[this.defaultPrefix];else for(c in this.namespaces)if(this.namespaces[c]==a)break;return c},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",
defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=a.documentElement;this.rootPrefix=a.prefix;var c={version:a.getAttribute("version")};this.runChildNodes(c,a);return c},runChildNodes:function(a,c){for(var d=c.childNodes,e,f,g,h=0,i=d.length;h<i;++h){e=d[h];if(e.nodeType==1){f=this.getNamespacePrefix(e.namespaceURI);g=e.nodeName.split(":").pop();
(f=this["read_"+f+"_"+g])&&f.apply(this,[a,e])}}},read_wmc_General:function(a,c){this.runChildNodes(a,c)},read_wmc_BoundingBox:function(a,c){a.projection=c.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(c.getAttribute("minx"),c.getAttribute("miny"),c.getAttribute("maxx"),c.getAttribute("maxy"))},read_wmc_LayerList:function(a,c){a.layersContext=[];this.runChildNodes(a,c)},read_wmc_Layer:function(a,c){var d={visibility:c.getAttribute("hidden")!="1",queryable:c.getAttribute("queryable")=="1",formats:[],
styles:[],metadata:{}};this.runChildNodes(d,c);a.layersContext.push(d)},read_wmc_Extension:function(a,c){this.runChildNodes(a,c)},read_ol_units:function(a,c){a.units=this.getChildValue(c)},read_ol_maxExtent:function(a,c){var d=new OpenLayers.Bounds(c.getAttribute("minx"),c.getAttribute("miny"),c.getAttribute("maxx"),c.getAttribute("maxy"));a.maxExtent=d},read_ol_transparent:function(a,c){a.transparent=this.getChildValue(c)},read_ol_numZoomLevels:function(a,c){a.numZoomLevels=parseInt(this.getChildValue(c))},
read_ol_opacity:function(a,c){a.opacity=parseFloat(this.getChildValue(c))},read_ol_singleTile:function(a,c){a.singleTile=this.getChildValue(c)=="true"},read_ol_tileSize:function(a,c){var d={width:c.getAttribute("width"),height:c.getAttribute("height")};a.tileSize=d},read_ol_isBaseLayer:function(a,c){a.isBaseLayer=this.getChildValue(c)=="true"},read_ol_displayInLayerSwitcher:function(a,c){a.displayInLayerSwitcher=this.getChildValue(c)=="true"},read_wmc_Server:function(a,c){a.version=c.getAttribute("version");
a.url=this.getOnlineResource_href(c);a.metadata.servertitle=c.getAttribute("title")},read_wmc_FormatList:function(a,c){this.runChildNodes(a,c)},read_wmc_Format:function(a,c){var d={value:this.getChildValue(c)};if(c.getAttribute("current")=="1")d.current=true;a.formats.push(d)},read_wmc_StyleList:function(a,c){this.runChildNodes(a,c)},read_wmc_Style:function(a,c){var d={};this.runChildNodes(d,c);if(c.getAttribute("current")=="1")d.current=true;a.styles.push(d)},read_wmc_SLD:function(a,c){this.runChildNodes(a,
c)},read_sld_StyledLayerDescriptor:function(a,c){var d=OpenLayers.Format.XML.prototype.write.apply(this,[c]);a.body=d},read_sld_FeatureTypeStyle:function(a,c){var d=OpenLayers.Format.XML.prototype.write.apply(this,[c]);a.body=d},read_wmc_OnlineResource:function(a,c){a.href=this.getAttributeNS(c,this.namespaces.xlink,"href")},read_wmc_Name:function(a,c){var d=this.getChildValue(c);if(d)a.name=d},read_wmc_Title:function(a,c){var d=this.getChildValue(c);if(d)a.title=d},read_wmc_MetadataURL:function(a,
c){a.metadataURL=this.getOnlineResource_href(c)},read_wmc_KeywordList:function(a,c){a.keywords=[];this.runChildNodes(a.keywords,c)},read_wmc_Keyword:function(a,c){a.push(this.getChildValue(c))},read_wmc_Abstract:function(a,c){var d=this.getChildValue(c);d&&(a["abstract"]=d)},read_wmc_LogoURL:function(a,c){a.logo={width:c.getAttribute("width"),height:c.getAttribute("height"),format:c.getAttribute("format"),href:this.getOnlineResource_href(c)}},read_wmc_DescriptionURL:function(a,c){a.descriptionURL=
this.getOnlineResource_href(c)},read_wmc_ContactInformation:function(a,c){var d={};this.runChildNodes(d,c);a.contactInformation=d},read_wmc_ContactPersonPrimary:function(a,c){var d={};this.runChildNodes(d,c);a.personPrimary=d},read_wmc_ContactPerson:function(a,c){var d=this.getChildValue(c);if(d)a.person=d},read_wmc_ContactOrganization:function(a,c){var d=this.getChildValue(c);if(d)a.organization=d},read_wmc_ContactPosition:function(a,c){var d=this.getChildValue(c);if(d)a.position=d},read_wmc_ContactAddress:function(a,
c){var d={};this.runChildNodes(d,c);a.contactAddress=d},read_wmc_AddressType:function(a,c){var d=this.getChildValue(c);if(d)a.type=d},read_wmc_Address:function(a,c){var d=this.getChildValue(c);if(d)a.address=d},read_wmc_City:function(a,c){var d=this.getChildValue(c);if(d)a.city=d},read_wmc_StateOrProvince:function(a,c){var d=this.getChildValue(c);if(d)a.stateOrProvince=d},read_wmc_PostCode:function(a,c){var d=this.getChildValue(c);if(d)a.postcode=d},read_wmc_Country:function(a,c){var d=this.getChildValue(c);
if(d)a.country=d},read_wmc_ContactVoiceTelephone:function(a,c){var d=this.getChildValue(c);if(d)a.phone=d},read_wmc_ContactFacsimileTelephone:function(a,c){var d=this.getChildValue(c);if(d)a.fax=d},read_wmc_ContactElectronicMailAddress:function(a,c){var d=this.getChildValue(c);if(d)a.email=d},read_wmc_DataURL:function(a,c){a.dataURL=this.getOnlineResource_href(c)},read_wmc_LegendURL:function(a,c){var d={width:c.getAttribute("width"),height:c.getAttribute("height"),format:c.getAttribute("format"),
href:this.getOnlineResource_href(c)};a.legend=d},read_wmc_DimensionList:function(a,c){a.dimensions={};this.runChildNodes(a.dimensions,c)},read_wmc_Dimension:function(a,c){var d={name:c.getAttribute("name").toLowerCase(),units:c.getAttribute("units")||"",unitSymbol:c.getAttribute("unitSymbol")||"",userValue:c.getAttribute("userValue")||"",nearestValue:c.getAttribute("nearestValue")==="1",multipleValues:c.getAttribute("multipleValues")==="1",current:c.getAttribute("current")==="1","default":c.getAttribute("default")||
""},e=this.getChildValue(c);d.values=e.split(",");a[d.name]=d},write:function(a,c){var d=this.createElementDefaultNS("ViewContext");this.setAttributes(d,{version:this.VERSION,id:c&&typeof c.id=="string"?c.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(d,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);d.appendChild(this.write_wmc_General(a));d.appendChild(this.write_wmc_LayerList(a));return OpenLayers.Format.XML.prototype.write.apply(this,[d])},createElementDefaultNS:function(a,
c,d){a=this.createElementNS(this.namespaces[this.defaultPrefix],a);c&&a.appendChild(this.createTextNode(c));d&&this.setAttributes(a,d);return a},setAttributes:function(a,c){var d,e;for(e in c){d=c[e].toString();d.match(/[A-Z]/)?this.setAttributeNS(a,null,e,d):a.setAttribute(e,d)}},write_wmc_General:function(a){var c=this.createElementDefaultNS("General");a.size&&c.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}));var d=a.bounds;c.appendChild(this.createElementDefaultNS("BoundingBox",
null,{minx:d.left.toPrecision(18),miny:d.bottom.toPrecision(18),maxx:d.right.toPrecision(18),maxy:d.top.toPrecision(18),SRS:a.projection}));c.appendChild(this.createElementDefaultNS("Title",a.title));a.keywords&&c.appendChild(this.write_wmc_KeywordList(a.keywords));a["abstract"]&&c.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.logo&&c.appendChild(this.write_wmc_URLType("LogoURL",a.logo.href,a.logo));a.descriptionURL&&c.appendChild(this.write_wmc_URLType("DescriptionURL",a.descriptionURL));
a.contactInformation&&c.appendChild(this.write_wmc_ContactInformation(a.contactInformation));c.appendChild(this.write_ol_MapExtension(a));return c},write_wmc_KeywordList:function(a){for(var c=this.createElementDefaultNS("KeywordList"),d=0,e=a.length;d<e;d++)c.appendChild(this.createElementDefaultNS("Keyword",a[d]));return c},write_wmc_ContactInformation:function(a){var c=this.createElementDefaultNS("ContactInformation");a.personPrimary&&c.appendChild(this.write_wmc_ContactPersonPrimary(a.personPrimary));
a.position&&c.appendChild(this.createElementDefaultNS("ContactPosition",a.position));a.contactAddress&&c.appendChild(this.write_wmc_ContactAddress(a.contactAddress));a.phone&&c.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",a.phone));a.fax&&c.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",a.fax));a.email&&c.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",a.email));return c},write_wmc_ContactPersonPrimary:function(a){var c=this.createElementDefaultNS("ContactPersonPrimary");
a.person&&c.appendChild(this.createElementDefaultNS("ContactPerson",a.person));a.organization&&c.appendChild(this.createElementDefaultNS("ContactOrganization",a.organization));return c},write_wmc_ContactAddress:function(a){var c=this.createElementDefaultNS("ContactAddress");a.type&&c.appendChild(this.createElementDefaultNS("AddressType",a.type));a.address&&c.appendChild(this.createElementDefaultNS("Address",a.address));a.city&&c.appendChild(this.createElementDefaultNS("City",a.city));a.stateOrProvince&&
c.appendChild(this.createElementDefaultNS("StateOrProvince",a.stateOrProvince));a.postcode&&c.appendChild(this.createElementDefaultNS("PostCode",a.postcode));a.country&&c.appendChild(this.createElementDefaultNS("Country",a.country));return c},write_ol_MapExtension:function(a){var c=this.createElementDefaultNS("Extension");if(a=a.maxExtent){var d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18),
maxy:a.top.toPrecision(18)});c.appendChild(d)}return c},write_wmc_LayerList:function(a){for(var c=this.createElementDefaultNS("LayerList"),d=0,e=a.layersContext.length;d<e;++d)c.appendChild(this.write_wmc_Layer(a.layersContext[d]));return c},write_wmc_Layer:function(a){var c=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});c.appendChild(this.write_wmc_Server(a));c.appendChild(this.createElementDefaultNS("Name",a.name));c.appendChild(this.createElementDefaultNS("Title",
a.title));a["abstract"]&&c.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.dataURL&&c.appendChild(this.write_wmc_URLType("DataURL",a.dataURL));a.metadataURL&&c.appendChild(this.write_wmc_URLType("MetadataURL",a.metadataURL));return c},write_wmc_LayerExtension:function(a){var c=this.createElementDefaultNS("Extension"),d=a.maxExtent,e=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(e,{minx:d.left.toPrecision(18),miny:d.bottom.toPrecision(18),maxx:d.right.toPrecision(18),
maxy:d.top.toPrecision(18)});c.appendChild(e);if(a.tileSize&&!a.singleTile){d=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(d,a.tileSize);c.appendChild(d)}for(var d=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"],f=0,g=d.length;f<g;++f)(e=this.createOLPropertyNode(a,d[f]))&&c.appendChild(e);return c},createOLPropertyNode:function(a,c){var d=null;if(a[c]!=null){d=this.createElementNS(this.namespaces.ol,"ol:"+c);d.appendChild(this.createTextNode(a[c].toString()))}return d},
write_wmc_Server:function(a){var a=a.server,c=this.createElementDefaultNS("Server"),d={service:"OGC:WMS",version:a.version};if(a.title)d.title=a.title;this.setAttributes(c,d);c.appendChild(this.write_wmc_OnlineResource(a.url));return c},write_wmc_URLType:function(a,c,d){a=this.createElementDefaultNS(a);a.appendChild(this.write_wmc_OnlineResource(c));if(d)for(var c=["width","height","format"],e=0;e<c.length;e++)c[e]in d&&a.setAttribute(c[e],d[c[e]]);return a},write_wmc_DimensionList:function(a){var c=
this.createElementDefaultNS("DimensionList"),d;for(d in a.dimensions){var e={},f=a.dimensions[d],g;for(g in f)e[g]=typeof f[g]=="boolean"?Number(f[g]):f[g];f="";if(e.values){f=e.values.join(",");delete e.values}c.appendChild(this.createElementDefaultNS("Dimension",f,e))}return c},write_wmc_FormatList:function(a){for(var c=this.createElementDefaultNS("FormatList"),d=0,e=a.formats.length;d<e;d++){var f=a.formats[d];c.appendChild(this.createElementDefaultNS("Format",f.value,f.current&&f.current==true?
{current:"1"}:null))}return c},write_wmc_StyleList:function(a){var c=this.createElementDefaultNS("StyleList");if((a=a.styles)&&OpenLayers.Util.isArray(a))for(var d,e=0,f=a.length;e<f;e++){var g=a[e],h=this.createElementDefaultNS("Style",null,g.current&&g.current==true?{current:"1"}:null);if(g.href){d=this.createElementDefaultNS("SLD");g.name&&d.appendChild(this.createElementDefaultNS("Name",g.name));g.title&&d.appendChild(this.createElementDefaultNS("Title",g.title));g.legend&&d.appendChild(this.write_wmc_URLType("LegendURL",
g.legend.href,g.legend));g=this.write_wmc_OnlineResource(g.href);d.appendChild(g);h.appendChild(d)}else if(g.body){d=this.createElementDefaultNS("SLD");g.name&&d.appendChild(this.createElementDefaultNS("Name",g.name));g.title&&d.appendChild(this.createElementDefaultNS("Title",g.title));g.legend&&d.appendChild(this.write_wmc_URLType("LegendURL",g.legend.href,g.legend));g=OpenLayers.Format.XML.prototype.read.apply(this,[g.body]).documentElement;d.ownerDocument&&d.ownerDocument.importNode&&(g=d.ownerDocument.importNode(g,
true));d.appendChild(g);h.appendChild(d)}else{h.appendChild(this.createElementDefaultNS("Name",g.name));h.appendChild(this.createElementDefaultNS("Title",g.title));g["abstract"]&&h.appendChild(this.createElementDefaultNS("Abstract",g["abstract"]));g.legend&&h.appendChild(this.write_wmc_URLType("LegendURL",g.legend.href,g.legend))}c.appendChild(h)}return c},write_wmc_OnlineResource:function(a){var c=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(c,this.namespaces.xlink,"xlink:type",
"simple");this.setAttributeNS(c,this.namespaces.xlink,"xlink:href",a);return c},getOnlineResource_href:function(a){var c={},a=a.getElementsByTagName("OnlineResource");a.length>0&&this.read_wmc_OnlineResource(c,a[0]);return c.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});
OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_sld_MinScaleDenominator:function(a,c){var d=parseFloat(this.getChildValue(c));if(d>0)a.maxScale=d},read_sld_MaxScaleDenominator:function(a,c){a.minScale=parseFloat(this.getChildValue(c))},read_wmc_SRS:function(a,c){if(!("srs"in
a))a.srs={};a.srs[this.getChildValue(c)]=true},write_wmc_Layer:function(a){var c=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);if(a.maxScale){var d=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");d.appendChild(this.createTextNode(a.maxScale.toPrecision(16)));c.appendChild(d)}if(a.minScale){d=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");d.appendChild(this.createTextNode(a.minScale.toPrecision(16)));c.appendChild(d)}if(a.srs)for(var e in a.srs)c.appendChild(this.createElementDefaultNS("SRS",
e));c.appendChild(this.write_wmc_FormatList(a));c.appendChild(this.write_wmc_StyleList(a));a.dimensions&&c.appendChild(this.write_wmc_DimensionList(a));c.appendChild(this.write_wmc_LayerExtension(a));return c},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"});
OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(a,c){OpenLayers.Util.applyDefaults(c,this.options);var d={};this.readChildNodes(a,d);return d},readers:{xls:{XLS:function(a,c){c.version=a.getAttribute("version");
this.readChildNodes(a,c)},Response:function(a,c){this.readChildNodes(a,c)},GeocodeResponse:function(a,c){c.responseLists=[];this.readChildNodes(a,c)},GeocodeResponseList:function(a,c){var d={features:[],numberOfGeocodedAddresses:parseInt(a.getAttribute("numberOfGeocodedAddresses"))};c.responseLists.push(d);this.readChildNodes(a,d)},GeocodedAddress:function(a,c){var d=new OpenLayers.Feature.Vector;c.features.push(d);this.readChildNodes(a,d);d.geometry=d.components[0]},GeocodeMatchCode:function(a,c){c.attributes.matchCode=
{accuracy:parseFloat(a.getAttribute("accuracy")),matchType:a.getAttribute("matchType")}},Address:function(a,c){var d={countryCode:a.getAttribute("countryCode"),addressee:a.getAttribute("addressee"),street:[],place:[]};c.attributes.address=d;this.readChildNodes(a,d)},freeFormAddress:function(a,c){c.freeFormAddress=this.getChildValue(a)},StreetAddress:function(a,c){this.readChildNodes(a,c)},Building:function(a,c){c.building={number:a.getAttribute("number"),subdivision:a.getAttribute("subdivision"),
buildingName:a.getAttribute("buildingName")}},Street:function(a,c){c.street.push(this.getChildValue(a))},Place:function(a,c){c.place[a.getAttribute("type")]=this.getChildValue(a)},PostalCode:function(a,c){c.postalCode=this.getChildValue(a)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(a){return this.writers.xls.XLS.apply(this,[a])},writers:{xls:{XLS:function(a){var c=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});
this.writeNode("RequestHeader",a.header,c);this.writeNode("Request",a,c);return c},RequestHeader:function(){return this.createElementNSPlus("xls:RequestHeader")},Request:function(a){var c=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:a.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",a.addresses,c);return c},GeocodeRequest:function(a){for(var c=this.createElementNSPlus("xls:GeocodeRequest"),d=0,e=a.length;d<e;d++)this.writeNode("Address",
a[d],c);return c},Address:function(a){var c=this.createElementNSPlus("xls:Address",{attributes:{countryCode:a.countryCode}});if(a.freeFormAddress)this.writeNode("freeFormAddress",a.freeFormAddress,c);else{a.street&&this.writeNode("StreetAddress",a,c);a.municipality&&this.writeNode("Municipality",a.municipality,c);a.countrySubdivision&&this.writeNode("CountrySubdivision",a.countrySubdivision,c);a.postalCode&&this.writeNode("PostalCode",a.postalCode,c)}return c},freeFormAddress:function(a){return this.createElementNSPlus("freeFormAddress",
{value:a})},StreetAddress:function(a){var c=this.createElementNSPlus("xls:StreetAddress");a.building&&this.writeNode(c,"Building",a.building);a=a.street;OpenLayers.Util.isArray(a)||(a=[a]);for(var d=0,e=a.length;d<e;d++)this.writeNode("Street",a[d],c);return c},Building:function(a){return this.createElementNSPlus("xls:Building",{attributes:{number:a.number,subdivision:a.subdivision,buildingName:a.buildingName}})},Street:function(a){return this.createElementNSPlus("xls:Street",{value:a})},Municipality:function(a){return this.createElementNSPlus("xls:Place",
{attributes:{type:"Municipality"},value:a})},CountrySubdivision:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:a})},PostalCode:function(a){return this.createElementNSPlus("xls:PostalCode",{value:a})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"});
OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;
OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){if(this.supported()){OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.symbolMetrics={}}},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG",
"1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(a,c,d){a=a+(d?0:this.translationParameters.x);c=c+(d?0:this.translationParameters.y);return a>=-this.MAX_PIXEL&&a<=this.MAX_PIXEL&&c>=-this.MAX_PIXEL&&c<=this.MAX_PIXEL},setExtent:function(a,c){var d=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),e=this.getResolution(),f=-a.left/e,e=a.top/e;if(c){this.left=f;this.top=e;this.rendererRoot.setAttributeNS(null,
"viewBox","0 0 "+this.size.w+" "+this.size.h);this.translate(this.xOffset,0);return true}(f=this.translate(f-this.left+this.xOffset,e-this.top))||this.setExtent(a,true);return d&&f},translate:function(a,c){if(this.inValidRange(a,c,true)){var d="";if(a||c)d="translate("+a+","+c+")";this.root.setAttributeNS(null,"transform",d);this.translationParameters={x:a,y:c};return true}return false},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,
"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,c){var d=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":d=c.externalGraphic?"image":this.isComplexSymbol(c.graphicName)?"svg":"circle";break;case "OpenLayers.Geometry.Rectangle":d="rect";break;case "OpenLayers.Geometry.LineString":d="polyline";break;case "OpenLayers.Geometry.LinearRing":d="polygon";break;case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":d="path"}return d},
setStyle:function(a,c,d){var c=c||a._style,d=d||a._options,e=parseFloat(a.getAttributeNS(null,"r")),f=1,g;if(a._geometryClass=="OpenLayers.Geometry.Point"&&e){a.style.visibility="";if(c.graphic===false)a.style.visibility="hidden";else if(c.externalGraphic){g=this.getPosition(a);if(c.graphicTitle){a.setAttributeNS(null,"title",c.graphicTitle);e=a.getElementsByTagName("title");if(e.length>0)e[0].firstChild.textContent=c.graphicTitle;else{e=this.nodeFactory(null,"title");e.textContent=c.graphicTitle;
a.appendChild(e)}}c.graphicWidth&&c.graphicHeight&&a.setAttributeNS(null,"preserveAspectRatio","none");var e=c.graphicWidth||c.graphicHeight,h=c.graphicHeight||c.graphicWidth,e=e?e:c.pointRadius*2,h=h?h:c.pointRadius*2,i=c.graphicYOffset!=void 0?c.graphicYOffset:-(0.5*h),j=c.graphicOpacity||c.fillOpacity;a.setAttributeNS(null,"x",(g.x+(c.graphicXOffset!=void 0?c.graphicXOffset:-(0.5*e))).toFixed());a.setAttributeNS(null,"y",(g.y+i).toFixed());a.setAttributeNS(null,"width",e);a.setAttributeNS(null,
"height",h);a.setAttributeNS(this.xlinkns,"href",c.externalGraphic);a.setAttributeNS(null,"style","opacity: "+j);a.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(c.graphicName)){var e=c.pointRadius*3,h=e*2,k=this.importSymbol(c.graphicName);g=this.getPosition(a);f=this.symbolMetrics[k.id][0]*3/h;i=a.parentNode;j=a.nextSibling;i&&i.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(k.firstChild.cloneNode(true));a.setAttributeNS(null,"viewBox",k.getAttributeNS(null,
"viewBox"));a.setAttributeNS(null,"width",h);a.setAttributeNS(null,"height",h);a.setAttributeNS(null,"x",g.x-e);a.setAttributeNS(null,"y",g.y-e);j?i.insertBefore(a,j):i&&i.appendChild(a)}else a.setAttributeNS(null,"r",c.pointRadius);e=c.rotation;if((e!==void 0||a._rotation!==void 0)&&g){a._rotation=e;e=e|0;if(a.nodeName!=="svg")a.setAttributeNS(null,"transform","rotate("+e+" "+g.x+" "+g.y+")");else{g=this.symbolMetrics[k.id];a.firstChild.setAttributeNS(null,"transform","rotate("+e+" "+g[1]+" "+g[2]+
")")}}}if(d.isFilled){a.setAttributeNS(null,"fill",c.fillColor);a.setAttributeNS(null,"fill-opacity",c.fillOpacity)}else a.setAttributeNS(null,"fill","none");if(d.isStroked){a.setAttributeNS(null,"stroke",c.strokeColor);a.setAttributeNS(null,"stroke-opacity",c.strokeOpacity);a.setAttributeNS(null,"stroke-width",c.strokeWidth*f);a.setAttributeNS(null,"stroke-linecap",c.strokeLinecap||"round");a.setAttributeNS(null,"stroke-linejoin","round");c.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",
this.dashStyle(c,f))}else a.setAttributeNS(null,"stroke","none");c.pointerEvents&&a.setAttributeNS(null,"pointer-events",c.pointerEvents);c.cursor!=null&&a.setAttributeNS(null,"cursor",c.cursor);return a},dashStyle:function(a,c){var d=a.strokeWidth*c,e=a.strokeDashstyle;switch(e){case "solid":return"none";case "dot":return[1,4*d].join();case "dash":return[4*d,4*d].join();case "dashdot":return[4*d,4*d,1,4*d].join();case "longdash":return[8*d,4*d].join();case "longdashdot":return[8*d,4*d,1,4*d].join();
default:return OpenLayers.String.trim(e).replace(/\s+/g,",")}},createNode:function(a,c){var d=document.createElementNS(this.xmlns,a);c&&d.setAttributeNS(null,"id",c);return d},nodeTypeCompare:function(a,c){return c==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");
this.rendererRoot.appendChild(a);return a},drawPoint:function(a,c){return this.drawCircle(a,c,1)},drawCircle:function(a,c,d){var e=this.getResolution(),f=(c.x-this.featureDx)/e+this.left,c=this.top-c.y/e;if(this.inValidRange(f,c)){a.setAttributeNS(null,"cx",f);a.setAttributeNS(null,"cy",c);a.setAttributeNS(null,"r",d);return a}return false},drawLineString:function(a,c){var d=this.getComponentsString(c.components);if(d.path){a.setAttributeNS(null,"points",d.path);return d.complete?a:null}return false},
drawLinearRing:function(a,c){var d=this.getComponentsString(c.components);if(d.path){a.setAttributeNS(null,"points",d.path);return d.complete?a:null}return false},drawPolygon:function(a,c){for(var d="",e=true,f=true,g,h,i=0,j=c.components.length;i<j;i++){d=d+" M";g=this.getComponentsString(c.components[i].components," ");if(h=g.path){d=d+(" "+h);f=g.complete&&f}else e=false}if(e){a.setAttributeNS(null,"d",d+" z");a.setAttributeNS(null,"fill-rule","evenodd");return f?a:null}return false},drawRectangle:function(a,
c){var d=this.getResolution(),e=(c.x-this.featureDx)/d+this.left,f=this.top-c.y/d;if(this.inValidRange(e,f)){a.setAttributeNS(null,"x",e);a.setAttributeNS(null,"y",f);a.setAttributeNS(null,"width",c.width/d);a.setAttributeNS(null,"height",c.height/d);return a}return false},drawText:function(a,c,d){var e=!!c.labelOutlineWidth;if(e){var f=OpenLayers.Util.extend({},c);f.fontColor=f.labelOutlineColor;f.fontStrokeColor=f.labelOutlineColor;f.fontStrokeWidth=c.labelOutlineWidth;delete f.labelOutlineWidth;
this.drawText(a,f,d)}var g=this.getResolution(),f=(d.x-this.featureDx)/g+this.left,h=d.y/g-this.top,e=e?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,g=this.nodeFactory(a+e,"text");g.setAttributeNS(null,"x",f);g.setAttributeNS(null,"y",-h);c.fontColor&&g.setAttributeNS(null,"fill",c.fontColor);c.fontStrokeColor&&g.setAttributeNS(null,"stroke",c.fontStrokeColor);c.fontStrokeWidth&&g.setAttributeNS(null,"stroke-width",c.fontStrokeWidth);c.fontOpacity&&g.setAttributeNS(null,"opacity",c.fontOpacity);
c.fontFamily&&g.setAttributeNS(null,"font-family",c.fontFamily);c.fontSize&&g.setAttributeNS(null,"font-size",c.fontSize);c.fontWeight&&g.setAttributeNS(null,"font-weight",c.fontWeight);c.fontStyle&&g.setAttributeNS(null,"font-style",c.fontStyle);if(c.labelSelect===true){g.setAttributeNS(null,"pointer-events","visible");g._featureId=a}else g.setAttributeNS(null,"pointer-events","none");h=c.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;g.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[h[0]]||
"middle");OpenLayers.IS_GECKO===true&&g.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[h[1]]||"central");for(var i=c.label.split("\n"),j=i.length;g.childNodes.length>j;)g.removeChild(g.lastChild);for(var k=0;k<j;k++){var l=this.nodeFactory(a+e+"_tspan_"+k,"tspan");if(c.labelSelect===true){l._featureId=a;l._geometry=d;l._geometryClass=d.CLASS_NAME}OpenLayers.IS_GECKO===false&&l.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[h[1]]||"-35%");l.setAttribute("x",
f);if(k==0){var m=OpenLayers.Renderer.SVG.LABEL_VFACTOR[h[1]];m==null&&(m=-0.5);l.setAttribute("dy",m*(j-1)+"em")}else l.setAttribute("dy","1em");l.textContent=i[k]===""?" ":i[k];l.parentNode||g.appendChild(l)}g.parentNode||this.textRoot.appendChild(g)},getComponentsString:function(a,c){for(var d=[],e=true,f=a.length,g=[],h,i=0;i<f;i++){h=a[i];d.push(h);if(h=this.getShortString(h))g.push(h);else{i>0&&this.getShortString(a[i-1])&&g.push(this.clipLine(a[i],a[i-1]));i<f-1&&this.getShortString(a[i+1])&&
g.push(this.clipLine(a[i],a[i+1]));e=false}}return{path:g.join(c||","),complete:e}},clipLine:function(a,c){if(c.equals(a))return"";var d=this.getResolution(),e=this.MAX_PIXEL-this.translationParameters.x,f=this.MAX_PIXEL-this.translationParameters.y,g=(c.x-this.featureDx)/d+this.left,h=this.top-c.y/d,i=(a.x-this.featureDx)/d+this.left,d=this.top-a.y/d,j;if(i<-e||i>e){j=(d-h)/(i-g);i=i<0?-e:e;d=h+(i-g)*j}if(d<-f||d>f){j=(i-g)/(d-h);d=d<0?-f:f;i=g+(d-h)*j}return i+","+d},getShortString:function(a){var c=
this.getResolution(),d=(a.x-this.featureDx)/c+this.left,a=this.top-a.y/c;return this.inValidRange(d,a)?d+","+a:false},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){if(!this.defs)this.defs=this.createDefs();var c=this.container.id+"-"+a,d=document.getElementById(c);if(d!=null)return d;var e=OpenLayers.Renderer.symbol[a];if(!e)throw Error(a+" is not a valid symbol name");var a=this.nodeFactory(c,"symbol"),
f=this.nodeFactory(null,"polygon");a.appendChild(f);for(var d=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),g=[],h,i,j=0;j<e.length;j=j+2){h=e[j];i=e[j+1];d.left=Math.min(d.left,h);d.bottom=Math.min(d.bottom,i);d.right=Math.max(d.right,h);d.top=Math.max(d.top,i);g.push(h,",",i)}f.setAttributeNS(null,"points",g.join(" "));e=d.getWidth();f=d.getHeight();a.setAttributeNS(null,"viewBox",[d.left-e,d.bottom-f,e*3,f*3].join(" "));this.symbolMetrics[c]=[Math.max(e,f),d.getCenterLonLat().lon,
d.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var c=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!c){c=a.target;c=c.parentNode&&c!=this.rendererRoot?c.parentNode._featureId:void 0}return c},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};
OpenLayers.Renderer.SVG.preventDefault=function(a){a.preventDefault&&a.preventDefault()};OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});
OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(a,c){var d=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);if(d==="0.3.0")d=this.defaultVersion;return d},toContext:function(a){var c={};if(a.CLASS_NAME=="OpenLayers.Map"){c.bounds=a.getExtent();c.maxExtent=a.maxExtent;c.projection=a.projection;c.size=a.getSize();c.layers=a.layers}return c},CLASS_NAME:"OpenLayers.Format.OWSContext"});
OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",
defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(a){if(a.layersContext)for(var c=0,d=a.layersContext.length;c<d;c++){var e=
a.layersContext[c],f=[],g=a.title||"";a.metadata&&a.metadata.nestingPath&&(f=a.metadata.nestingPath.slice());g!=""&&f.push(g);e.metadata.nestingPath=f;e.layersContext&&this.setNestingPath(e)}},decomposeNestingPath:function(a){var c=[];if(OpenLayers.Util.isArray(a)){for(a=a.slice();a.length>0;){c.push(a.slice());a.pop()}c.reverse()}return c},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,
c);this.setNestingPath({layersContext:c.layersContext});a=[];this.processLayer(a,c);delete c.layersContext;c.layersContext=a;return c},processLayer:function(a,c){if(c.layersContext)for(var d=0,e=c.layersContext.length;d<e;d++){var f=c.layersContext[d];a.push(f);f.layersContext&&this.processLayer(a,f)}},write:function(a,c){this.nestingLayerLookup={};c=c||{};OpenLayers.Util.applyDefaults(c,a);var d=this.writeNode("OWSContext",c);this.nestingLayerLookup=null;this.setAttributeNS(d,this.namespaces.xsi,
"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[d])},readers:{kml:{Document:function(a,c){c.features=(new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:true})).read(a)}},owc:{OWSContext:function(a,c){this.readChildNodes(a,c)},General:function(a,c){this.readChildNodes(a,c)},ResourceList:function(a,c){this.readChildNodes(a,c)},Layer:function(a,c){var d={metadata:{},visibility:a.getAttribute("hidden")!="1",queryable:a.getAttribute("queryable")==
"1",opacity:a.getAttribute("opacity")!=null?parseFloat(a.getAttribute("opacity")):null,name:a.getAttribute("name"),categoryLayer:a.getAttribute("name")==null,formats:[],styles:[]};if(!c.layersContext)c.layersContext=[];c.layersContext.push(d);this.readChildNodes(a,d)},InlineGeometry:function(a,c){c.features=[];var d=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember"),e;d.length>=1&&(e=d[0]);if(e&&e.firstChild){d=e.firstChild.nextSibling?e.firstChild.nextSibling:e.firstChild;this.setNamespace("feature",
d.namespaceURI);this.featureType=d.localName||d.nodeName.split(":").pop();this.readChildNodes(a,c)}},Server:function(a,c){if(!c.service&&!c.version||c.service!=OpenLayers.Format.Context.serviceTypes.WMS){c.service=a.getAttribute("service");c.version=a.getAttribute("version");this.readChildNodes(a,c)}},Name:function(a,c){c.name=this.getChildValue(a);this.readChildNodes(a,c)},Title:function(a,c){c.title=this.getChildValue(a);this.readChildNodes(a,c)},StyleList:function(a,c){this.readChildNodes(a,c.styles)},
Style:function(a,c){var d={};c.push(d);this.readChildNodes(a,d)},LegendURL:function(a,c){var d={};c.legend=d;this.readChildNodes(a,d)},OnlineResource:function(a,c){c.url=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,c)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(a){var c=
this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:a.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",a,c);this.writeNode("ResourceList",a,c);return c},General:function(a){var c=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",a,c);this.writeNode("ows:Title",a.title||"OpenLayers OWSContext",c);return c},ResourceList:function(a){for(var c=this.createElementNSPlus("ResourceList"),d=0,e=a.layers.length;d<e;d++){var f=
a.layers[d],g=this.decomposeNestingPath(f.metadata.nestingPath);this.writeNode("_Layer",{layer:f,subPaths:g},c)}return c},Server:function(a){var c=this.createElementNSPlus("Server",{attributes:{version:a.version,service:a.service}});this.writeNode("OnlineResource",a,c);return c},OnlineResource:function(a){return this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":a.url}})},InlineGeometry:function(a){var c=this.createElementNSPlus("InlineGeometry");this.writeNode("gml:boundedBy",a.getDataExtent(),
c);for(var d=0,e=a.features.length;d<e;d++)this.writeNode("gml:featureMember",a.features[d],c);return c},StyleList:function(a){for(var c=this.createElementNSPlus("StyleList"),d=0,e=a.length;d<e;d++)this.writeNode("Style",a[d],c);return c},Style:function(a){var c=this.createElementNSPlus("Style");this.writeNode("Name",a,c);this.writeNode("Title",a,c);a.legend&&this.writeNode("LegendURL",a,c);return c},Name:function(a){return this.createElementNSPlus("Name",{value:a.name})},Title:function(a){return this.createElementNSPlus("Title",
{value:a.title})},LegendURL:function(a){var c=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",a.legend,c);return c},_WMS:function(a){var c=this.createElementNSPlus("Layer",{attributes:{name:a.params.LAYERS,queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1",opacity:a.hasOwnProperty("opacity")?a.opacity:null}});this.writeNode("ows:Title",a.name,c);this.writeNode("ows:OutputFormat",a.params.FORMAT,c);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,
version:a.params.VERSION,url:a.url},c);a.metadata.styles&&a.metadata.styles.length>0&&this.writeNode("StyleList",a.metadata.styles,c);return c},_Layer:function(a){var c,d,e;c=a.layer;d=a.subPaths;e=null;if(d.length>0){c=d[0].join("/");d=c.lastIndexOf("/");e=this.nestingLayerLookup[c];d=d>0?c.substring(d+1,c.length):c;if(!e){e=this.createElementNSPlus("Layer");this.writeNode("ows:Title",d,e);this.nestingLayerLookup[c]=e}a.subPaths.shift();this.writeNode("_Layer",a,e)}else{if(c instanceof OpenLayers.Layer.WMS)e=
this.writeNode("_WMS",c);else if(c instanceof OpenLayers.Layer.Vector)if(c.protocol instanceof OpenLayers.Protocol.WFS.v1)e=this.writeNode("_WFS",c);else if(c.protocol instanceof OpenLayers.Protocol.HTTP)if(c.protocol.format instanceof OpenLayers.Format.GML){c.protocol.format.version="2.1.2";e=this.writeNode("_GML",c)}else{if(c.protocol.format instanceof OpenLayers.Format.KML){c.protocol.format.version="2.2";e=this.writeNode("_KML",c)}}else{this.setNamespace("feature",this.featureNS);e=this.writeNode("_InlineGeometry",
c)}c.options.maxScale&&this.writeNode("sld:MinScaleDenominator",c.options.maxScale,e);c.options.minScale&&this.writeNode("sld:MaxScaleDenominator",c.options.minScale,e);this.nestingLayerLookup[c.name]=e}return e},_WFS:function(a){var c=this.createElementNSPlus("Layer",{attributes:{name:a.protocol.featurePrefix+":"+a.protocol.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,c);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:a.protocol.version,
url:a.protocol.url},c);return c},_InlineGeometry:function(a){var c=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,c);this.writeNode("InlineGeometry",a,c);return c},_GML:function(a){var c=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,c);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:a.protocol.url,version:a.protocol.format.version},c);return c},_KML:function(a){var c=
this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,c);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:a.protocol.format.version,url:a.protocol.url},c);return c}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(a){var c=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",a,c);return c}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,
feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});
OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.eTop=document.createElement("div");this.eTop.className=this.displayClass+"Top";this.div.appendChild(this.eTop);this.eTop.style.visibility=this.topOutUnits==""||this.topInUnits==""?"hidden":"visible";this.eBottom=document.createElement("div");
this.eBottom.className=this.displayClass+"Bottom";this.div.appendChild(this.eBottom);this.eBottom.style.visibility=this.bottomOutUnits==""||this.bottomInUnits==""?"hidden":"visible"}this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var c=parseInt(Math.log(a)/Math.log(10)),c=Math.pow(10,c),a=parseInt(a/c);return(a>5?5:a>2?2:1)*c},update:function(){var a=this.map.getResolution();if(a){var c=this.map.getUnits(),d=OpenLayers.INCHES_PER_UNIT,e=this.maxWidth*
a*d[c],f=1;if(this.geodesic===true){f=(this.map.getGeodesicPixelSize().w||1.0E-6)*this.maxWidth/(e/d.km);e=e*f}var g,h;if(e>1E5){g=this.topOutUnits;h=this.bottomOutUnits}else{g=this.topInUnits;h=this.bottomInUnits}var i=e/d[g],j=e/d[h],e=this.getBarLen(i),k=this.getBarLen(j),i=e/d[c]*d[g],j=k/d[c]*d[h],c=i/a/f,a=j/a/f;if(this.eBottom.style.visibility=="visible"){this.eBottom.style.width=Math.round(a)+"px";this.eBottom.innerHTML=k+" "+h}if(this.eTop.style.visibility=="visible"){this.eTop.style.width=
Math.round(c)+"px";this.eTop.innerHTML=e+" "+g}}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});
OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);this.removeButtons();this.position=this.buttons=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},
setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position;this.buttons=[];var c={w:18,h:18},d=new OpenLayers.Pixel(a.x+c.w/2,a.y);this._addButton("panup","north-mini.png",d,c);a.y=d.y+c.h;this._addButton("panleft","west-mini.png",a,c);this._addButton("panright","east-mini.png",a.add(c.w,0),c);this._addButton("pandown","south-mini.png",
d.add(0,c.h*2),c);this._addButton("zoomin","zoom-plus-mini.png",d.add(0,c.h*3+5),c);this._addButton("zoomworld","zoom-world-mini.png",d.add(0,c.h*4+5),c);this._addButton("zoomout","zoom-minus-mini.png",d.add(0,c.h*5+5),c);return this.div},_addButton:function(a,c,d,e){c=OpenLayers.Util.getImageLocation(c);d=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,d,e,c,"absolute");d.style.cursor="pointer";this.div.appendChild(d);d.action=a;d.className="olButton";this.buttons.push(d);return d},_removeButton:function(a){this.div.removeChild(a);
OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;a>=0;--a)this._removeButton(this.buttons[a])},onButtonClick:function(a){switch(a.buttonElement.action){case "panup":this.map.pan(0,-this.getSlideFactor("h"));break;case "pandown":this.map.pan(0,this.getSlideFactor("h"));break;case "panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case "panright":this.map.pan(this.getSlideFactor("w"),0);break;case "zoomin":this.map.zoomIn();break;case "zoomout":this.map.zoomOut();
break;case "zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;
OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){if(typeof this.padding=="number")this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding)},panMapIfOutOfView:!1,
keepInMap:!1,closeOnMove:!1,map:null,initialize:function(a,c,d,e,f,g){a==null&&(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=c;this.contentSize=d!=null?d:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(e!=null)this.contentHTML=e;this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;
this.groupDiv=OpenLayers.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null,"hidden");a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);f&&this.addCloseBox(g);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=
null;this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv)}this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;this.map!=null&&this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(a){a==null&&this.lonlat!=null&&
this.map!=null&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&this.map.events.register("movestart",this,this.hide);if(!this.disableFirefoxOverflowHack&&OpenLayers.BROWSER_NAME=="firefox"){this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");if(a!="hidden"){this.contentDiv._oldOverflow=a;this.contentDiv.style.overflow="hidden"}});this.map.events.register("moveend",this,function(){var a=
this.contentDiv._oldOverflow;if(a){this.contentDiv.style.overflow=a;this.contentDiv._oldOverflow=null}})}this.moveTo(a);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){if(a!=null&&this.div!=null){this.div.style.left=
a.x+"px";this.div.style.top=a.y+"px"}},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){if(this.div!=null)this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){if(this.div!=null)this.div.style.display="none"},setSize:function(a){this.size=a.clone();var c=this.getContentDivPadding(),d=c.left+c.right,e=c.top+c.bottom;this.fixPadding();if(this.padding){d=d+(this.padding.left+this.padding.right);
e=e+(this.padding.top+this.padding.bottom)}if(this.closeDiv)var f=parseInt(this.closeDiv.style.width),d=d+(f+c.right);this.size.w=this.size.w+d;this.size.h=this.size.h+e;if(OpenLayers.BROWSER_NAME=="msie"){this.contentSize.w=this.contentSize.w+(c.left+c.right);this.contentSize.h=this.contentSize.h+(c.bottom+c.top)}if(this.div!=null){this.div.style.width=this.size.w+"px";this.div.style.height=this.size.h+"px"}if(this.contentDiv!=null){this.contentDiv.style.width=a.w+"px";this.contentDiv.style.height=
a.h+"px"}},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",c=this.map?this.map.div:document.body,d=OpenLayers.Util.getRenderedDimensions(a,null,{displayClass:this.displayClass,containerElement:c}),e=this.getSafeContentSize(d),f=null;if(e.equals(d))f=d;else{d={w:e.w<d.w?e.w:null,h:e.h<d.h?e.h:null};if(d.w&&d.h)f=e;else{a=OpenLayers.Util.getRenderedDimensions(a,d,{displayClass:this.contentDisplayClass,containerElement:c});if(OpenLayers.Element.getStyle(this.contentDiv,
"overflow")!="hidden"&&a.equals(e)){e=OpenLayers.Util.getScrollbarWidth();d.w?a.h=a.h+e:a.w=a.w+e}f=this.getSafeContentSize(a)}}this.setSize(f)},setBackgroundColor:function(a){if(a!=void 0)this.backgroundColor=a;if(this.div!=null)this.div.style.backgroundColor=this.backgroundColor},setOpacity:function(a){if(a!=void 0)this.opacity=a;if(this.div!=null){this.div.style.opacity=this.opacity;this.div.style.filter="alpha(opacity="+this.opacity*100+")"}},setBorder:function(a){if(a!=void 0)this.border=a;if(this.div!=
null)this.div.style.border=this.border},setContentHTML:function(a){if(a!=null)this.contentHTML=a;if(this.contentDiv!=null&&this.contentHTML!=null&&this.contentHTML!=this.contentDiv.innerHTML){this.contentDiv.innerHTML=this.contentHTML;if(this.autoSize){this.registerImageListeners();this.updateSize()}}},registerImageListeners:function(){for(var a=function(){if(this.popup.id!==null){this.popup.updateSize();this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView();OpenLayers.Event.stopObserving(this.img,
"load",this.img._onImageLoad)}},c=this.contentDiv.getElementsByTagName("img"),d=0,e=c.length;d<e;d++){var f=c[d];if(f.width==0||f.height==0){f._onImgLoad=OpenLayers.Function.bind(a,{popup:this,img:f});OpenLayers.Event.observe(f,"load",f._onImgLoad)}}},getSafeContentSize:function(a){var a=a.clone(),c=this.getContentDivPadding(),d=c.left+c.right,e=c.top+c.bottom;this.fixPadding();if(this.padding){d=d+(this.padding.left+this.padding.right);e=e+(this.padding.top+this.padding.bottom)}if(this.closeDiv)var f=
parseInt(this.closeDiv.style.width),d=d+(f+c.right);if(this.minSize){a.w=Math.max(a.w,this.minSize.w-d);a.h=Math.max(a.h,this.minSize.h-e)}if(this.maxSize){a.w=Math.min(a.w,this.maxSize.w-d);a.h=Math.min(a.h,this.maxSize.h-e)}if(this.map&&this.map.size){f=c=0;if(this.keepInMap&&!this.panMapIfOutOfView){f=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case "tr":c=f.x;f=this.map.size.h-f.y;break;case "tl":c=this.map.size.w-f.x;f=this.map.size.h-f.y;break;case "bl":c=this.map.size.w-
f.x;f=f.y;break;case "br":c=f.x;f=f.y;break;default:c=f.x;f=this.map.size.h-f.y}}e=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-e-f;a.w=Math.min(a.w,this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-d-c);a.h=Math.min(a.h,e)}return a},getContentDivPadding:function(){var a=this._contentDivPadding;if(!a){if(this.div.parentNode==null){this.div.style.display="none";document.body.appendChild(this.div)}this._contentDivPadding=a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,
"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top"));if(this.div.parentNode==document.body){document.body.removeChild(this.div);this.div.style.display=""}}return a},addCloseBox:function(a){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var c=this.getContentDivPadding();this.closeDiv.style.right=
c.right+"px";this.closeDiv.style.top=c.top+"px";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();OpenLayers.Event.stop(a)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(a,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(a,this))},panIntoView:function(){var a=this.map.getSize(),c=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),
d=c.clone();if(c.x<this.map.paddingForPopups.left)d.x=this.map.paddingForPopups.left;else if(c.x+this.size.w>a.w-this.map.paddingForPopups.right)d.x=a.w-this.map.paddingForPopups.right-this.size.w;if(c.y<this.map.paddingForPopups.top)d.y=this.map.paddingForPopups.top;else if(c.y+this.size.h>a.h-this.map.paddingForPopups.bottom)d.y=a.h-this.map.paddingForPopups.bottom-this.size.h;this.map.pan(c.x-d.x,c.y-d.y)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,true);this.events.on({mousedown:this.onmousedown,
mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(a){OpenLayers.Event.stop(a,true)},scope:this})},onmousedown:function(a){this.mousedown=true;OpenLayers.Event.stop(a,true)},onmousemove:function(a){this.mousedown&&OpenLayers.Event.stop(a,true)},onmouseup:function(a){if(this.mousedown){this.mousedown=false;OpenLayers.Event.stop(a,true)}},onclick:function(a){OpenLayers.Event.stop(a,true)},onmouseout:function(){this.mousedown=
false},ondblclick:function(a){OpenLayers.Event.stop(a,true)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";
OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this})}return a},cacheFeatures:function(a){if(!this.paging){this.clearCache();
this.features=a.features;this.pageNext(a)}},clearCache:function(){if(this.features)for(var a=0;a<this.features.length;++a)this.features[a].destroy();this.num=this.features=null},pageCount:function(){return Math.ceil((this.features?this.features.length:0)/this.length)},pageNum:function(){return this.num},pageLength:function(a){if(a&&a>0)this.length=a;return this.length},pageNext:function(a){var c=false;if(this.features){if(this.num===null)this.num=-1;c=this.page((this.num+1)*this.length,a)}return c},
pagePrevious:function(){var a=false;if(this.features){if(this.num===null)this.num=this.pageCount();a=this.page((this.num-1)*this.length)}return a},page:function(a,c){var d=false;if(this.features&&a>=0&&a<this.features.length){var e=Math.floor(a/this.length);if(e!=this.num){this.paging=true;d=this.features.slice(a,a+this.length);this.layer.removeFeatures(this.layer.features);this.num=e;c&&c.features?c.features=d:this.layer.addFeatures(d);this.paging=false;d=true}}return d},CLASS_NAME:"OpenLayers.Strategy.Paging"});
OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,c,d,e,f,g,h){OpenLayers.Popup.prototype.initialize.apply(this,[a,c,d,e,g,h]);this.anchor=f!=null?f:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},
moveTo:function(a){var c=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);a=this.calculateNewPx(a);OpenLayers.Popup.prototype.moveTo.apply(this,Array(a));this.relativePosition!=c&&this.updateRelativePosition()},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},calculateRelativePosition:function(a){a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a);
return OpenLayers.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(a){var a=a.offset(this.anchor.offset),c=this.size||this.contentSize,d=this.relativePosition.charAt(0)=="t";a.y=a.y+(d?-c.h:this.anchor.size.h);d=this.relativePosition.charAt(1)=="l";a.x=a.x+(d?-c.w:this.anchor.size.w);return a},CLASS_NAME:"OpenLayers.Popup.Anchored"});
OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,c,d,e,f,g,h){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition){this.updateRelativePosition();this.calculateRelativePosition=function(){return this.relativePosition}}this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;if(g)this.closeDiv.style.zIndex=
1;this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=false;this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var c=this.blocks[a];c.image&&c.div.removeChild(c.image);c.image=null;c.div&&this.groupDiv.removeChild(c.div);c.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,
arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var c=
OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return c=c.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var a=null,c;for(c in this.positionBlocks){a=c;break}a=this.positionBlocks[a];for(c=0;c<a.blocks.length;c++){var d={};this.blocks.push(d);d.div=OpenLayers.Util.createDiv(this.id+"_FrameDecorationDiv_"+c,null,null,null,"absolute",null,"hidden",null);d.image=(this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(this.id+
"_FrameDecorationImg_"+c,null,this.imageSize,this.imageSrc,"absolute",null,null,null);d.div.appendChild(d.image);this.groupDiv.appendChild(d.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){for(var a=this.positionBlocks[this.relativePosition],c=0;c<a.blocks.length;c++){var d=a.blocks[c],e=this.blocks[c],f=d.anchor.left,g=d.anchor.bottom,h=d.anchor.right,i=d.anchor.top,j=isNaN(d.size.w)?this.size.w-(h+f):d.size.w,k=isNaN(d.size.h)?this.size.h-(g+
i):d.size.h;e.div.style.width=(j<0?0:j)+"px";e.div.style.height=(k<0?0:k)+"px";e.div.style.left=f!=null?f+"px":"";e.div.style.bottom=g!=null?g+"px":"";e.div.style.right=h!=null?h+"px":"";e.div.style.top=i!=null?i+"px":"";e.image.style.left=d.position.x+"px";e.image.style.top=d.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});
OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=a.documentElement;if(c)var d=this["read_"+c.nodeName],a=d?d.call(this,c):(new OpenLayers.Format.GML(this.options?this.options:{})).read(a);return a},read_msGMLOutput:function(a){var c=
[];if(a=this.getSiblingNodesByTagCriteria(a,this.layerIdentifier))for(var d=0,e=a.length;d<e;++d){var f=a[d],g=f.nodeName;f.prefix&&(g=g.split(":")[1]);g=g.replace(this.layerIdentifier,"");if(f=this.getSiblingNodesByTagCriteria(f,this.featureIdentifier))for(var h=0;h<f.length;h++){var i=f[h],j=this.parseGeometry(i),i=this.parseAttributes(i),i=new OpenLayers.Feature.Vector(j.geometry,i,null);i.bounds=j.bounds;i.type=g;c.push(i)}}return c},read_FeatureInfoResponse:function(a){for(var c=[],a=this.getElementsByTagNameNS(a,
"*","FIELDS"),d=0,e=a.length;d<e;d++){var f=a[d],g={},h,i=f.attributes.length;if(i>0)for(h=0;h<i;h++){var j=f.attributes[h];g[j.nodeName]=j.nodeValue}else{f=f.childNodes;h=0;for(i=f.length;h<i;++h){j=f[h];j.nodeType!=3&&(g[j.getAttribute("name")]=j.getAttribute("value"))}}c.push(new OpenLayers.Feature.Vector(null,g,null))}return c},getSiblingNodesByTagCriteria:function(a,c){var d=[],e,f,g,h;if(a&&a.hasChildNodes()){e=a.childNodes;g=e.length;for(var i=0;i<g;i++){for(h=e[i];h&&h.nodeType!=1;){h=h.nextSibling;
i++}f=h?h.nodeName:"";if(f.length>0&&f.indexOf(c)>-1)d.push(h);else{f=this.getSiblingNodesByTagCriteria(h,c);f.length>0&&(d.length==0?d=f:d.push(f))}}}return d},parseAttributes:function(a){var c={};if(a.nodeType==1)for(var a=a.childNodes,d=a.length,e=0;e<d;++e){var f=a[e];if(f.nodeType==1){var g=f.childNodes,f=f.prefix?f.nodeName.split(":")[1]:f.nodeName;if(g.length==0)c[f]=null;else if(g.length==1){g=g[0];if(g.nodeType==3||g.nodeType==4){g=g.nodeValue.replace(this.regExes.trimSpace,"");c[f]=g}}}}return c},
parseGeometry:function(a){if(!this.gmlFormat)this.gmlFormat=new OpenLayers.Format.GML;var a=this.gmlFormat.parseFeature(a),c,d=null;if(a){c=a.geometry&&a.geometry.clone();d=a.bounds&&a.bounds.clone();a.destroy()}return{geometry:c,bounds:d}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});
OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||!(typeof JSON.parse=="function"&&typeof JSON.stringify=="function"))}(),read:function(a,c){var d;if(this.nativeJSON)d=JSON.parse(a,c);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=eval("("+a+")");if(typeof c===
"function"){var e=function(a,d){if(d&&typeof d==="object")for(var f in d)d.hasOwnProperty(f)&&(d[f]=e(f,d[f]));return c(a,d)};d=e("",d)}}}catch(f){}if(this.keepData)this.data=d;return d},write:function(a,c){this.pretty=!!c;var d=null,e=typeof a;if(this.serialize[e])try{d=!this.pretty&&this.nativeJSON?JSON.stringify(a):this.serialize[e].apply(this,[a])}catch(f){OpenLayers.Console.error("Trouble serializing: "+f)}return d},writeIndent:function(){var a=[];if(this.pretty)for(var c=0;c<this.level;++c)a.push(this.indent);
return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(a==null)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var c=["{"];this.level=this.level+1;var d,e,f,g=false;for(d in a)if(a.hasOwnProperty(d)){e=OpenLayers.Format.JSON.prototype.write.apply(this,[d,this.pretty]);f=OpenLayers.Format.JSON.prototype.write.apply(this,
[a[d],this.pretty]);if(e!=null&&f!=null){g&&c.push(",");c.push(this.writeNewline(),this.writeIndent(),e,":",this.writeSpace(),f);g=true}}this.level=this.level-1;c.push(this.writeNewline(),this.writeIndent(),"}");return c.join("")},array:function(a){var c,d=["["];this.level=this.level+1;for(var e=0,f=a.length;e<f;++e){c=OpenLayers.Format.JSON.prototype.write.apply(this,[a[e],this.pretty]);if(c!=null){e>0&&d.push(",");d.push(this.writeNewline(),this.writeIndent(),c)}}this.level=this.level-1;d.push(this.writeNewline(),
this.writeIndent(),"]");return d.join("")},string:function(a){var c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,e){var f=c[e];if(f)return f;f=e.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?""+a:"null"},"boolean":function(a){return""+a},date:function(a){function c(a){return a<10?"0"+a:a}return'"'+
a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+"T"+c(a.getHours())+":"+c(a.getMinutes())+":"+c(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});
OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(a,c,d){var c=c?c:"FeatureCollection",e=null,f=null;if(f=typeof a=="string"?OpenLayers.Format.JSON.prototype.read.apply(this,[a,d]):a)if(typeof f.type!="string")OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else{if(this.isValidType(f,c))switch(c){case "Geometry":try{e=this.parseGeometry(f)}catch(g){OpenLayers.Console.error(g)}break;case "Feature":try{e=this.parseFeature(f);e.type="Feature"}catch(h){OpenLayers.Console.error(h)}break;
case "FeatureCollection":e=[];switch(f.type){case "Feature":try{e.push(this.parseFeature(f))}catch(i){e=null;OpenLayers.Console.error(i)}break;case "FeatureCollection":a=0;for(c=f.features.length;a<c;++a)try{e.push(this.parseFeature(f.features[a]))}catch(j){e=null;OpenLayers.Console.error(j)}break;default:try{var k=this.parseGeometry(f);e.push(new OpenLayers.Feature.Vector(k))}catch(l){e=null;OpenLayers.Console.error(l)}}}}else OpenLayers.Console.error("Bad JSON: "+a);return e},isValidType:function(a,
c){var d=false;switch(c){case "Geometry":OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],a.type)==-1?OpenLayers.Console.error("Unsupported geometry type: "+a.type):d=true;break;case "FeatureCollection":d=true;break;default:a.type==c?d=true:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+c)}return d},parseFeature:function(a){var c,d,e;d=a.properties?a.properties:{};e=a.geometry&&a.geometry.bbox||a.bbox;
try{c=this.parseGeometry(a.geometry)}catch(f){throw f;}c=new OpenLayers.Feature.Vector(c,d);if(e)c.bounds=OpenLayers.Bounds.fromArray(e);if(a.id)c.fid=a.id;return c},parseGeometry:function(a){if(a==null)return null;var c,d=false;if(a.type=="GeometryCollection"){if(!OpenLayers.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;c=a.geometries.length;for(var d=Array(c),e=0;e<c;++e)d[e]=this.parseGeometry.apply(this,[a.geometries[e]]);c=new OpenLayers.Geometry.Collection(d);
d=true}else{if(!OpenLayers.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{c=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(f){throw f;}}this.internalProjection&&this.externalProjection&&!d&&c.transform(this.externalProjection,this.internalProjection);return c},parseCoords:{point:function(a){if(this.ignoreExtraDims==false&&a.length!=2)throw"Only 2D points are supported: "+
a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var c=[],d=null,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.point.apply(this,[a[e]])}catch(g){throw g;}c.push(d)}return new OpenLayers.Geometry.MultiPoint(c)},linestring:function(a){for(var c=[],d=null,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.point.apply(this,[a[e]])}catch(g){throw g;}c.push(d)}return new OpenLayers.Geometry.LineString(c)},multilinestring:function(a){for(var c=[],d=null,e=0,f=a.length;e<f;++e){try{d=
this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c.push(d)}return new OpenLayers.Geometry.MultiLineString(c)},polygon:function(a){for(var c=[],d,e,f=0,g=a.length;f<g;++f){try{e=this.parseCoords.linestring.apply(this,[a[f]])}catch(h){throw h;}d=new OpenLayers.Geometry.LinearRing(e.components);c.push(d)}return new OpenLayers.Geometry.Polygon(c)},multipolygon:function(a){for(var c=[],d=null,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.polygon.apply(this,[a[e]])}catch(g){throw g;}c.push(d)}return new OpenLayers.Geometry.MultiPolygon(c)},
box:function(a){if(a.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,c){var d={type:null};if(OpenLayers.Util.isArray(a)){d.type="FeatureCollection";var e=
a.length;d.features=Array(e);for(var f=0;f<e;++f){var g=a[f];if(!g instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: "+g;d.features[f]=this.extract.feature.apply(this,[g])}}else if(a.CLASS_NAME.indexOf("OpenLayers.Geometry")==0)d=this.extract.geometry.apply(this,[a]);else if(a instanceof OpenLayers.Feature.Vector){d=this.extract.feature.apply(this,[a]);if(a.layer&&a.layer.projection)d.crs=this.createCRSObject(a)}return OpenLayers.Format.JSON.prototype.write.apply(this,
[d,c])},createCRSObject:function(a){var a=a.layer.projection.toString(),c={};if(a.match(/epsg:/i)){a=parseInt(a.substring(a.indexOf(":")+1));c=a==4326?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}}}return c},extract:{feature:function(a){var c=this.extract.geometry.apply(this,[a.geometry]),c={type:"Feature",properties:a.attributes,geometry:c};if(a.fid!=null)c.id=a.fid;return c},geometry:function(a){if(a==null)return null;if(this.internalProjection&&
this.externalProjection){a=a.clone();a.transform(this.internalProjection,this.externalProjection)}var c=a.CLASS_NAME.split(".")[2],a=this.extract[c.toLowerCase()].apply(this,[a]);return c=="Collection"?{type:"GeometryCollection",geometries:a}:{type:c,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extract.point.apply(this,[a.components[d]]));return c},linestring:function(a){for(var c=[],d=0,e=a.components.length;d<
e;++d)c.push(this.extract.point.apply(this,[a.components[d]]));return c},multilinestring:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extract.linestring.apply(this,[a.components[d]]));return c},polygon:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extract.linestring.apply(this,[a.components[d]]));return c},multipolygon:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extract.polygon.apply(this,[a.components[d]]));return c},collection:function(a){for(var c=
a.components.length,d=Array(c),e=0;e<c;++e)d[e]=this.extract.geometry.apply(this,[a.components[e]]);return d}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});
OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this});this.update()}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,
scope:this});return a},update:function(a){var c=this.getMapBounds();if(c!==null&&(a&&a.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(c))){this.calculateBounds(c);this.resolution=this.layer.map.getResolution();this.triggerRead(a)}},getMapBounds:function(){if(this.layer.map===null)return null;var a=this.layer.map.getExtent();a&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));
return a},invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);if(!a&&this.resFactor){a=this.resolution/this.layer.map.getResolution();a=a>=this.resFactor||a<=1/this.resFactor}return a},calculateBounds:function(a){a||(a=this.getMapBounds());var c=a.getCenterLonLat(),d=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(c.lon-d/2,c.lat-a/2,c.lon+d/2,c.lat+a/2)},triggerRead:function(a){if(this.response&&!(a&&a.noAbort===
true)){this.layer.protocol.abort(this.response);this.layer.events.triggerEvent("loadend")}this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:this.createFilter(),callback:this.merge,scope:this},a))},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,
filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();if((a=a.features)&&a.length>0){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c))for(var e,f=0,g=a.length;f<g;++f)(e=a[f].geometry)&&e.transform(c,d);this.layer.addFeatures(a)}this.response=null;this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"});
OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a,c){var d=this.readers.ogc._expression.call(this,a);if(d)c.priority=d},VendorOption:function(a,c){if(!c.vendorOptions)c.vendorOptions={};c.vendorOptions[a.getAttribute("name")]=this.getChildValue(a)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),
writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Priority",a)},VendorOption:function(a){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:a.name},value:a.value})},TextSymbolizer:function(a){var c=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(this,arguments);a.graphic!==false&&(a.externalGraphic||a.graphicName)&&this.writeNode("Graphic",a,c);"priority"in a&&
this.writeNode("Priority",a.priority,c);return this.addVendorOptions(c,a)},PointSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(this,arguments),a)},LineSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(this,arguments),a)},PolygonSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(this,
arguments),a)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(a,c){if(c.vendorOptions)for(var d in c.vendorOptions)this.writeNode("VendorOption",{name:d,value:c.vendorOptions[d]},a);return a},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"});
OpenLayers.Protocol.CSW=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.CSW.DEFAULTS),c=OpenLayers.Protocol.CSW["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported CSW version: "+a.version;return new c(a)};OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"};
OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(a){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);if(this.outputFormat&&!this.readFormat)if(this.outputFormat.toLowerCase()=="gml2")this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName});else if(this.outputFormat.toLowerCase()=="json")this.readFormat=new OpenLayers.Format.GeoJSON},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});
OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(a,c){if(!("layer"in c))throw Error("Missing property 'layer' in configuration.");for(var d=a.contents,e,f=0,g=d.layers.length;f<g;++f)if(d.layers[f].identifier===c.layer){e=d.layers[f];break}if(!e)throw Error("Layer not found");var h;c.matrixSet?h=d.tileMatrixSets[c.matrixSet]:e.tileMatrixSetLinks.length==1&&(h=d.tileMatrixSets[e.tileMatrixSetLinks[0].tileMatrixSet]);
if(!h)throw Error("matrixSet not found");for(var i,f=0,g=e.styles.length;f<g;++f){i=e.styles[f];if(i.isDefault)break}d=c.requestEncoding;if(!d){d="KVP";if(a.operationsMetadata.GetTile.dcp.http){f=a.operationsMetadata.GetTile.dcp.http;if(f.get[0].constraints){f=f.get[0].constraints;!f.GetEncoding.allowedValues.KVP&&f.GetEncoding.allowedValues.REST&&(d="REST")}}}f=[];g=c.params||{};delete c.params;for(var j=0,k=e.dimensions.length;j<k;j++){var l=e.dimensions[j];f.push(l.identifier);g.hasOwnProperty(l.identifier)||
(g[l.identifier]=l["default"])}j=c.projection||h.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3");k=c.units||j==="EPSG:4326"?"degrees":"m";l=[];if(c.isBaseLayer!==false)for(mid in h.matrixIds)h.matrixIds.hasOwnProperty(mid)&&l.push(h.matrixIds[mid].scaleDenominator*2.8E-4/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[k]);return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(c,{url:d==="REST"&&e.resourceUrl?e.resourceUrl.tile.template:a.operationsMetadata.GetTile.dcp.http.get[0].url,
requestEncoding:d,name:e.title,style:i.identifier,matrixIds:h.matrixIds,matrixSet:h.identifier,projection:j,units:k,resolutions:c.isBaseLayer===false?void 0:l,tileFullExtent:h.bounds,dimensions:f,params:g}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});
OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){if(!this.type)this.type=google.maps.MapTypeId.ROADMAP;var a,c=OpenLayers.Layer.Google.cache[this.map.id];if(c){a=c.mapObject;++c.count}else{c=this.map.viewPortDiv;a=document.createElement("div");a.id=this.map.id+"_GMapContainer";a.style.position="absolute";a.style.width="100%";a.style.height="100%";c.appendChild(a);c=this.map.getCenter();a=new google.maps.Map(a,{center:c?
new google.maps.LatLng(c.lat,c.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false});c={mapObject:a,count:1};OpenLayers.Layer.Google.cache[this.map.id]=c;this.repositionListener=google.maps.event.addListenerOnce(a,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this))}this.mapObject=a;this.setGMapVisibility(this.visibility)},
repositionMapElements:function(){google.maps.event.trigger(this.mapObject,"resize");var a=this.mapObject.getDiv().firstChild;if(!a||a.childNodes.length<3){this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250);return false}for(var c=OpenLayers.Layer.Google.cache[this.map.id],d=this.map.viewPortDiv,e=a.children.length-1;e>=0;--e){if(a.children[e].style.zIndex==1000001){var f=a.children[e];d.appendChild(f);f.style.zIndex="1100";f.style.bottom="";f.className=
"olLayerGoogleCopyright olLayerGoogleV3";f.style.display="";c.termsOfUse=f}if(a.children[e].style.zIndex==1E6){f=a.children[e];d.appendChild(f);f.style.zIndex="1100";f.style.bottom="";f.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint";f.style.display="";c.poweredBy=f}a.children[e].style.zIndex==10000002&&d.appendChild(a.children[e])}this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility)google.maps.event.trigger(this.mapObject,"resize");else{var a=OpenLayers.Layer.Google.cache[this.map.id];
if(!a.resized){var c=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){google.maps.event.trigger(c.mapObject,"resize");c.moveTo(c.map.getCenter(),c.map.getZoom());delete a.resized})}a.resized=true}},setGMapVisibility:function(a){var c=OpenLayers.Layer.Google.cache[this.map.id];if(c){for(var d=this.type,e=this.map.layers,f,g=e.length-1;g>=0;--g){f=e[g];if(f instanceof OpenLayers.Layer.Google&&f.visibility===true&&f.inRange===true){d=f.type;a=true;break}}e=this.mapObject.getDiv();
if(a===true){this.mapObject.setMapTypeId(d);e.style.left="";if(c.termsOfUse&&c.termsOfUse.style){c.termsOfUse.style.left="";c.termsOfUse.style.display="";c.poweredBy.style.display=""}c.displayed=this.id}else{delete c.displayed;e.style.left="-9999px";if(c.termsOfUse&&c.termsOfUse.style){c.termsOfUse.style.display="none";c.termsOfUse.style.left="-9999px";c.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(a){var c=null;
if(a!=null){c=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left);a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right);c=new google.maps.LatLngBounds(new google.maps.LatLng(c.lat,c.lon),new google.maps.LatLng(a.lat,a.lon))}return c},getMapObjectLonLatFromMapObjectPixel:function(a){var c=this.map.getSize(),d=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),e=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),
f=this.map.getResolution(),a=new OpenLayers.LonLat(d+(a.x-c.w/2)*f,e-(a.y-c.h/2)*f);this.wrapDateLine&&(a=a.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(a.lon,a.lat)},getMapObjectPixelFromMapObjectLonLat:function(a){var c=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),d=this.map.getResolution(),e=this.map.getExtent();return this.getMapObjectPixelFromXY(1/d*(c-e.left),1/d*(e.top-a))},setMapObjectCenter:function(a,c){if(this.animationEnabled===
false&&c!=this.mapObject.zoom){var d=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){d.style.visibility=""});d.style.visibility="hidden"}this.mapObject.setOptions({center:a,zoom:c})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,c){var d;if(this.sphericalMercator){d=this.inverseMercator(a,c);d=new google.maps.LatLng(d.lat,d.lon)}else d=new google.maps.LatLng(c,a);return d},
getMapObjectPixelFromXY:function(a,c){return new google.maps.Point(a,c)},destroy:function(){this.repositionListener&&google.maps.event.removeListener(this.repositionListener);this.repositionTimer&&window.clearTimeout(this.repositionTimer);OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}};
OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);return c},readers:{wps:{ProcessDescriptions:function(a,c){c.processDescriptions={};this.readChildNodes(a,c.processDescriptions)},ProcessDescription:function(a,c){var d={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion"),statusSupported:a.getAttribute("statusSupported")==="true",storeSupported:a.getAttribute("storeSupported")==="true"};this.readChildNodes(a,d);c[d.identifier]=d},DataInputs:function(a,
c){c.dataInputs=[];this.readChildNodes(a,c.dataInputs)},ProcessOutputs:function(a,c){c.processOutputs=[];this.readChildNodes(a,c.processOutputs)},Output:function(a,c){var d={};this.readChildNodes(a,d);c.push(d)},ComplexOutput:function(a,c){c.complexOutput={};this.readChildNodes(a,c.complexOutput)},LiteralOutput:function(a,c){c.literalOutput={};this.readChildNodes(a,c.literalOutput)},Input:function(a,c){var d={maxOccurs:parseInt(a.getAttribute("maxOccurs")),minOccurs:parseInt(a.getAttribute("minOccurs"))};
this.readChildNodes(a,d);c.push(d)},BoundingBoxData:function(a,c){c.boundingBoxData={};this.readChildNodes(a,c.boundingBoxData)},CRS:function(a,c){if(!c.CRSs)c.CRSs={};c.CRSs[this.getChildValue(a)]=true},LiteralData:function(a,c){c.literalData={};this.readChildNodes(a,c.literalData)},ComplexData:function(a,c){c.complexData={};this.readChildNodes(a,c.complexData)},Default:function(a,c){c["default"]={};this.readChildNodes(a,c["default"])},Supported:function(a,c){c.supported={};this.readChildNodes(a,
c.supported)},Format:function(a,c){var d={};this.readChildNodes(a,d);if(!c.formats)c.formats={};c.formats[d.mimeType]=true},MimeType:function(a,c){c.mimeType=this.getChildValue(a)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"});
OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",
requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);return c},
readers:{csw:{GetRecordsResponse:function(a,c){c.records=[];this.readChildNodes(a,c);var d=this.getAttributeNS(a,"","version");if(d!="")c.version=d},RequestId:function(a,c){c.RequestId=this.getChildValue(a)},SearchStatus:function(a,c){c.SearchStatus={};var d=this.getAttributeNS(a,"","timestamp");if(d!="")c.SearchStatus.timestamp=d},SearchResults:function(a,c){this.readChildNodes(a,c);for(var d=a.attributes,e={},f=0,g=d.length;f<g;++f)e[d[f].name]=d[f].name=="numberOfRecordsMatched"||d[f].name=="numberOfRecordsReturned"||
d[f].name=="nextRecord"?parseInt(d[f].nodeValue):d[f].nodeValue;c.SearchResults=e},SummaryRecord:function(a,c){var d={type:"SummaryRecord"};this.readChildNodes(a,d);c.records.push(d)},BriefRecord:function(a,c){var d={type:"BriefRecord"};this.readChildNodes(a,d);c.records.push(d)},DCMIRecord:function(a,c){var d={type:"DCMIRecord"};this.readChildNodes(a,d);c.records.push(d)},Record:function(a,c){var d={type:"Record"};this.readChildNodes(a,d);c.records.push(d)},"*":function(a,c){var d=a.localName||a.nodeName.split(":").pop();
c[d]=this.getChildValue(a)}},geonet:{info:function(a,c){var d={};this.readChildNodes(a,d);c.gninfo=d}},dc:{"*":function(a,c){var d=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(c[d])||(c[d]=[]);for(var e={},f=a.attributes,g=0,h=f.length;g<h;++g)e[f[g].name]=f[g].nodeValue;e.value=this.getChildValue(a);e.value!=""&&c[d].push(e)}},dct:{"*":function(a,c){var d=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(c[d])||(c[d]=[]);c[d].push(this.getChildValue(a))}},ows:OpenLayers.Util.applyDefaults({BoundingBox:function(a,
c){if(c.bounds){c.BoundingBox=[{crs:c.projection,value:[c.bounds.left,c.bounds.bottom,c.bounds.right,c.bounds.top]}];delete c.projection;delete c.bounds}OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(a){a=this.writeNode("csw:GetRecords",a);a.setAttribute("xmlns:gmd",this.namespaces.gmd);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{csw:{GetRecords:function(a){a||
(a={});var c=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:a.requestId||this.requestId,resultType:a.resultType||this.resultType,outputFormat:a.outputFormat||this.outputFormat,outputSchema:a.outputSchema||this.outputSchema,startPosition:a.startPosition||this.startPosition,maxRecords:a.maxRecords||this.maxRecords}});if(a.DistributedSearch||this.DistributedSearch)this.writeNode("csw:DistributedSearch",a.DistributedSearch||this.DistributedSearch,c);
var d=a.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(d)&&d.length>0)for(var e=0,f=d.length;e<f;e++)this.writeNode("csw:ResponseHandler",d[e],c);this.writeNode("Query",a.Query||this.Query,c);return c},DistributedSearch:function(a){return this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}})},ResponseHandler:function(a){return this.createElementNSPlus("csw:ResponseHandler",{value:a.value})},Query:function(a){a||(a={});var c=this.createElementNSPlus("csw:Query",
{attributes:{typeNames:a.typeNames||"csw:Record"}}),d=a.ElementName;if(OpenLayers.Util.isArray(d)&&d.length>0)for(var e=0,f=d.length;e<f;e++)this.writeNode("csw:ElementName",d[e],c);else this.writeNode("csw:ElementSetName",a.ElementSetName||{value:"summary"},c);a.Constraint&&this.writeNode("csw:Constraint",a.Constraint,c);a.SortBy&&this.writeNode("ogc:SortBy",a.SortBy,c);return c},ElementName:function(a){return this.createElementNSPlus("csw:ElementName",{value:a.value})},ElementSetName:function(a){return this.createElementNSPlus("csw:ElementSetName",
{attributes:{typeNames:a.typeNames},value:a.value})},Constraint:function(a){var c=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var d=new OpenLayers.Format.Filter({version:a.version});c.appendChild(d.write(a.Filter))}else if(a.CqlText){a=this.createElementNSPlus("CqlText",{value:a.CqlText.value});c.appendChild(a)}return c}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});
OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,c,d){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===true){var e=this;this._docMove=function(a){e.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){e.mouseup({xy:{x:a.clientX,y:a.clientY}})}}},
dragstart:function(a){var c=true;this.dragging=false;if(this.checkModifiers(a)&&(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))){this.started=true;this.last=this.start=a.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(a);this.callback("down",[a.xy]);OpenLayers.Event.stop(a);if(!this.oldOnselectstart)this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True;document.onselectstart=OpenLayers.Function.False;c=!this.stopDown}else{this.started=
false;this.last=this.start=null}return c},dragmove:function(a){this.lastMoveEvt=a;if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y)){if(this.documentDrag===true&&this.documentEvents)if(a.element===document){this.adjustXY(a);this.setEvent(a)}else this.removeDocumentEvents();if(this.interval>0)this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval);this.dragging=true;this.move(a);this.callback("move",[a.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=
document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=a.xy}return true},dragend:function(a){if(this.started){if(this.documentDrag===true&&this.documentEvents){this.adjustXY(a);this.removeDocumentEvents()}var c=this.start!=this.last;this.dragging=this.started=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);c&&this.callback("done",[a.xy]);document.onselectstart=this.oldOnselectstart}return true},down:function(){},
move:function(){},up:function(){},out:function(){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){if(!this.touch){this.touch=true;this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})}return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},
touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv))if(this.documentDrag===true)this.addDocumentEvents();else{var c=this.start!=this.last;this.dragging=this.started=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);c&&this.callback("done",[a.xy]);if(document.onselectstart)document.onselectstart=this.oldOnselectstart}return true},click:function(){return this.start==
this.last},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragging=this.started=this.touch=false;this.last=this.start=null;a=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return a},adjustXY:function(a){var c=OpenLayers.Util.pagePosition(this.map.viewPortDiv);a.xy.x=a.xy.x-c[0];a.xy.y=
a.xy.y-c[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=true;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=false;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});
OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,c,d){if(!d||!d.layerOptions||!d.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.Drag.prototype.initialize.apply(this,[a,c,d]);this.options=d?d:{}},setOptions:function(a){OpenLayers.Util.extend(this.options,
a);OpenLayers.Util.extend(this,a)},activate:function(){var a=false;if(OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)){a=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)){this.dragging&&
this.cancel();if(this.layer.map!=null){this.layer.destroy(false);this.feature&&this.feature.destroy()}this.feature=this.layer=null;a=true}return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new OpenLayers.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear();this.feature=new OpenLayers.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);
this.layer.addFeatures([this.feature],{silent:true});this.layer.drawFeature(this.feature,this.style)},move:function(a){var c=this.layer.getLonLatFromViewPortPx(a.xy),c=new OpenLayers.Geometry.Point(c.lon,c.lat);if(this.irregular){a=Math.sqrt(2)*Math.abs(c.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,a)}else if(this.fixedRadius)this.origin=c;else{this.calculateAngle(c,a);this.radius=Math.max(this.map.getResolution()/2,c.distanceTo(this.origin))}this.modifyGeometry();if(this.irregular){a=
c.x-this.origin.x;c=c.y-this.origin.y;this.feature.geometry.resize(1,this.origin,c==0?a/(this.radius*Math.sqrt(2)):a/c);this.feature.geometry.move(a/2,c/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&&this.callback("done",[a.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);if(this.snapAngle)this.angle=this.angle+this.snapAngle*(Math.PI/180);this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,
this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var a,c,d=this.feature.geometry.components[0];if(d.components.length!=this.sides+1){this.createGeometry();d=this.feature.geometry.components[0]}for(var e=0;e<this.sides;++e){c=d.components[e];a=this.angle+e*2*Math.PI/this.sides;c.x=this.origin.x+this.radius*Math.cos(a);c.y=this.origin.y+this.radius*Math.sin(a);c.clearBounds()}},calculateAngle:function(a,c){var d=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&
!c[this.snapToggle]){var e=Math.PI/180*this.snapAngle;this.angle=Math.round(d/e)*e}else this.angle=d},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){if(this.layer){this.layer.renderer.clear();this.layer.destroyFeatures()}},callback:function(a){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);!this.persist&&(a=="done"||a=="cancel")&&this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});
OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,
this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:true})},addPoint:function(a){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var c=this.point.geometry,d=this.control.layer.features,e,f=d.length-1;f>=0;--f){e=d[f].geometry;if((e instanceof OpenLayers.Geometry.Polygon||e instanceof OpenLayers.Geometry.MultiPolygon)&&e.intersects(c)){c=d[f];this.control.layer.removeFeatures([c],{silent:true});this.control.layer.events.registerPriority("sketchcomplete",
this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);c.geometry.addComponent(this.line.geometry);this.polygon=c;this.drawingHole=true;break}}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){var a=a.vertex,c=this.line.geometry.components;if(!this.polygon.geometry.intersects(a)){c=c[c.length-3];a.x=c.x;a.y=c.y}},
finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,c=a.getArea()!==0;if(c){for(var d=this.polygon.geometry.components,e=d.length-2;e>=0;--e)if(a.intersects(d[e])){c=false;break}if(c){e=d.length-2;a:for(;e>0;--e)for(var f=d[e].components,g=0,h=f.length;g<h;++g)if(a.containsPoint(f[g])){c=false;break a}}}if(c){if(this.polygon.state!==
OpenLayers.State.INSERT)this.polygon.state=OpenLayers.State.UPDATE}else this.polygon.geometry.removeComponent(a);this.restoreFeature();return false},cancel:function(){if(this.drawingHole){this.polygon.geometry.removeComponent(this.line.geometry);this.restoreFeature(true)}return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",
this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:true});this.control.layer.addFeatures([this.polygon],{silent:true});this.drawingHole=false;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},
getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},CLASS_NAME:"OpenLayers.Handler.Polygon"});
OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){if(!this.touch){this.unregisterMouseListeners();this.touch=true}this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return true},touchmove:function(a){this.last=this.getEventInfo(a);return true},touchend:function(a){if(this.down){a.xy=
this.last.xy;a.lastTouches=this.last.touches;this.handleSingle(a);this.down=null}return true},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return true},mouseup:function(a){var c=true;this.checkModifiers(a)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a)&&(c=this.rightclick(a));return c},
rightclick:function(a){if(this.passesTolerance(a)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[a]);return!this.stopDouble}a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",[a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){if(!this.last)this.last=
this.getEventInfo(a);this.handleSingle(a);return!this.stopSingle},dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){if(this.passesDblclickTolerance(a)){this["double"]&&this.callback("dblclick",[a]);this.clearTimer()}},handleSingle:function(a){if(this.passesTolerance(a))if(this.timerId!=null){if(this.last.touches&&this.last.touches.length===1){this["double"]&&OpenLayers.Event.stop(a);this.handleDouble(a)}(!this.last.touches||this.last.touches.length!==2)&&this.clearTimer()}else{this.first=
this.getEventInfo(a);this.queuePotentialClick(this.single?OpenLayers.Util.extend({},a):null)}},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)},passesTolerance:function(a){var c=true;if(this.pixelTolerance!=null&&this.down&&this.down.xy)if((c=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length)for(var a=0,d=this.down.touches.length;a<d;++a)if(this.getTouchDistance(this.down.touches[a],
this.last.touches[a])>this.pixelTolerance){c=false;break}return c},getTouchDistance:function(a,c){return Math.sqrt(Math.pow(a.clientX-c.clientX,2)+Math.pow(a.clientY-c.clientY,2))},passesDblclickTolerance:function(){var a=true;this.down&&this.first&&(a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return a},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);
this.rightclickTimerId=null}},delayedCall:function(a){this.timerId=null;a&&this.callback("click",[a])},getEventInfo:function(a){var c;if(a.touches){var d=a.touches.length;c=Array(d);for(var e,f=0;f<d;f++){e=a.touches[f];c[f]={clientX:e.clientX,clientY:e.clientY}}}return{xy:a.xy,touches:c}},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.last=this.first=this.down=null;this.touch=false;a=true}return a},CLASS_NAME:"OpenLayers.Handler.Click"});
OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,handlerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},
this.callbacks);this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:false,tileOptions:{maxGetUrlLength:2048}});if(this.sketchStyle)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})});this.handler=new a(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var a in this.layerCache)delete this.layerCache[a];
for(a in this.wfsCache)delete this.wfsCache[a];OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(a){this.setVisibility(a.object.getVisibility())},createSelectionLayer:function(a){var c;if(this.layerCache[a.id])c=this.layerCache[a.id];else{c=new OpenLayers.Layer.WMS(a.name,a.url,a.params,OpenLayers.Util.applyDefaults(this.layerOptions,a.getOptions()));this.layerCache[a.id]=c;if(this.layerOptions.displayInLayerSwitcher===false)a.events.on({visibilitychanged:this.coupleLayerVisiblity,
scope:c});this.map.addLayer(c)}return c},createSLD:function(a,c,d){for(var e={version:"1.0.0",namedLayers:{}},f=(""+a.params.LAYERS).split(","),g=0,h=f.length;g<h;g++){var i=f[g];e.namedLayers[i]={name:i,userStyles:[]};var j=this.selectionSymbolizer,k=d[g];k.type.indexOf("Polygon")>=0?j={Polygon:this.selectionSymbolizer.Polygon}:k.type.indexOf("LineString")>=0?j={Line:this.selectionSymbolizer.Line}:k.type.indexOf("Point")>=0&&(j={Point:this.selectionSymbolizer.Point});e.namedLayers[i].userStyles.push({name:"default",
rules:[new OpenLayers.Rule({symbolizer:j,filter:c[g],maxScaleDenominator:a.options.minScale})]})}return(new OpenLayers.Format.SLD({srsName:this.map.getProjection()})).write(e)},parseDescribeLayer:function(a){var c=new OpenLayers.Format.WMSDescribeLayer,d=a.responseXML;if(!d||!d.documentElement)d=a.responseText;for(var a=c.read(d),c=[],d=null,e=0,f=a.length;e<f;e++)if(a[e].owsType=="WFS"){c.push(a[e].typeName);d=a[e].owsURL}OpenLayers.Request.GET({url:d,params:{SERVICE:"WFS",TYPENAME:c.toString(),
REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},callback:function(a){var c=new OpenLayers.Format.WFSDescribeFeatureType,d=a.responseXML;if(!d||!d.documentElement)d=a.responseText;this.control.wfsCache[this.layer.id]=c.read(d);this.control._queue&&this.control.applySelection()},scope:this})},getGeometryAttributes:function(a){for(var c=[],a=this.wfsCache[a.id],d=0,e=a.featureTypes.length;d<e;d++)for(var f=a.featureTypes[d].properties,g=0,h=f.length;g<h;g++){var i=f[g],j=i.type;(j.indexOf("LineString")>=
0||j.indexOf("GeometryAssociationType")>=0||j.indexOf("GeometryPropertyType")>=0||j.indexOf("Point")>=0||j.indexOf("Polygon")>=0)&&c.push(i)}return c},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];e&&!this.wfsCache[e.id]&&OpenLayers.Request.GET({url:e.url,params:{SERVICE:"WMS",VERSION:e.params.VERSION,LAYERS:e.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:e,control:this}})}return a},
deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);if(a)for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e&&this.clearOnDeactivate===true){var f=this.layerCache,g=f[e.id];if(g){e.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:g});g.destroy();delete f[e.id]}}}return a},setLayers:function(a){if(this.active){this.deactivate();this.layers=a;this.activate()}else this.layers=a},createFilter:function(a,c){var d=null;this.handler instanceof OpenLayers.Handler.RegularPolygon?
d=this.handler.irregular===true?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:a.name,value:c.getBounds()}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c}):this.handler instanceof OpenLayers.Handler.Polygon?d=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c}):this.handler instanceof OpenLayers.Handler.Path?d=a.type.indexOf("Point")>=0?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,
property:a.name,distance:this.map.getExtent().getWidth()*0.01,distanceUnits:this.map.getUnits(),value:c}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c}):this.handler instanceof OpenLayers.Handler.Click&&(d=a.type.indexOf("Polygon")>=0?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:this.map.getExtent().getWidth()*
0.01,distanceUnits:this.map.getUnits(),value:c}));return d},select:function(a){this._queue=function(){for(var c=0,d=this.layers.length;c<d;c++){for(var e=this.layers[c],f=this.getGeometryAttributes(e),g=[],h=0,i=f.length;h<i;h++){var j=f[h];if(j!==null){if(!(a instanceof OpenLayers.Geometry)){var k=this.map.getLonLatFromPixel(a.xy);a=new OpenLayers.Geometry.Point(k.lon,k.lat)}j=this.createFilter(j,a);j!==null&&g.push(j)}}h=this.createSelectionLayer(e);f=this.createSLD(e,g,f);this.events.triggerEvent("selected",
{layer:e,filters:g});h.mergeNewParams({SLD_BODY:f});delete this._queue}};this.applySelection()},applySelection:function(){for(var a=true,c=0,d=this.layers.length;c<d;c++)if(!this.wfsCache[this.layers[c].id]){a=false;break}a&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});
OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.element=OpenLayers.Util.getElement(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.element=document.createElement("div");this.div.appendChild(this.element)}this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var a;
if(this.geodesic===true){if(!this.map.getUnits())return;a=OpenLayers.INCHES_PER_UNIT;a=(this.map.getGeodesicPixelSize().w||1.0E-6)*a.km*OpenLayers.DOTS_PER_INCH}else a=this.map.getScale();if(a){a=a>=9500&&a<=95E4?Math.round(a/1E3)+"K":a>=95E4?Math.round(a/1E6)+"M":Math.round(a);this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:a})}},CLASS_NAME:"OpenLayers.Control.Scale"});
OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(a){a=a||{};OpenLayers.Layer.Vector.prototype.initialize.apply(this,[a.name,a])},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);a.events.register("moveend",this,this.onMoveEnd)},removeMap:function(a){a.events.unregister("moveend",this,this.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(this,
arguments)},setRatio:function(a){this.ratio=a;this.updateGrid(true)},setMaxFeatures:function(a){this.maxFeatures=a;this.updateGrid(true)},setSpacing:function(a,c){this.dx=a;this.dy=c||a;this.updateGrid(true)},setOrigin:function(a){this.origin=a;this.updateGrid(true)},getOrigin:function(){if(!this.origin)this.origin=this.map.getExtent().getCenterLonLat();return this.origin},setRotation:function(a){this.rotation=a;this.updateGrid(true)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var a=
this.map.getExtent();if(this.rotation){var c=this.getOrigin(),c=new OpenLayers.Geometry.Point(c.lon,c.lat),a=a.toGeometry();a.rotate(-this.rotation,c);a=a.getBounds()}return a},updateGrid:function(a){if(a||this.invalidBounds()){var c=this.getViewBounds(),d=this.getOrigin(),a=new OpenLayers.Geometry.Point(d.lon,d.lat),e=c.getWidth(),f=c.getHeight(),g=e/f,h=Math.sqrt(this.dx*this.dy*this.maxFeatures/g),e=Math.min(e*this.ratio,h*g),f=Math.min(f*this.ratio,h),c=c.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(c.lon-
e/2,c.lat-f/2,c.lon+e/2,c.lat+f/2);for(var c=Math.floor(f/this.dy),e=Math.floor(e/this.dx),f=d.lon+this.dx*Math.ceil((this.gridBounds.left-d.lon)/this.dx),d=d.lat+this.dy*Math.ceil((this.gridBounds.bottom-d.lat)/this.dy),h=Array(c*e),i,j=0;j<e;++j)for(var g=f+j*this.dx,k=0;k<c;++k){i=d+k*this.dy;i=new OpenLayers.Geometry.Point(g,i);this.rotation&&i.rotate(this.rotation,a);h[j*c+k]=new OpenLayers.Feature.Vector(i)}this.destroyFeatures(this.features,{silent:true});this.addFeatures(h,{silent:true})}},
invalidBounds:function(){return!this.gridBounds||!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"});
OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);var d={done:this.measureComplete,point:this.measurePartial};if(this.immediate)d.modify=this.measureImmediate;this.callbacks=OpenLayers.Util.extend(d,
this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,c){var d=this.active;d&&
this.deactivate();this.handler=new a(this,this.callbacks,c);d&&this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,c){this.cancelDelay();c=c.clone();this.handler.freehandMode(this.handler.evt)?this.measure(c,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(c,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,c,d){if(d&&!this.handler.freehandMode(this.handler.evt)){this.cancelDelay();
this.measure(c.geometry,"measurepartial")}},cancelDelay:function(){if(this.delayedTrigger!==null){window.clearTimeout(this.delayedTrigger);this.delayedTrigger=null}},measure:function(a,c){var d,e;if(a.CLASS_NAME.indexOf("LineString")>-1){d=this.getBestLength(a);e=1}else{d=this.getBestArea(a);e=2}this.events.triggerEvent(c,{measure:d[0],units:d[1],order:e,geometry:a})},getBestArea:function(a){for(var c=this.displaySystemUnits[this.displaySystem],d,e,f=0,g=c.length;f<g;++f){d=c[f];e=this.getArea(a,
d);if(e>1)break}return[e,d]},getArea:function(a,c){var d,e;if(this.geodesic){d=a.getGeodesicArea(this.map.getProjectionObject());e="m"}else{d=a.getArea();e=this.map.getUnits()}var f=OpenLayers.INCHES_PER_UNIT[c];f&&(d=d*Math.pow(OpenLayers.INCHES_PER_UNIT[e]/f,2));return d},getBestLength:function(a){for(var c=this.displaySystemUnits[this.displaySystem],d,e,f=0,g=c.length;f<g;++f){d=c[f];e=this.getLength(a,d);if(e>1)break}return[e,d]},getLength:function(a,c){var d,e;if(this.geodesic){d=a.getGeodesicLength(this.map.getProjectionObject());
e="m"}else{d=a.getLength();e=this.map.getUnits()}var f=OpenLayers.INCHES_PER_UNIT[c];f&&(d=d*(OpenLayers.INCHES_PER_UNIT[e]/f));return d},CLASS_NAME:"OpenLayers.Control.Measure"});
OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_wmc_SRS:function(a,c){var d=this.getChildValue(c);if(typeof a.projections!="object")a.projections={};for(var d=d.split(/ +/),e=0,f=d.length;e<f;e++)a.projections[d[e]]=true},write_wmc_Layer:function(a){var c=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,
[a]);if(a.srs){var d=[],e;for(e in a.srs)d.push(e);c.appendChild(this.createElementDefaultNS("SRS",d.join(" ")))}c.appendChild(this.write_wmc_FormatList(a));c.appendChild(this.write_wmc_StyleList(a));a.dimensions&&c.appendChild(this.write_wmc_DimensionList(a));c.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});
OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a;a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(a){typeof a==
"string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);c.version=this.version;return c},readers:{wmts:{Capabilities:function(a,c){this.readChildNodes(a,c)},Contents:function(a,c){c.contents={};c.contents.layers=[];c.contents.tileMatrixSets={};this.readChildNodes(a,c.contents)},Layer:function(a,c){var d={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[],layers:[]};this.readChildNodes(a,d);c.layers.push(d)},Style:function(a,
c){var d={};d.isDefault=a.getAttribute("isDefault")==="true";this.readChildNodes(a,d);c.styles.push(d)},Format:function(a,c){c.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(a,c){var d={};this.readChildNodes(a,d);c.tileMatrixSetLinks.push(d)},TileMatrixSet:function(a,c){if(c.layers){var d={matrixIds:[]};this.readChildNodes(a,d);c.tileMatrixSets[d.identifier]=d}else c.tileMatrixSet=this.getChildValue(a)},TileMatrix:function(a,c){var d={supportedCRS:c.supportedCRS};this.readChildNodes(a,
d);c.matrixIds.push(d)},ScaleDenominator:function(a,c){c.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(a,c){var d=this.getChildValue(a).split(" "),e;c.supportedCRS&&(e=!!this.yx[c.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2")]);c.topLeftCorner=e?new OpenLayers.LonLat(d[1],d[0]):new OpenLayers.LonLat(d[0],d[1])},TileWidth:function(a,c){c.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,c){c.tileHeight=parseInt(this.getChildValue(a))},
MatrixWidth:function(a,c){c.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,c){c.matrixHeight=parseInt(this.getChildValue(a))},ResourceURL:function(a,c){c.resourceUrl=c.resourceUrl||{};c.resourceUrl[a.getAttribute("resourceType")]={format:a.getAttribute("format"),template:a.getAttribute("template")}},WSDL:function(a,c){c.wsdl={};c.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a,c){c.serviceMetadataUrl={};c.serviceMetadataUrl.href=a.getAttribute("xlink:href")},
LegendURL:function(a,c){c.legend={};c.legend.href=a.getAttribute("xlink:href");c.legend.format=a.getAttribute("format")},Dimension:function(a,c){var d={values:[]};this.readChildNodes(a,d);c.dimensions.push(d)},Default:function(a,c){c["default"]=this.getChildValue(a)},Value:function(a,c){c.values.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});
OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(a,c,d){OpenLayers.Control.prototype.initialize.apply(this,[d]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,c){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:c})},create:function(a,c){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:c})}},this.callbacks);this.layer=
a;this.handlerOptions=this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});if(!("multi"in this.handlerOptions))this.handlerOptions.multi=this.multi;if(a=this.layer.styleMap&&this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":a})});this.handler=new c(this,
this.callbacks,this.handlerOptions)},drawFeature:function(a){a=new OpenLayers.Feature.Vector(a);if(this.layer.events.triggerEvent("sketchcomplete",{feature:a})!==false){a.state=OpenLayers.State.INSERT;this.layer.addFeatures([a]);this.featureAdded(a);this.events.triggerEvent("featureadded",{feature:a})}},insertXY:function(a,c){this.handler&&this.handler.line&&this.handler.insertXY(a,c)},insertDeltaXY:function(a,c){this.handler&&this.handler.line&&this.handler.insertDeltaXY(a,c)},insertDirectionLength:function(a,
c){this.handler&&this.handler.line&&this.handler.insertDirectionLength(a,c)},insertDeflectionLength:function(a,c){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(a,c)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});
OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,
50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto",
"auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,
0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,
21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,
0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(a,c,d,e,f,g,h){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png");
OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});
OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,c,d){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);if(this.dragHandler){this.dragHandler.destroy();this.dragHandler=
null}},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var c=this.dragHandler.start.x,
d=this.dragHandler.start.y,e=Math.abs(c-a.x),f=Math.abs(d-a.y),g=this.getBoxOffsets();this.zoomBox.style.width=e+g.width+1+"px";this.zoomBox.style.height=f+g.height+1+"px";this.zoomBox.style.left=(a.x<c?c-e-g.left:c-g.left)+"px";this.zoomBox.style.top=(a.y<d?d-f-g.top:d-g.top)+"px"},endBox:function(a){var c;if(Math.abs(this.dragHandler.start.x-a.x)>5||Math.abs(this.dragHandler.start.y-a.y)>5){var d=this.dragHandler.start;c=Math.min(d.y,a.y);var e=Math.max(d.y,a.y),f=Math.min(d.x,a.x),a=Math.max(d.x,
a.x);c=new OpenLayers.Bounds(f,e,a,c)}else c=this.dragHandler.start.clone();this.removeBox();this.callback("done",[c])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}return false},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,
arguments)){this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox();return true}return false},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var c=a.clientWidth==3;document.body.removeChild(a);var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),e=parseInt(OpenLayers.Element.getStyle(this.zoomBox,
"border-top-width")),f=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:d,top:e,bottom:f,width:c===false?a+d:0,height:c===false?e+f:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});
OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var c;if(this.out){c=Math.abs(a.right-a.left);var d=Math.abs(a.top-a.bottom);c=Math.min(this.map.size.h/d,this.map.size.w/c);var d=this.map.getExtent(),e=this.map.getLonLatFromPixel(a.getCenterPixel()),a=e.lon-
d.getWidth()/2*c,f=e.lon+d.getWidth()/2*c,g=e.lat-d.getHeight()/2*c;c=e.lat+d.getHeight()/2*c;c=new OpenLayers.Bounds(a,g,f,c)}else{c=this.map.getLonLatFromPixel({x:a.left,y:a.bottom});d=this.map.getLonLatFromPixel({x:a.right,y:a.top});c=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}d=this.map.getZoom();this.map.zoomToExtent(c);d==this.map.getZoom()&&this.alwaysZoom==true&&this.map.zoomTo(d+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(a),
this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"});
OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var a={interval:this.kineticInterval};typeof this.enableKinetic==="object"&&(a=OpenLayers.Util.extend(a,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,
documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=true;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:true,animate:false})},panMapDone:function(a){if(this.panned){var c=null;this.kinetic&&(c=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!c,animate:false});if(c){var d=this;this.kinetic.move(c,function(a,c,g){d.map.pan(a,
c,{dragging:!g,animate:false})})}this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});
OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;
this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&this.pinchZoom.deactivate();
this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks)this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False;this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":true,stopDouble:true});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,
documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);if(OpenLayers.Control.PinchZoom)this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&a.lastTouches.length==
2&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom+1)},defaultDblRightClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom-1)},wheelChange:function(a,c){var d=this.map.getZoom(),e=this.map.getZoom()+Math.round(c),e=Math.max(e,0),e=Math.min(e,this.map.getNumZoomLevels());if(e!==d){var f=this.map.getSize(),d=f.w/2-a.xy.x,f=a.xy.y-f.h/2,g=this.map.baseLayer.getResolutionForZoom(e),h=this.map.getLonLatFromPixel(a.xy);
this.map.setCenter(new OpenLayers.LonLat(h.lon+d*g,h.lat+f*g),e)}},wheelUp:function(a,c){this.wheelChange(a,c||1)},wheelDown:function(a,c){this.wheelChange(a,c||-1)},disableZoomBox:function(){this.zoomBoxEnabled=false;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=true;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;this.active&&this.handlers.wheel.activate()},
CLASS_NAME:"OpenLayers.Control.Navigation"});
OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={};this.readNode(a,c);return c},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,c){c.name=this.getChildValue(a)},TimePeriod:function(a,c){c.timePeriod={};this.readChildNodes(a,c.timePeriod)},beginPosition:function(a,c){c.beginPosition=this.getChildValue(a)},endPosition:function(a,c){c.endPosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,c){this.readChildNodes(a,c)},Contents:function(a,
c){c.contents={};this.readChildNodes(a,c.contents)},ObservationOfferingList:function(a,c){c.offeringList={};this.readChildNodes(a,c.offeringList)},ObservationOffering:function(a,c){var d=this.getAttributeNS(a,this.namespaces.gml,"id");c[d]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(a,c[d])},time:function(a,c){c.time={};this.readChildNodes(a,c.time)},procedure:function(a,c){c.procedures.push(this.getAttributeNS(a,
this.namespaces.xlink,"href"))},observedProperty:function(a,c){c.observedProperties.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},featureOfInterest:function(a,c){c.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,c){c.responseFormats.push(this.getChildValue(a))},resultModel:function(a,c){c.resultModels.push(this.getChildValue(a))},responseMode:function(a,c){c.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},
CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});
OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(a){var c=true;this.pinching=false;if(OpenLayers.Event.isMultiTouch(a)){this.started=true;this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1};this.callback("start",[a,this.start]);c=!this.stopDown}else{this.started=false;this.last=this.start=null}OpenLayers.Event.stop(a);return c},touchmove:function(a){if(this.started&&OpenLayers.Event.isMultiTouch(a)){this.pinching=
true;var c=this.getPinchData(a);this.callback("move",[a,c]);this.last=c;OpenLayers.Event.stop(a)}return true},touchend:function(a){if(this.started){this.pinching=this.started=false;this.callback("done",[a,this.start,this.last]);this.last=this.start=null}return true},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.pinching=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.pinching=
this.started=false;this.last=this.start=null;a=true}return a},getDistance:function(a){var c=a[0],a=a[1];return Math.sqrt(Math.pow(c.clientX-a.clientX,2)+Math.pow(c.clientY-a.clientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});
OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{};if(a.extractStyles!==false)a.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){for(var a=a.split("\n"),c,d=[],e=0;e<a.length-1;e++){var f=a[e].replace(/^\s*/,"").replace(/\s*$/,"");if(f.charAt(0)!="#")if(c){for(var f=
f.split("\t"),g=new OpenLayers.Geometry.Point(0,0),h={},i=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,j=false,k=0;k<f.length;k++)if(f[k])if(c[k]=="point"){j=f[k].split(",");g.y=parseFloat(j[0]);g.x=parseFloat(j[1]);j=true}else if(c[k]=="lat"){g.y=parseFloat(f[k]);j=true}else if(c[k]=="lon"){g.x=parseFloat(f[k]);j=true}else if(c[k]=="title")h.title=f[k];else if(c[k]=="image"||c[k]=="icon"&&i)i.externalGraphic=f[k];else if(c[k]=="iconSize"&&i){var l=f[k].split(",");i.graphicWidth=
parseFloat(l[0]);i.graphicHeight=parseFloat(l[1])}else if(c[k]=="iconOffset"&&i){l=f[k].split(",");i.graphicXOffset=parseFloat(l[0]);i.graphicYOffset=parseFloat(l[1])}else c[k]=="description"?h.description=f[k]:c[k]=="overflow"?h.overflow=f[k]:h[c[k]]=f[k];if(j){this.internalProjection&&this.externalProjection&&g.transform(this.externalProjection,this.internalProjection);f=new OpenLayers.Feature.Vector(g,h,i);d.push(f)}}else c=f.split("\t")}return d},CLASS_NAME:"OpenLayers.Format.Text"});
OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,containerCenter:null,pinchOrigin:null,currentCenter:null,autoActivate:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},activate:function(){var a=OpenLayers.Control.prototype.activate.apply(this,arguments);if(a){this.map.events.on({moveend:this.updateContainerCenter,
scope:this});this.updateContainerCenter()}return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.apply(this,arguments);this.map&&this.map.events&&this.map.events.un({moveend:this.updateContainerCenter,scope:this});return a},updateContainerCenter:function(){var a=this.map.layerContainerDiv;this.containerCenter={x:parseInt(a.style.left,10)+50,y:parseInt(a.style.top,10)+50}},pinchStart:function(a){this.currentCenter=this.pinchOrigin=a.xy},pinchMove:function(a,c){var d=c.scale,
e=this.containerCenter,f=this.pinchOrigin,g=a.xy,h=Math.round(g.x-f.x+(d-1)*(e.x-f.x)),e=Math.round(g.y-f.y+(d-1)*(e.y-f.y));this.applyTransform("translate("+h+"px, "+e+"px) scale("+d+")");this.currentCenter=g},applyTransform:function(a){var c=this.map.layerContainerDiv.style;c["-webkit-transform"]=a;c["-moz-transform"]=a},pinchDone:function(a,c,d){this.applyTransform("");a=this.map.getZoomForResolution(this.map.getResolution()/d.scale,true);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var c=
this.map.getResolutionForZoom(a),d=this.map.getLonLatFromPixel(this.pinchOrigin),e=this.currentCenter,f=this.map.getSize();d.lon=d.lon+c*(f.w/2-e.x);d.lat=d.lat-c*(f.h/2-e.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(d,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});
OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(a,c,d){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},
this.options&&this.options.tileOptions)},clone:function(a){a==null&&(a=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.OSM"});
OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){this.layer.visibility===true&&this.start();this.layer.events.on({visibilitychanged:this.reset,scope:this})}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.stop();return a},reset:function(){this.layer.visibility===true?this.start():this.stop()},start:function(){if(this.interval&&
typeof this.interval==="number"&&this.interval>0)this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval)},refresh:function(){this.layer&&this.layer.refresh&&typeof this.layer.refresh=="function"&&this.layer.refresh({force:this.force})},stop:function(){if(this.timer!==null){window.clearInterval(this.timer);this.timer=null}},CLASS_NAME:"OpenLayers.Strategy.Refresh"});
OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:navigator.geolocation,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(!this.geolocation){this.events.triggerEvent("locationuncapable");return false}if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),
OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation();return true}return false},deactivate:function(){this.active&&this.watchId!==null&&this.geolocation.clearWatch(this.watchId);return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var c=(new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(c);this.events.triggerEvent("locationupdated",
{position:a,point:new OpenLayers.Geometry.Point(c.lon,c.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return false;this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return true},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"OpenLayers.Control.Geolocate"});
OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var c,d,a=a.replace(/[\n\r]/g," ");if(d=this.regExes.typeStr.exec(a)){a=d[1].toLowerCase();d=d[2];this.parse[a]&&(c=this.parse[a].apply(this,[d]));if(this.internalProjection&&this.externalProjection)if(c&&
c.CLASS_NAME=="OpenLayers.Feature.Vector")c.geometry.transform(this.externalProjection,this.internalProjection);else if(c&&a!="geometrycollection"&&typeof c=="object"){a=0;for(d=c.length;a<d;a++)c[a].geometry.transform(this.externalProjection,this.internalProjection)}}return c},write:function(a){var c,d;if(a.constructor==Array)d=true;else{a=[a];d=false}var e=[];d&&e.push("GEOMETRYCOLLECTION(");for(var f=0,g=a.length;f<g;++f){d&&f>0&&e.push(",");c=a[f].geometry;e.push(this.extractGeometry(c))}d&&e.push(")");
return e.join("")},extractGeometry:function(a){var c=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[c])return null;if(this.internalProjection&&this.externalProjection){a=a.clone();a.transform(this.internalProjection,this.externalProjection)}return(c=="collection"?"GEOMETRYCOLLECTION":c.toUpperCase())+"("+this.extract[c].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push("("+this.extract.point.apply(this,
[a.components[d]])+")");return c.join(",")},linestring:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extract.point.apply(this,[a.components[d]]));return c.join(",")},multilinestring:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push("("+this.extract.linestring.apply(this,[a.components[d]])+")");return c.join(",")},polygon:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push("("+this.extract.linestring.apply(this,[a.components[d]])+")");return c.join(",")},
multipolygon:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push("("+this.extract.polygon.apply(this,[a.components[d]])+")");return c.join(",")},collection:function(a){for(var c=[],d=0,e=a.components.length;d<e;++d)c.push(this.extractGeometry.apply(this,[a.components[d]]));return c.join(",")}},parse:{point:function(a){a=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var c=
OpenLayers.String.trim(a).split(","),d=[],e=0,f=c.length;e<f;++e){a=c[e].replace(this.regExes.trimParens,"$1");d.push(this.parse.point.apply(this,[a]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(d))},linestring:function(a){for(var a=OpenLayers.String.trim(a).split(","),c=[],d=0,e=a.length;d<e;++d)c.push(this.parse.point.apply(this,[a[d]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(c))},multilinestring:function(a){for(var c=
OpenLayers.String.trim(a).split(this.regExes.parenComma),d=[],e=0,f=c.length;e<f;++e){a=c[e].replace(this.regExes.trimParens,"$1");d.push(this.parse.linestring.apply(this,[a]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(d))},polygon:function(a){for(var c,a=OpenLayers.String.trim(a).split(this.regExes.parenComma),d=[],e=0,f=a.length;e<f;++e){c=a[e].replace(this.regExes.trimParens,"$1");c=this.parse.linestring.apply(this,[c]).geometry;c=new OpenLayers.Geometry.LinearRing(c.components);
d.push(c)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(d))},multipolygon:function(a){for(var c=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),d=[],e=0,f=c.length;e<f;++e){a=c[e].replace(this.regExes.trimParens,"$1");d.push(this.parse.polygon.apply(this,[a]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(d))},geometrycollection:function(a){for(var a=a.replace(/,\s*([A-Za-z])/g,"|$1"),a=OpenLayers.String.trim(a).split("|"),
c=[],d=0,e=a.length;d<e;++d)c.push(OpenLayers.Format.WKT.prototype.read.apply(this,[a[d]]));return c}},CLASS_NAME:"OpenLayers.Format.WKT"});
OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){if(this.passesTolerance(a.xy)){this.clearTimer();this.callback("move",[a]);this.px=a.xy;a=OpenLayers.Util.extend({},a);this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)}return!this.stopMove},mouseout:function(a){if(OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)){this.clearTimer();this.callback("move",[a])}return true},
passesTolerance:function(a){var c=true;this.pixelTolerance&&this.px&&Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))<this.pixelTolerance&&(c=false);return c},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();a=true}return a},CLASS_NAME:"OpenLayers.Handler.Hover"});
OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(a){a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.features={};this.handlers=
{};if(this.click)this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{});if(this.box)this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}));if(this.hover)this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2}))},
activate:function(){if(!this.active)for(var a in this.handlers)this.handlers[a].activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var a in this.handlers)this.handlers[a].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(a){var c=this.pixelToBounds(a.xy);this.setModifiers(a);this.request(c,{single:this.single})},selectBox:function(a){var c;if(a instanceof OpenLayers.Bounds){c=
this.map.getLonLatFromPixel({x:a.left,y:a.bottom});a=this.map.getLonLatFromPixel({x:a.right,y:a.top});c=new OpenLayers.Bounds(c.lon,c.lat,a.lon,a.lat)}else{if(this.click)return;c=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(c)},selectHover:function(a){this.request(this.pixelToBounds(a.xy),{single:true,hover:true})},cancelHover:function(){if(this.hoverResponse){this.protocol.abort(this.hoverResponse);this.hoverResponse=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,
"olCursorWait")}},request:function(a,c){var c=c||{},d=new OpenLayers.Filter.Spatial({type:this.filterType,value:a});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");d=this.protocol.read({maxFeatures:c.single==true?this.maxFeatures:void 0,filter:d,callback:function(d){if(d.success())if(d.features.length)c.single==true?this.selectBestFeature(d.features,a.getCenterLonLat(),c):this.select(d.features);else if(c.hover)this.hoverSelect();else{this.events.triggerEvent("clickout");this.clickout&&
this.unselectAll()}OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});if(c.hover==true)this.hoverResponse=d},selectBestFeature:function(a,c,d){d=d||{};if(a.length){for(var c=new OpenLayers.Geometry.Point(c.lon,c.lat),e,f,g,h=Number.MAX_VALUE,i=0;i<a.length;++i){e=a[i];if(e.geometry){g=c.distanceTo(e.geometry,{edge:false});if(g<h){h=g;f=e;if(h==0)break}}}d.hover==true?this.hoverSelect(f):this.select(f||a)}},setModifiers:function(a){this.modifiers={multiple:this.multiple||
this.multipleKey&&a[this.multipleKey],toggle:this.toggle||this.toggleKey&&a[this.toggleKey]}},select:function(a){!this.modifiers.multiple&&!this.modifiers.toggle&&this.unselectAll();OpenLayers.Util.isArray(a)||(a=[a]);var c=this.events.triggerEvent("beforefeaturesselected",{features:a});if(c!==false){for(var d=[],e,f=0,g=a.length;f<g;++f){e=a[f];if(this.features[e.fid||e.id])this.modifiers.toggle&&this.unselect(this.features[e.fid||e.id]);else{c=this.events.triggerEvent("beforefeatureselected",{feature:e});
if(c!==false){this.features[e.fid||e.id]=e;d.push(e);this.events.triggerEvent("featureselected",{feature:e})}}}this.events.triggerEvent("featuresselected",{features:d})}},hoverSelect:function(a){var c=a?a.fid||a.id:null,d=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;if(d&&d!=c){this.events.triggerEvent("outfeature",{feature:this.hoverFeature});this.hoverFeature=null}if(c&&c!=d){this.events.triggerEvent("hoverfeature",{feature:a});this.hoverFeature=a}},unselect:function(a){delete this.features[a.fid||
a.id];this.events.triggerEvent("featureunselected",{feature:a})},unselectAll:function(){for(var a in this.features)this.unselect(this.features[a])},setMap:function(a){for(var c in this.handlers)this.handlers[c].setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(a){var c=a.add(-this.clickTolerance/2,this.clickTolerance/2),a=a.add(this.clickTolerance/2,-this.clickTolerance/2),c=this.map.getLonLatFromPixel(c),a=this.map.getLonLatFromPixel(a);return new OpenLayers.Bounds(c.lon,
c.lat,a.lon,a.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});
OpenLayers.Format.QueryStringFilter=function(){function a(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(a,c){return c?a:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(a,c,d){return c||d?a:"_"});a=a.replace(/(\\)?\.\*/g,function(a,c){return c?a:"%"});a=a.replace(/\\\./g,".");return a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"*"})}var c={};c[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";c[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";c[OpenLayers.Filter.Comparison.LESS_THAN]=
"lt";c[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";c[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";c[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";c[OpenLayers.Filter.Comparison.LIKE]="ilike";return OpenLayers.Class(OpenLayers.Format,{wildcarded:false,srsInBBOX:false,write:function(d,e){var e=e||{},f=d.CLASS_NAME,f=f.substring(f.lastIndexOf(".")+1);switch(f){case "Spatial":switch(d.type){case OpenLayers.Filter.Spatial.BBOX:e.bbox=d.value.toArray();this.srsInBBOX&&d.projection&&
e.bbox.push(d.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:e.tolerance=d.distance;case OpenLayers.Filter.Spatial.WITHIN:e.lon=d.value.x;e.lat=d.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+d.type)}break;case "Comparison":f=c[d.type];if(f!==void 0){var g=d.value;if(d.type==OpenLayers.Filter.Comparison.LIKE){g=a(g);this.wildcarded&&(g="%"+g+"%")}e[d.property+"__"+f]=g;e.queryable=e.queryable||[];e.queryable.push(d.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+
d.type);break;case "Logical":if(d.type===OpenLayers.Filter.Logical.AND){f=0;for(g=d.filters.length;f<g;f++)e=this.write(d.filters[f],e)}else OpenLayers.Console.warn("Unsupported logical filter type "+d.type);break;default:OpenLayers.Console.warn("Unknown filter type "+f)}return e},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}();
OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.events.register("mousemove",this,this.redraw);this.map.events.register("mouseout",this,this.reset);
this.redraw();return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("mousemove",this,this.redraw);this.map.events.unregister("mouseout",this,this.reset);this.element.innerHTML="";return true}return false},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left="";this.div.top="";this.element=this.div}return this.div},redraw:function(a){var c;if(a==null)this.reset();
else if(this.lastXy==null||Math.abs(a.xy.x-this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity)this.lastXy=a.xy;else if(c=this.map.getLonLatFromPixel(a.xy)){this.displayProjection&&c.transform(this.map.getProjectionObject(),this.displayProjection);this.lastXy=a.xy;a=this.formatOutput(c);if(a!=this.element.innerHTML)this.element.innerHTML=a}},reset:function(){if(this.emptyString!=null)this.element.innerHTML=this.emptyString},formatOutput:function(a){var c=parseInt(this.numDigits);
return this.prefix+a.lon.toFixed(c)+this.separator+a.lat.toFixed(c)+this.suffix},CLASS_NAME:"OpenLayers.Control.MousePosition"});
OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a){if(this.isLoading){this.abortLoading();this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}this.url=this.layer.getURL(this.bounds);if(this.layer.useJSONP){var c=new OpenLayers.Protocol.Script({url:this.url,
callback:function(a){this.isLoading=false;this.events.triggerEvent("loadend");this.json=a.data},scope:this});c.read();this.request=c}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(a){this.isLoading=false;this.events.triggerEvent("loadend");a.status===200&&this.parseData(a.responseText)},scope:this})}else this.unload();return a},abortLoading:function(){if(this.request){this.request.abort();delete this.request}this.isLoading=false},getFeatureInfo:function(a,c){var d=null;if(this.json){var e=
this.getFeatureId(a,c);e!==null&&(d={id:e,data:this.json.data[e]})}return d},getFeatureId:function(a,c){var d=null;if(this.json){var e=this.utfgridResolution,e=this.indexFromCharCode(this.json.grid[Math.floor(c/e)].charCodeAt(Math.floor(a/e))),f=this.json.keys;!isNaN(e)&&e in f&&(d=f[e])}return d},indexFromCharCode:function(a){a>=93&&a--;a>=35&&a--;return a-32},parseData:function(a){if(!this.format)this.format=new OpenLayers.Format.JSON;this.json=this.format.read(a)},clear:function(){this.json=null},
CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});
OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);a={trigger:OpenLayers.Function.bind(this.previousTrigger,
this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(a,this.previousOptions);this.previous=new OpenLayers.Control.Button(a);a={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(a,this.nextOptions);this.next=new OpenLayers.Control.Button(a);this.clear()},onPreviousChange:function(a){a&&!this.previous.active?this.previous.activate():!a&&this.previous.active&&this.previous.deactivate()},
onNextChange:function(a){a&&!this.next.active?this.next.activate():!a&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var a=this.previousStack.shift(),
c=this.previousStack.shift();if(c!=void 0){this.nextStack.unshift(a);this.previousStack.unshift(c);this.restoring=true;this.restore(c);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}else this.previousStack.unshift(a);return c},nextTrigger:function(){var a=this.nextStack.shift();if(a!=void 0){this.previousStack.unshift(a);this.restoring=true;this.restore(a);this.restoring=false;this.onNextChange(this.nextStack[0],
this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(a){var c,d;if(this.map.getProjectionObject()==
a.projection){d=this.map.getZoomForResolution(a.resolution);c=a.center}else{c=a.center.clone();c.transform(a.projection,this.map.getProjectionObject());d=a.units;var e=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;d=this.map.getZoomForResolution((d&&e?OpenLayers.INCHES_PER_UNIT[d]/OpenLayers.INCHES_PER_UNIT[e]:1)*a.resolution)}this.map.setCenter(c,d)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){this.previousStack.unshift(this.registry[a].apply(this,
arguments));if(this.previousStack.length>1)this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);this.previousStack.length>this.limit+1&&this.previousStack.pop();if(this.nextStack.length>0){this.nextStack=[];this.onNextChange(null,0)}}return true},this)},activate:function(){var a=false;if(this.map&&OpenLayers.Control.prototype.activate.apply(this)){this.listeners==null&&this.setListeners();for(var c in this.listeners)this.map.events.register(c,this,this.listeners[c]);a=true;this.previousStack.length==
0&&this.initStack()}return a},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var a=false;if(this.map&&OpenLayers.Control.prototype.deactivate.apply(this)){for(var c in this.listeners)this.map.events.unregister(c,this,this.listeners[c]);this.clearOnDeactivate&&this.clear();a=true}return a},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});
OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var c=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=
function(a,e){return c.write(a,e)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a=OpenLayers.Util.applyDefaults(a,this.options);if(a.filter&&this.filterToParams)a.params=this.filterToParams(a.filter,a.params);var c=a.readWithPOST!==void 0?a.readWithPOST:this.readWithPOST,d=new OpenLayers.Protocol.Response({requestType:"read"});
if(c){c=a.headers||{};c["Content-Type"]="application/x-www-form-urlencoded";d.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,d,a),data:OpenLayers.Util.getParameterString(a.params),headers:c})}else d.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,d,a),params:a.params,headers:a.headers});return d},handleRead:function(a,c){this.handleResponse(a,c)},create:function(a,c){var c=OpenLayers.Util.applyDefaults(c,this.options),d=new OpenLayers.Protocol.Response({reqFeatures:a,
requestType:"create"});d.priv=OpenLayers.Request.POST({url:c.url,callback:this.createCallback(this.handleCreate,d,c),headers:c.headers,data:this.format.write(a)});return d},handleCreate:function(a,c){this.handleResponse(a,c)},update:function(a,c){var c=c||{},d=c.url||a.url||this.options.url+"/"+a.fid,c=OpenLayers.Util.applyDefaults(c,this.options),e=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});e.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:d,callback:this.createCallback(this.handleUpdate,
e,c),headers:c.headers,data:this.format.write(a)});return e},handleUpdate:function(a,c){this.handleResponse(a,c)},"delete":function(a,c){var c=c||{},d=c.url||a.url||this.options.url+"/"+a.fid,c=OpenLayers.Util.applyDefaults(c,this.options),e=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"}),f=this.deleteWithPOST?"POST":"DELETE",d={url:d,callback:this.createCallback(this.handleDelete,e,c),headers:c.headers};if(this.deleteWithPOST)d.data=this.format.write(a);e.priv=OpenLayers.Request[f](d);
return e},handleDelete:function(a,c){this.handleResponse(a,c)},handleResponse:function(a,c){var d=a.priv;if(c.callback){if(d.status>=200&&d.status<300){if(a.requestType!="delete")a.features=this.parseFeatures(d);a.code=OpenLayers.Protocol.Response.SUCCESS}else a.code=OpenLayers.Protocol.Response.FAILURE;c.callback.call(c.scope,a)}},parseFeatures:function(a){var c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;return!c||c.length<=0?null:this.format.read(c)},commit:function(a,c){function d(a){for(var c=
a.features?a.features.length:0,d=Array(c),f=0;f<c;++f)d[f]=a.features[f].fid;p.insertIds=d;e.apply(this,[a])}function e(a){this.callUserCallback(a,c);o=o&&a.success();g++;if(g>=n&&c.callback){p.code=o?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;c.callback.apply(c.scope,[p])}}var c=OpenLayers.Util.applyDefaults(c,this.options),f=[],g=0,h={};h[OpenLayers.State.INSERT]=[];h[OpenLayers.State.UPDATE]=[];h[OpenLayers.State.DELETE]=[];for(var i,j,k=[],l=0,m=a.length;l<m;++l){i=
a[l];if(j=h[i.state]){j.push(i);k.push(i)}}var n=(h[OpenLayers.State.INSERT].length>0?1:0)+h[OpenLayers.State.UPDATE].length+h[OpenLayers.State.DELETE].length,o=true,p=new OpenLayers.Protocol.Response({reqFeatures:k});i=h[OpenLayers.State.INSERT];i.length>0&&f.push(this.create(i,OpenLayers.Util.applyDefaults({callback:d,scope:this},c.create)));i=h[OpenLayers.State.UPDATE];for(l=i.length-1;l>=0;--l)f.push(this.update(i[l],OpenLayers.Util.applyDefaults({callback:e,scope:this},c.update)));i=h[OpenLayers.State.DELETE];
for(l=i.length-1;l>=0;--l)f.push(this["delete"](i[l],OpenLayers.Util.applyDefaults({callback:e,scope:this},c["delete"])));return f},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,c){var d=c[a.requestType];d&&d.callback&&d.callback.call(d.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});
OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,
moveend:this.cluster,scope:this})}return a},cacheFeatures:function(a){var c=true;if(!this.clustering){this.clearCache();this.features=a.features;this.cluster();c=false}return c},clearCache:function(){this.features=null},cluster:function(a){if((!a||a.zoomChanged)&&this.features){a=this.layer.map.getResolution();if(a!=this.resolution||!this.clustersExist()){this.resolution=a;for(var a=[],c,d,e,f=0;f<this.features.length;++f){c=this.features[f];if(c.geometry){d=false;for(var g=a.length-1;g>=0;--g){e=
a[g];if(this.shouldCluster(e,c)){this.addToCluster(e,c);d=true;break}}d||a.push(this.createCluster(this.features[f]))}}this.layer.removeAllFeatures();if(a.length>0){if(this.threshold>1){c=a.slice();a=[];f=0;for(e=c.length;f<e;++f){d=c[f];d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}}this.clustering=true;this.layer.addFeatures(a);this.clustering=false}this.clusters=a}}},clustersExist:function(){var a=false;if(this.clusters&&this.clusters.length>0&&this.clusters.length==
this.layer.features.length)for(var a=true,c=0;c<this.clusters.length;++c)if(this.clusters[c]!=this.layer.features[c]){a=false;break}return a},shouldCluster:function(a,c){var d=a.geometry.getBounds().getCenterLonLat(),e=c.geometry.getBounds().getCenterLonLat();return Math.sqrt(Math.pow(d.lon-e.lon,2)+Math.pow(d.lat-e.lat,2))/this.resolution<=this.distance},addToCluster:function(a,c){a.cluster.push(c);a.attributes.count=a.attributes.count+1},createCluster:function(a){var c=a.geometry.getBounds().getCenterLonLat(),
c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(c.lon,c.lat),{count:1});c.cluster=[a];return c},CLASS_NAME:"OpenLayers.Strategy.Cluster"});
OpenLayers.Lang.en={unhandledRequest:"Unhandled request return ${statusText}",Permalink:"Permalink",Overlays:"Overlays","Base Layer":"Base Layer",noFID:"Can't update a feature for which there is no FID.",browserNotSupported:"Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}",minZoomLevelError:"The minZoomLevel property is only intended for use with the FixedZoomLevels-descendent layers. That this wfs layer checks for minZoomLevel is a relic of thepast. We cannot, however, remove it without possibly breaking OL based applications that may depend on it. Therefore we are deprecating it -- the minZoomLevel check below will be removed at 3.0. Please instead use min/max resolution setting as described here: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaction: SUCCESS ${response}",
commitFailed:"WFS Transaction: FAILED ${response}",googleWarning:"The Google Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the Google Maps library script was either not included, or does not contain the correct API key for your site.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",
getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>","Scale = 1 : ${scaleDenom}":"Scale = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",Graticule:"Graticule",
reprojectDeprecated:"You are using the 'reproject' option on the ${layerName} layer. This option is deprecated: its use was designed to support displaying data over commercial basemaps, but that functionality should now be achieved by using Spherical Mercator support. More information is available from http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"This method has been deprecated and will be removed in 3.0. Please use ${newMethod} instead.",proxyNeeded:"You probably need to set OpenLayers.ProxyHost to access ${url}.See http://trac.osgeo.org/openlayers/wiki/FrequentlyAskedQuestions#ProxyHost",
end:""};OpenLayers.Protocol.SOS=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS),c=OpenLayers.Protocol.SOS["v"+a.version.replace(/\./g,"_")];if(!c)throw"Unsupported SOS version: "+a.version;return new c(a)};OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"};
OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(a){var c=this.getElementsByTagNameNS(a,this.georssns,"point"),d=this.getElementsByTagNameNS(a,this.geons,"lat"),e=this.getElementsByTagNameNS(a,
this.geons,"long"),f=this.getElementsByTagNameNS(a,this.georssns,"line"),g=this.getElementsByTagNameNS(a,this.georssns,"polygon"),h=this.getElementsByTagNameNS(a,this.georssns,"where"),a=this.getElementsByTagNameNS(a,this.georssns,"box");if(c.length>0||d.length>0&&e.length>0){if(c.length>0){d=OpenLayers.String.trim(c[0].firstChild.nodeValue).split(/\s+/);d.length!=2&&(d=OpenLayers.String.trim(c[0].firstChild.nodeValue).split(/\s*,\s*/))}else d=[parseFloat(d[0].firstChild.nodeValue),parseFloat(e[0].firstChild.nodeValue)];
var i=new OpenLayers.Geometry.Point(d[1],d[0])}else if(f.length>0){d=OpenLayers.String.trim(this.getChildValue(f[0])).split(/\s+/);e=[];f=0;for(g=d.length;f<g;f=f+2){c=new OpenLayers.Geometry.Point(d[f+1],d[f]);e.push(c)}i=new OpenLayers.Geometry.LineString(e)}else if(g.length>0){d=OpenLayers.String.trim(this.getChildValue(g[0])).split(/\s+/);e=[];f=0;for(g=d.length;f<g;f=f+2){c=new OpenLayers.Geometry.Point(d[f+1],d[f]);e.push(c)}i=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(e)])}else if(h.length>
0){if(!this.gmlParser)this.gmlParser=new OpenLayers.Format.GML({xy:this.xy});i=this.gmlParser.parseFeature(h[0]).geometry}else if(a.length>0){d=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/);e=[];if(d.length>3){c=new OpenLayers.Geometry.Point(d[1],d[0]);e.push(c);c=new OpenLayers.Geometry.Point(d[1],d[2]);e.push(c);c=new OpenLayers.Geometry.Point(d[3],d[2]);e.push(c);c=new OpenLayers.Geometry.Point(d[3],d[0]);e.push(c);c=new OpenLayers.Geometry.Point(d[1],d[0]);e.push(c)}i=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(e)])}i&&
this.internalProjection&&this.externalProjection&&i.transform(this.externalProjection,this.internalProjection);return i},createFeatureFromItem:function(a){var c=this.createGeometryFromItem(a),d=this._getChildValue(a,"*","title",this.featureTitle),e=this._getChildValue(a,"*","description",this._getChildValue(a,"*","content",this._getChildValue(a,"*","summary",this.featureDescription))),f=this._getChildValue(a,"*","link");if(!f)try{f=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(g){f=
null}a=this._getChildValue(a,"*","id",null);c=new OpenLayers.Feature.Vector(c,{title:d,description:e,link:f});c.fid=a;return c},_getChildValue:function(a,c,d,e){return(a=this.getElementsByTagNameNS(a,c,d))&&a[0]&&a[0].firstChild&&a[0].firstChild.nodeValue?this.getChildValue(a[0]):e==void 0?"":e},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=null,c=this.getElementsByTagNameNS(a,"*","item");c.length==0&&(c=this.getElementsByTagNameNS(a,"*","entry"));
for(var a=c.length,d=Array(a),e=0;e<a;e++)d[e]=this.createFeatureFromItem(c[e]);return d},write:function(a){var c;if(OpenLayers.Util.isArray(a)){c=this.createElementNS(this.rssns,"rss");for(var d=0,e=a.length;d<e;d++)c.appendChild(this.createFeatureXML(a[d]))}else c=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createFeatureXML:function(a){var c=this.buildGeometryNode(a.geometry),d=this.createElementNS(this.rssns,"item"),e=this.createElementNS(this.rssns,"title");
e.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var f=this.createElementNS(this.rssns,"description");f.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:""));d.appendChild(e);d.appendChild(f);if(a.attributes.link){e=this.createElementNS(this.rssns,"link");e.appendChild(this.createTextNode(a.attributes.link));d.appendChild(e)}for(var g in a.attributes)if(!(g=="link"||g=="title"||g=="description")){e=this.createTextNode(a.attributes[g]);f=
g;g.search(":")!=-1&&(f=g.split(":")[1]);f=this.createElementNS(this.featureNS,"feature:"+f);f.appendChild(e);d.appendChild(f)}d.appendChild(c);return d},buildGeometryNode:function(a){if(this.internalProjection&&this.externalProjection){a=a.clone();a.transform(this.internalProjection,this.externalProjection)}var c;if(a.CLASS_NAME=="OpenLayers.Geometry.Polygon"){c=this.createElementNS(this.georssns,"georss:polygon");c.appendChild(this.buildCoordinatesNode(a.components[0]))}else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString"){c=
this.createElementNS(this.georssns,"georss:line");c.appendChild(this.buildCoordinatesNode(a))}else if(a.CLASS_NAME=="OpenLayers.Geometry.Point"){c=this.createElementNS(this.georssns,"georss:point");c.appendChild(this.buildCoordinatesNode(a))}else throw"Couldn't parse "+a.CLASS_NAME;return c},buildCoordinatesNode:function(a){var c=null;if(a.components)c=a.components;if(c){for(var a=c.length,d=Array(a),e=0;e<a;e++)d[e]=c[e].y+" "+c[e].x;c=d.join(" ")}else c=a.y+" "+a.x;return this.createTextNode(c)},
CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"});
OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;
var c={};this.readNode(a,c);return c},readers:{wps:{Capabilities:function(a,c){this.readChildNodes(a,c)},ProcessOfferings:function(a,c){c.processOfferings={};this.readChildNodes(a,c.processOfferings)},Process:function(a,c){var d={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion")};this.readChildNodes(a,d);c[d.identifier]=d},Languages:function(a,c){c.languages=[];this.readChildNodes(a,c.languages)},Default:function(a,c){var d={isDefault:true};this.readChildNodes(a,d);c.push(d)},
Supported:function(a,c){var d={};this.readChildNodes(a,d);c.push(d)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"});
OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;if(this.pinchZoom){this.pinchZoom.destroy();delete this.pinchZoom}OpenLayers.Control.prototype.destroy.apply(this,
arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragPan.activate();this.handlers.click.activate();this.pinchZoom.activate();return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.dragPan.deactivate();this.handlers.click.deactivate();this.pinchZoom.deactivate();return true}return false},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},c=OpenLayers.Util.extend({"double":true,
stopDouble:true,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,c);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&a.lastTouches.length==2&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),
this.map.zoom+1)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});
OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,c=this.rules.length;a<c;a++)this.rules[a].destroy();delete this.rules},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var c=0,d=this.rules.length;c<d;++c)a.rules.push(this.rules[c].clone())}return new OpenLayers.Style2(a)},
CLASS_NAME:"OpenLayers.Style2"});
OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},onLeave:function(){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.layer=a;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,
up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(a){if(this.handlers.feature.touch&&!this.over&&this.overFeature(a)){this.handlers.drag.dragstart(this.handlers.feature.evt);this.handlers.drag.stopDown=
false}},clickoutFeature:function(a){if(this.handlers.feature.touch&&this.over){this.outFeature(a);this.handlers.drag.stopDown=true}},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=false;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,
this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var c=false;if(this.handlers.drag.dragging)this.over=this.feature.id==a.id?true:false;else{this.feature=a;this.handlers.drag.activate();this.over=c=true;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over");this.onEnter(a)}return c},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var c=this.map.getResolution();this.feature.geometry.move(c*
(a.x-this.lastPixel.x),c*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){if(this.handlers.drag.dragging){if(this.feature.id==a.id)this.over=false}else{this.over=false;this.handlers.drag.deactivate();OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");this.onLeave(a);this.feature=
null}},cancel:function(){this.handlers.drag.deactivate();this.over=false},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});
OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,c,d){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,
arguments)){this.observeElement=this.observeElement||document;for(var a=0,c=this.KEY_EVENTS.length;a<c;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return true}return false},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,c=this.KEY_EVENTS.length;a<c;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=true}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&
this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});
OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,c){c=c||{};this.layer=
a;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,c.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[c]);if(!OpenLayers.Util.isArray(this.deleteCodes))this.deleteCodes=[this.deleteCodes];var d=this,e={geometryTypes:this.geometryTypes,
clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};if(this.standalone===false)this.selectControl=new OpenLayers.Control.SelectFeature(a,e);this.dragControl=new OpenLayers.Control.DragFeature(a,{geometryTypes:["OpenLayers.Geometry.Point"],onStart:function(a,c){d.dragStart.apply(d,[a,c])},onDrag:function(a,c){d.dragVertex.apply(d,[a,c])},onComplete:function(a){d.dragComplete.apply(d,[a])},featureCallbacks:{over:function(a){(d.standalone!==
true||a._sketch||d.feature===a)&&d.dragControl.overFeature.apply(d.dragControl,[a])}}});this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,{keydown:this.handleKeypress})}},destroy:function(){this.layer=null;this.standalone||this.selectControl.destroy();this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,
arguments)},deactivate:function(){var a=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:true});this.layer.removeFeatures(this.virtualVertices,{silent:true});this.vertices=[];this.dragControl.deactivate();var c=(a=this.feature)&&a.geometry&&a.layer;if(this.standalone===false){c&&this.selectControl.unselect.apply(this.selectControl,[a]);this.selectControl.deactivate()}else c&&this.unselectFeature(a);this.handlers.keyboard.deactivate();
a=true}return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:a})},selectFeature:function(a){if(!this.standalone||this.beforeSelectFeature(a)!==false){this.feature=a;this.modified=false;this.resetVertices();this.dragControl.activate();this.onModificationStart(this.feature)}var c=a.modified;if(a.geometry&&(!c||!c.geometry))this._originalGeometry=a.geometry.clone()},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,{silent:true});
this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});delete this.dragHandle}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});delete this.radiusHandle}this.feature=null;this.dragControl.deactivate();this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",{feature:a,modified:this.modified});this.modified=false},
dragStart:function(a,c){if(a!=this.feature&&!a.geometry.parent&&a!=this.dragHandle&&a!=this.radiusHandle){this.standalone===false&&this.feature&&this.selectControl.clickFeature.apply(this.selectControl,[this.feature]);if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)!=-1){this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[a]);this.dragControl.overFeature.apply(this.dragControl,[a]);this.dragControl.lastPixel=c;this.dragControl.handlers.drag.started=
true;this.dragControl.handlers.drag.start=c;this.dragControl.handlers.drag.last=c}}},dragVertex:function(a,c){this.modified=true;if(this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"){if(this.feature!=a)this.feature=a;this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:c})}else{if(a._index){a.geometry.parent.addComponent(a.geometry,a._index);delete a._index;OpenLayers.Util.removeItem(this.virtualVertices,a);this.vertices.push(a)}else if(a==this.dragHandle){this.layer.removeFeatures(this.vertices,
{silent:true});this.vertices=[];if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}}else a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:c});if(this.virtualVertices.length>0){this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent)}this.layer.drawFeature(a)},
dragComplete:function(){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE;if(this.modified&&this._originalGeometry){var a=this.feature;a.modified=OpenLayers.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}}},
resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature);if(this.vertices.length>0){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[]}if(this.virtualVertices.length>0){this.layer.removeFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});this.dragHandle=null}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});
this.radiusHandle=null}if(this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"){this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle();this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle();this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices())}},handleKeypress:function(a){var c=a.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,
c)!=-1)if((c=this.dragControl.feature)&&OpenLayers.Util.indexOf(this.vertices,c)!=-1&&!this.dragControl.handlers.drag.dragging&&c.geometry.parent){c.geometry.parent.removeComponent(c.geometry);this.layer.events.triggerEvent("vertexremoved",{vertex:c.geometry,feature:this.feature,pixel:a.xy});this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent);this.modified=true;this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",
{feature:this.feature})}},collectVertices:function(){function a(d){var e,f,g;if(d.CLASS_NAME=="OpenLayers.Geometry.Point"){f=new OpenLayers.Feature.Vector(d);f._sketch=true;f.renderIntent=c.vertexRenderIntent;c.vertices.push(f)}else{g=d.components.length;d.CLASS_NAME=="OpenLayers.Geometry.LinearRing"&&(g=g-1);for(e=0;e<g;++e){f=d.components[e];if(f.CLASS_NAME=="OpenLayers.Geometry.Point"){f=new OpenLayers.Feature.Vector(f);f._sketch=true;f.renderIntent=c.vertexRenderIntent;c.vertices.push(f)}else a(f)}if(c.createVertices&&
d.CLASS_NAME!="OpenLayers.Geometry.MultiPoint"){e=0;for(g=d.components.length;e<g-1;++e){f=d.components[e];var h=d.components[e+1];if(f.CLASS_NAME=="OpenLayers.Geometry.Point"&&h.CLASS_NAME=="OpenLayers.Geometry.Point"){f=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((f.x+h.x)/2,(f.y+h.y)/2),null,c.virtualStyle);f.geometry.parent=d;f._index=e+1;f._sketch=true;c.virtualVertices.push(f)}}}}}this.vertices=[];this.virtualVertices=[];var c=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,
{silent:true});this.layer.addFeatures(this.vertices,{silent:true})},collectDragHandle:function(){var a=this.feature.geometry,c=a.getBounds().getCenterLonLat(),c=new OpenLayers.Geometry.Point(c.lon,c.lat),d=new OpenLayers.Feature.Vector(c);c.move=function(c,d){OpenLayers.Geometry.Point.prototype.move.call(this,c,d);a.move(c,d)};d._sketch=true;this.dragHandle=d;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:true})},collectRadiusHandle:function(){var a=
this.feature.geometry,c=a.getBounds(),d=c.getCenterLonLat(),e=new OpenLayers.Geometry.Point(d.lon,d.lat),c=new OpenLayers.Geometry.Point(c.right,c.bottom),d=new OpenLayers.Feature.Vector(c),f=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,g=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,h=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;c.move=function(c,d){OpenLayers.Geometry.Point.prototype.move.call(this,c,d);var k=this.x-e.x,l=this.y-e.y,m=k-c,n=l-d;if(h){var o=Math.atan2(n,m),o=Math.atan2(l,
k)-o,o=o*(180/Math.PI);a.rotate(o,e)}if(f){var p;if(g){l=l/n;p=k/m/l}else{m=Math.sqrt(m*m+n*n);l=Math.sqrt(k*k+l*l)/m}a.resize(l,e,p)}};d._sketch=true;this.radiusHandle=d;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:true})},setMap:function(a){this.standalone||this.selectControl.setMap(a);this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});
OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;
OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(a,c){c.service={};this.readChildNodes(a,c.service)},Fees:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.fees=d},AccessConstraints:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.accessConstraints=d},OnlineResource:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.onlineResource=
d},Keywords:function(a,c){var d=this.getChildValue(a);if(d&&d.toLowerCase()!="none")c.keywords=d.split(", ")},Capability:function(a,c){c.capability={};this.readChildNodes(a,c.capability)},Request:function(a,c){c.request={};this.readChildNodes(a,c.request)},GetFeature:function(a,c){c.getfeature={href:{},formats:[]};this.readChildNodes(a,c.getfeature)},ResultFormat:function(a,c){for(var d=a.childNodes,e,f=0;f<d.length;f++){e=d[f];e.nodeType==1&&c.formats.push(e.nodeName)}},DCPType:function(a,c){this.readChildNodes(a,
c)},HTTP:function(a,c){this.readChildNodes(a,c.href)},Get:function(a,c){c.get=a.getAttribute("onlineResource")},Post:function(a,c){c.post=a.getAttribute("onlineResource")},SRS:function(a,c){var d=this.getChildValue(a);if(d)c.srs=d}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});
OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){typeof a==
"string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={features:[]};this.readNode(a,c);for(var a=[],d=0,e=c.features.length;d<e;d++){var f=c.features[d];this.internalProjection&&this.externalProjection&&f.components[0]&&f.components[0].transform(this.externalProjection,this.internalProjection);f=new OpenLayers.Feature.Vector(f.components[0],f.attributes);a.push(f)}return a},readers:{sa:{SamplingPoint:function(a,c){if(!c.attributes){var d=
{attributes:{}};c.features.push(d);c=d}c.attributes.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,c)},position:function(a,c){this.readChildNodes(a,c)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,c){this.readChildNodes(a,c)},featureMember:function(a,c){var d={attributes:{}};c.features.push(d);this.readChildNodes(a,d)},name:function(a,c){c.attributes.name=this.getChildValue(a)},pos:function(a,c){if(!this.externalProjection)this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName"));
OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,c])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(a){for(var c=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),d=0,e=a.fois.length;d<e;d++)this.writeNode("FeatureOfInterestId",{foi:a.fois[d]},c);return c},FeatureOfInterestId:function(a){return this.createElementNSPlus("FeatureOfInterestId",{value:a.foi})}}},
CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});
OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",
defaultPrefix:"sos",read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var c={measurements:[],observations:[]};this.readNode(a,c);return c},write:function(a){a=this.writeNode("sos:GetObservation",a);a.setAttribute("xmlns:om",this.namespaces.om);a.setAttribute("xmlns:ogc",this.namespaces.ogc);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,
[a])},readers:{om:{ObservationCollection:function(a,c){c.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,c)},member:function(a,c){this.readChildNodes(a,c)},Measurement:function(a,c){var d={};c.measurements.push(d);this.readChildNodes(a,d)},Observation:function(a,c){var d={};c.observations.push(d);this.readChildNodes(a,d)},samplingTime:function(a,c){var d={};c.samplingTime=d;this.readChildNodes(a,d)},observedProperty:function(a,c){c.observedProperty=this.getAttributeNS(a,this.namespaces.xlink,
"href");this.readChildNodes(a,c)},procedure:function(a,c){c.procedure=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,c)},featureOfInterest:function(a,c){var d={features:[]};c.fois=[];c.fois.push(d);this.readChildNodes(a,d);for(var e=[],f=0,g=d.features.length;f<g;f++){var h=d.features[f];e.push(new OpenLayers.Feature.Vector(h.components[0],h.attributes))}d.features=e},result:function(a,c){var d={};c.result=d;if(this.getChildValue(a)!==""){d.value=this.getChildValue(a);d.uom=
a.getAttribute("uom")}else this.readChildNodes(a,d)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,c){var d={};c.timeInstant=d;this.readChildNodes(a,d)},timePosition:function(a,c){c.timePosition=this.getChildValue(a)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var c=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});
this.writeNode("offering",a,c);a.eventTime&&this.writeNode("eventTime",a,c);for(var d in a.procedures)this.writeNode("procedure",a.procedures[d],c);for(var e in a.observedProperties)this.writeNode("observedProperty",a.observedProperties[e],c);a.foi&&this.writeNode("featureOfInterest",a.foi,c);this.writeNode("responseFormat",a,c);a.resultModel&&this.writeNode("resultModel",a,c);a.responseMode&&this.writeNode("responseMode",a,c);return c},featureOfInterest:function(a){var c=this.createElementNSPlus("featureOfInterest");
this.writeNode("ObjectID",a.objectId,c);return c},ObjectID:function(a){return this.createElementNSPlus("ObjectID",{value:a})},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a})},eventTime:function(a){var c=
this.createElementNSPlus("eventTime");a.eventTime==="latest"&&this.writeNode("ogc:TM_Equals",a,c);return c},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var c=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},c);a.eventTime==="latest"&&this.writeNode("gml:TimeInstant",
{value:"latest"},c);return c},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})}},gml:{TimeInstant:function(a){var c=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,c);return c},timePosition:function(a){return this.createElementNSPlus("gml:timePosition",{value:a.value})}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});
OpenLayers.Format.CQL=function(){function a(a){function c(){var a=f.pop();switch(a.type){case "LOGICAL":var d=c(),h=c();return new OpenLayers.Filter.Logical({filters:[h,d],type:g[a.text.toUpperCase()]});case "NOT":d=c();return new OpenLayers.Filter.Logical({filters:[d],type:OpenLayers.Filter.Logical.NOT});case "BETWEEN":f.pop();h=c();a=c();d=c();return new OpenLayers.Filter.Comparison({property:d,lowerBoundary:a,upperBoundary:h,type:OpenLayers.Filter.Comparison.BETWEEN});case "COMPARISON":h=c();d=
c();return new OpenLayers.Filter.Comparison({property:d,value:h,type:e[a.text.toUpperCase()]});case "VALUE":return/^'.*'$/.test(a.text)?a.text.substr(1,a.text.length-2):Number(a.text);case "SPATIAL":switch(a.text.toUpperCase()){case "BBOX":var d=c(),a=c(),h=c(),i=c(),j=c();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:j,value:OpenLayers.Bounds.fromArray([i,h,a,d])});case "INTERSECTS":h=c();d=c();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,
property:d,value:h});case "WITHIN":h=c();d=c();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:d,value:h});case "CONTAINS":h=c();d=c();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:d,value:h});case "DWITHIN":a=c();h=c();d=c();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:h,property:d,distance:Number(a)})}case "GEOMETRY":return OpenLayers.Geometry.fromWKT(a.text);default:return a.text}}
for(var d=[],f=[];a.length;){var h=a.shift();switch(h.type){case "PROPERTY":case "GEOMETRY":case "VALUE":f.push(h);break;case "COMPARISON":case "BETWEEN":case "LOGICAL":for(var j=i[h.type];d.length>0&&i[d[d.length-1].type]<=j;)f.push(d.pop());d.push(h);break;case "SPATIAL":case "NOT":case "LPAREN":d.push(h);break;case "RPAREN":for(;d.length>0&&d[d.length-1].type!="LPAREN";)f.push(d.pop());d.pop();d.length>0&&d[d.length-1].type=="SPATIAL"&&f.push(d.pop());case "COMMA":case "END":break;default:throw Error("Unknown token type "+
h.type);}}for(;d.length>0;)f.push(d.pop());a=c();if(f.length>0){a="Remaining tokens after building AST: \n";for(d=f.length-1;d>=0;d--)a=a+(f[d].type+": "+f[d].text+"\n");throw Error(a);}return a}var c={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('\w+'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(a){var c=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(a);
if(c){var d=a.length,c=a.indexOf("(",c[0].length);if(c>-1)for(var e=1;c<d&&e>0;){c++;switch(a.charAt(c)){case "(":e++;break;case ")":e--}}return[a.substr(0,c+1)]}},END:/^$/},d={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA"],BETWEEN:["VALUE"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],
NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},e={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN},f={},g={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},
h={},i={RPAREN:3,LOGICAL:2,COMPARISON:1},j;for(j in e)e.hasOwnProperty(j)&&(f[e[j]]=j);for(j in g)g.hasOwnProperty(j)&&(h[g[j]]=j);return OpenLayers.Class(OpenLayers.Format,{read:function(e){var f=e,e=[],g,h=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{a:{g=h;for(var i=void 0,h=void 0,j=g.length,i=0;i<j;i++){var h=g[i],q=c[h]instanceof RegExp?c[h].exec(f):(0,c[h])(f);if(q){g=q[0];f=f.substr(g.length).replace(/^\s*/,"");g={type:h,text:g,remainder:f};break a}}e="ERROR: In parsing: ["+f+"], expected one of: ";
for(i=0;i<j;i++){h=g[i];e=e+("\n    "+h+": "+c[h])}throw Error(e);}f=g.remainder;h=d[g.type];if(g.type!="END"&&!h)throw Error("No follows list for "+g.type);e.push(g)}while(g.type!="END");e=a(e);if(this.keepData)this.data=e;return e},write:function(a){if(a instanceof OpenLayers.Geometry)return a.toString();switch(a.CLASS_NAME){case "OpenLayers.Filter.Spatial":switch(a.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+a.property+","+a.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+
a.property+", "+this.write(a.value)+", "+a.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+a.property+", "+this.write(a.value)+")";default:throw Error("Unknown spatial filter type: "+a.type);}case "OpenLayers.Filter.Logical":if(a.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(a.filters[0])+
")";for(var c="(",d=true,e=0;e<a.filters.length;e++){d?d=false:c=c+(") "+h[a.type]+" (");c=c+this.write(a.filters[e])}return c+")";case "OpenLayers.Filter.Comparison":return a.type==OpenLayers.Filter.Comparison.BETWEEN?a.property+" BETWEEN "+this.write(a.lowerBoundary)+" AND "+this.write(a.upperBoundary):a.property+" "+f[a.type]+" "+this.write(a.value);case void 0:if(typeof a==="string")return"'"+a+"'";if(typeof a==="number")return""+a;default:throw Error("Can't encode: "+a.CLASS_NAME+" "+a);}},CLASS_NAME:"OpenLayers.Format.CQL"})}();
OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var c=document.createStyleSheet(),d=["shape","rect","oval","fill","stroke","imagedata","group","textbox"],e=0,f=d.length;e<f;e++)c.addRule("olv\\:"+d[e],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,
arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,c){var d=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),e=this.getResolution(),f=a.left/e|0,e=a.top/e-this.size.h|0;if(c||!this.offset){this.offset={x:f,y:e};e=f=0}else{f=f-this.offset.x;e=e-this.offset.y}this.root.coordorigin=f-this.xOffset+" "+e;for(var f=[this.root,this.vectorRoot,this.textRoot],g=0,h=f.length;g<h;++g){e=f[g];e.coordsize=this.size.w+" "+this.size.h}this.root.style.flip="y";
return d},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var c=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],d=this.size.w+"px",e=this.size.h+"px",f,g=0,h=c.length;g<h;++g){f=c[g];f.style.width=d;f.style.height=e}},getNodeType:function(a,c){var d=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":d=c.externalGraphic?"olv:rect":this.isComplexSymbol(c.graphicName)?"olv:shape":"olv:oval";break;case "OpenLayers.Geometry.Rectangle":d="olv:rect";
break;case "OpenLayers.Geometry.LineString":case "OpenLayers.Geometry.LinearRing":case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":d="olv:shape"}return d},setStyle:function(a,c,d,e){var c=c||a._style,d=d||a._options,f=c.fillColor;if(a._geometryClass==="OpenLayers.Geometry.Point")if(c.externalGraphic){d.isFilled=true;if(c.graphicTitle)a.title=c.graphicTitle;var f=c.graphicWidth||c.graphicHeight,g=c.graphicHeight||c.graphicWidth,f=f?f:c.pointRadius*2,g=g?g:c.pointRadius*2,h=this.getResolution(),
i=c.graphicXOffset!=void 0?c.graphicXOffset:-(0.5*f),j=c.graphicYOffset!=void 0?c.graphicYOffset:-(0.5*g);a.style.left=((e.x-this.featureDx)/h-this.offset.x+i|0)+"px";a.style.top=(e.y/h-this.offset.y-(j+g)|0)+"px";a.style.width=f+"px";a.style.height=g+"px";a.style.flip="y";f="none";d.isStroked=false}else if(this.isComplexSymbol(c.graphicName)){g=this.importSymbol(c.graphicName);a.path=g.path;a.coordorigin=g.left+","+g.bottom;g=g.size;a.coordsize=g+","+g;this.drawCircle(a,e,c.pointRadius);a.style.flip=
"y"}else this.drawCircle(a,e,c.pointRadius);d.isFilled?a.fillcolor=f:a.filled="false";e=a.getElementsByTagName("fill");e=e.length==0?null:e[0];if(d.isFilled){e||(e=this.createNode("olv:fill",a.id+"_fill"));e.opacity=c.fillOpacity;if(a._geometryClass==="OpenLayers.Geometry.Point"&&c.externalGraphic){if(c.graphicOpacity)e.opacity=c.graphicOpacity;e.src=c.externalGraphic;e.type="frame";if(!c.graphicWidth||!c.graphicHeight)e.aspect="atmost"}e.parentNode!=a&&a.appendChild(e)}else e&&a.removeChild(e);f=
c.rotation;if(f!==void 0||a._rotation!==void 0){a._rotation=f;if(c.externalGraphic){this.graphicRotate(a,i,j,c);e.opacity=0}else if(a._geometryClass==="OpenLayers.Geometry.Point")a.style.rotation=f||0}i=a.getElementsByTagName("stroke");i=i.length==0?null:i[0];if(d.isStroked){if(!i){i=this.createNode("olv:stroke",a.id+"_stroke");a.appendChild(i)}i.on=true;i.color=c.strokeColor;i.weight=c.strokeWidth+"px";i.opacity=c.strokeOpacity;i.endcap=c.strokeLinecap=="butt"?"flat":c.strokeLinecap||"round";if(c.strokeDashstyle)i.dashstyle=
this.dashStyle(c)}else{a.stroked=false;if(i)i.on=false}if(c.cursor!="inherit"&&c.cursor!=null)a.style.cursor=c.cursor;return a},graphicRotate:function(a,c,d,e){var e=e||a._style,f=e.rotation||0,g,h;if(!e.graphicWidth||!e.graphicHeight){var i=new Image;i.onreadystatechange=OpenLayers.Function.bind(function(){if(i.readyState=="complete"||i.readyState=="interactive"){g=i.width/i.height;h=Math.max(e.pointRadius*2,e.graphicWidth||0,e.graphicHeight||0);c=c*g;e.graphicWidth=h*g;e.graphicHeight=h;this.graphicRotate(a,
c,d,e)}},this);i.src=e.externalGraphic}else{h=Math.max(e.graphicWidth,e.graphicHeight);g=e.graphicWidth/e.graphicHeight;var j=Math.round(e.graphicWidth||h*g),k=Math.round(e.graphicHeight||h);a.style.width=j+"px";a.style.height=k+"px";var l=document.getElementById(a.id+"_image");if(!l){l=this.createNode("olv:imagedata",a.id+"_image");a.appendChild(l)}l.style.width=j+"px";l.style.height=k+"px";l.src=e.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";
l=f*Math.PI/180;f=Math.sin(l);l=Math.cos(l);f="progid:DXImageTransform.Microsoft.Matrix(M11="+l+",M12="+-f+",M21="+f+",M22="+l+",SizingMethod='auto expand')\n";(l=e.graphicOpacity||e.fillOpacity)&&l!=1&&(f=f+("progid:DXImageTransform.Microsoft.BasicImage(opacity="+l+")\n"));a.style.filter=f;f=new OpenLayers.Geometry.Point(-c,-d);j=(new OpenLayers.Bounds(0,0,j,k)).toGeometry();j.rotate(e.rotation,f);j=j.getBounds();a.style.left=Math.round(parseInt(a.style.left)+j.left)+"px";a.style.top=Math.round(parseInt(a.style.top)-
j.bottom)+"px"}},postDraw:function(a){a.style.visibility="visible";var c=a._style.fillColor,d=a._style.strokeColor;if(c=="none"&&a.fillcolor!=c)a.fillcolor=c;if(d=="none"&&a.strokecolor!=d)a.strokecolor=d},setNodeDimension:function(a,c){var d=c.getBounds();if(d){var e=this.getResolution(),d=new OpenLayers.Bounds((d.left-this.featureDx)/e-this.offset.x|0,d.bottom/e-this.offset.y|0,(d.right-this.featureDx)/e-this.offset.x|0,d.top/e-this.offset.y|0);a.style.left=d.left+"px";a.style.top=d.top+"px";a.style.width=
d.getWidth()+"px";a.style.height=d.getHeight()+"px";a.coordorigin=d.left+" "+d.top;a.coordsize=d.getWidth()+" "+d.getHeight()}},dashStyle:function(a){a=a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a;default:a=a.split(/[ ,]/);return a.length==2?1*a[0]>=2*a[1]?"longdash":a[0]==1||a[1]==1?"dot":"dash":a.length==4?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,c){var d=document.createElement(a);if(c)d.id=
c;d.unselectable="on";d.onselectstart=OpenLayers.Function.False;return d},nodeTypeCompare:function(a,c){var d=c,e=d.indexOf(":");e!=-1&&(d=d.substr(e+1));var f=a.nodeName,e=f.indexOf(":");e!=-1&&(f=f.substr(e+1));return d==f},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,c){return this.drawCircle(a,c,1)},drawCircle:function(a,c,d){if(!isNaN(c.x)&&!isNaN(c.y)){var e=
this.getResolution();a.style.left=((c.x-this.featureDx)/e-this.offset.x|0)-d+"px";a.style.top=(c.y/e-this.offset.y|0)-d+"px";c=d*2;a.style.width=c+"px";a.style.height=c+"px";return a}return false},drawLineString:function(a,c){return this.drawLine(a,c,false)},drawLinearRing:function(a,c){return this.drawLine(a,c,true)},drawLine:function(a,c,d){this.setNodeDimension(a,c);for(var e=this.getResolution(),f=c.components.length,g=Array(f),h,i,j=0;j<f;j++){h=c.components[j];i=(h.x-this.featureDx)/e-this.offset.x|
0;h=h.y/e-this.offset.y|0;g[j]=" "+i+","+h+" l "}a.path="m"+g.join("")+(d?" x e":" e");return a},drawPolygon:function(a,c){this.setNodeDimension(a,c);var d=this.getResolution(),e=[],f,g,h,i,j,k,l,m,n,o;f=0;for(g=c.components.length;f<g;f++){e.push("m");h=c.components[f].components;i=f===0;k=j=null;l=0;for(m=h.length;l<m;l++){n=h[l];o=(n.x-this.featureDx)/d-this.offset.x|0;n=n.y/d-this.offset.y|0;o=" "+o+","+n;e.push(o);l==0&&e.push(" l");i||(j?j!=o&&(k?k!=o&&(i=true):k=o):j=o)}e.push(i?" x ":" ")}e.push("e");
a.path=e.join("");return a},drawRectangle:function(a,c){var d=this.getResolution();a.style.left=((c.x-this.featureDx)/d-this.offset.x|0)+"px";a.style.top=(c.y/d-this.offset.y|0)+"px";a.style.width=(c.width/d|0)+"px";a.style.height=(c.height/d|0)+"px";return a},drawText:function(a,c,d){var e=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"olv:rect"),f=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),g=this.getResolution();e.style.left=((d.x-this.featureDx)/g-this.offset.x|0)+"px";e.style.top=
(d.y/g-this.offset.y|0)+"px";e.style.flip="y";f.innerText=c.label;if(c.cursor!="inherit"&&c.cursor!=null)f.style.cursor=c.cursor;if(c.fontColor)f.style.color=c.fontColor;if(c.fontOpacity)f.style.filter="alpha(opacity="+c.fontOpacity*100+")";if(c.fontFamily)f.style.fontFamily=c.fontFamily;if(c.fontSize)f.style.fontSize=c.fontSize;if(c.fontWeight)f.style.fontWeight=c.fontWeight;if(c.fontStyle)f.style.fontStyle=c.fontStyle;if(c.labelSelect===true){e._featureId=a;f._featureId=a;f._geometry=d;f._geometryClass=
d.CLASS_NAME}f.style.whiteSpace="nowrap";f.inset="1px,0px,0px,0px";if(!e.parentNode){e.appendChild(f);this.textRoot.appendChild(e)}c=c.labelAlign||"cm";c.length==1&&(c=c+"m");a=f.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[c.substr(0,1)];f=f.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[c.substr(1,1)];e.style.left=parseInt(e.style.left)-a-1+"px";e.style.top=parseInt(e.style.top)+f+"px"},moveRoot:function(a){var c=this.map.getLayer(a.container.id);c instanceof OpenLayers.Layer.Vector.RootContainer&&
(c=this.map.getLayer(this.container.id));c&&c.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);c&&c.redraw()},importSymbol:function(a){var c=this.container.id+"-"+a,d=this.symbolCache[c];if(d)return d;d=OpenLayers.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");for(var a=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),e=["m"],f=0;f<d.length;f=f+2){var g=d[f],h=d[f+1];a.left=Math.min(a.left,g);a.bottom=Math.min(a.bottom,h);a.right=
Math.max(a.right,g);a.top=Math.max(a.top,h);e.push(g);e.push(h);f==0&&e.push("l")}e.push("x e");d=e.join(" ");e=(a.getWidth()-a.getHeight())/2;if(e>0){a.bottom=a.bottom-e;a.top=a.top+e}else{a.left=a.left+e;a.right=a.right-e}d={path:d,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[c]=d},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};
OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var c,d=this.layers||a.layers;for(c=d.length-1;c>=0;--c)this.addLayer({layer:d[c]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(a){a.layer.events.unregister(this.fetchEvent,
this,this.fetch)},fetch:function(a){if(this.active&&window.localStorage&&a.tile instanceof OpenLayers.Tile.Image){var c=a.tile,d=c.url;!c.layer.crossOriginKeyword&&OpenLayers.ProxyHost&&d.indexOf(OpenLayers.ProxyHost)===0&&(d=OpenLayers.Control.CacheWrite.urlMap[d]);if(d=window.localStorage.getItem("olCache_"+d)){c.url=d;a.type==="tileerror"&&c.setImgSrc(d)}}},destroy:function(){if(this.layers||this.map){var a,c=this.layers||this.map.layers;for(a=c.length-1;a>=0;--a)this.removeLayer({layer:c[a]})}this.map&&
this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});
OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);if(!a.format)this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,
this.options||{});var c=new OpenLayers.Protocol.Response({requestType:"read"}),d=this.format.write(a.params);c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers,data:d});return c},handleRead:function(a,c){if(c.callback){var d=a.priv;if(d.status>=200&&d.status<300){a.data=this.parseData(d);a.code=OpenLayers.Protocol.Response.SUCCESS}else a.code=OpenLayers.Protocol.Response.FAILURE;c.callback.call(c.scope,a)}},parseData:function(a){var c=
a.responseXML;if(!c||!c.documentElement)c=a.responseText;return!c||c.length<=0?null:this.format.read(c)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"});
OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.0050,0.0020,0.0010],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||OpenLayers.i18n("Graticule");OpenLayers.Control.prototype.initialize.apply(this,
[a]);this.labelSymbolizer.stroke=false;this.labelSymbolizer.fill=false;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.gratLayer){this.gratLayer.destroy();this.gratLayer=null}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=
new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.addLayer(this.gratLayer);this.map.events.register("moveend",this,this.update);this.update();
return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("moveend",this,this.update);this.map.removeLayer(this.gratLayer);return true}return false},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var c=new OpenLayers.Projection("EPSG:4326"),d=this.map.getProjectionObject(),e=this.map.getResolution();if(d.proj&&d.proj.projName=="longlat")this.numPoints=1;var f=this.map.getCenter(),
g=new OpenLayers.Pixel(f.lon,f.lat);OpenLayers.Projection.transform(g,d,c);for(var f=this.targetSize*e,f=f*f,h,e=0;e<this.intervals.length;++e){h=this.intervals[e];var i=h/2,j=g.offset({x:-i,y:-i}),i=g.offset({x:i,y:i});OpenLayers.Projection.transform(j,c,d);OpenLayers.Projection.transform(i,c,d);if((j.x-i.x)*(j.x-i.x)+(j.y-i.y)*(j.y-i.y)<=f)break}g.x=Math.floor(g.x/h)*h;g.y=Math.floor(g.y/h)*h;var e=0,f=[g.clone()],i=g.clone(),k;do{i=i.offset({x:0,y:h});k=OpenLayers.Projection.transform(i.clone(),
c,d);f.unshift(i)}while(a.containsPixel(k)&&++e<1E3);i=g.clone();do{i=i.offset({x:0,y:-h});k=OpenLayers.Projection.transform(i.clone(),c,d);f.push(i)}while(a.containsPixel(k)&&++e<1E3);e=0;j=[g.clone()];i=g.clone();do{i=i.offset({x:-h,y:0});k=OpenLayers.Projection.transform(i.clone(),c,d);j.unshift(i)}while(a.containsPixel(k)&&++e<1E3);i=g.clone();do{i=i.offset({x:h,y:0});k=OpenLayers.Projection.transform(i.clone(),c,d);j.push(i)}while(a.containsPixel(k)&&++e<1E3);h=[];for(e=0;e<j.length;++e){k=j[e].x;
for(var g=[],l=null,m=Math.min(f[0].y,90),i=Math.max(f[f.length-1].y,-90),n=(m-i)/this.numPoints,m=i,i=0;i<=this.numPoints;++i){var o=new OpenLayers.Geometry.Point(k,m);o.transform(c,d);g.push(o);m=m+n;o.y>=a.bottom&&!l&&(l=o)}if(this.labelled){l=new OpenLayers.Geometry.Point(l.x,a.bottom);k={value:k,label:this.labelled?OpenLayers.Util.getFormattedLonLat(k,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(l,k))}g=new OpenLayers.Geometry.LineString(g);
h.push(new OpenLayers.Feature.Vector(g))}for(i=0;i<f.length;++i){m=f[i].y;if(!(m<-90||m>90)){g=[];e=j[0].x;n=(j[j.length-1].x-e)/this.numPoints;k=e;l=null;for(e=0;e<=this.numPoints;++e){o=new OpenLayers.Geometry.Point(k,m);o.transform(c,d);g.push(o);k=k+n;o.x<a.right&&(l=o)}if(this.labelled){l=new OpenLayers.Geometry.Point(a.right,l.y);k={value:m,label:this.labelled?OpenLayers.Util.getFormattedLonLat(m,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(l,
k))}g=new OpenLayers.Geometry.LineString(g);h.push(new OpenLayers.Feature.Vector(g))}}this.gratLayer.addFeatures(h)}},CLASS_NAME:"OpenLayers.Control.Graticule"});
OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,{},a]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},clone:function(a){a==null&&(a=new OpenLayers.Layer.UTFGrid(this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getFeatureInfo:function(a){var c=null,a=this.getTileData(a);a.tile&&(c=a.tile.getFeatureInfo(a.i,a.j));return c},getFeatureId:function(a){var c=null,a=this.getTileData(a);a.tile&&(c=a.tile.getFeatureId(a.i,a.j));return c},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});
OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.format)this.format=new OpenLayers.Format.GeoJSON;if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var c=
new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(a,e){return c.write(a,e)}}},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);if(a.filter&&this.filterToParams)a.params=this.filterToParams(a.filter,a.params);var c=new OpenLayers.Protocol.Response({requestType:"read"}),d=this.createRequest(a.url,a.params,OpenLayers.Function.bind(function(d){c.data=
d;this.handleRead(c,a)},this));c.priv=d;return c},createRequest:function(a,c,d){var d=OpenLayers.Protocol.Script.register(d),e=OpenLayers.String.format(this.callbackTemplate,{id:d}),c=OpenLayers.Util.extend({},c);c[this.callbackKey]=this.callbackPrefix+e;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(c));c=document.createElement("script");c.type="text/javascript";c.src=a;c.id="OpenLayers_Protocol_Script_"+d;this.pendingRequests[c.id]=c;document.getElementsByTagName("head")[0].appendChild(c);
return c},destroyRequest:function(a){OpenLayers.Protocol.Script.unregister(a.id.split("_").pop());delete this.pendingRequests[a.id];a.parentNode&&a.parentNode.removeChild(a)},handleRead:function(a,c){this.handleResponse(a,c)},handleResponse:function(a,c){if(c.callback){var d=a.priv;if(a.data){a.features=this.parseFeatures(a.data);a.code=OpenLayers.Protocol.Response.SUCCESS}else a.code=OpenLayers.Protocol.Response.FAILURE;this.destroyRequest(d);c.callback.call(c.scope,a)}},parseFeatures:function(a){return this.format.read(a)},
abort:function(a){if(a)this.destroyRequest(a.priv);else for(var c in this.pendingRequests)this.destroyRequest(this.pendingRequests[c])},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var a=OpenLayers.Protocol.Script,c=0;a.registry={};a.register=function(d){var e="c"+ ++c;a.registry[e]=function(){d.apply(this,arguments)};return e};a.unregister=function(c){delete a.registry[c]}})();
OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(a,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.layer=a;if(!this.rotationHandleSymbolizer)this.rotationHandleSymbolizer={stroke:false,pointRadius:10,
fillOpacity:0,cursor:"pointer"};this.createBox();this.createControl()},activate:function(){var a=false;if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragControl.activate();this.layer.addFeatures([this.box]);this.rotate&&this.layer.addFeatures(this.rotationHandles);this.layer.addFeatures(this.handles);a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.handles);this.rotate&&this.layer.removeFeatures(this.rotationHandles);
this.layer.removeFeatures([this.box]);this.dragControl.deactivate();a=true}return a},setMap:function(a){this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,c){var c=OpenLayers.Util.applyDefaults(c,{rotation:0,scale:1,ratio:1}),d=this.rotation,e=this.center;OpenLayers.Util.extend(this,c);if(this.events.triggerEvent("beforesetfeature",{feature:a})!==false){this.feature=a;this.activate();this._setfeature=true;var f=this.feature.geometry.getBounds();
this.box.move(f.getCenterLonLat());this.box.geometry.rotate(-d,e);this._angle=0;if(this.rotation){d=a.geometry.clone();d.rotate(-this.rotation,this.center);d=new OpenLayers.Feature.Vector(d.getBounds().toGeometry());d.geometry.rotate(this.rotation,this.center);this.box.geometry.rotate(this.rotation,this.center);this.box.move(d.geometry.getBounds().getCenterLonLat());d=d.geometry.components[0].components[0].getBounds().getCenterLonLat()}else d=new OpenLayers.LonLat(f.left,f.bottom);this.handles[0].move(d);
delete this._setfeature;this.events.triggerEvent("setfeature",{feature:a})}},unsetFeature:function(){if(this.active)this.deactivate();else{this.feature=null;this.rotation=0;this.ratio=this.scale=1}},createBox:function(){var a=this;this.center=new OpenLayers.Geometry.Point(0,0);this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,
1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,typeof this.renderIntent=="string"?null:this.renderIntent);this.box.geometry.move=function(c,d){a._moving=true;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);a.center.move(c,d);delete a._moving};for(var c=function(a,c){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(a,
c);this._handle.geometry.move(a,c)},d=function(a,c,d){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(a,c,d);this._handle.geometry.resize(a,c,d)},e=function(a,c){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(a,c);this._handle.geometry.rotate(a,c)},f=function(c,d){var e=this.x,f=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,c,d);if(!a._moving){var g=
a.dragControl.handlers.drag.evt,h=!(!a._setfeature&&a.preserveAspectRatio)&&!(g&&g.shiftKey),i=new OpenLayers.Geometry.Point(e,f),g=a.center;this.rotate(-a.rotation,g);i.rotate(-a.rotation,g);var j=this.x-g.x,k=this.y-g.y,l=j-(this.x-i.x),m=k-(this.y-i.y);if(a.irregular&&!a._setfeature){j=j-(this.x-i.x)/2;k=k-(this.y-i.y)/2}this.x=e;this.y=f;i=1;if(h){k=Math.abs(m)<1.0E-5?1:k/m;i=(Math.abs(l)<1.0E-5?1:j/l)/k}else{l=Math.sqrt(l*l+m*m);k=Math.sqrt(j*j+k*k)/l}a._moving=true;a.box.geometry.rotate(-a.rotation,
g);delete a._moving;a.box.geometry.resize(k,g,i);a.box.geometry.rotate(a.rotation,g);a.transformFeature({scale:k,ratio:i});if(a.irregular&&!a._setfeature){j=g.clone();j.x=j.x+(Math.abs(e-g.x)<1.0E-5?0:this.x-e);j.y=j.y+(Math.abs(f-g.y)<1.0E-5?0:this.y-f);a.box.geometry.move(this.x-e,this.y-f);a.transformFeature({center:j})}}},g=function(c,d){var e=this.x,f=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,c,d);if(!a._moving){var g=a.dragControl.handlers.drag.evt,g=g&&g.shiftKey?45:1,h=a.center,
i=this.x-h.x,j=this.y-h.y;this.x=e;this.y=f;e=Math.atan2(j-d,i-c);e=Math.atan2(j,i)-e;e=e*(180/Math.PI);a._angle=(a._angle+e)%360;e=a.rotation%g;if(Math.abs(a._angle)>=g||e!==0){e=Math.round(a._angle/g)*g-e;a._angle=0;a.box.geometry.rotate(e,h);a.transformFeature({rotation:e})}}},h=Array(8),i=Array(4),j,k,l,m=["sw","s","se","e","ne","n","nw","w"],n=0;n<8;++n){j=this.box.geometry.components[n];k=new OpenLayers.Feature.Vector(j.clone(),{role:m[n]+"-resize"},typeof this.renderIntent=="string"?null:this.renderIntent);
if(n%2==0){l=new OpenLayers.Feature.Vector(j.clone(),{role:m[n]+"-rotate"},typeof this.rotationHandleSymbolizer=="string"?null:this.rotationHandleSymbolizer);l.geometry.move=g;j._rotationHandle=l;i[n/2]=l}j.move=c;j.resize=d;j.rotate=e;k.geometry.move=f;j._handle=k;h[n]=k}this.rotationHandles=i;this.handles=h},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:true,moveFeature:function(c){if(this.feature===a.feature)this.feature=a.box;
OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(c){c===a.box&&a.transformFeature({center:a.center})},onStart:function(c){var d=!a.geometryTypes||OpenLayers.Util.indexOf(a.geometryTypes,c.geometry.CLASS_NAME)!==-1,e=OpenLayers.Util.indexOf(a.handles,c),e=e+OpenLayers.Util.indexOf(a.rotationHandles,c);c!==a.feature&&c!==a.box&&e==-2&&d&&a.setFeature(c)},onComplete:function(){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){for(var a=
this.layer,c=0;c<8;++c){this.rotate&&c%2===0&&a.drawFeature(this.rotationHandles[c/2],this.rotationHandleSymbolizer);a.drawFeature(this.handles[c],this.renderIntent)}},transformFeature:function(a){if(!this._setfeature){this.scale=this.scale*(a.scale||1);this.ratio=this.ratio*(a.ratio||1);var c=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(this.events.triggerEvent("beforetransform",a)!==false){var d=this.feature,e=d.geometry,f=this.center;e.rotate(-c,f);a.scale||a.ratio?e.resize(a.scale,
f,a.ratio):a.center&&d.move(a.center.getBounds().getCenterLonLat());e.rotate(this.rotation,f);this.layer.drawFeature(d);d.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform",a)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){for(var a,c=0;c<8;++c){a=this.box.geometry.components[c];a._handle.destroy();a._handle=null;a._rotationHandle&&a._rotationHandle.destroy();a._rotationHandle=null}this.rotationHandles=this.rotationHandleSymbolizer=this.handles=
this.feature=this.center=null;this.box.destroy();this.layer=this.box=null;this.dragControl.destroy();this.dragControl=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"});
OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);if(!this.format)this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions);
if(this.drillDown===true)this.hover=false;if(this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{a={};a[this.clickCallback]=this.getInfoForClick;this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{})}},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");
this.request(a.xy,{})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});this.request(a.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){for(var a=this.layers||this.map.layers,c=[],d,e,f=a.length-1;f>=0;--f){d=a[f];if(d instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||d.getVisibility())){e=OpenLayers.Util.isArray(d.url)?d.url[0]:d.url;if(this.drillDown===false&&!this.url)this.url=
e;(this.drillDown===true||this.urlMatches(e))&&c.push(d)}}return c},urlMatches:function(a){var c=OpenLayers.Util.isEquivalentUrl(this.url,a);if(!c&&this.layerUrls)for(var d=0,e=this.layerUrls.length;d<e;++d)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[d],a)){c=true;break}return c},buildWMSOptions:function(a,c,d,e){for(var f=[],g=[],h=0,i=c.length;h<i;h++)if(c[h].params.LAYERS!=null){f=f.concat(c[h].params.LAYERS);g=g.concat(this.getStyleNames(c[h]))}c=c[0];h=this.map.getProjection();(i=c.projection)&&
i.equals(this.map.getProjectionObject())&&(h=i.getCode());e=OpenLayers.Util.extend({service:"WMS",version:c.params.VERSION,request:"GetFeatureInfo",exceptions:c.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,c.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:e,info_format:c.params.INFO_FORMAT||this.infoFormat},parseFloat(c.params.VERSION)>=1.3?{crs:h,i:parseInt(d.x),j:parseInt(d.y)}:{srs:h,x:parseInt(d.x),y:parseInt(d.y)});f.length!=
0&&(e=OpenLayers.Util.extend({layers:f,query_layers:f,styles:g},e));OpenLayers.Util.applyDefaults(e,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(e),callback:function(c){this.handleResponse(d,c,a)},scope:this}},getStyleNames:function(a){return a.params.STYLES?a.params.STYLES:OpenLayers.Util.isArray(a.params.LAYERS)?Array(a.params.LAYERS.length):a.params.LAYERS.replace(/[^,]/g,"")},request:function(a,c){var d=this.findLayers();if(d.length==0){this.events.triggerEvent("nogetfeatureinfo");
OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")}else{c=c||{};if(this.drillDown===false){var d=this.buildWMSOptions(this.url,d,a,d[0].params.FORMAT),e=OpenLayers.Request.GET(d);if(c.hover===true)this.hoverRequest=e}else{this._numRequests=this._requestCount=0;this.features=[];for(var e={},f,g=0,h=d.length;g<h;g++){var i=d[g];f=OpenLayers.Util.isArray(i.url)?i.url[0]:i.url;if(f in e)e[f].push(i);else{this._numRequests++;e[f]=[i]}}for(f in e){d=e[f];d=this.buildWMSOptions(f,d,a,d[0].params.FORMAT);
OpenLayers.Request.GET(d)}}}},triggerGetFeatureInfo:function(a,c,d){this.events.triggerEvent("getfeatureinfo",{text:a.responseText,features:d,request:a,xy:c});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(a,c,d){var e=c.responseXML;if(!e||!e.documentElement)e=c.responseText;e=this.format.read(e);if(this.drillDown===false)this.triggerGetFeatureInfo(c,a,e);else{this._requestCount++;this._features=this.output==="object"?(this._features||[]).concat({url:d,
features:e}):(this._features||[]).concat(e);if(this._requestCount===this._numRequests){this.triggerGetFeatureInfo(c,a,this._features.concat());delete this._features;delete this._requestCount;delete this._numRequests}}},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});
OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,c){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]);this.layer=c;if(this.layer.featureNS)this.featureNS=this.layer.featureNS;if(this.layer.options.geometry_column)this.geometryName=this.layer.options.geometry_column;if(this.layer.options.typename)this.featureName=this.layer.options.typename},write:function(a){var c=this.createElementNS(this.wfsns,
"wfs:Transaction");c.setAttribute("version","1.0.0");c.setAttribute("service","WFS");for(var d=0;d<a.length;d++)switch(a[d].state){case OpenLayers.State.INSERT:c.appendChild(this.insert(a[d]));break;case OpenLayers.State.UPDATE:c.appendChild(this.update(a[d]));break;case OpenLayers.State.DELETE:c.appendChild(this.remove(a[d]))}return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createFeatureXML:function(a){var c=this.buildGeometryNode(a.geometry),d=this.createElementNS(this.featureNS,"feature:"+
this.geometryName);d.appendChild(c);c=this.createElementNS(this.featureNS,"feature:"+this.featureName);c.appendChild(d);for(var e in a.attributes){var d=this.createTextNode(a.attributes[e]),f=e;e.search(":")!=-1&&(f=e.split(":")[1]);f=this.createElementNS(this.featureNS,"feature:"+f);f.appendChild(d);c.appendChild(f)}return c},insert:function(a){var c=this.createElementNS(this.wfsns,"wfs:Insert");c.appendChild(this.createFeatureXML(a));return c},update:function(a){a.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));
var c=this.createElementNS(this.wfsns,"wfs:Update");c.setAttribute("typeName",this.featurePrefix+":"+this.featureName);c.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var d=this.createElementNS(this.wfsns,"wfs:Property"),e=this.createElementNS(this.wfsns,"wfs:Name"),f=this.createTextNode(this.geometryName);e.appendChild(f);d.appendChild(e);e=this.createElementNS(this.wfsns,"wfs:Value");f=this.buildGeometryNode(a.geometry);a.layer&&f.setAttribute("srsName",a.layer.projection.getCode());
e.appendChild(f);d.appendChild(e);c.appendChild(d);for(var g in a.attributes){d=this.createElementNS(this.wfsns,"wfs:Property");e=this.createElementNS(this.wfsns,"wfs:Name");e.appendChild(this.createTextNode(g));d.appendChild(e);e=this.createElementNS(this.wfsns,"wfs:Value");e.appendChild(this.createTextNode(a.attributes[g]));d.appendChild(e);c.appendChild(d)}d=this.createElementNS(this.ogcns,"ogc:Filter");g=this.createElementNS(this.ogcns,"ogc:FeatureId");g.setAttribute("fid",a.fid);d.appendChild(g);
c.appendChild(d);return c},remove:function(a){if(!a.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"));return false}var c=this.createElementNS(this.wfsns,"wfs:Delete");c.setAttribute("typeName",this.featurePrefix+":"+this.featureName);c.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var d=this.createElementNS(this.ogcns,"ogc:Filter"),e=this.createElementNS(this.ogcns,"ogc:FeatureId");e.setAttribute("fid",a.fid);d.appendChild(e);c.appendChild(d);return c},destroy:function(){this.layer=
null},CLASS_NAME:"OpenLayers.Format.WFS"});
OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(a){this.handlerMode=a;this.resetHandler()},resetHandler:function(){if(this.handler){this.handler.deactivate();this.handler.destroy();this.handler=null}if(this.handlerMode=="hover")this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},
this.handlerOptions);else if(this.handlerMode=="click")this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions);else if(this.handlerMode=="move")this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions);return this.handler?true:false},initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[a]);this.resetHandler()},handleEvent:function(a){if(a==
null)this.reset();else{var c=this.map.getLonLatFromPixel(a.xy);if(c){var d=this.findLayers();if(d.length>0){for(var e={},f,g,h=0,i=d.length;h<i;h++){f=d[h];g=OpenLayers.Util.indexOf(this.map.layers,f);e[g]=f.getFeatureInfo(c)}this.callback(e,c,a.xy)}}}},callback:function(){},reset:function(){this.callback(null)},findLayers:function(){for(var a=this.layers||this.map.layers,c=[],d,e=a.length-1;e>=0;--e){d=a[e];d instanceof OpenLayers.Layer.UTFGrid&&c.push(d)}return c},CLASS_NAME:"OpenLayers.Control.UTFGrid"});
OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);if(!a.format)this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions)},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||
{});var c=new OpenLayers.Protocol.Response({requestType:"read"}),d=this.format,d=OpenLayers.Format.XML.prototype.write.apply(d,[d.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:d});return c},handleRead:function(a,c){if(c.callback){var d=a.priv;if(d.status>=200&&d.status<300){a.features=this.parseFeatures(d);a.code=OpenLayers.Protocol.Response.SUCCESS}else a.code=OpenLayers.Protocol.Response.FAILURE;
c.callback.call(c.scope,a)}},parseFeatures:function(a){var c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;return!c||c.length<=0?null:this.format.read(c)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});
OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(a,c,d,e){this.layername=d;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,c,{},e]);this.extension=this.format.split("/")[1].toLowerCase();this.extension=this.extension=="jpg"?"jpeg":this.extension},clone:function(a){a==null&&(a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){function c(a,c){for(var a=""+a,d=[],e=0;e<c;++e)d.push("0");return d.join("").substring(0,c-a.length)+a}var d=this.getServerResolution(),e=this.maxExtent,f=this.tileSize,g=Math.round((a.left-e.left)/(d*f.w)),a=Math.round((a.bottom-e.bottom)/(d*f.h)),d=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,d):this.map.getZoom(),g=[this.layername,c(d,2),c(parseInt(g/1E6),3),c(parseInt(g/1E3)%1E3,3),c(parseInt(g)%1E3,3),c(parseInt(a/1E6),3),c(parseInt(a/
1E3)%1E3,3),c(parseInt(a)%1E3,3)+"."+this.extension].join("/"),d=this.url;OpenLayers.Util.isArray(d)&&(d=this.selectUrl(g,d));d=d.charAt(d.length-1)=="/"?d:d+"/";return d+g},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,c){c.srs[this.getChildValue(a)]=true}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});
OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(a,c){c.vendorSpecific={tileSets:[]};this.readChildNodes(a,c.vendorSpecific)},TileSet:function(a,c){var d={srs:{},bbox:{},resolutions:[]};this.readChildNodes(a,d);c.tileSets.push(d)},Resolutions:function(a,c){for(var d=this.getChildValue(a).split(" "),e=0,f=d.length;e<f;e++)d[e]!=""&&c.resolutions.push(parseFloat(d[e]))},
Width:function(a,c){c.width=parseInt(this.getChildValue(a))},Height:function(a,c){c.height=parseInt(this.getChildValue(a))},Layers:function(a,c){c.layers=this.getChildValue(a)},Styles:function(a,c){c.styles=this.getChildValue(a)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"});
OpenLayers.Tile.Image.IFrame={useIFrame:null,draw:function(){if(OpenLayers.Tile.Image.prototype.shouldDraw.call(this)){var a=this.layer.getURL(this.bounds),c=this.useIFrame;this.useIFrame=this.maxGetUrlLength!==null&&!this.layer.async&&a.length>this.maxGetUrlLength;a=c&&!this.useIFrame;c=!c&&this.useIFrame;if(a||c){this.imgDiv&&this.imgDiv.parentNode===this.frame&&this.frame.removeChild(this.imgDiv);this.imgDiv=null;if(a){this.blankImageUrl=this._blankImageUrl;this.frame.removeChild(this.frame.firstChild)}else{this._blankImageUrl=
this.blankImageUrl;this.blankImageUrl="about:blank"}}}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(this.useIFrame===true){if(!this.frame.childNodes.length){var a=document.createElement("div"),c=a.style;c.position="absolute";c.width="100%";c.height="100%";c.zIndex=1;c.backgroundImage="url("+this._blankImageUrl+")";this.frame.appendChild(a)}a=this.id+"_iFrame";if(parseFloat(navigator.appVersion.split("MSIE")[1])<9){c=document.createElement('<iframe name="'+
a+'">');c.style.backgroundColor="#FFFFFF";c.style.filter="chroma(color=#FFFFFF)"}else{c=document.createElement("iframe");c.style.backgroundColor="transparent";c.name=a}c.scrolling="no";c.marginWidth="0px";c.marginHeight="0px";c.frameBorder="0";c.style.position="absolute";c.style.width="100%";c.style.height="100%";this.layer.opacity<1&&OpenLayers.Util.modifyDOMElement(c,null,null,null,null,null,null,this.layer.opacity);this.frame.appendChild(c);return this.imgDiv=c}return OpenLayers.Tile.Image.prototype.getImage.apply(this,
arguments)},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var c=this.layer.params._OLSALT,c=(c?c+"_":"")+this.bounds.toBBOX();a.action=OpenLayers.Util.urlAppend(this.layer.url,c);a.target=this.id+"_iFrame";this.layer.getImageSize();var c=OpenLayers.Util.getParameters(this.url),d,e;for(e in c){d=document.createElement("input");d.type="hidden";d.name=e;d.value=c[e];a.appendChild(d)}return a},setImgSrc:function(a){if(this.useIFrame===true)if(a){var c=this.createRequestForm();
this.frame.appendChild(c);c.submit();this.frame.removeChild(c)}else{if(this.imgDiv.parentNode===this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv=null}}else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);if(this.useIFrame===true){this.imgDiv.style.opacity=1;this.frame.style.opacity=this.layer.opacity}},createBackBuffer:function(){var a;this.useIFrame===false&&(a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this));
return a}};
OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var c;if(OpenLayers.Util.isArray(a)){c=this.createElementNSPlus("atom:feed");c.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));
for(var d=0,e=a.length;d<e;d++)c.appendChild(this.buildEntryNode(a[d]))}else c=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},buildContentNode:function(a){var c=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)c.setAttribute("src",a.src);else if(a.type=="text"||a.type==null)c.appendChild(this.createTextNode(a.value));else if(a.type=="html"){if(typeof a.value!="string")throw"HTML content must be in form of an escaped string";c.appendChild(this.createTextNode(a.value))}else a.type==
"xhtml"?c.appendChild(a.value):a.type=="xhtml"||a.type.match(/(\+|\/)xml$/)?c.appendChild(a.value):c.appendChild(this.createTextNode(a.value));return c},buildEntryNode:function(a){var c=a.attributes,d=c.atom||{},e=this.createElementNSPlus("atom:entry");if(d.authors)for(var f=OpenLayers.Util.isArray(d.authors)?d.authors:[d.authors],g=0,h=f.length;g<h;g++)e.appendChild(this.buildPersonConstructNode("author",f[g]));if(d.categories)for(var f=OpenLayers.Util.isArray(d.categories)?d.categories:[d.categories],
i,g=0,h=f.length;g<h;g++){i=f[g];e.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:i.term,scheme:i.scheme||null,label:i.label||null}}))}d.content&&e.appendChild(this.buildContentNode(d.content));if(d.contributors){f=OpenLayers.Util.isArray(d.contributors)?d.contributors:[d.contributors];g=0;for(h=f.length;g<h;g++)e.appendChild(this.buildPersonConstructNode("contributor",f[g]))}a.fid&&e.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(d.links){f=OpenLayers.Util.isArray(d.links)?
d.links:[d.links];g=0;for(h=f.length;g<h;g++){i=f[g];e.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:i.href,rel:i.rel||null,type:i.type||null,hreflang:i.hreflang||null,title:i.title||null,length:i.length||null}}))}}d.published&&e.appendChild(this.createElementNSPlus("atom:published",{value:d.published}));d.rights&&e.appendChild(this.createElementNSPlus("atom:rights",{value:d.rights}));if(d.summary||c.description)e.appendChild(this.createElementNSPlus("atom:summary",{value:d.summary||
c.description}));e.appendChild(this.createElementNSPlus("atom:title",{value:d.title||c.title||this.defaultEntryTitle}));d.updated&&e.appendChild(this.createElementNSPlus("atom:updated",{value:d.updated}));if(a.geometry){c=this.createElementNSPlus("georss:where");c.appendChild(this.buildGeometryNode(a.geometry));e.appendChild(c)}return e},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,
externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();return this.gmlParser.writeNode("feature:_geometry",a).firstChild},buildPersonConstructNode:function(a,c){var d=["uri","email"],e=this.createElementNSPlus("atom:"+a);e.appendChild(this.createElementNSPlus("atom:name",{value:c.name}));for(var f=0,g=d.length;f<g;f++)c[d[f]]&&e.appendChild(this.createElementNSPlus("atom:"+d[f],{value:c[d[f]]}));return e},getFirstChildValue:function(a,c,d,
e){return(a=this.getElementsByTagNameNS(a,c,d))&&a.length>0?this.getChildValue(a[0],e):e},parseFeature:function(a){var c={},d=null,e=null,f=null,g=this.namespaces.atom;this.parsePersonConstructs(a,"author",c);e=this.getElementsByTagNameNS(a,g,"category");if(e.length>0)c.categories=[];for(var h=0,i=e.length;h<i;h++){d={};d.term=e[h].getAttribute("term");if(f=e[h].getAttribute("scheme"))d.scheme=f;if(f=e[h].getAttribute("label"))d.label=f;c.categories.push(d)}e=this.getElementsByTagNameNS(a,g,"content");
if(e.length>0){d={};if(f=e[0].getAttribute("type"))d.type=f;if(f=e[0].getAttribute("src"))d.src=f;else{d.value=d.type=="text"||d.type=="html"||d.type==null?this.getFirstChildValue(a,g,"content",null):d.type=="xhtml"||d.type.match(/(\+|\/)xml$/)?this.getChildEl(e[0]):this.getFirstChildValue(a,g,"content",null);c.content=d}}this.parsePersonConstructs(a,"contributor",c);c.id=this.getFirstChildValue(a,g,"id",null);e=this.getElementsByTagNameNS(a,g,"link");if(e.length>0)c.links=Array(e.length);for(var j=
["rel","type","hreflang","title","length"],h=0,i=e.length;h<i;h++){d={};d.href=e[h].getAttribute("href");for(var k=0,l=j.length;k<l;k++)(f=e[h].getAttribute(j[k]))&&(d[j[k]]=f);c.links[h]=d}if(d=this.getFirstChildValue(a,g,"published",null))c.published=d;if(d=this.getFirstChildValue(a,g,"rights",null))c.rights=d;if(d=this.getFirstChildValue(a,g,"summary",null))c.summary=d;c.title=this.getFirstChildValue(a,g,"title",null);c.updated=this.getFirstChildValue(a,g,"updated",null);d={title:c.title,description:c.summary,
atom:c};a=this.parseLocations(a)[0];a=new OpenLayers.Feature.Vector(a,d);a.fid=c.id;return a},parseFeatures:function(a){var c=[],d=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");d.length==0&&(d=[a]);for(var a=0,e=d.length;a<e;a++)c.push(this.parseFeature(d[a]));return c},parseLocations:function(a){var c=this.namespaces.georss,d={components:[]},e=this.getElementsByTagNameNS(a,c,"where");if(e&&e.length>0){this.gmlParser||this.initGmlParser();for(var f=0,g=e.length;f<g;f++)this.gmlParser.readChildNodes(e[f],
d)}d=d.components;if((e=this.getElementsByTagNameNS(a,c,"point"))&&e.length>0){f=0;for(g=e.length;f<g;f++){var h=OpenLayers.String.trim(e[f].firstChild.nodeValue).split(/\s+/);h.length!=2&&(h=OpenLayers.String.trim(e[f].firstChild.nodeValue).split(/\s*,\s*/));d.push(new OpenLayers.Geometry.Point(h[1],h[0]))}}var i=this.getElementsByTagNameNS(a,c,"line");if(i&&i.length>0)for(var j,f=0,g=i.length;f<g;f++){e=OpenLayers.String.trim(i[f].firstChild.nodeValue).split(/\s+/);j=[];for(var k=0,l=e.length;k<
l;k=k+2){h=new OpenLayers.Geometry.Point(e[k+1],e[k]);j.push(h)}d.push(new OpenLayers.Geometry.LineString(j))}if((a=this.getElementsByTagNameNS(a,c,"polygon"))&&a.length>0){f=0;for(g=a.length;f<g;f++){e=OpenLayers.String.trim(a[f].firstChild.nodeValue).split(/\s+/);j=[];k=0;for(l=e.length;k<l;k=k+2){h=new OpenLayers.Geometry.Point(e[k+1],e[k]);j.push(h)}d.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)]))}}if(this.internalProjection&&this.externalProjection){f=0;for(g=
d.length;f<g;f++)d[f]&&d[f].transform(this.externalProjection,this.internalProjection)}return d},parsePersonConstructs:function(a,c,d){for(var e=[],f=this.namespaces.atom,a=this.getElementsByTagNameNS(a,f,c),g=["uri","email"],h=0,i=a.length;h<i;h++){var j={};j.name=this.getFirstChildValue(a[h],f,"name",null);for(var k=0,l=g.length;k<l;k++){var m=this.getFirstChildValue(a[h],f,g[k],null);m&&(j[g[k]]=m)}e.push(j)}e.length>0&&(d[c+"s"]=e)},CLASS_NAME:"OpenLayers.Format.Atom"});
OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var c,d=true;switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,
-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:c=this.map.getSize();this.map.pan(0,-0.75*c.h);break;case 34:c=this.map.getSize();this.map.pan(0,0.75*c.h);break;case 35:c=this.map.getSize();this.map.pan(0.75*c.w,0);break;case 36:c=this.map.getSize();this.map.pan(-0.75*c.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:d=false}d&&OpenLayers.Event.stop(a)},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});
OpenLayers.Layer.OWMComposite=OpenLayers.Class(OpenLayers.Layer.WMS,{initialize:function(a,c,d){this.l=a;d==void 0&&(d={isBaseLayer:false,opacity:0.6});d.attribution='Forecast layers from <a href="http://openweathermap.org/wiki/Models/GDPRS">Environment Canada</a>';OpenLayers.Layer.WMS.prototype.initialize.apply(this,[c,"http://tile.openweathermap.org/wms",{layers:"GLBETA_"+this.l,SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetMap",transparent:"true",format:"image/png"},d])},getURL:function(a){var c=this.map.getZoom();
this.params.LAYERS="GLBETA_"+this.l;if(c>5){b=this.map.getExtent();if(isREGETA(b)){this.params.LAYERS="REGETA_"+this.l;if(c>7)if(isLAMARCTICETA(b))this.params.LAYERS="LAMARCTICETA_"+this.l;else if(isLAMWESTETA(b))this.params.LAYERS="LAMWESTETA_"+this.l;else if(isLAMMARITIMEETA(b))this.params.LAYERS="LAMMARITIMEETA_"+this.l;else if(isLAMEASTETA(b))this.params.LAYERS="LAMEASTETA_"+this.l}}var a=this.adjustBounds(a),c=this.getImageSize(),d={},e=this.reverseAxisOrder();d.BBOX=this.encodeBBOX?a.toBBOX(null,
e):a.toArray(e);d.WIDTH=c.w;d.HEIGHT=c.h;return this.getFullRequestString(d)}});
OpenLayers.Layer.OWMRadar=OpenLayers.Class(OpenLayers.Layer.WMS,{initialize:function(a,c){c==void 0&&(c={isBaseLayer:false,opacity:0.4});c.attribution='Radar layer from <a href="http://openweathermap.org/wiki/Layer/radar">Environment Canada</a>';OpenLayers.Layer.WMS.prototype.initialize.apply(this,[a,"http://tile.openweathermap.org/wms",{layers:"RADAR.12KM",SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetMap",transparent:"true",format:"image/png"},c])},getURL:function(a){this.params.LAYERS=this.map.getZoom()>
8?"RADAR.2KM":"RADAR.12KM";var a=this.adjustBounds(a),c=this.getImageSize(),d={},e=this.reverseAxisOrder();d.BBOX=this.encodeBBOX?a.toBBOX(null,e):a.toArray(e);d.WIDTH=c.w;d.HEIGHT=c.h;return this.getFullRequestString(d)}});
OpenLayers.Layer.OWMwms=OpenLayers.Class(OpenLayers.Layer.WMS,{initialize:function(a,c,d){d==void 0&&(d={isBaseLayer:false,opacity:0.3});a||(a=GLBETA_PR);c||(c=a);OpenLayers.Layer.WMS.prototype.initialize.apply(this,[c,"http://tile.openweathermap.org/wms",{layers:a,SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetMap",transparent:"true",format:"image/png"},d])}});
OpenLayers.Layer.OWMCanada=OpenLayers.Class(OpenLayers.Layer.WMS,{initialize:function(a,c,d){d==void 0&&(d={isBaseLayer:false,opacity:0.3});a||(a=GLBETA_PR);c||(c=a);OpenLayers.Layer.WMS.prototype.initialize.apply(this,[c,"",{layers:a,SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetMap",transparent:"true",format:"image/png"},d])},getURL:function(a){var a=this.adjustBounds(a),c=this.getImageSize(),d={},e=this.reverseAxisOrder();d.BBOX=this.encodeBBOX?a.toBBOX(null,e):a.toArray(e);d.WIDTH=c.w;d.HEIGHT=c.h;
a=this.getFullRequestString(d);return a="http://openweathermap.org/t/t?url="+a.replace(/&/g,"%26")}});
OpenLayers.Format.OWMWeather=OpenLayers.Class(OpenLayers.Format,{read:function(a){if(a.cod!=="200")throw Error(["OWM failure response (",a.cod,"): ",a.message].join(""));if(!a||!a.list||!OpenLayers.Util.isArray(a.list))throw Error("Unexpected OWM response");for(var a=a.list,c,d=[],e=0,f=a.length;e<f;e++){c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[e].coord.lon,a[e].coord.lat),{title:a[e].name,station:a[e],temp:Math.round(10*(a[e].main.temp-273.15))/10});d.push(c)}return d}});
OpenLayers.Layer.Vector.OWMWeather=OpenLayers.Class(OpenLayers.Layer.Vector,{projection:new OpenLayers.Projection("EPSG:4326"),strategies:[new OpenLayers.Strategy.BBOX({resFactor:1})],styleMap:new OpenLayers.StyleMap(new OpenLayers.Style({fontColor:"black",fontSize:"12px",fontFamily:"Arial, Courier New",graphicXOffset:-20,graphicYOffset:-5,labelAlign:"lt",labelXOffset:"-5",labelYOffset:"-35",labelOutlineColor:"white",labelOutlineWidth:3,externalGraphic:"${icon}",graphicWidth:50,label:"${temp}\u00b0C"},
{context:{icon:function(a){return a.layer?a.layer.options.getIcon(a.attributes.station):S3.Ap.concat("/static/img/gis/openlayers/blank.gif")}}})),initialize:function(a,c){c==void 0&&(c={});if(c.eventListeners==void 0)c.eventListeners={featureselected:this.onSelect,featureunselected:this.onUnselect};if(c.iconsets==void 0)c.iconsets="main";c.attribution='Weather from <a href="http://openweathermap.org/" alt="World Map and worldwide Weather Forecast online">OpenWeatherMap</a>';if(c.getIcon==void 0)c.getIcon=
this.getIcon;if(c.getPopupHtml==void 0){c.getPopupHtml=this.getPopupHtml;if(c.popupX==void 0)c.popupX=150;if(c.popupY==void 0)c.popupY=175}var d=[];d.push(a,c);OpenLayers.Layer.Vector.prototype.initialize.apply(this,d);this.protocol=new OpenLayers.Protocol.Script({url:"http://openweathermap.org/data/2.1/find/city",params:{cluster:"yes",cnt:200,format:"json",layer:this},filterToParams:function(a,c){if(a.type===OpenLayers.Filter.Spatial.BBOX){c.bbox=a.value.toArray();c.bbox.push(c.layer.map.getZoom());
a.projection&&c.bbox.push(a.projection.getCode())}return c},callbackKey:"callback",format:new OpenLayers.Format.OWMWeather})},onPopupClose:function(){var a=this.feature;a.pois?selectControl.unselect(a):this.destroy()},onSelect:function(a){feature=a.feature;a=this.options.getPopupHtml(feature.attributes.station);popup=new OpenLayers.Popup("FramedCloud",feature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(this.options.popupX,this.options.popupY),a,"City",false);feature.popup=popup;popup.feature=
feature;this.map.addPopup(popup,true)},onUnselect:function(a){feature=a.feature;if(feature.popup){popup.feature=null;this.map.removePopup(feature.popup);feature.popup.destroy();feature.popup=null}},getPopupHtml:function(a){return GetWeatherPopupHtml(a)},getIcon:function(a){if(a.weather.length>0)return"http://openweathermap.org/img/w/"+a.weather[0].icon+".png";var c=new Date,d=SunCalc.getTimes(c,a.coord.lat,a.coord.lon);return"http://openweathermap.org/img/w/"+GetWeatherIconDay(a,c>d.sunrise&&c<d.sunset?
"day":"night")}});
OpenLayers.Format.OWMStations=OpenLayers.Class(OpenLayers.Format,{read:function(a){if(a.cod!=="200")throw Error(["OWM failure response (",a.cod,"): ",a.message].join(""));if(!a||!a.list||!OpenLayers.Util.isArray(a.list))throw Error("Unexpected OWM response");for(var a=a.list,c,d=[],e=0,f=a.length;e<f;e++)if(a[e].main){c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[e].coord.lon,a[e].coord.lat),{title:a[e].name,station:a[e],stationType:a[e].type,temp:Math.round(10*(a[e].main.temp-273.15))/
10});d.push(c)}return d}});
OpenLayers.Layer.Vector.OWMStations=OpenLayers.Class(OpenLayers.Layer.Vector,{projection:new OpenLayers.Projection("EPSG:4326"),strategies:[new OpenLayers.Strategy.BBOX({resFactor:1})],styleMap:new OpenLayers.StyleMap(new OpenLayers.Style({fontColor:"black",fontSize:"12px",fontFamily:"Courier New, monospace",labelAlign:"lt",labelXOffset:"-15",labelYOffset:"-17",labelOutlineColor:"white",labelOutlineWidth:3,externalGraphic:"${icon}",graphicWidth:25,label:"${temp}\u00b0C"},{context:{icon:function(a){return a.layer?
a.layer.options.getIcon(a.attributes.station):S3.Ap.concat("/static/img/gis/openlayers/blank.gif")}}})),initialize:function(a,c){c==void 0&&(c={});if(c.eventListeners==void 0)c.eventListeners={featureselected:this.onSelect,featureunselected:this.onUnselect};c.attribution='Weather from <a href="http://openweathermap.org/" alt="World Map and worldwide Weather Forecast online">OpenWeatherMap</a>';var d=[];if(c.getIcon==void 0)c.getIcon=this.getIcon;if(c.getPopupHtml==void 0){c.getPopupHtml=this.getPopupHtml;
if(c.popupX==void 0)c.popupX=150;if(c.popupY==void 0)c.popupY=200}d.push(a,c);OpenLayers.Layer.Vector.prototype.initialize.apply(this,d);this.StationPopupHtml=GetStationPopupHtml;this.protocol=new OpenLayers.Protocol.Script({url:"http://openweathermap.org/data/2.1/find/station",params:{cluster_distance:120,cluster:"yes",format:"json",layer:this},filterToParams:function(a,c){if(a.type===OpenLayers.Filter.Spatial.BBOX){c.bbox=a.value.toArray();c.bbox.push(c.layer.map.getZoom());a.projection&&c.bbox.push(a.projection.getCode())}return c},
callbackKey:"callback",format:new OpenLayers.Format.OWMStations})},onPopupClose:function(){var a=this.feature;a.pois?selectControl.unselect(a):this.destroy()},onSelect:function(a){feature=a.feature;a=this.options.getPopupHtml(feature.attributes.station);popup=new OpenLayers.Popup("Popup",feature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(this.options.popupX,this.options.popupY),a,"Station",false);feature.popup=popup;popup.feature=feature;this.map.addPopup(popup,true)},onUnselect:function(a){feature=
a.feature;if(feature.popup){popup.feature=null;this.map.removePopup(feature.popup);feature.popup.destroy();feature.popup=null}},getPopupHtml:function(a){return GetStationPopupHtml(a)},getIcon:function(a){return{1:{externalGraphic:"http://openweathermap.org/img/s/iplane.png"},2:{externalGraphic:"http://openweathermap.org/img/s/istation.png"},5:{externalGraphic:"http://openweathermap.org/img/s/istation.png"}}[a.type].externalGraphic}});
function GetWeatherIconDay(a,c){var d=0;if(a.clouds&&a.clouds.all)d=a.clouds.all;var e="transparent";d<1&&d>=0&&(e="01");d<5&&d>=1&&(e="01");d<25&&d>=5&&(e="01");d<50&&d>=25&&(e="02");d<75&&d>=50&&(e="03");d>=75&&(e="04");if(a.rain&&a.rain["3h"]){e="09";d<30&&(e="10")}return e+(c==void 0||c=="day"?"d":"n")+".png"}
function isboundsinrect(a,c){var d=new OpenLayers.LonLat(a.left,a.bottom);d.transform(new OpenLayers.Projection("EPSG:900913"),new OpenLayers.Projection("EPSG:4326"));var e=new OpenLayers.LonLat(a.right,a.top);e.transform(new OpenLayers.Projection("EPSG:900913"),new OpenLayers.Projection("EPSG:4326"));p1={x:d.lat,y:d.lon};p2={x:e.lat,y:e.lon};return inRectangle(p1,c[0],c[1],c[2],c[3])&&inRectangle(p2,c[0],c[1],c[2],c[3])}
function isLAMEASTETA(a){return isboundsinrect(a,[{x:37.99,y:-92.055},{x:38.718,y:-70.551},{x:51.323,y:-68.764},{x:50.421,y:-95.476}])?true:false}function isLAMWESTETA(a){return isboundsinrect(a,[{x:44.167,y:-130.909},{x:45.99,y:-108.855},{x:57.208,y:-108.123},{x:54.903,y:-136.01}])?true:false}function isLAMMARITIMEETA(a){return isboundsinrect(a,[{x:40.21,y:-66.554},{x:44.907,y:-50.824},{x:54.596,y:-54.152},{x:49.002,y:-73.506}])?true:false}
function isLAMARCTICETA(a){return isboundsinrect(a,[{x:58.252,y:-77.123},{x:59.478,y:-56.694},{x:70.236,y:-55.179},{x:68.439,y:-85.106}])?true:false}function isREGETA(a){return isboundsinrect(a,[{x:20,y:-163.696},{x:15,y:-71.801},{x:66,y:-17},{x:80,y:-179.9}])?true:false}function areaOfTriangle(a,c,d){return Math.abs(((a.x-d.x)*(c.y-d.y)-(c.x-d.x)*(a.y-d.y))/2)}
function inTriangle(a,c,d,e){var f=areaOfTriangle(c,d,e),a=areaOfTriangle(a,c,d)+areaOfTriangle(a,c,e)+areaOfTriangle(a,d,e);return Math.abs(f-a)<0.0010?true:false}function inRectangle(a,c,d,e,f){return inTriangle(a,c,d,f)||inTriangle(a,e,d,f)}
var WeekDayText={months:"\u044f\u043d\u0432\u0430\u0440\u044f,\u0444\u0435\u0432\u0440\u0430\u043b\u044f,\u043c\u0430\u0440\u0442\u0430,\u0430\u043f\u0440\u0435\u043b\u044f,\u043c\u0430\u044f,\u0438\u044e\u043d\u044f,\u0438\u044e\u043b\u044f,\u0430\u0432\u0433\u0443\u0441\u0442\u0430,\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f,\u043e\u043a\u0442\u044f\u0431\u0440\u044f,\u043d\u043e\u044f\u0431\u0440\u044f,\u0434\u0435\u043a\u0430\u0431\u0440\u044f".split(","),days:"\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435,\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a,\u0432\u0442\u043e\u0440\u043d\u0438\u043a,\u0441\u0440\u0435\u0434\u0430,\u0447\u0435\u0442\u0432\u0435\u0440\u0433,\u043f\u044f\u0442\u043d\u0438\u0446\u0430,\u0441\u0443\u0431\u0431\u043e\u0442\u0430".split(","),
days_small:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")};function GetWeatherText2(a){var c="";a.snow&&a.snow["3h"]&&(c="Snow ( "+a.snow["3h"]+"\u043c\u043c )");a.rain&&a.rain["3h"]&&(c="Rain:("+a.rain["3h"]+"\u043c\u043c)");return c}
function GetWeatherIcon2(a,c){var d=new Date,e=SunCalc.getTimes(d,a.lat,a.lng),d=d>e.sunrise&&d<e.sunset?"d":"n",e=c.clouds.all,f="transparent";e<1&&e>=0&&(f="01");e<5&&e>=1&&(f="01");e<25&&e>=5&&(f="01");e<50&&e>=25&&(f="02");e<75&&e>=50&&(f="03");e>=75&&(f="04");c.rain&&c.rain["3h"]&&(f="09");return f+d+".png"}
function GetWeatherForecastBubleHtml(a,c,d){var e=new Date((new Date).getTime()-168E5),f=Math.round((a.main.temp-273)*10)/10,g=Math.round((a.main.temp_min-273)*100)/100,h=Math.round((a.main.temp_max-273)*100)/100,i=new Date(a.dt*1E3),j=SunCalc.getTimes(i,a.coord.lat,a.coord.lon),j=a.dt>j.sunrise&&a.dt<j.sunset?"d":"n",k=GetWeatherText2(a),g='<p class="weather_title"><a style="weather_title_link" href="http://openweathermap.org/city/'+a.id+'">'+a.name+'</a></p> <div style="float: left;" ><div class="weather_block"> <div class="cur_weather_block" title="'+
k+'">  <img class="weather_image" alt="'+k+'" src="http://openweathermap.org/img/w/'+GetWeatherIconDay(a,j)+'"/>  <div class="temp_block" >   <div class="big_temp" title="Current Temperature '+l+'">'+f+'\u00b0</div>   <div class="small_temp_block" >    <div class="small_temp">'+k+'</div>   </div>  </div> </div> <div class="small_val_grey" title="Min and max temperature">Min t: '+g+" / Max t: "+h+' \u00b0C</div> <div class="small_val_grey">Humidity: '+a.main.humidity+'%</div> <div class="small_val_grey">Wind: '+
a.wind.speed+" m/s</div></div>";h_footer="</div>";h_body="";for(h=0;h<d;h++)if(e<new Date(c[h].dt*1E3))break;for(j=h;j<d+h;j++){var l=new Date;SunCalc.getTimes(i,a.coord.lat,a.coord.lon);f=Math.round(c[j].main.temp-273);Math.round((c[j].main.temp_min-273)*100);Math.round((c[j].main.temp_max-273)*100);i=new Date(c[j].dt*1E3);if(!(e>i)){hr=i.getHours();l=hr+":00";hr<10&&(l="0"+l);h_o='<div style="font-size: small; float: left; text-align: center;" > <div title="'+WeekDayText.days[i.getDay()]+'">'+WeekDayText.days_small[i.getDay()]+
'</div> <div title="'+i.toString()+'">'+l+'</div> <img alt="'+GetWeatherText2(c[j])+'" src="http://openweathermap.org/img/w/'+GetWeatherIcon2(a,c[j])+'"/> <div class="small_val" title="Temperature">'+f+'\u00b0C</div> <div class="small_val" title="\u0412\u0435\u0442\u0435\u0440">'+c[j].wind.speed+' m/s</div> <div class="small_val_grey" title="\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435">'+c[j].main.pressure+"</div></div>";h_body=h_body+h_o}}return g+h_body+h_footer}
function GetWeatherPopupHtml(a){var c=Math.round((a.main.temp-273.15)*10)/10,d=Math.round((a.main.temp_min-273.15)*10)/10,e=Math.round((a.main.temp_max-273.15)*10)/10;if(a.weather.length>0)var f="http://openweathermap.org/img/w/"+a.weather[0].icon+".png",g=a.weather[0].main,h=a.weather[0].description;else{f=SunCalc.getTimes(new Date(a.dt*1E3),a.coord.lat,a.coord.lon);f=GetWeatherIconDay(a,a.dt>f.sunrise&&a.dt<f.sunset?"d":"n");g=GetWeatherText2(a)}return'<p class="weather_title"><a class="weather_title_link"  href="http://openweathermap.org/city/'+
a.id+'">'+a.name+'</a></p> <div class="weather_block"> <div class="cur_weather_block" title="'+h+'">  <img class="weather_image" alt="'+h+'" src="'+f+'"/>  <div class="temp_block" >   <div class="big_temp" title="Current Temperature">'+c+'\u00b0</div>   <div class="small_temp_block" >    <div class="small_temp">'+g+'</div>   </div>  </div> </div> <div class="small_val_grey" title="Min and max temperature">Min t: '+d+" / Max t: "+e+' \u00b0C</div> <div class="small_val_grey">Humidity: '+a.main.humidity+
'%</div> <div class="small_val_grey">Wind: '+a.wind.speed+' m/s</div> <div class="small_val_grey">Clouds: '+a.clouds.all+" %</div></div>"}
function GetStationPopupHtml(a){var c=Math.round((a.main.temp-273.15)*10)/10,d=new Date(a.dt*1E3),c='<p class="weather_title"><a href="http://openweathermap.org/station/'+a.id+'">'+a.name+'</a></p> <div class="weather_block">\t<div class="cur_weather_block" >\t\t<img class="station_image" alt="'+GetWeatherText2(a)+'" src="'+GetStationIcon(a)+'"/>\t\t<div class="temp_block">\t\t\t<div class="big_temp" title="Current Temperature">'+c+"\u00b0</div>\t\t</div>\t</div>";a.main.humidity&&(c=c+('<div class="small_val_grey">Humidity: '+
a.main.humidity+"%</div>"));a.wind&&(c=c+('<div class="small_val_grey">Wind: '+a.wind.speed+" m/s</div>"));a.main.pressure&&(c=c+('<div class="small_val_grey">Pressure: '+a.main.pressure+" hpa</div>"));a.rain&&a.rain["1h"]&&(c=c+('<div class="small_val_grey">Rain: '+a.rain["1h"]+" mm</div>"));c=c+('<div class="small_val_grey" title="'+d.toString()+'" >Recived at '+d.toTimeString()+"</div></div>");return c+"</div>"}
function GetStationIcon(a){return a.type==1?"http://openweathermap.org/img/s/iplane.png":"http://openweathermap.org/img/s/istation.png"}
(function(a){function c(a){return new Date((a+0.5-i)*h)}var a="undefined"!==typeof exports?exports:a.SunCalc={},d=Math,e=d.PI/180,f=d.sin,g=d.cos,h=864E5,i=2440588,j=357.5291*e,k=0.98560028*e,l=1.9148*e,m=0.02*e,n=3.0E-4*e,o=102.9372*e,p=23.45*e,q=280.16*e,r=360.9856235*e,s=[[-0.83,"sunrise","sunset"],[-0.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];a.addTime=function(a,c,d){s.push([a,c,d])};a.getTimes=
function(a,q,r){var r=e*-r,q=e*q,a=d.round(a.valueOf()/h-0.5+i-2451545-9.0E-4-r/(2*d.PI)),v=2451545.0009+(0+r)/(2*d.PI)+a,w=j+k*(v-2451545),z=l*f(w)+m*f(2*w)+n*f(3*w),z=w+o+z+d.PI,D=d.asin(f(z)*f(p)),v=v+0.0053*f(w)+-0.0069*f(2*z),C={solarNoon:c(v)},A,E,y,B,F,G;A=0;for(E=s.length;A<E;A=A+1){y=s[A];B=y[0];F=y[1];y=y[2];B=2451545.0009+(d.acos((f(B*e)-f(q)*f(D))/(g(q)*g(D)))+r)/(2*d.PI)+a+0.0053*f(w)+-0.0069*f(2*z);G=v-(B-v);C[F]=c(G);C[y]=c(B)}return C};a.getPosition=function(a,c,s){var s=e*-s,c=e*
c,a=a.valueOf()/h-0.5+i,v=j+k*(a-2451545),w=l*f(v)+m*f(2*v)+n*f(3*v),w=v+o+w+d.PI,v=d.asin(f(w)*f(p)),w=d.atan2(f(w)*g(p),g(w)),s=q+r*(a-2451545)-s-w;return{azimuth:d.atan2(f(s),g(s)*f(c)-d.tan(v)*g(c)),altitude:d.asin(f(c)*f(v)+g(c)*g(v)*g(s))}}})(this);
function style_osm_feature(a){a.style=OpenLayers.Util.extend({fill:"black"},OpenLayers.Feature.Vector.style["default"]);if(a.attributes.highway=="motorway"){a.style.strokeColor="blue";a.style.strokeWidth=5}else if(a.attributes.highway=="primary")a.style.strokeColor="red";else if(a.attributes.highway=="secondary")a.style.strokeColor="orange";else if(a.attributes.highway)a.style.strokeColor="black"}OpenLayers.Layer.cdauth={};
OpenLayers.Layer.cdauth.CoordinateGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{maxHorizontalLines:6,maxVerticalLines:null,styleMapNormal:{stroke:!0,stokeWidth:1,strokeColor:"black",strokeOpacity:0.2},styleMapHighlight:{stroke:!0,stokeWidth:2,strokeColor:"black",strokeOpacity:0.5},labelStyleMapNormal:{fontColor:"#777",fontSize:"10px"},labelStyleMapHighlight:{fontColor:"#666",fontSize:"10px",fontWeight:"bold"},horizontalLines:{},verticalLines:{},degreeLabels:[],initialize:function(a,c){if(typeof a==
"undefined"||a==null)a=OpenLayers.i18n("Coordinate grid");c=OpenLayers.Util.extend(c,{projection:new OpenLayers.Projection("EPSG:4326")});OpenLayers.Layer.Vector.prototype.initialize.apply(this,[a,c])},setMap:function(){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.drawGrid);this.map.events.register("mapResize",this,this.drawGrid);this.events.register("visibilitychanged",this,this.drawGrid)},drawGrid:function(){if(this.map&&this.map.getExtent()&&
this.getVisibility()){var a=this.map.getExtent().transform(this.map.getProjectionObject(),this.projection),c=this.map.maxExtent.clone().transform(this.map.getProjectionObject(),this.projection),d=[],e=[];this.destroyFeatures(this.degreeLabels);this.degreeLabels=[];var f=Math.pow(10,Math.ceil(Math.log((a.top-a.bottom)/this.maxHorizontalLines)/Math.LN10));5*(a.top-a.bottom)/f<=this.maxHorizontalLines?f=f/5:2*(a.top-a.bottom)/f<=this.maxHorizontalLines&&(f=f/2);for(var g in this.horizontalLines){var h=
g/f,i=h%5==0,j=this.horizontalLines[g].style==this.styleMapHighlight;if(Math.floor(h)!=h||i!=j){e.push(this.horizontalLines[g]);delete this.horizontalLines[g]}}for(h=Math.ceil(a.bottom/f)*f;h<a.top;h=h+f)if(!(h<-90||h>90)){i=h/f%5==0;this.degreeLabels.push(new OpenLayers.Feature.Vector((new OpenLayers.Geometry.Point(a.left,h)).transform(this.projection,this.map.getProjectionObject()),null,OpenLayers.Util.extend({label:Math.round(h*1E8)/1E8+"\ufffd",labelAlign:"lm"},i?this.labelStyleMapHighlight:this.labelStyleMapNormal)));
this.degreeLabels.push(new OpenLayers.Feature.Vector((new OpenLayers.Geometry.Point(a.right,h)).transform(this.projection,this.map.getProjectionObject()),null,OpenLayers.Util.extend({label:Math.round(h*1E8)/1E8+"\ufffd",labelAlign:"rm"},i?this.labelStyleMapHighlight:this.labelStyleMapNormal)));if(!this.horizontalLines[h]){this.horizontalLines[h]=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([(new OpenLayers.Geometry.Point(c.left,h)).transform(this.projection,this.map.getProjectionObject()),
(new OpenLayers.Geometry.Point(c.right,h)).transform(this.projection,this.map.getProjectionObject())]),null,i?this.styleMapHighlight:this.styleMapNormal);d.push(this.horizontalLines[h])}}i=this.maxVerticalLines!=null?this.maxVerticalLines:Math.round(this.maxHorizontalLines*this.map.size.w/this.map.size.h);f=Math.pow(10,Math.ceil(Math.log((a.right-a.left)/i)/Math.LN10));5*(a.right-a.left)/f<=i?f=f/5:2*(a.right-a.left)/f<=i&&(f=f/2);for(g in this.verticalLines){h=g/f;i=h%5==0;j=this.verticalLines[g].style==
this.styleMapHighlight;if(Math.floor(h)!=h||i!=j){e.push(this.verticalLines[g]);delete this.verticalLines[g]}}for(h=Math.ceil(a.left/f)*f;h<a.right;h=h+f)if(!(h<=-180||h>180)){i=h/f%5==0;this.degreeLabels.push(new OpenLayers.Feature.Vector((new OpenLayers.Geometry.Point(h,a.top)).transform(this.projection,this.map.getProjectionObject()),null,OpenLayers.Util.extend({label:Math.round(h*1E8)/1E8+"\ufffd",labelAlign:"ct"},i?this.labelStyleMapHighlight:this.labelStyleMapNormal)));this.degreeLabels.push(new OpenLayers.Feature.Vector((new OpenLayers.Geometry.Point(h,
a.bottom)).transform(this.projection,this.map.getProjectionObject()),null,OpenLayers.Util.extend({label:Math.round(h*1E8)/1E8+"\ufffd",labelAlign:"cb"},i?this.labelStyleMapHighlight:this.labelStyleMapNormal)));if(!this.verticalLines[h]){this.verticalLines[h]=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([(new OpenLayers.Geometry.Point(h,c.top)).transform(this.projection,this.map.getProjectionObject()),(new OpenLayers.Geometry.Point(h,c.bottom)).transform(this.projection,this.map.getProjectionObject())]),
null,i?this.styleMapHighlight:this.styleMapNormal);d.push(this.verticalLines[h])}}this.destroyFeatures(e);this.addFeatures(d);this.addFeatures(this.degreeLabels)}}});
