(function(c){c.extend(c.fn,{pstrength:function(a){a=c.extend({verdects:["Very Weak","Weak","Medium","Strong","Very Strong","Too Short","Unsafe Password Word!"],colors:["#f00","#c06","#f60","#3c0","#3f0","#ccc","#f00"],scores:[10,15,30,40],common:["password","sex","god","123456","123","liverpool","letmein","qwerty","monkey"],minchar:6,minchar_label:"The minimum number of characters is "},a);return this.each(function(){var e=c(this).attr("id");c(this).after('<div class="pstrength-minchar" id="'+e+'_minchar">'+
a.minchar_label+a.minchar+"</div>");c(this).after('<div class="pstrength-info" id="'+e+'_text"></div>');c(this).after('<div class="pstrength-bar" id="'+e+'_bar" style="border: 1px solid white; font-size: 1px; height: 2px; width: 0px;"></div>');c(this).keyup(function(){c.fn.runPassword(c(this).val(),e,a)})})},runPassword:function(a,e,b){nPerc=c.fn.checkPassword(a,b);a="#"+e+"_bar";e="#"+e+"_text";nPerc<=-200?(strColor=b.colors[6],strText=b.verdects[6],c(a).css({width:"0%"})):nPerc<=0&&nPerc>=-199?
(strColor=b.colors[5],strText=b.verdects[5],c(a).css({width:"1%"})):nPerc>=0&&nPerc<=b.scores[0]?(strColor=b.colors[0],strText=b.verdects[0],c(a).css({width:"1%"})):nPerc>b.scores[0]&&nPerc<=b.scores[1]?(strColor=b.colors[1],strText=b.verdects[1],c(a).css({width:"25%"})):nPerc>b.scores[1]&&nPerc<=b.scores[2]?(strColor=b.colors[2],strText=b.verdects[2],c(a).css({width:"50%"})):nPerc>b.scores[2]&&nPerc<=b.scores[3]?(strColor=b.colors[3],strText=b.verdects[3],c(a).css({width:"75%"})):(strColor=b.colors[4],
strText=b.verdects[4],c(a).css({width:"99%"}));c(a).css({backgroundColor:strColor});c(e).html("<span style='color: "+strColor+";'>"+strText+"</span>")},checkPassword:function(a,c){var b=0;a.length<c.minchar?b-=100:a.length>=c.minchar&&a.length<=c.minchar+2?b+=6:a.length>=c.minchar+3&&a.length<=c.minchar+4?b+=12:a.length>=c.minchar+5&&(b+=18);a.match(/[a-z]/)&&(b+=1);a.match(/[A-Z]/)&&(b+=5);a.match(/\d+/)&&(b+=5);a.match(/(.*[0-9].*[0-9].*[0-9])/)&&(b+=7);a.match(/.\W/)&&(b+=5);a.match(/(.*\W.*\W)/)&&
(b+=7);a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(b+=2);a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)&&(b+=3);a.match(/([a-zA-Z0-9].*\W)|(\W.*[a-zA-Z0-9])/)&&(b+=3);a.match(/(\w)\1{2}/)&&(b-=10);a.match(/[a-z]{4}/i)&&(b-=5);var f=a.split(/\d/),g=f.length-1,f=a.split(/\W/),f=f.length-1,d=a.length-d-f,g=d-g;if(g<=a.length/3||g>=-a.length/3)b+=7;d-=f;if(d<=a.length/3||d>=-a.length/3)b+=7;for(d=0;d<c.common.length;d++)a.toLowerCase()==c.common[d]?b=-200:a.toLowerCase().indexOf(c.common[d])>=0&&(b-=20);return b}})})(jQuery);
