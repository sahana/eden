(function(c){function t(b){var e;return b&&b.constructor==Array&&3==b.length?b:(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[2.55*parseFloat(e[1]),2.55*parseFloat(e[2]),2.55*parseFloat(e[3])]:(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:
(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]:k[c.trim(b).toLowerCase()]}c.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(b,e){c.fx.step[e]=function(b){if(0==b.state){var k;k=b.elem;var Q=e,K;do{K=c.curCSS(k,Q);if(""!=K&&"transparent"!=K||c.nodeName(k,"body"))break;Q="backgroundColor"}while(k=k.parentNode);k=t(K);b.start=k;b.end=t(b.end)}b.elem.style[e]=
"rgb("+[Math.max(Math.min(parseInt(b.pos*(b.end[0]-b.start[0])+b.start[0]),255),0),Math.max(Math.min(parseInt(b.pos*(b.end[1]-b.start[1])+b.start[1]),255),0),Math.max(Math.min(parseInt(b.pos*(b.end[2]-b.start[2])+b.start[2]),255),0)].join()+")"}});var k={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,
139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,
203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(c){c.Jcrop=function(t,k){function b(a){return Math.round(a)+"px"}function e(a){a=c(a).offset();return[a.left,a.top]}function h(a){return[a.pageX-G[0],a.pageY-G[1]]}function x(B){"object"!==typeof B&&(B={});a=c.extend(a,B);c.each(["onChange","onSelect","onRelease","onDblClick"],function(B,b){"function"!==typeof a[b]&&(a[b]=function(){})})}function Q(a,b,A){G=e(u);E.setCursor("move"===a?a:a+"-resize");if("move"===a)return E.activateHandlers(ta(b),Z,A);b=v.getFixed();var c=fa(a),d=v.getCorner(fa(c));
v.setPressed(v.getCorner(c));v.setCurrent(d);E.activateHandlers(K(a,b),Z,A)}function K(B,b){return function(A){if(a.aspectRatio)switch(B){case "e":A[1]=b.y+1;break;case "w":A[1]=b.y+1;break;case "n":A[0]=b.x+1;break;case "s":A[0]=b.x+1}else switch(B){case "e":A[1]=b.y2;break;case "w":A[1]=b.y2;break;case "n":A[0]=b.x2;break;case "s":A[0]=b.x2}v.setCurrent(A);n.update()}}function ta(a){var b=a;aa.watchKeys();return function(a){v.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;n.update()}}function fa(a){switch(a){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function ha(b){return function(c){if(a.disabled||"move"===b&&!a.allowMove)return!1;G=e(u);L=!0;Q(b,h(c));c.stopPropagation();c.preventDefault();return!1}}function ia(a,b,c){var e=a.width(),d=a.height();e>b&&0<b&&(e=b,d=b/a.width()*a.height());d>c&&0<c&&(d=c,e=c/a.height()*a.width());y=a.width()/e;z=a.height()/d;a.width(e).height(d)}function R(a){return{x:a.x*
y,y:a.y*z,x2:a.x2*y,y2:a.y2*z,w:a.w*y,h:a.h*z}}function Z(b){b=v.getFixed();b.w>a.minSelect[0]&&b.h>a.minSelect[1]?(n.enableHandles(),n.done()):n.release();E.setCursor(a.allowSelect?"crosshair":"default")}function ja(b){if(a.disabled||!a.allowSelect)return!1;L=!0;G=e(u);n.disableHandles();E.setCursor("crosshair");var c=h(b);v.setPressed(c);n.update();E.activateHandlers(ua,Z,"touch"===b.type.substring(0,5));aa.watchKeys();b.stopPropagation();b.preventDefault();return!1}function ua(a){v.setCurrent(a);
n.update()}function ka(){var b=c("<div></div>").addClass(a.baseClass+"-tracker");la&&b.css({opacity:0,backgroundColor:"white"});return b}function ma(b){na([b[0]/y,b[1]/z,b[2]/y,b[3]/z]);a.onSelect.call(C,R(v.getFixed()));n.enableHandles()}function na(a){v.setPressed([a[0],a[1]]);v.setCurrent([a[2],a[3]]);n.update()}function oa(){a.disabled=!0;n.disableHandles();n.setCursor("default");E.setCursor("default")}function pa(){a.disabled=!1;ba()}function ca(b,e,A){e=e||a.bgColor;a.bgFade&&c.fx.step.hasOwnProperty("backgroundColor")&&
a.fadeTime&&!A?b.animate({backgroundColor:e},{queue:!1,duration:a.fadeTime}):b.css("backgroundColor",e)}function ba(b){a.allowResize?b?n.enableOnly():n.enableHandles():n.disableHandles();E.setCursor(a.allowSelect?"crosshair":"default");n.setCursor(a.allowMove?"move":"default");a.hasOwnProperty("trueSize")&&(y=a.trueSize[0]/m,z=a.trueSize[1]/s);a.hasOwnProperty("setSelect")&&(ma(a.setSelect),n.done(),delete a.setSelect);H.refresh();a.bgColor!=qa&&(ca(a.shade?H.getShades():F,a.shade?a.shadeColor||a.bgColor:
a.bgColor),qa=a.bgColor);S!=a.bgOpacity&&(S=a.bgOpacity,a.shade?H.refresh():n.setBgOpacity(S));T=a.maxSize[0]||0;U=a.maxSize[1]||0;V=a.minSize[0]||0;W=a.minSize[1]||0;a.hasOwnProperty("outerImage")&&(u.attr("src",a.outerImage),delete a.outerImage);n.refresh()}var a=c.extend({},c.Jcrop.defaults),G,M=navigator.userAgent.toLowerCase(),la=/msie/.test(M),ra=/msie [1-6]\./.test(M);"object"!==typeof t&&(t=c(t)[0]);"object"!==typeof k&&(k={});x(k);var M={border:"none",visibility:"visible",margin:0,padding:0,
position:"absolute",top:0,left:0},w=c(t),sa=!0;if("IMG"==t.tagName){if(0!=w[0].width&&0!=w[0].height)w.width(w[0].width),w.height(w[0].height);else{var da=new Image;da.src=w[0].src;w.width(da.width);w.height(da.height)}var u=w.clone().removeAttr("id").css(M).show();u.width(w.width());u.height(w.height());w.after(u).hide()}else u=w.css(M).show(),sa=!1,null===a.shade&&(a.shade=!0);ia(u,a.boxWidth,a.boxHeight);var m=u.width(),s=u.height(),F=c("<div />").width(m).height(s).addClass(a.baseClass+"-holder").css({position:"relative",
backgroundColor:a.bgColor}).insertAfter(w).append(u);a.addClass&&F.addClass(a.addClass);var I=c("<div />"),Y=c("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),N=c("<div />").width("100%").height("100%").css("zIndex",320),O=c("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var b=v.getFixed();a.onDblClick.call(C,b)}).insertBefore(u).append(Y,N);sa&&(I=c("<img />").attr("src",u.attr("src")).css(M).width(m).height(s),Y.append(I));ra&&
O.css({overflowY:"hidden"});var P=a.boundary,J=ka().width(m+2*P).height(s+2*P).css({position:"absolute",top:b(-P),left:b(-P),zIndex:290}).mousedown(ja),qa=a.bgColor,S=a.bgOpacity,T,U,V,W,y,z,L,ea,va;G=e(u);var D=function(){function b(){var a={},c=["touchstart","touchmove","touchend"],d=document.createElement("div"),f;try{for(f=0;f<c.length;f++){var e=c[f],e="on"+e,l=e in d;l||(d.setAttribute(e,"return;"),l="function"==typeof d[e]);a[c[f]]=l}return a.touchstart&&a.touchend&&a.touchmove}catch(n){return!1}}
var c;c=!0===a.touchSupport||!1===a.touchSupport?a.touchSupport:b();return{createDragger:function(b){return function(c){if(a.disabled||"move"===b&&!a.allowMove)return!1;G=e(u);L=!0;Q(b,h(D.cfilter(c)),!0);c.stopPropagation();c.preventDefault();return!1}},newSelection:function(a){return ja(D.cfilter(a))},cfilter:function(a){a.pageX=a.originalEvent.changedTouches[0].pageX;a.pageY=a.originalEvent.changedTouches[0].pageY;return a},isSupported:b,support:c}}(),v=function(){function b(){if(!a.aspectRatio){var p=
r-d,c=l-f;T&&Math.abs(p)>T&&(r=0<p?d+T:d-T);U&&Math.abs(c)>U&&(l=0<c?f+U:f-U);W/z&&Math.abs(c)<W/z&&(l=0<c?f+W/z:f-W/z);V/y&&Math.abs(p)<V/y&&(r=0<p?d+V/y:d-V/y);0>d&&(r-=d,d-=d);0>f&&(l-=f,f-=f);0>r&&(d-=r,r-=r);0>l&&(f-=l,l-=l);r>m&&(p=r-m,d-=p,r-=p);l>s&&(p=l-s,f-=p,l-=p);d>m&&(p=d-s,l-=p,f-=p);f>s&&(p=f-s,l-=p,f-=p);return n(e(d,f,r,l))}var p=a.aspectRatio,c=a.minSize[0]/y,k=a.maxSize[0]/y,B=r-d,h=l-f,q=Math.abs(B),g=Math.abs(h);0===k&&(k=10*m);q/g<p?(q=l,g*=p,g=0>B?d-g:g+d,0>g?(g=0,q=Math.abs((g-
d)/p),q=0>h?f-q:q+f):g>m&&(g=m,q=Math.abs((g-d)/p),q=0>h?f-q:q+f)):(g=r,q/=p,q=0>h?f-q:f+q,0>q?(q=0,g=Math.abs((q-f)*p),g=0>B?d-g:g+d):q>s&&(q=s,g=Math.abs(q-f)*p,g=0>B?d-g:g+d));g>d?(g-d<c?g=d+c:g-d>k&&(g=d+k),q=q>f?f+(g-d)/p:f-(g-d)/p):g<d&&(d-g<c?g=d-c:d-g>k&&(g=d-k),q=q>f?f+(d-g)/p:f-(d-g)/p);0>g?(d-=g,g=0):g>m&&(d-=g-m,g=m);0>q?(f-=q,q=0):q>s&&(f-=q-s,q=s);return n(e(d,f,g,q))}function c(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>m&&(a[0]=m);a[1]>s&&(a[1]=s);return[Math.round(a[0]),Math.round(a[1])]}
function e(a,b,c,d){var f=a,l=c,g=b,r=d;c<a&&(f=c,l=a);d<b&&(g=d,r=b);return[f,g,l,r]}function n(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var d=0,f=0,r=0,l=0,k,h;return{flipCoords:e,setPressed:function(a){a=c(a);r=d=a[0];l=f=a[1]},setCurrent:function(a){a=c(a);k=a[0]-r;h=a[1]-l;r=a[0];l=a[1]},getOffset:function(){return[k,h]},moveOffset:function(a){var b=a[0];a=a[1];0>d+b&&(b-=b+d);0>f+a&&(a-=a+f);s<l+a&&(a+=s-(l+a));m<r+b&&(b+=m-(r+b));d+=b;r+=b;f+=a;l+=a},getCorner:function(a){var c=
b();switch(a){case "ne":return[c.x2,c.y];case "nw":return[c.x,c.y];case "se":return[c.x2,c.y2];case "sw":return[c.x,c.y2]}},getFixed:b}}(),H=function(){function e(){return k(v.getFixed())}function k(a){p.top.css({left:b(a.x),width:b(a.w),height:b(a.y)});p.bottom.css({top:b(a.y2),left:b(a.x),width:b(a.w),height:b(s-a.y2)});p.right.css({left:b(a.x2),width:b(m-a.x2)});p.left.css({width:b(a.x)})}function h(){return c("<div />").css({position:"absolute",backgroundColor:a.shadeColor||a.bgColor}).appendTo(t)}
function ga(){X||(X=!0,t.insertBefore(u),e(),n.setBgOpacity(1,0,1),I.hide(),d(a.shadeColor||a.bgColor,1),n.isAwake()?r(a.bgOpacity,1):r(1,1))}function d(a,b){ca(l(),a,b)}function f(){X&&(t.remove(),I.show(),X=!1,n.isAwake()?n.setBgOpacity(a.bgOpacity,1,1):(n.setBgOpacity(1,1,1),n.disableHandles()),ca(F,0,1))}function r(b,c){X&&(a.bgFade&&!c?t.animate({opacity:1-b},{queue:!1,duration:a.fadeTime}):t.css({opacity:1-b}))}function l(){return t.children()}var X=!1,t=c("<div />").css({position:"absolute",
zIndex:240,opacity:0}),p={top:h(),left:h().height(s),right:h().height(s),bottom:h()};return{update:e,updateRaw:k,getShades:l,setBgColor:d,enable:ga,disable:f,resize:function(a,c){p.left.css({height:b(c)});p.right.css({height:b(c)})},refresh:function(){a.shade?ga():f();n.isAwake()&&r(a.bgOpacity)},opacity:r}}(),n=function(){function e(a,b){var d=c("<div />").mousedown(ha(a)).css({cursor:a+"-resize",position:"absolute",zIndex:b}).addClass("ord-"+a);D.support&&d.bind("touchstart.jcrop",D.createDragger(a));
N.append(d);return d}function k(a){var b;for(b=0;b<a.length;b++)e(a[b],w++).addClass("jcrop-dragbar")}function h(b){var d,e;for(e=0;e<b.length;e++){switch(b[e]){case "n":d="hline";break;case "s":d="hline bottom";break;case "e":d="vline right";break;case "w":d="vline"}var f=y,l=b[e],g=d,g=c("<div />").css({position:"absolute",opacity:a.borderOpacity}).addClass(a.baseClass+"-"+g);Y.append(g);f[l]=g}}function n(b){var c;for(c=0;c<b.length;c++){var d=z,f=b[c],l=a.handleSize,g=e(b[c],w++).css({opacity:a.handleOpacity}).addClass(a.baseClass+
"-handle");l&&g.width(l).height(l);d[f]=g}}function d(){var a=v.getFixed();v.setPressed([a.x,a.y]);v.setCurrent([a.x2,a.y2]);f()}function f(a){if(m)return r(a)}function r(c){var d=v.getFixed(),e=d.h;O.width(Math.round(d.w)).height(Math.round(e));var e=d.x,f=d.y;a.shade||I.css({top:b(-f),left:b(-e)});O.css({top:b(f),left:b(e)});a.shade&&H.updateRaw(d);m||(O.show(),a.shade?H.opacity(S):l(S,!0),m=!0);c?a.onSelect.call(C,R(d)):a.onChange.call(C,R(d))}function l(b,c,d){if(m||c)a.bgFade&&!d?u.animate({opacity:b},
{queue:!1,duration:a.fadeTime}):u.css("opacity",b)}function s(){q=!0;if(a.allowResize)return N.show(),!0}function t(){q=!1;N.hide()}function p(a){a?(ea=!0,t()):(ea=!1,s())}var m,w=370,y={},z={},q=!1;a.dragEdges&&c.isArray(a.createDragbars)&&k(a.createDragbars);c.isArray(a.createHandles)&&n(a.createHandles);a.drawBorders&&c.isArray(a.createBorders)&&h(a.createBorders);c(document).bind("touchstart.jcrop-ios",function(a){c(a.currentTarget).hasClass("jcrop-tracker")&&a.stopPropagation()});var g=ka().mousedown(ha("move")).css({cursor:"move",
position:"absolute",zIndex:360});D.support&&g.bind("touchstart.jcrop",D.createDragger("move"));Y.append(g);t();return{updateVisible:f,update:r,release:function(){t();O.hide();a.shade?H.opacity(1):l(1);m=!1;a.onRelease.call(C)},refresh:d,isAwake:function(){return m},setCursor:function(a){g.css("cursor",a)},enableHandles:s,enableOnly:function(){q=!0},showHandles:function(){q&&N.show()},disableHandles:t,animMode:p,setBgOpacity:l,done:function(){p(!1);d()}}}(),E=function(){function b(a){d(h(a));return!1}
function e(b){b.preventDefault();b.stopPropagation();L&&(L=!1,f(h(b)),n.isAwake()&&a.onSelect.call(C,R(v.getFixed())),J.css({zIndex:290}),c(document).unbind(".jcrop"),d=function(){},f=function(){});return!1}function k(a){d(h(D.cfilter(a)));return!1}function m(a){return e(D.cfilter(a))}var d=function(){},f=function(){},r=a.trackDocument;r||J.mousemove(b).mouseup(e).mouseout(e);u.before(J);return{activateHandlers:function(a,h,n){L=!0;d=a;f=h;J.css({zIndex:450});n?c(document).bind("touchmove.jcrop",
k).bind("touchend.jcrop",m):r&&c(document).bind("mousemove.jcrop",b).bind("mouseup.jcrop",e);return!1},setCursor:function(a){J.css("cursor",a)}}}(),aa=function(){function b(a){h.hide()}function e(b,c,d){a.allowMove&&(v.moveOffset([c,d]),n.updateVisible(!0));b.preventDefault();b.stopPropagation()}function k(b){if(b.ctrlKey||b.metaKey)return!0;var c=(va=b.shiftKey?!0:!1)?10:1;switch(b.keyCode){case 37:e(b,-c,0);break;case 39:e(b,c,0);break;case 38:e(b,0,-c);break;case 40:e(b,0,c);break;case 27:a.allowSelect&&
n.release();break;case 9:return!0}return!1}var h=c('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),d=c("<div />").css({position:"absolute",overflow:"hidden"}).append(h);a.keySupport&&(h.keydown(k).blur(b),ra||!a.fixedSupport?(h.css({position:"absolute",left:"-20px"}),d.append(h).insertBefore(u)):h.insertBefore(u));return{watchKeys:function(){a.keySupport&&(h.show(),h.focus())}}}();D.support&&J.bind("touchstart.jcrop",D.newSelection);N.hide();ba(!0);
var C={setImage:function(b,c){n.release();oa();var e=new Image;e.onload=function(){var h=e.height,d=a.boxWidth,f=a.boxHeight;u.width(e.width).height(h);u.attr("src",b);I.attr("src",b);ia(u,d,f);m=u.width();s=u.height();I.width(m).height(s);J.width(m+2*P).height(s+2*P);F.width(m).height(s);H.resize(m,s);pa();"function"===typeof c&&c.call(C)};e.src=b},animateTo:function(b,c){var e=b[0]/y,h=b[1]/z,d=b[2]/y,f=b[3]/z;if(!ea){var k=v.flipCoords(e,h,d,f),l=v.getFixed(),m=[l.x,l.y,l.x2,l.y2],s=a.animationDelay,
p=k[0]-m[0],t=k[1]-m[1],u=k[2]-m[2],w=k[3]-m[3],x=0,q=a.swingSpeed,e=m[0],h=m[1],d=m[2],f=m[3];n.animMode(!0);var g=function(){return function(){x+=(100-x)/q;m[0]=Math.round(e+x/100*p);m[1]=Math.round(h+x/100*t);m[2]=Math.round(d+x/100*u);m[3]=Math.round(f+x/100*w);99.8<=x&&(x=100);100>x?(na(m),window.setTimeout(g,s)):(n.done(),n.animMode(!1),"function"===typeof c&&c.call(C))}}();window.setTimeout(g,s)}},setSelect:ma,setOptions:function(a){x(a);ba()},tellSelect:function(){return R(v.getFixed())},
tellScaled:function(){return v.getFixed()},setClass:function(b){F.removeClass().addClass(a.baseClass+"-holder").addClass(b)},disable:oa,enable:pa,cancel:function(){n.done();E.activateHandlers(null,null)},release:n.release,destroy:function(){F.remove();w.show();w.css("visibility","visible");c(t).removeData("Jcrop")},focus:aa.watchKeys,getBounds:function(){return[m*y,s*z]},getWidgetSize:function(){return[m,s]},getScaleFactor:function(){return[y,z]},getOptions:function(){return a},ui:{holder:F,selection:O}};
la&&F.bind("selectstart",function(){return!1});w.data("Jcrop",C);return C};c.fn.Jcrop=function(t,k){var b;this.each(function(){if(c(this).data("Jcrop")){if("api"===t)return c(this).data("Jcrop");c(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?c.Jcrop.Loader(this,function(){c(this).css({display:"block",visibility:"hidden"});b=c.Jcrop(this,t);c.isFunction(k)&&k.call(b)}):(c(this).css({display:"block",visibility:"hidden"}),b=c.Jcrop(this,t),c.isFunction(k)&&k.call(b))});return this};c.Jcrop.Loader=
function(t,k,b){function e(){x.complete?(h.unbind(".jcloader"),c.isFunction(k)&&k.call(x)):window.setTimeout(e,50)}var h=c(t),x=h[0];h.bind("load.jcloader",e).bind("error.jcloader",function(e){h.unbind(".jcloader");c.isFunction(b)&&b.call(x)});x.complete&&c.isFunction(k)&&(h.unbind(".jcloader"),k.call(x))};c.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:!1,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,
aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);
$(function(){var c="png PNG jpg JPG jpeg JPEG gif GIF tif TIF tiff TIFF bmp BMP raw RAW".split(" "),t=function(b,c){var h;c[0]>b[0]&&(h=b[0]/c[0],c[0]*=h,c[1]*=h);c[1]>b[1]&&(h=b[1]/c[1],c[0]*=h,c[1]*=h);c[0]=Math.floor(c[0]);c[1]=Math.floor(c[1]);return c},k;$(".imagecrop-upload").change(function(){var b=$(this);$(".imagecrop-preview");var e=b.val().split("."),e=e[e.length-1];-1==$.inArray(e,c)&&(alert(i18n.invalid_image),b.val(""))});$(".imagecrop-preview").Jcrop({onChange:function(b){b=b.x+","+
b.y+","+b.x2+","+b.y2;$('input[name="imagecrop-points"]').val(b)}},function(){k=this;this.disable()});$(".imagecrop-toggle").click(function(){$(this).val()===i18n.crop_image?($(this).val(i18n.cancel_crop),$(".imagecrop-help").show(),k.enable()):($(this).val(i18n.crop_image),$(".imagecrop-help").hide(),k.release(),k.disable(),$('input[name="imagecrop-points"]').val(""))});$(".imagecrop-canvas").bind("dragover",function(b){b.preventDefault()});$(".imagecrop-canvas").bind("drop",function(b){b.preventDefault();
var c=new FileReader,h=$(this),x=b.originalEvent.dataTransfer.files[0].name;c.onload=function(b){var c=new Image;c.src=b.target.result;c.onload=function(){var b=t([h.width(),h.height()],[this.width,this.height]);h[0].width=b[0];h[0].height=b[1];h[0].getContext("2d").drawImage(this,0,0,b[0],b[1]);$(".imagecrop-upload").hide();$(".imagecrop-data").val(x+";"+h[0].toDataURL());h.Jcrop({onChange:function(b){b=b.x+","+b.y+","+b.x2+","+b.y2;$('input[name="imagecrop-points"]').val(b)}},function(){k=this})}};
c.readAsDataURL(b.originalEvent.dataTransfer.files[0])})});
