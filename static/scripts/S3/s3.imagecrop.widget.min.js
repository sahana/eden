/*
 jQuery Color Animations v2.0pre
 http://jquery.org/

 Copyright 2011 John Resig
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(b,h){function n(a,b,e){var f=A[b.type]||{};if((b.empty||e)&&null==a)return null;if(b.def&&null==a)return b.def;a=f.floor?~~a:parseFloat(a);return null==a||isNaN(a)?b.def:f.mod?(a%=f.mod,0>a?f.mod+a:a):f.min>a?f.min:f.max<a?f.max:a}function g(a){var d=l(),e=d._rgba=[];a=a.toLowerCase();r(H,function(b,x){var f=x.re.exec(a),g=f&&x.parse(f),h=x.space||"rgba",f=B[h].cache;if(g)return g=d[h](g),d[f]=g[f],e=d._rgba=g._rgba,!1});if(0!==e.length)return 0===Math.max.apply(Math,e)&&b.extend(e,E.transparent),
d;if(a=E[a])return a}function F(a,b,e){e=(e+1)%1;return 1>6*e?a+6*(b-a)*e:1>2*e?b:2>3*e?a+(b-a)*(2/3-e)*6:a}var G=/^([\-+])=\s*(\d+\.?\d*)/,H=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],l=b.Color=function(a,d,e,f){return new b.Color.fn.parse(a,d,e,f)},B={rgba:{cache:"_rgba",props:{red:{idx:0,
type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},A={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},M=B.rgba.props,N=l.support={},E,r=b.each;B.hsla.props.alpha=M.alpha;l.fn=l.prototype={constructor:l,parse:function(a,d,e,f){if(a===h)return this._rgba=
[null,null,null,null],this;if(a instanceof b||a.nodeType)a=a instanceof b?a.css(d):b(a).css(d),d=h;var x=this,J=b.type(a),S=this._rgba=[];d!==h&&(a=[a,d,e,f],J="array");if("string"===J)return this.parse(g(a)||E._default);if("array"===J)return r(M,function(b,e){S[e.idx]=n(a[e.idx],e)}),this;if("object"===J)return a instanceof l?r(B,function(b,e){a[e.cache]&&(x[e.cache]=a[e.cache].slice())}):r(B,function(e,b){r(b.props,function(e,c){var f=b.cache;if(!x[f]&&b.to){if(null==a[e]||"alpha"===e)return;x[f]=
b.to(x._rgba)}x[f][c.idx]=n(a[e],c,!0)})}),this},is:function(a){var b=l(a),e=!0,f=this;r(B,function(a,d){var g=b[d.cache],x;g&&(x=f[d.cache]||d.to&&d.to(f._rgba)||[],r(d.props,function(a,b){if(null!=g[b.idx])return e=g[b.idx]===x[b.idx]}));return e});return e},_space:function(){var a=[],b=this;r(B,function(e,f){b[f.cache]&&a.push(e)});return a.pop()},transition:function(a,b){var e=l(a),f=e._space(),d=B[f],g=this[d.cache]||d.to(this._rgba),h=g.slice(),e=e[d.cache];r(d.props,function(a,f){var d=f.idx,
c=g[d],k=e[d],v=A[f.type]||{};null!==k&&(null===c?h[d]=k:(v.mod&&(k-c>v.mod/2?c+=v.mod:c-k>v.mod/2&&(c-=v.mod)),h[f.idx]=n((k-c)*b+c,f)))});return this[f](h)},blend:function(a){if(1===this._rgba[3])return this;var d=this._rgba.slice(),e=d.pop(),f=l(a)._rgba;return l(b.map(d,function(a,b){return(1-e)*f[b]+e*a}))},toRgbaString:function(){var a="rgba(",d=b.map(this._rgba,function(a,b){return null==a?2<b?1:0:a});1===d[3]&&(d.pop(),a="rgb(");return a+d.join(",")+")"},toHslaString:function(){var a="hsla(",
d=b.map(this.hsla(),function(a,b){null==a&&(a=2<b?1:0);b&&3>b&&(a=Math.round(100*a)+"%");return a});1===d[3]&&(d.pop(),a="hsl(");return a+d.join(",")+")"},toHexString:function(a){var d=this._rgba.slice(),e=d.pop();a&&d.push(~~(255*e));return"#"+b.map(d,function(a,b){a=(a||0).toString(16);return 1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}};l.fn.parse.prototype=l.fn;B.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,
null,null,a[3]];var b=a[0]/255,e=a[1]/255,f=a[2]/255;a=a[3];var g=Math.max(b,e,f),h=Math.min(b,e,f),l=g-h,r=g+h,n=.5*r;return[Math.round(h===g?0:b===g?60*(e-f)/l+360:e===g?60*(f-b)/l+120:60*(b-e)/l+240)%360,0===n||1===n?n:.5>=n?l/r:l/(2-r),n,null==a?1:a]};B.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,e=a[1],f=a[2];a=a[3];e=.5>=f?f*(1+e):f+e-f*e;f=2*f-e;return[Math.round(255*F(f,e,b+1/3)),Math.round(255*F(f,e,b)),Math.round(255*F(f,e,b-1/3)),
a]};r(B,function(a,d){var e=d.props,f=d.cache,g=d.to,J=d.from;l.fn[a]=function(a){g&&!this[f]&&(this[f]=g(this._rgba));if(a===h)return this[f].slice();var d=b.type(a),x="array"===d||"object"===d?a:arguments,L=this[f].slice(),c;r(e,function(a,c){var b=x["object"===d?a:c.idx];null==b&&(b=L[c.idx]);L[c.idx]=n(b,c)});return J?(c=l(J(L)),c[f]=L,c):l(L)};r(e,function(e,f){l.fn[e]||(l.fn[e]=function(d){var g=b.type(d),c="alpha"===e?this._hsla?"hsla":"rgba":a,k=this[c](),h=k[f.idx];if("undefined"===g)return h;
"function"===g&&(d=d.call(this,h),g=b.type(d));if(null==d&&f.empty)return this;"string"===g&&(g=G.exec(d))&&(d=h+parseFloat(g[2])*("+"===g[1]?1:-1));k[f.idx]=d;return this[c](k)})})});r("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(a,d){b.cssHooks[d]={set:function(a,f){var e,h;if("string"!==b.type(f)||(e=g(f))){f=l(e||f);if(!N.rgba&&1!==f._rgba[3]){h="backgroundColor"===d?a.parentNode:a;do e=b.curCSS(h,"backgroundColor");
while((""===e||"transparent"===e)&&(h=h.parentNode)&&h.style);f=f.blend(e&&"transparent"!==e?e:"_default")}f=f.toRgbaString()}a.style[d]=f}};b.fx.step[d]=function(a){a.colorInit||(a.start=l(a.elem,d),a.end=l(a.end),a.colorInit=!0);b.cssHooks[d].set(a.elem,a.start.transition(a.end,a.pos))}});b(function(){var a=document.createElement("div").style;a.cssText="background-color:rgba(1,1,1,.5)";N.rgba=-1<a.backgroundColor.indexOf("rgba")});E=b.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",
black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",
lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(b){b.Jcrop=function(h,n){function g(a){return Math.round(a)+"px"}function F(a){a=b(a).offset();return[a.left,a.top]}function G(a){return[a.pageX-k[0],a.pageY-k[1]]}function H(a){"object"!==typeof a&&(a={});c=b.extend(c,a);b.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!==typeof c[b]&&(c[b]=function(){})})}function l(c,b,e){k=F(w);Q.setCursor("move"===c?c:c+"-resize");if("move"===c)return Q.activateHandlers(A(b),a,e);b=y.getFixed();var C=M(c),f=y.getCorner(M(C));
y.setPressed(y.getCorner(C));y.setCurrent(f);Q.activateHandlers(B(c,b),a,e)}function B(a,b){return function(C){if(c.aspectRatio)switch(a){case "e":C[1]=b.y+1;break;case "w":C[1]=b.y+1;break;case "n":C[0]=b.x+1;break;case "s":C[0]=b.x+1}else switch(a){case "e":C[1]=b.y2;break;case "w":C[1]=b.y2;break;case "n":C[0]=b.x2;break;case "s":C[0]=b.x2}y.setCurrent(C);q.update()}}function A(a){var c=a;ja.watchKeys();return function(a){y.moveOffset([a[0]-c[0],a[1]-c[1]]);c=a;q.update()}}function M(a){switch(a){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function N(a){return function(b){if(c.disabled||"move"===a&&!c.allowMove)return!1;k=F(w);X=!0;l(a,G(b));b.stopPropagation();b.preventDefault();return!1}}function E(a,c,b){var e=a.width(),f=a.height();e>c&&0<c&&(e=c,f=c/a.width()*a.height());f>b&&0<b&&(f=b,e=b/a.height()*a.width());D=a.width()/e;I=a.height()/f;a.width(e).height(f)}function r(a){return{x:a.x*
D,y:a.y*I,x2:a.x2*D,y2:a.y2*I,w:a.w*D,h:a.h*I}}function a(a){a=y.getFixed();a.w>c.minSelect[0]&&a.h>c.minSelect[1]?(q.enableHandles(),q.done()):q.release();Q.setCursor(c.allowSelect?"crosshair":"default")}function d(b){if(c.disabled||!c.allowSelect)return!1;X=!0;k=F(w);q.disableHandles();Q.setCursor("crosshair");var f=G(b);y.setPressed(f);q.update();Q.activateHandlers(e,a,"touch"===b.type.substring(0,5));ja.watchKeys();b.stopPropagation();b.preventDefault();return!1}function e(a){y.setCurrent(a);
q.update()}function f(){var a=b("<div></div>").addClass(c.baseClass+"-tracker");ca&&a.css({opacity:0,backgroundColor:"white"});return a}function x(a){J([a[0]/D,a[1]/I,a[2]/D,a[3]/I]);c.onSelect.call(O,r(y.getFixed()));q.enableHandles()}function J(a){y.setPressed([a[0],a[1]]);y.setCurrent([a[2],a[3]]);q.update()}function S(){c.disabled=!0;q.disableHandles();q.setCursor("default");Q.setCursor("default")}function W(){c.disabled=!1;L()}function ba(a,e,f){e=e||c.bgColor;c.bgFade&&b.fx.step.hasOwnProperty("backgroundColor")&&
c.fadeTime&&!f?a.animate({backgroundColor:e},{queue:!1,duration:c.fadeTime}):a.css("backgroundColor",e)}function L(a){c.allowResize?a?q.enableOnly():q.enableHandles():q.disableHandles();Q.setCursor(c.allowSelect?"crosshair":"default");q.setCursor(c.allowMove?"move":"default");c.hasOwnProperty("trueSize")&&(D=c.trueSize[0]/t,I=c.trueSize[1]/p);c.hasOwnProperty("setSelect")&&(x(c.setSelect),q.done(),delete c.setSelect);T.refresh();c.bgColor!=ma&&(ba(c.shade?T.getShades():R,c.shade?c.shadeColor||c.bgColor:
c.bgColor),ma=c.bgColor);da!=c.bgOpacity&&(da=c.bgOpacity,c.shade?T.refresh():q.setBgOpacity(da));ea=c.maxSize[0]||0;fa=c.maxSize[1]||0;ga=c.minSize[0]||0;ha=c.minSize[1]||0;c.hasOwnProperty("outerImage")&&(w.attr("src",c.outerImage),delete c.outerImage);q.refresh()}var c=b.extend({},b.Jcrop.defaults),k,v=navigator.userAgent.toLowerCase(),ca=/msie/.test(v),K=/msie [1-6]\./.test(v);"object"!==typeof h&&(h=b(h)[0]);"object"!==typeof n&&(n={});H(n);var v={border:"none",visibility:"visible",margin:0,
padding:0,position:"absolute",top:0,left:0},z=b(h),na=!0;if("IMG"==h.tagName){if(0!=z[0].width&&0!=z[0].height)z.width(z[0].width),z.height(z[0].height);else{var ka=new Image;ka.src=z[0].src;z.width(ka.width);z.height(ka.height)}var w=z.clone().removeAttr("id").css(v).show();w.width(z.width());w.height(z.height());z.after(w).hide()}else w=z.css(v).show(),na=!1,null===c.shade&&(c.shade=!0);E(w,c.boxWidth,c.boxHeight);var t=w.width(),p=w.height(),R=b("<div />").width(t).height(p).addClass(c.baseClass+
"-holder").css({position:"relative",backgroundColor:c.bgColor}).insertAfter(z).append(w);c.addClass&&R.addClass(c.addClass);var U=b("<div />"),ia=b("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),Y=b("<div />").width("100%").height("100%").css("zIndex",320),Z=b("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=y.getFixed();c.onDblClick.call(O,a)}).insertBefore(w).append(ia,Y);na&&(U=b("<img />").attr("src",w.attr("src")).css(v).width(t).height(p),
ia.append(U));K&&Z.css({overflowY:"hidden"});var aa=c.boundary,V=f().width(t+2*aa).height(p+2*aa).css({position:"absolute",top:g(-aa),left:g(-aa),zIndex:290}).mousedown(d),ma=c.bgColor,da=c.bgOpacity,ea,fa,ga,ha,D,I,X,la,oa;k=F(w);var P=function(){function a(){var a={},c=["touchstart","touchmove","touchend"],b=document.createElement("div"),e;try{for(e=0;e<c.length;e++){var f=c[e],f="on"+f,d=f in b;d||(b.setAttribute(f,"return;"),d="function"==typeof b[f]);a[c[e]]=d}return a.touchstart&&a.touchend&&
a.touchmove}catch(pa){return!1}}var b;b=!0===c.touchSupport||!1===c.touchSupport?c.touchSupport:a();return{createDragger:function(a){return function(b){if(c.disabled||"move"===a&&!c.allowMove)return!1;k=F(w);X=!0;l(a,G(P.cfilter(b)),!0);b.stopPropagation();b.preventDefault();return!1}},newSelection:function(a){return d(P.cfilter(a))},cfilter:function(a){a.pageX=a.originalEvent.changedTouches[0].pageX;a.pageY=a.originalEvent.changedTouches[0].pageY;return a},isSupported:a,support:b}}(),y=function(){function a(){if(!c.aspectRatio){var a=
g-d,b=h-k;ea&&Math.abs(a)>ea&&(g=0<a?d+ea:d-ea);fa&&Math.abs(b)>fa&&(h=0<b?k+fa:k-fa);ha/I&&Math.abs(b)<ha/I&&(h=0<b?k+ha/I:k-ha/I);ga/D&&Math.abs(a)<ga/D&&(g=0<a?d+ga/D:d-ga/D);0>d&&(g-=d,d-=d);0>k&&(h-=k,k-=k);0>g&&(d-=g,g-=g);0>h&&(k-=h,h-=h);g>t&&(a=g-t,d-=a,g-=a);h>p&&(a=h-p,k-=a,h-=a);d>t&&(a=d-p,h-=a,k-=a);k>p&&(a=k-p,h-=a,k-=a);return f(e(d,k,g,h))}var a=c.aspectRatio,b=c.minSize[0]/D,l=c.maxSize[0]/D,v=g-d,C=h-k,u=Math.abs(v),m=Math.abs(C);0===l&&(l=10*t);u/m<a?(u=h,m*=a,m=0>v?d-m:m+d,0>
m?(m=0,u=Math.abs((m-d)/a),u=0>C?k-u:u+k):m>t&&(m=t,u=Math.abs((m-d)/a),u=0>C?k-u:u+k)):(m=g,u/=a,u=0>C?k-u:k+u,0>u?(u=0,m=Math.abs((u-k)*a),m=0>v?d-m:m+d):u>p&&(u=p,m=Math.abs(u-k)*a,m=0>v?d-m:m+d));m>d?(m-d<b?m=d+b:m-d>l&&(m=d+l),u=u>k?k+(m-d)/a:k-(m-d)/a):m<d&&(d-m<b?m=d-b:d-m>l&&(m=d-l),u=u>k?k+(d-m)/a:k-(d-m)/a);0>m?(d-=m,m=0):m>t&&(d-=m-t,m=t);0>u?(k-=u,u=0):u>p&&(k-=u-p,u=p);return f(e(d,k,m,u))}function b(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>t&&(a[0]=t);a[1]>p&&(a[1]=p);return[Math.round(a[0]),
Math.round(a[1])]}function e(a,b,c,d){var k=a,e=c,f=b,g=d;c<a&&(k=c,e=a);d<b&&(f=d,g=b);return[k,f,e,g]}function f(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var d=0,k=0,g=0,h=0,l,v;return{flipCoords:e,setPressed:function(a){a=b(a);g=d=a[0];h=k=a[1]},setCurrent:function(a){a=b(a);l=a[0]-g;v=a[1]-h;g=a[0];h=a[1]},getOffset:function(){return[l,v]},moveOffset:function(a){var b=a[0];a=a[1];0>d+b&&(b-=b+d);0>k+a&&(a-=a+k);p<h+a&&(a+=p-(h+a));t<g+b&&(b+=t-(g+b));d+=b;g+=b;k+=a;h+=
a},getCorner:function(b){var c=a();switch(b){case "ne":return[c.x2,c.y];case "nw":return[c.x,c.y];case "se":return[c.x2,c.y2];case "sw":return[c.x,c.y2]}},getFixed:a}}(),T=function(){function a(){return d(y.getFixed())}function d(a){r.top.css({left:g(a.x),width:g(a.w),height:g(a.y)});r.bottom.css({top:g(a.y2),left:g(a.x),width:g(a.w),height:g(p-a.y2)});r.right.css({left:g(a.x2),width:g(t-a.x2)});r.left.css({width:g(a.x)})}function k(){return b("<div />").css({position:"absolute",backgroundColor:c.shadeColor||
c.bgColor}).appendTo(K)}function e(){n||(n=!0,K.insertBefore(w),a(),q.setBgOpacity(1,0,1),U.hide(),f(c.shadeColor||c.bgColor,1),q.isAwake()?l(c.bgOpacity,1):l(1,1))}function f(a,b){ba(v(),a,b)}function h(){n&&(K.remove(),U.show(),n=!1,q.isAwake()?q.setBgOpacity(c.bgOpacity,1,1):(q.setBgOpacity(1,1,1),q.disableHandles()),ba(R,0,1))}function l(a,b){n&&(c.bgFade&&!b?K.animate({opacity:1-a},{queue:!1,duration:c.fadeTime}):K.css({opacity:1-a}))}function v(){return K.children()}var n=!1,K=b("<div />").css({position:"absolute",
zIndex:240,opacity:0}),r={top:k(),left:k().height(p),right:k().height(p),bottom:k()};return{update:a,updateRaw:d,getShades:v,setBgColor:f,enable:e,disable:h,resize:function(a,b){r.left.css({height:g(b)});r.right.css({height:g(b)})},refresh:function(){c.shade?e():h();q.isAwake()&&l(c.bgOpacity)},opacity:l}}(),q=function(){function a(a,c){var d=b("<div />").mousedown(N(a)).css({cursor:a+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+a);P.support&&d.bind("touchstart.jcrop",P.createDragger(a));
Y.append(d);return d}function d(b){var c;for(c=0;c<b.length;c++)a(b[c],ca++).addClass("jcrop-dragbar")}function k(a){var d,k;for(k=0;k<a.length;k++){switch(a[k]){case "n":d="hline";break;case "s":d="hline bottom";break;case "e":d="vline right";break;case "w":d="vline"}var e=d,e=b("<div />").css({position:"absolute",opacity:c.borderOpacity}).addClass(c.baseClass+"-"+e);ia.append(e)}}function e(b){var d;for(d=0;d<b.length;d++){var k=c.handleSize,e=a(b[d],ca++).css({opacity:c.handleOpacity}).addClass(c.baseClass+
"-handle");k&&e.width(k).height(k)}}function h(){var a=y.getFixed();y.setPressed([a.x,a.y]);y.setCurrent([a.x2,a.y2]);l()}function l(a){if(t)return v(a)}function v(a){var b=y.getFixed(),d=b.h;Z.width(Math.round(b.w)).height(Math.round(d));var d=b.x,k=b.y;c.shade||U.css({top:g(-k),left:g(-d)});Z.css({top:g(k),left:g(d)});c.shade&&T.updateRaw(b);t||(Z.show(),c.shade?T.opacity(da):q(da,!0),t=!0);a?c.onSelect.call(O,r(b)):c.onChange.call(O,r(b))}function q(a,b,d){if(t||b)c.bgFade&&!d?w.animate({opacity:a},
{queue:!1,duration:c.fadeTime}):w.css("opacity",a)}function K(){x=!0;if(c.allowResize)return Y.show(),!0}function n(){x=!1;Y.hide()}function p(a){a?(la=!0,n()):(la=!1,K())}var t,ca=370,x=!1;c.dragEdges&&b.isArray(c.createDragbars)&&d(c.createDragbars);b.isArray(c.createHandles)&&e(c.createHandles);c.drawBorders&&b.isArray(c.createBorders)&&k(c.createBorders);b(document).bind("touchstart.jcrop-ios",function(a){b(a.currentTarget).hasClass("jcrop-tracker")&&a.stopPropagation()});var z=f().mousedown(N("move")).css({cursor:"move",
position:"absolute",zIndex:360});P.support&&z.bind("touchstart.jcrop",P.createDragger("move"));ia.append(z);n();return{updateVisible:l,update:v,release:function(){n();Z.hide();c.shade?T.opacity(1):q(1);t=!1;c.onRelease.call(O)},refresh:h,isAwake:function(){return t},setCursor:function(a){z.css("cursor",a)},enableHandles:K,enableOnly:function(){x=!0},showHandles:function(){x&&Y.show()},disableHandles:n,animMode:p,setBgOpacity:q,done:function(){p(!1);h()}}}(),Q=function(){function a(a){f(G(a));return!1}
function d(a){a.preventDefault();a.stopPropagation();X&&(X=!1,g(G(a)),q.isAwake()&&c.onSelect.call(O,r(y.getFixed())),V.css({zIndex:290}),b(document).unbind(".jcrop"),f=function(){},g=function(){});return!1}function k(a){f(G(P.cfilter(a)));return!1}function e(a){return d(P.cfilter(a))}var f=function(){},g=function(){},h=c.trackDocument;h||V.mousemove(a).mouseup(d).mouseout(d);w.before(V);return{activateHandlers:function(c,l,v){X=!0;f=c;g=l;V.css({zIndex:450});v?b(document).bind("touchmove.jcrop",
k).bind("touchend.jcrop",e):h&&b(document).bind("mousemove.jcrop",a).bind("mouseup.jcrop",d);return!1},setCursor:function(a){V.css("cursor",a)}}}(),ja=function(){function a(a){e.hide()}function d(a,b,d){c.allowMove&&(y.moveOffset([b,d]),q.updateVisible(!0));a.preventDefault();a.stopPropagation()}function k(a){if(a.ctrlKey||a.metaKey)return!0;var b=(oa=a.shiftKey?!0:!1)?10:1;switch(a.keyCode){case 37:d(a,-b,0);break;case 39:d(a,b,0);break;case 38:d(a,0,-b);break;case 40:d(a,0,b);break;case 27:c.allowSelect&&
q.release();break;case 9:return!0}return!1}var e=b('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),f=b("<div />").css({position:"absolute",overflow:"hidden"}).append(e);c.keySupport&&(e.keydown(k).blur(a),K||!c.fixedSupport?(e.css({position:"absolute",left:"-20px"}),f.append(e).insertBefore(w)):e.insertBefore(w));return{watchKeys:function(){c.keySupport&&(e.show(),e.focus())}}}();P.support&&V.bind("touchstart.jcrop",P.newSelection);Y.hide();L(!0);
var O={setImage:function(a,b){q.release();S();var d=new Image;d.onload=function(){var k=d.height,e=c.boxWidth,f=c.boxHeight;w.width(d.width).height(k);w.attr("src",a);U.attr("src",a);E(w,e,f);t=w.width();p=w.height();U.width(t).height(p);V.width(t+2*aa).height(p+2*aa);R.width(t).height(p);T.resize(t,p);W();"function"===typeof b&&b.call(O)};d.src=a},animateTo:function(a,b){var d=a[0]/D,k=a[1]/I,e=a[2]/D,f=a[3]/I;if(!la){var g=y.flipCoords(d,k,e,f),h=y.getFixed(),l=[h.x,h.y,h.x2,h.y2],v=c.animationDelay,
n=g[0]-l[0],K=g[1]-l[1],r=g[2]-l[2],t=g[3]-l[3],p=0,u=c.swingSpeed,d=l[0],k=l[1],e=l[2],f=l[3];q.animMode(!0);var m=function(){return function(){p+=(100-p)/u;l[0]=Math.round(d+p/100*n);l[1]=Math.round(k+p/100*K);l[2]=Math.round(e+p/100*r);l[3]=Math.round(f+p/100*t);99.8<=p&&(p=100);100>p?(J(l),window.setTimeout(m,v)):(q.done(),q.animMode(!1),"function"===typeof b&&b.call(O))}}();window.setTimeout(m,v)}},setSelect:x,setOptions:function(a){H(a);L()},tellSelect:function(){return r(y.getFixed())},tellScaled:function(){return y.getFixed()},
setClass:function(a){R.removeClass().addClass(c.baseClass+"-holder").addClass(a)},disable:S,enable:W,cancel:function(){q.done();Q.activateHandlers(null,null)},release:q.release,destroy:function(){R.remove();z.show();z.css("visibility","visible");b(h).removeData("Jcrop")},focus:ja.watchKeys,getBounds:function(){return[t*D,p*I]},getWidgetSize:function(){return[t,p]},getScaleFactor:function(){return[D,I]},getOptions:function(){return c},ui:{holder:R,selection:Z}};ca&&R.bind("selectstart",function(){return!1});
z.data("Jcrop",O);return O};b.fn.Jcrop=function(h,n){var g;this.each(function(){if(b(this).data("Jcrop")){if("api"===h)return b(this).data("Jcrop");b(this).data("Jcrop").setOptions(h)}else"IMG"==this.tagName?b.Jcrop.Loader(this,function(){b(this).css({display:"block",visibility:"hidden"});g=b.Jcrop(this,h);b.isFunction(n)&&n.call(g)}):(b(this).css({display:"block",visibility:"hidden"}),g=b.Jcrop(this,h),b.isFunction(n)&&n.call(g))});return this};b.Jcrop.Loader=function(h,n,g){function F(){H.complete?
(G.unbind(".jcloader"),b.isFunction(n)&&n.call(H)):window.setTimeout(F,50)}var G=b(h),H=G[0];G.bind("load.jcloader",F).bind("error.jcloader",function(h){G.unbind(".jcloader");b.isFunction(g)&&g.call(H)});H.complete&&b.isFunction(n)&&(G.unbind(".jcloader"),n.call(H))};b.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),
createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);
$(function(){var b="png PNG jpg JPG jpeg JPEG".split(" "),h,n=$(".imagecrop-canvas"),g=n[0];if(void 0!=g){var F=g.width;heightLimit=g.height;toScale=!0;if(0==F||0==heightLimit)toScale=!1,F=heightLimit=600;var G=function(a){a=a.type.split("/");var c=a[0];h=a[a.length-1];if("image"==c&&-1!=$.inArray(h,b))return h="png"==h||"PNG"==h?"png":"jpeg",!0},H,l,B=function(a){a.stopPropagation();a.preventDefault();a.target.className="imagecrop-drag";"dragover"==a.type&&(a.target.className="imagecrop-drag hover")},
A,M,N,E=new Image,r=function(a){var b;E.src=a;E.onload=function(){var c=[F,heightLimit],d=[E.width,E.height];d[0]>c[0]&&(l=c[0]/d[0],d[0]*=l,d[1]*=l);d[1]>c[1]&&(l=c[1]/d[1],d[0]*=l,d[1]*=l);d[0]=Math.floor(d[0]);d[1]=Math.floor(d[1]);M=d;g.width=M[0];g.height=M[1];g.getContext("2d").drawImage(E,0,0,M[0],M[1]);b=g.toDataURL("image/"+h);toScale?$(".imagecrop-data").val(N+";"+b):$(".imagecrop-data").val(N+";"+a);$("#uploaded-image").attr({src:b,style:"display: block"});$("#select-crop-btn").css({display:"inline"});
$("hr").attr({style:"display:block"})}},a=$("#upload-title"),d=$("#upload-container");a.bind("click",function(b){d.slideDown("fast",function(){a.html(i18n.upload_image)})});var e=function(b){A&&A.destroy();setTimeout(function(){d.slideUp("fast",function(){a.html("<a>"+i18n.upload_new_image+"</a>")})},500);var c=new FileReader,e=(b.target.files||b.originalEvent.dataTransfer.files)[0];N=e.name;H=b;"drop"==b.type&&B(b);b=$(".imagecrop-upload");G(e)?(c.onload=function(a){r(a.target.result)},c.readAsDataURL(e)):
alert(i18n.invalid_image+"\n"+i18n.supported_image_formats+": png, jpeg or jpg");b.val("")},f=$("#select-crop-btn"),x=$("#crop-btn"),J=$("#remove-btn"),S=$('input[name="imagecrop-points"]'),W=function(a){A.release();A.disable();x.css({display:"none"});J.css({display:"none"});f.css({display:"inline"})};f.bind("click",function(a){A.enable();var b=A.getBounds();a=b[0]/2;var c=b[1]/2,d=b[0]/4,b=b[1]/4;A.animateTo([a-d,c-b,a+d,c+b]);f.css({display:"none"});x.css({display:"inline"});J.css({display:"inline"})});
x.bind("click",function(a){var b=$(".jcrop-holder");a=parseInt(b.css("width").split("px")[0]);var c=parseInt(b.css("height").split("px")[0]),b=E.width/a,c=E.height/c;a=S.val().split(",");var d=a[0],e=a[1],f=a[3];a=Math.round((a[2]-d)*b);c=Math.round((f-e)*c);A.destroy();W(H);n.attr({width:a,height:c});g.getContext("2d").drawImage(E,Math.round(d*b),Math.round(e*b),a,c,0,0,a,c);a=g.toDataURL("image/"+h);r(a)});J.bind("click",W);var ba=function(a){S.val(a.x+","+a.y+","+a.x2+","+a.y2)};$("#uploaded-image").bind("load",
function(a){a=$(this);A&&(A.destroy(),W(H));a.Jcrop({onChange:ba,opacity:.2,bgFade:!0,bgColor:"black",addClass:"jcrop-light"},function(){A=this;A.getBounds();A.ui.selection.addClass("jcrop-selection");A.disable()})});var L=$(".imagecrop-data").attr("value");H=document.createEvent("Event");var c=new Image;c.src=L;c.onload=function(){n.attr({width:c.width,height:c.height});g.getContext("2d").drawImage(c,0,0,c.width,c.height);var a=L.split(".");h=a[a.length-1];"jpg"==h&&(h="jpeg");N="upload."+h;a=g.toDataURL("image/"+
h);r(a)};$(".imagecrop-drag").bind("dragover",B).bind("dragleave",B).bind("drop",e);$(".imagecrop-upload").bind("change",e)}});
