$("#contact-add").click(function(){$("#contact-add_throbber").removeClass("hide").show();var b=$(this);$("#popup").remove();var c=S3.Ap.concat("/pr/contact/create.iframe");$.get(c,function(a){b.hide();b.after("<div></div>");b.next().html(a);a=S3.Ap.concat("/pr/contact/create?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",a);$("#contact-add_throbber").hide();$("#popup form").show()})});
$(".contact").each(function(){var b=$(this),c=b.attr("id").match(/\d+/);b.find("a.delete-btn-ajax").click(function(a){confirm(i18n.delete_confirmation)&&($.post(S3.Ap.concat("/pr/contact/"+c[0]+"/delete")),b.addClass("hide"))});b.find("a.editBtn").click(function(a){a=b.find("span");var e=a.html(),g=$("<div>").addClass("form-container"),d=$("<form>");g.append(d);var f=$('<input id="pr_contact_value" size=62>');f.val(e);d.append(f);e=$('<input type="submit" class="fright">');e.val("Save");d.append(e);
a.replaceWith(g);b.addClass("edit");d.submit(function(a){a.preventDefault();$("#pr_contact_value_error").remove();b.removeClass("edit").addClass("saving");d.append($('<img class="pr_contact_throbber" src="'+S3.Ap.concat("/static/img/jquery-ui/ui-anim_basic_16x16.gif")+'">').addClass("fright"));d.find("input[type=submit]").addClass("hide");$.post(S3.Ap.concat("/pr/contact/"+c[0]+".s3json"),'{"$_pr_contact":'+JSON.stringify({value:f.val()})+"}",function(a){if("failed"==a.status){try{error_message=a.tree.$_pr_contact[0].value["@error"]}catch(c){error_message=
a.message}$("#pr_contact_value").after($('<div id="pr_contact_value_error" class="error">'+error_message+"</div>").css({display:"none"}).slideDown("slow").click(function(){$(this).fadeOut("slow");return!1}));b.removeClass("saving").addClass("edit");d.find("input[type=submit]").removeClass("hide");$(".pr_contact_throbber").remove()}else b.removeClass("saving"),a=f.val(),g.replaceWith($("<span>").html(a))},"json")})})});
$("#emergency-add").click(function(){$("#emergency-add_throbber").removeClass("hide").show();var b=$(this);$("#popup").remove();var c=S3.Ap.concat("/pr/contact_emergency/create.iframe");$.get(c,function(a){b.hide();b.after("<div></div>");b.next().html(a);a=S3.Ap.concat("/pr/contact_emergency/create?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",a);$("#emergency-add_throbber").hide();$("#popup form").show()})});
$(".emergency").each(function(){var b=$(this),c=b.attr("id").match(/\d+/);b.find("a.delete-btn-ajax").click(function(a){confirm(i18n.delete_confirmation)&&($.post(S3.Ap.concat("/pr/contact_emergency/"+c+"/delete")),b.addClass("hide"))});b.find("a.editBtn").click(function(){$("#emergency-add_throbber").removeClass("hide").show();var a=S3.Ap.concat("/pr/contact_emergency/"+c+".iframe/update");$.get(a,function(a){$("#popup").remove();b.hide();b.after("<div></div>");b.next().html(a);a=S3.Ap.concat("/pr/contact_emergency/"+
c+"/update?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",a);$("#emergency-add_throbber").hide();$("#popup form").show()})})});
