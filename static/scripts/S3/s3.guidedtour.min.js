(function(b,k,m){var l={version:"2.0.3",tipLocation:"bottom",nubPosition:"auto",scroll:!0,scrollSpeed:300,timer:0,autoStart:!1,startTimerOnClick:!0,startOffset:0,nextButton:!0,tipAnimation:"fade",pauseAfter:[],tipAnimationFadeSpeed:300,cookieMonster:!1,cookieName:"joyride",cookieDomain:!1,localStorage:!1,localStorageKey:"joyride",tipContainer:"body",modal:!1,expose:!1,postExposeCallback:b.noop,preRideCallback:b.noop,postRideCallback:b.noop,preStepCallback:b.noop,postStepCallback:b.noop,template:{link:'<a href="#close" class="joyride-close-tip">X</a>',
timer:'<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>',tip:'<div class="joyride-tip-guide"><span class="joyride-nub"></span></div>',wrapper:'<div class="joyride-content-wrapper" role="dialog"></div>',button:'<a href="#" class="joyride-next-tip"></a>',modal:'<div class="joyride-modal-bg"></div>',expose:'<div class="joyride-expose-wrapper"></div>',exposeCover:'<div class="joyride-expose-cover"></div>'}},h=h||!1,a={},d={init:function(c){return this.each(function(){b.isEmptyObject(a)?
(a=b.extend(!0,l,c),a.document=k.document,a.$document=b(a.document),a.$window=b(k),a.$content_el=b(this),a.$body=b(a.tipContainer),a.body_offset=b(a.tipContainer).position(),a.$tip_content=b("> li",a.$content_el),a.paused=!1,a.attempts=0,a.tipLocationPatterns={top:["bottom"],bottom:[],left:["right","top","bottom"],right:["left","top","bottom"]},d.jquery_check(),b.isFunction(b.cookie)||(a.cookieMonster=!1),a.cookieMonster&&b.cookie(a.cookieName)||a.localStorage&&d.support_localstorage()&&localStorage.getItem(a.localStorageKey)||
(a.$tip_content.each(function(a){d.create({$li:b(this),index:a})}),a.autoStart&&(!a.startTimerOnClick&&0<a.timer?(d.show("init"),d.startTimer()):d.show("init"))),a.$document.on("click.joyride",".joyride-next-tip, .joyride-modal-bg",function(c){c.preventDefault();1>a.$li.next().length?d.end():0<a.timer?(clearTimeout(a.automate),d.hide(),d.show(),d.startTimer()):(d.hide(),d.show())}),a.$document.on("click.joyride",".joyride-close-tip",function(a){a.preventDefault();d.end()}),a.$window.bind("resize.joyride",
function(c){a.$li&&(a.exposed&&0<a.exposed.length&&b(a.exposed).each(function(){var a=b(this);d.un_expose(a);d.expose(a)}),d.is_phone()?d.pos_phone():d.pos_default())})):d.restart()})},resume:function(){d.set_li();d.show()},nextTip:function(){1>a.$li.next().length?d.end():0<a.timer?(clearTimeout(a.automate),d.hide(),d.show(),d.startTimer()):(d.hide(),d.show())},tip_template:function(c){var e,f,g;c.tip_class=c.tip_class||"";e=b(a.template.tip).addClass(c.tip_class);f=b.trim(b(c.li).html())+d.button_text(c.button_text)+
a.template.link+d.timer_instance(c.index);g=b(a.template.wrapper);c.li.attr("data-aria-labelledby")&&g.attr("aria-labelledby",c.li.attr("data-aria-labelledby"));c.li.attr("data-aria-describedby")&&g.attr("aria-describedby",c.li.attr("data-aria-describedby"));e.append(g);e.first().attr("data-index",c.index);b(".joyride-content-wrapper",e).append(f);return e[0]},timer_instance:function(c){return 0===c&&a.startTimerOnClick&&0<a.timer||0===a.timer?"":d.outerHTML(b(a.template.timer)[0])},button_text:function(c){a.nextButton?
(c=b.trim(c)||"Next",c=d.outerHTML(b(a.template.button).append(c)[0])):c="";return c},create:function(c){var e=c.$li.attr("data-button")||c.$li.attr("data-text"),f=c.$li.attr("class");c=b(d.tip_template({tip_class:f,index:c.index,button_text:e,li:c.$li}));b(a.tipContainer).append(c)},show:function(c){var e={},f=[],g=0,f=null;if(a.$li===m||-1===b.inArray(a.$li.index(),a.pauseAfter))if(a.paused?a.paused=!1:d.set_li(c),a.attempts=0,a.$li.length&&0<a.$target.length){c&&(a.preRideCallback(a.$li.index(),
a.$next_tip),a.modal&&d.show_modal());a.preStepCallback(a.$li.index(),a.$next_tip);f=(a.$li.data("options")||":").split(";");g=f.length;for(c=g-1;0<=c;c--)g=f[c].split(":"),2===g.length&&(e[b.trim(g[0])]=b.trim(g[1]));a.tipSettings=b.extend({},a,e);a.tipSettings.tipLocationPattern=a.tipLocationPatterns[a.tipSettings.tipLocation];a.modal&&a.expose&&d.expose();!/body/i.test(a.$target.selector)&&a.scroll&&d.scroll_to();d.is_phone()?d.pos_phone(!0):d.pos_default(!0);f=b(".joyride-timer-indicator",a.$next_tip);
/pop/i.test(a.tipAnimation)?(f.outerWidth(0),0<a.timer?(a.$next_tip.show(),f.animate({width:b(".joyride-timer-indicator-wrap",a.$next_tip).outerWidth()},a.timer)):a.$next_tip.show()):/fade/i.test(a.tipAnimation)&&(f.outerWidth(0),0<a.timer?(a.$next_tip.fadeIn(a.tipAnimationFadeSpeed),a.$next_tip.show(),f.animate({width:b(".joyride-timer-indicator-wrap",a.$next_tip).outerWidth()},a.timer)):a.$next_tip.fadeIn(a.tipAnimationFadeSpeed));a.$current_tip=a.$next_tip;b(".joyride-next-tip",a.$current_tip).focus();
d.tabbable(a.$current_tip)}else a.$li&&1>a.$target.length?d.show():d.end();else a.paused=!0},is_phone:function(){return h?h.mq("only screen and (max-width: 767px)"):767>a.$window.width()?!0:!1},support_localstorage:function(){return h?h.localstorage:!!k.localStorage},hide:function(){a.modal&&a.expose&&d.un_expose();a.modal||b(".joyride-modal-bg").hide();a.$current_tip.hide();a.postStepCallback(a.$li.index(),a.$current_tip)},set_li:function(c){c?(a.$li=a.$tip_content.eq(a.startOffset),d.set_next_tip(),
a.$current_tip=a.$next_tip):(a.$li=a.$li.next(),d.set_next_tip());d.set_target()},set_next_tip:function(){a.$next_tip=b(".joyride-tip-guide[data-index="+a.$li.index()+"]")},set_target:function(){var c=a.$li.attr("data-class"),e=a.$li.attr("data-id");a.$target=e?b(a.document.getElementById(e)):c?b("."+c).filter(":visible").first():b("body")},scroll_to:function(){var c;c=a.$window.height()/2;c=Math.ceil(a.$target.offset().top-c+a.$next_tip.outerHeight());b("html, body").stop().animate({scrollTop:c},
a.scrollSpeed)},paused:function(){return-1===b.inArray(a.$li.index()+1,a.pauseAfter)?!0:!1},destroy:function(){b.isEmptyObject(a)||a.$document.off(".joyride");b(k).off(".joyride");b(".joyride-close-tip, .joyride-next-tip, .joyride-modal-bg").off(".joyride");b(".joyride-tip-guide, .joyride-modal-bg").remove();clearTimeout(a.automate);a={}},restart:function(){a.autoStart?(d.hide(),a.$li=m,d.show("init")):(!a.startTimerOnClick&&0<a.timer?(d.show("init"),d.startTimer()):d.show("init"),a.autoStart=!0)},
pos_default:function(c){Math.ceil(a.$window.height()/2);a.$next_tip.offset();var e=b(".joyride-nub",a.$next_tip),f=Math.ceil(e.outerWidth()/2),g=Math.ceil(e.outerHeight()/2);if(c=c||!1)a.$next_tip.css("visibility","hidden"),a.$next_tip.show();/body/i.test(a.$target.selector)?a.$li.length&&d.pos_modal(e):(d.bottom()?(a.$next_tip.css({top:a.$target.offset().top+g+a.$target.outerHeight(),left:a.$target.offset().left}),/right/i.test(a.tipSettings.nubPosition)&&a.$next_tip.css("left",a.$target.offset().left-
a.$next_tip.outerWidth()+a.$target.outerWidth()),d.nub_position(e,a.tipSettings.nubPosition,"top")):d.top()?(a.$next_tip.css({top:a.$target.offset().top-a.$next_tip.outerHeight()-g,left:a.$target.offset().left}),d.nub_position(e,a.tipSettings.nubPosition,"bottom")):d.right()?(a.$next_tip.css({top:a.$target.offset().top,left:a.$target.outerWidth()+a.$target.offset().left+f}),d.nub_position(e,a.tipSettings.nubPosition,"left")):d.left()&&(a.$next_tip.css({top:a.$target.offset().top,left:a.$target.offset().left-
a.$next_tip.outerWidth()-f}),d.nub_position(e,a.tipSettings.nubPosition,"right")),!d.visible(d.corners(a.$next_tip))&&a.attempts<a.tipSettings.tipLocationPattern.length&&(e.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),a.tipSettings.tipLocation=a.tipSettings.tipLocationPattern[a.attempts],a.attempts++,d.pos_default(!0)));c&&(a.$next_tip.hide(),a.$next_tip.css("visibility","visible"))},pos_phone:function(c){var e=a.$next_tip.outerHeight();a.$next_tip.offset();var f=
a.$target.outerHeight(),g=b(".joyride-nub",a.$next_tip),h=Math.ceil(g.outerHeight()/2);c=c||!1;g.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left");c&&(a.$next_tip.css("visibility","hidden"),a.$next_tip.show());/body/i.test(a.$target.selector)?a.$li.length&&d.pos_modal(g):d.top()?(a.$next_tip.offset({top:a.$target.offset().top-e-h}),g.addClass("bottom")):(a.$next_tip.offset({top:a.$target.offset().top+f+h}),g.addClass("top"));c&&(a.$next_tip.hide(),a.$next_tip.css("visibility",
"visible"))},pos_modal:function(a){d.center();a.hide();d.show_modal()},show_modal:function(){1>b(".joyride-modal-bg").length&&b("body").append(a.template.modal).show();/pop/i.test(a.tipAnimation)?b(".joyride-modal-bg").show():b(".joyride-modal-bg").fadeIn(a.tipAnimationFadeSpeed)},expose:function(){var c,e,f,g,h="expose-"+Math.floor(1E4*Math.random());if(0<arguments.length&&arguments[0]instanceof b)f=arguments[0];else if(a.$target&&!/body/i.test(a.$target.selector))f=a.$target;else return!1;if(1>
f.length)return k.console&&console.error("element not valid",f),!1;c=b(a.template.expose);a.$body.append(c);c.css({top:f.offset().top,left:f.offset().left,width:f.outerWidth(!0),height:f.outerHeight(!0)});e=b(a.template.exposeCover);g={zIndex:f.css("z-index"),position:f.css("position")};f.css("z-index",1*c.css("z-index")+1);"static"==g.position&&f.css("position","relative");f.data("expose-css",g);e.css({top:f.offset().top,left:f.offset().left,width:f.outerWidth(!0),height:f.outerHeight(!0)});a.$body.append(e);
c.addClass(h);e.addClass(h);a.tipSettings.exposeClass&&(c.addClass(a.tipSettings.exposeClass),e.addClass(a.tipSettings.exposeClass));f.data("expose",h);a.postExposeCallback(a.$li.index(),a.$next_tip,f);d.add_exposed(f)},un_expose:function(){var c,e,f;f=!1;if(0<arguments.length&&arguments[0]instanceof b)e=arguments[0];else if(a.$target&&!/body/i.test(a.$target.selector))e=a.$target;else return!1;if(1>e.length)return k.console&&console.error("element not valid",e),!1;c=e.data("expose");c=b("."+c);1<
arguments.length&&(f=arguments[1]);!0===f?b(".joyride-expose-wrapper,.joyride-expose-cover").remove():c.remove();f=e.data("expose-css");"auto"==f.zIndex?e.css("z-index",""):e.css("z-index",f.zIndex);f.position!=e.css("position")&&("static"==f.position?e.css("position",""):e.css("position",f.position));e.removeData("expose");e.removeData("expose-z-index");d.remove_exposed(e)},add_exposed:function(c){a.exposed=a.exposed||[];c instanceof b?a.exposed.push(c[0]):"string"==typeof c&&a.exposed.push(c)},
remove_exposed:function(c){var e;c instanceof b?e=c[0]:"string"==typeof c&&(e=c);a.exposed=a.exposed||[];for(c=0;c<a.exposed.length;c++)if(a.exposed[c]==e){a.exposed.splice(c,1);break}},center:function(){var c=a.$window;a.$next_tip.css({top:(c.height()-a.$next_tip.outerHeight())/2+c.scrollTop(),left:(c.width()-a.$next_tip.outerWidth())/2+c.scrollLeft()});return!0},bottom:function(){return/bottom/i.test(a.tipSettings.tipLocation)},top:function(){return/top/i.test(a.tipSettings.tipLocation)},right:function(){return/right/i.test(a.tipSettings.tipLocation)},
left:function(){return/left/i.test(a.tipSettings.tipLocation)},corners:function(c){var b=a.$window,d=b.height()/2,d=Math.ceil(a.$target.offset().top-d+a.$next_tip.outerHeight()),g=b.width()+b.scrollLeft(),h=b.height()+d,k=b.height()+b.scrollTop(),l=b.scrollTop();d<l&&(l=0>d?0:d);h>k&&(k=h);return[c.offset().top<l,g<c.offset().left+c.outerWidth(),k<c.offset().top+c.outerHeight(),b.scrollLeft()>c.offset().left]},visible:function(a){for(var b=a.length;b--;)if(a[b])return!1;return!0},nub_position:function(a,
b,d){"auto"===b?a.addClass(d):a.addClass(b)},startTimer:function(){a.$li.length?a.automate=setTimeout(function(){d.hide();d.show();d.startTimer()},a.timer):clearTimeout(a.automate)},end:function(){a.cookieMonster&&b.cookie(a.cookieName,"ridden",{expires:365,domain:a.cookieDomain});a.localStorage&&localStorage.setItem(a.localStorageKey,!0);0<a.timer&&clearTimeout(a.automate);a.modal&&a.expose&&d.un_expose();b(".joyride-modal-bg").hide();a.$current_tip.hide();a.postStepCallback(a.$li.index(),a.$current_tip);
a.postRideCallback(a.$li.index(),a.$current_tip)},jquery_check:function(){return b.isFunction(b.fn.on)?!0:(b.fn.on=function(a,b,d){return this.delegate(b,a,d)},b.fn.off=function(a,b,d){return this.undelegate(b,a,d)},!1)},outerHTML:function(a){return a.outerHTML||(new XMLSerializer).serializeToString(a)},version:function(){return a.version},tabbable:function(a){b(a).on("keydown",function(e){if(!e.isDefaultPrevented()&&e.keyCode&&27===e.keyCode)e.preventDefault(),d.end();else if(9===e.keyCode){var f=
b(a).find(":tabbable"),g=f.filter(":first"),f=f.filter(":last");e.target!==f[0]||e.shiftKey?e.target===g[0]&&e.shiftKey&&(f.focus(1),e.preventDefault()):(g.focus(1),e.preventDefault())}})}};b.fn.joyride=function(a){if(d[a])return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.joyride");else return d.init.apply(this,arguments)}})(jQuery,this);
function pre_step_callback(b,k){$.each(pre_step_data,function(m,l){var h=l[1],a=l[2];if(b==l[0]){var d=$("#"+h+" thead th").map(function(){return $(this).text().toLowerCase()});d[0]="id";var h=$("#"+h+" tbody tr").map(function(b){var c={};if(b==a)return $(this).find("td").each(function(a){a=d[a];c[a]="id"==a?$(this).find("a").attr("db_id"):$(this).text()}),c}).get(),c=$(k)[0].innerHTML;0<h.length&&$.each(h[0],function(a,b){c=c.replace(new RegExp("dt_"+a,"g"),b)});$($(k)[0]).html(c)}})}
function post_step_callback(b,k){$.each(post_step_data,function(k,l){var h=l[1];if(b==l[0]){if(2<l.length)var a=l[3],a=$($("td:first a:first","#"+l[2]+" tbody tr")[a]).attr("db_id"),h=h.replace(/dt_id/g,a);window.location.href=h}})}function post_ride_callback(b,k){var m={};m.completed=post_ride_data[0];m.tour_id=post_ride_data[1];$.ajax({type:"POST",url:S3.Ap.concat("/tour/guided_tour_finished"),data:m})}
$(document).ready(function(){var b=$("#prestep_data");0<b.length?(pre_step_data=$.parseJSON(b.val()),prestep_callback=pre_step_callback):prestep_callback=$.noop;b=$("#poststep_data");0<b.length?(post_step_data=$.parseJSON(b.val()),poststep_callback=post_step_callback):poststep_callback=$.noop;b=$("#postride_data");0<b.length?(post_ride_data=$.parseJSON(b.val()),postride_callback=post_ride_callback):postride_callback=$.noop;$("#joyrideID_1").joyride({autoStart:!0,preStepCallback:prestep_callback,postStepCallback:poststep_callback,
postRideCallback:post_ride_callback})});
