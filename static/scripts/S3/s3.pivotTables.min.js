/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(d){d.color={};d.color.make=function(A,a,e,c){var b={};b.r=A||0;b.g=a||0;b.b=e||0;b.a=null!=c?c:1;b.add=function(d,a){for(var e=0;e<d.length;++e)b[d.charAt(e)]+=a;return b.normalize()};b.scale=function(d,a){for(var e=0;e<d.length;++e)b[d.charAt(e)]*=a;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function d(a,e,b){return e<a?a:e>b?b:e}b.r=d(0,parseInt(b.r),255);b.g=d(0,parseInt(b.g),255);
b.b=d(0,parseInt(b.b),255);b.a=d(0,b.a,1);return b};b.clone=function(){return d.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};d.color.extract=function(A,a){var e;do{e=A.css(a).toLowerCase();if(""!=e&&"transparent"!=e)break;A=A.parent()}while(!d.nodeName(A.get(0),"body"));"rgba(0, 0, 0, 0)"==e&&(e="transparent");return d.color.parse(e)};d.color.parse=function(A){var a,e=d.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(A))return e(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(A))return e(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(A))return e(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(A))return e(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(A))return e(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(A))return e(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));A=d.trim(A).toLowerCase();if("transparent"==A)return e(255,255,255,0);a=E[A]||[0,0,0];return e(a[0],a[1],a[2])};var E={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d){function E(a,c){var b=c.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,d(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(c.width(),c.height());this.textContainer=null;this.text={};this._textCache={}}function A(a,c,b,k){function f(n,s){s=[H].concat(s);for(var l=0;l<n.length;++l)n[l].apply(this,s)}function g(n){for(var s=[],l=0;l<n.length;++l){var a=d.extend(!0,{},m.series);null!=n[l].data?
(a.data=n[l].data,delete n[l].data,d.extend(!0,a,n[l]),n[l].data=a.data):a.data=n[l];s.push(a)}F=s;l=F.length;s=-1;for(n=0;n<F.length;++n)a=F[n].color,null!=a&&(l--,"number"==typeof a&&a>s&&(s=a));l<=s&&(l=s+1);var s=[],u=m.colors,e=u.length,b=0;for(n=0;n<l;n++)a=d.color.parse(u[n%e]||"#666"),0==n%e&&n&&(b=0<=b?0.5>b?-b-0.2:0:-b),s[n]=a.scale("rgb",1+b);for(n=l=0;n<F.length;++n){a=F[n];null==a.color?(a.color=s[l].toString(),++l):"number"==typeof a.color&&(a.color=s[a.color].toString());if(null==a.lines.show){var c,
u=!0;for(c in a)if(a[c]&&a[c].show){u=!1;break}u&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=z(O,h(a,"x"));a.yaxis=z(W,h(a,"y"))}y()}function h(n,a){var l=n[a+"axis"];"object"==typeof l&&(l=l.n);"number"!=typeof l&&(l=1);return l}function q(){return d.grep(O.concat(W),function(n){return n})}function r(n){var a={},l,d;for(l=0;l<O.length;++l)(d=O[l])&&d.used&&(a["x"+d.n]=d.c2p(n.left));for(l=0;l<W.length;++l)(d=W[l])&&d.used&&(a["y"+d.n]=d.c2p(n.top));void 0!==a.x1&&
(a.x=a.x1);void 0!==a.y1&&(a.y=a.y1);return a}function z(n,a){n[a-1]||(n[a-1]={n:a,direction:n==O?"x":"y",options:d.extend(!0,{},n==O?m.xaxis:m.yaxis)});return n[a-1]}function y(){function n(n,a,l){a<n.datamin&&a!=-e&&(n.datamin=a);l>n.datamax&&l!=e&&(n.datamax=l)}var a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,e=Number.MAX_VALUE,u,b,G,c,v,m,I,k,p,g,h,M;d.each(q(),function(n,d){d.datamin=a;d.datamax=l;d.used=!1});for(u=0;u<F.length;++u)v=F[u],v.datapoints={points:[]},f(U.processRawData,
[v,v.data,v.datapoints]);for(u=0;u<F.length;++u){v=F[u];h=v.data;M=v.datapoints.format;if(!M){M=[];M.push({x:!0,number:!0,required:!0});M.push({y:!0,number:!0,required:!0});if(v.bars.show||v.lines.show&&v.lines.fill)M.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(v.bars.show&&v.bars.zero||v.lines.show&&v.lines.zero)}),v.bars.horizontal&&(delete M[M.length-1].y,M[M.length-1].x=!0);v.datapoints.format=M}if(null==v.datapoints.pointsize){v.datapoints.pointsize=M.length;I=v.datapoints.pointsize;
m=v.datapoints.points;var aa=v.lines.show&&v.lines.steps;v.xaxis.used=v.yaxis.used=!0;for(b=G=0;b<h.length;++b,G+=I){g=h[b];var ma=null==g;if(!ma)for(c=0;c<I;++c){k=g[c];if(p=M[c])p.number&&null!=k&&(k=+k,isNaN(k)?k=null:Infinity==k?k=e:-Infinity==k&&(k=-e)),null==k&&(p.required&&(ma=!0),null!=p.defaultValue&&(k=p.defaultValue));m[G+c]=k}if(ma)for(c=0;c<I;++c)k=m[G+c],null!=k&&(p=M[c],p.autoscale&&(p.x&&n(v.xaxis,k,k),p.y&&n(v.yaxis,k,k))),m[G+c]=null;else if(aa&&0<G&&null!=m[G-I]&&m[G-I]!=m[G]&&
m[G-I+1]!=m[G+1]){for(c=0;c<I;++c)m[G+I+c]=m[G+c];m[G+1]=m[G-I+1];G+=I}}}}for(u=0;u<F.length;++u)v=F[u],f(U.processDatapoints,[v,v.datapoints]);for(u=0;u<F.length;++u){v=F[u];m=v.datapoints.points;I=v.datapoints.pointsize;M=v.datapoints.format;g=G=a;aa=h=l;for(b=0;b<m.length;b+=I)if(null!=m[b])for(c=0;c<I;++c)k=m[b+c],(p=M[c])&&(!1!==p.autoscale&&k!=e&&k!=-e)&&(p.x&&(k<G&&(G=k),k>h&&(h=k)),p.y&&(k<g&&(g=k),k>aa&&(aa=k)));if(v.bars.show){switch(v.bars.align){case "left":b=0;break;case "right":b=-v.bars.barWidth;
break;case "center":b=-v.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+v.bars.align);}v.bars.horizontal?(g+=b,aa+=b+v.bars.barWidth):(G+=b,h+=b+v.bars.barWidth)}n(v.xaxis,G,h);n(v.yaxis,g,aa)}d.each(q(),function(n,d){d.datamin==a&&(d.datamin=null);d.datamax==l&&(d.datamax=null)})}function D(n){function a(n){return n}var l,d,b=n.options.transform||a,e=n.options.inverseTransform;"x"==n.direction?(l=n.scale=X/Math.abs(b(n.max)-b(n.min)),d=Math.min(b(n.max),b(n.min))):(l=n.scale=
V/Math.abs(b(n.max)-b(n.min)),l=-l,d=Math.max(b(n.max),b(n.min)));n.p2c=b==a?function(n){return(n-d)*l}:function(n){return(b(n)-d)*l};n.c2p=e?function(n){return e(d+n/l)}:function(n){return d+n/l}}function A(n){var a=n.labelWidth,l=n.labelHeight,b=n.options.position,e=n.options.tickLength,c=m.grid.axisMargin,G=m.grid.labelMargin,k="x"==n.direction?O:W,v,p=d.grep(k,function(n){return n&&n.options.position==b&&n.reserveSpace});d.inArray(n,p)==p.length-1&&(c=0);null==e&&(e=d.grep(k,function(n){return n&&
n.reserveSpace}),e=(v=0==d.inArray(n,e))?"full":5);isNaN(+e)||(G+=+e);"x"==n.direction?(l+=G,"bottom"==b?(t.bottom+=l+c,n.box={top:K.height-t.bottom,height:l}):(n.box={top:t.top+c,height:l},t.top+=l+c)):(a+=G,"left"==b?(n.box={left:t.left+c,width:a},t.left+=a+c):(t.right+=a+c,n.box={left:K.width-t.right,width:a}));n.position=b;n.tickLength=e;n.box.padding=G;n.innermost=v}function J(){var n=m.grid.minBorderMargin,a={x:0,y:0},l;if(null==n)for(l=n=0;l<F.length;++l)n=Math.max(n,2*(F[l].points.radius+
F[l].points.lineWidth/2));a.x=a.y=Math.ceil(n);d.each(q(),function(n,l){var d=l.direction;l.reserveSpace&&(a[d]=Math.ceil(Math.max(a[d],("x"==d?l.labelWidth:l.labelHeight)/2)))});t.left=Math.max(a.x,t.left);t.right=Math.max(a.x,t.right);t.top=Math.max(a.y,t.top);t.bottom=Math.max(a.y,t.bottom)}function w(){var n,a=q(),l=m.grid.show;for(n in t){var b=m.grid.margin||0;t[n]="number"==typeof b?b:b[n]||0}f(U.processOffset,[t]);for(n in t)t[n]="object"==typeof m.grid.borderWidth?t[n]+(l?m.grid.borderWidth[n]:
0):t[n]+(l?m.grid.borderWidth:0);d.each(a,function(n,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var l=a.options,d=+(null!=l.min?l.min:a.datamin),b=+(null!=l.max?l.max:a.datamax),e=b-d;if(0==e){if(e=0==b?1:0.01,null==l.min&&(d-=e),null==l.max||null!=l.min)b+=e}else{var s=l.autoscaleMargin;null!=s&&(null==l.min&&(d-=e*s,0>d&&(null!=a.datamin&&0<=a.datamin)&&(d=0)),null==l.max&&(b+=e*s,0<b&&(null!=a.datamax&&0>=a.datamax)&&(b=0)))}a.min=d;a.max=
b});if(l){b=d.grep(a,function(n){return n.reserveSpace});d.each(b,function(n,a){P(a);var l=a.options.ticks,b=[];null==l||"number"==typeof l&&0<l?b=a.tickGenerator(a):l&&(b=d.isFunction(l)?l(a):l);var e;a.ticks=[];for(l=0;l<b.length;++l){var s=null,c=b[l];"object"==typeof c?(e=+c[0],1<c.length&&(s=c[1])):e=+c;null==s&&(s=a.tickFormatter(e,a));isNaN(e)||a.ticks.push({v:e,label:s})}b=a.ticks;a.options.autoscaleMargin&&0<b.length&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&
1<b.length&&(a.max=Math.max(a.max,b[b.length-1].v)));b=a.options;l=a.ticks||[];e=b.labelWidth||0;s=b.labelHeight||0;c=e||"x"==a.direction?Math.floor(K.width/(l.length||1)):null;legacyStyles=a.direction+"Axis "+a.direction+a.n+"Axis";layer="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+legacyStyles;font=b.font||"flot-tick-label tickLabel";for(var m=0;m<l.length;++m){var k=l[m];k.label&&(k=K.getTextInfo(layer,k.label,font,null,c),e=Math.max(e,k.width),s=Math.max(s,k.height))}a.labelWidth=
b.labelWidth||e;a.labelHeight=b.labelHeight||s});for(n=b.length-1;0<=n;--n)A(b[n]);J();d.each(b,function(n,a){"x"==a.direction?(a.box.left=t.left-a.labelWidth/2,a.box.width=K.width-t.left-t.right+a.labelWidth):(a.box.top=t.top-a.labelHeight/2,a.box.height=K.height-t.bottom-t.top+a.labelHeight)})}X=K.width-t.left-t.right;V=K.height-t.bottom-t.top;d.each(a,function(n,a){D(a)});l&&N();B()}function P(n){var a=n.options,l;l="number"==typeof a.ticks&&0<a.ticks?a.ticks:0.3*Math.sqrt("x"==n.direction?K.width:
K.height);l=(n.max-n.min)/l;var b=-Math.floor(Math.log(l)/Math.LN10),e=a.tickDecimals;null!=e&&b>e&&(b=e);var c=Math.pow(10,-b),k=l/c,m;1.5>k?m=1:3>k?(m=2,2.25<k&&(null==e||b+1<=e)&&(m=2.5,++b)):m=7.5>k?5:10;m*=c;null!=a.minTickSize&&m<a.minTickSize&&(m=a.minTickSize);n.delta=l;n.tickDecimals=Math.max(0,null!=e?e:b);n.tickSize=a.tickSize||m;if("time"==a.mode&&!n.tickGenerator)throw Error("Time mode requires the flot.time plugin.");n.tickGenerator||(n.tickGenerator=function(a){var n=[],l=a.tickSize*
Math.floor(a.min/a.tickSize),d=0,b=Number.NaN,e;do e=b,b=l+d*a.tickSize,n.push(b),++d;while(b<a.max&&b!=e);return n},n.tickFormatter=function(a,n){var l=n.tickDecimals?Math.pow(10,n.tickDecimals):1,d=""+Math.round(a*l)/l;if(null!=n.tickDecimals){var b=d.indexOf("."),b=-1==b?0:d.length-b-1;if(b<n.tickDecimals)return(b?d:d+".")+(""+l).substr(1,n.tickDecimals-b)}return d});d.isFunction(a.tickFormatter)&&(n.tickFormatter=function(n,l){return""+a.tickFormatter(n,l)});if(null!=a.alignTicksWithAxis){var v=
("x"==n.direction?O:W)[a.alignTicksWithAxis-1];v&&(v.used&&v!=n)&&(l=n.tickGenerator(n),0<l.length&&(null==a.min&&(n.min=Math.min(n.min,l[0])),null==a.max&&1<l.length&&(n.max=Math.max(n.max,l[l.length-1]))),n.tickGenerator=function(a){var n=[],l,d;for(d=0;d<v.ticks.length;++d)l=(v.ticks[d].v-v.min)/(v.max-v.min),l=a.min+l*(a.max-a.min),n.push(l);return n},n.mode||null!=a.tickDecimals||(l=Math.max(0,-Math.floor(Math.log(n.delta)/Math.LN10)+1),b=n.tickGenerator(n),1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(l))||
(n.tickDecimals=l)))}}function C(){K.clear();f(U.drawBackground,[p]);var a=m.grid;a.show&&a.backgroundColor&&(p.save(),p.translate(t.left,t.top),p.fillStyle=pa(m.grid.backgroundColor,V,0,"rgba(255, 255, 255, 0)"),p.fillRect(0,0,X,V),p.restore());a.show&&!a.aboveData&&L();for(var d=0;d<F.length;++d){f(U.drawSeries,[p,F[d]]);var l=F[d];l.lines.show&&Q(l);l.bars.show&&ga(l);l.points.show&&R(l)}f(U.draw,[p]);a.show&&a.aboveData&&L();K.render();ca()}function x(a,d){for(var l,b,e,c,m=q(),k=0;k<m.length;++k)if(l=
m[k],l.direction==d&&(c=d+l.n+"axis",a[c]||1!=l.n||(c=d+"axis"),a[c])){b=a[c].from;e=a[c].to;break}a[c]||(l="x"==d?O[0]:W[0],b=a[d+"1"],e=a[d+"2"]);null!=b&&(null!=e&&b>e)&&(c=b,b=e,e=c);return{from:b,to:e,axis:l}}function L(){var a,b,l;p.save();p.translate(t.left,t.top);if(l=m.grid.markings)for(d.isFunction(l)&&(b=H.getAxes(),b.xmin=b.xaxis.min,b.xmax=b.xaxis.max,b.ymin=b.yaxis.min,b.ymax=b.yaxis.max,l=l(b)),a=0;a<l.length;++a){b=l[a];var e=x(b,"x"),c=x(b,"y");null==e.from&&(e.from=e.axis.min);null==
e.to&&(e.to=e.axis.max);null==c.from&&(c.from=c.axis.min);null==c.to&&(c.to=c.axis.max);e.to<e.axis.min||(e.from>e.axis.max||c.to<c.axis.min||c.from>c.axis.max)||(e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),c.from=Math.max(c.from,c.axis.min),c.to=Math.min(c.to,c.axis.max),e.from==e.to&&c.from==c.to)||(e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),c.from=c.axis.p2c(c.from),c.to=c.axis.p2c(c.to),e.from==e.to||c.from==c.to?(p.beginPath(),p.strokeStyle=b.color||m.grid.markingsColor,
p.lineWidth=b.lineWidth||m.grid.markingsLineWidth,p.moveTo(e.from,c.from),p.lineTo(e.to,c.to),p.stroke()):(p.fillStyle=b.color||m.grid.markingsColor,p.fillRect(e.from,c.to,e.to-e.from,c.from-c.to)))}b=q();l=m.grid.borderWidth;for(e=0;e<b.length;++e){c=b[e];a=c.box;var k=c.tickLength,f,g,v,h;if(c.show&&0!=c.ticks.length){p.lineWidth=1;"x"==c.direction?(f=0,g="full"==k?"top"==c.position?0:V:a.top-t.top+("top"==c.position?a.height:0)):(g=0,f="full"==k?"left"==c.position?0:X:a.left-t.left+("left"==c.position?
a.width:0));c.innermost||(p.strokeStyle=c.options.color,p.beginPath(),v=h=0,"x"==c.direction?v=X+1:h=V+1,1==p.lineWidth&&("x"==c.direction?g=Math.floor(g)+0.5:f=Math.floor(f)+0.5),p.moveTo(f,g),p.lineTo(f+v,g+h),p.stroke());p.strokeStyle=c.options.tickColor;p.beginPath();for(a=0;a<c.ticks.length;++a){var I=c.ticks[a].v;v=h=0;isNaN(I)||(I<c.min||I>c.max||"full"==k&&("object"==typeof l&&0<l[c.position]||0<l)&&(I==c.min||I==c.max))||("x"==c.direction?(f=c.p2c(I),h="full"==k?-V:k,"top"==c.position&&(h=
-h)):(g=c.p2c(I),v="full"==k?-X:k,"left"==c.position&&(v=-v)),1==p.lineWidth&&("x"==c.direction?f=Math.floor(f)+0.5:g=Math.floor(g)+0.5),p.moveTo(f,g),p.lineTo(f+v,g+h))}p.stroke()}}l&&(a=m.grid.borderColor,"object"==typeof l||"object"==typeof a?("object"!==typeof l&&(l={top:l,right:l,bottom:l,left:l}),"object"!==typeof a&&(a={top:a,right:a,bottom:a,left:a}),0<l.top&&(p.strokeStyle=a.top,p.lineWidth=l.top,p.beginPath(),p.moveTo(0-l.left,0-l.top/2),p.lineTo(X,0-l.top/2),p.stroke()),0<l.right&&(p.strokeStyle=
a.right,p.lineWidth=l.right,p.beginPath(),p.moveTo(X+l.right/2,0-l.top),p.lineTo(X+l.right/2,V),p.stroke()),0<l.bottom&&(p.strokeStyle=a.bottom,p.lineWidth=l.bottom,p.beginPath(),p.moveTo(X+l.right,V+l.bottom/2),p.lineTo(0,V+l.bottom/2),p.stroke()),0<l.left&&(p.strokeStyle=a.left,p.lineWidth=l.left,p.beginPath(),p.moveTo(0-l.left/2,V+l.bottom),p.lineTo(0-l.left/2,0),p.stroke())):(p.lineWidth=l,p.strokeStyle=m.grid.borderColor,p.strokeRect(-l/2,-l/2,X+l,V+l)));p.restore()}function N(){d.each(q(),function(a,
b){if(b.show&&0!=b.ticks.length){var l=b.box,d="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+(b.direction+"Axis "+b.direction+b.n+"Axis"),e=b.options.font||"flot-tick-label tickLabel",c,k,m,v,f;K.removeText(d);for(var p=0;p<b.ticks.length;++p)c=b.ticks[p],!c.label||(c.v<b.min||c.v>b.max)||("x"==b.direction?(v="center",k=t.left+b.p2c(c.v),"bottom"==b.position?m=l.top+l.padding:(m=l.top+l.height-l.padding,f="bottom")):(f="middle",m=t.top+b.p2c(c.v),"left"==b.position?(k=l.left+l.width-
l.padding,v="right"):k=l.left+l.padding),K.addText(d,k,m,c.label,e,null,null,v,f))}})}function Q(a){function b(a,n,l,d,e){var c=a.points;a=a.pointsize;var k=null,m=null;p.beginPath();for(var s=a;s<c.length;s+=a){var f=c[s-a],g=c[s-a+1],h=c[s],u=c[s+1];if(null!=f&&null!=h){if(g<=u&&g<e.min){if(u<e.min)continue;f=(e.min-g)/(u-g)*(h-f)+f;g=e.min}else if(u<=g&&u<e.min){if(g<e.min)continue;h=(e.min-g)/(u-g)*(h-f)+f;u=e.min}if(g>=u&&g>e.max){if(u>e.max)continue;f=(e.max-g)/(u-g)*(h-f)+f;g=e.max}else if(u>=
g&&u>e.max){if(g>e.max)continue;h=(e.max-g)/(u-g)*(h-f)+f;u=e.max}if(f<=h&&f<d.min){if(h<d.min)continue;g=(d.min-f)/(h-f)*(u-g)+g;f=d.min}else if(h<=f&&h<d.min){if(f<d.min)continue;u=(d.min-f)/(h-f)*(u-g)+g;h=d.min}if(f>=h&&f>d.max){if(h>d.max)continue;g=(d.max-f)/(h-f)*(u-g)+g;f=d.max}else if(h>=f&&h>d.max){if(f>d.max)continue;u=(d.max-f)/(h-f)*(u-g)+g;h=d.max}f==k&&g==m||p.moveTo(d.p2c(f)+n,e.p2c(g)+l);k=h;m=u;p.lineTo(d.p2c(h)+n,e.p2c(u)+l)}}p.stroke()}function l(a,n,b){var d=a.points;a=a.pointsize;
for(var l=Math.min(Math.max(0,b.min),b.max),e=0,c=!1,k=1,m=0,f=0;!(0<a&&e>d.length+a);){var e=e+a,s=d[e-a],g=d[e-a+k],h=d[e],u=d[e+k];if(c){if(0<a&&null!=s&&null==h){f=e;a=-a;k=2;continue}if(0>a&&e==m+a){p.fill();c=!1;a=-a;k=1;e=m=f+a;continue}}if(null!=s&&null!=h){if(s<=h&&s<n.min){if(h<n.min)continue;g=(n.min-s)/(h-s)*(u-g)+g;s=n.min}else if(h<=s&&h<n.min){if(s<n.min)continue;u=(n.min-s)/(h-s)*(u-g)+g;h=n.min}if(s>=h&&s>n.max){if(h>n.max)continue;g=(n.max-s)/(h-s)*(u-g)+g;s=n.max}else if(h>=s&&
h>n.max){if(s>n.max)continue;u=(n.max-s)/(h-s)*(u-g)+g;h=n.max}c||(p.beginPath(),p.moveTo(n.p2c(s),b.p2c(l)),c=!0);if(g>=b.max&&u>=b.max)p.lineTo(n.p2c(s),b.p2c(b.max)),p.lineTo(n.p2c(h),b.p2c(b.max));else if(g<=b.min&&u<=b.min)p.lineTo(n.p2c(s),b.p2c(b.min)),p.lineTo(n.p2c(h),b.p2c(b.min));else{var q=s,oa=h;g<=u&&g<b.min&&u>=b.min?(s=(b.min-g)/(u-g)*(h-s)+s,g=b.min):u<=g&&(u<b.min&&g>=b.min)&&(h=(b.min-g)/(u-g)*(h-s)+s,u=b.min);g>=u&&g>b.max&&u<=b.max?(s=(b.max-g)/(u-g)*(h-s)+s,g=b.max):u>=g&&(u>
b.max&&g<=b.max)&&(h=(b.max-g)/(u-g)*(h-s)+s,u=b.max);s!=q&&p.lineTo(n.p2c(q),b.p2c(g));p.lineTo(n.p2c(s),b.p2c(g));p.lineTo(n.p2c(h),b.p2c(u));h!=oa&&(p.lineTo(n.p2c(h),b.p2c(u)),p.lineTo(n.p2c(oa),b.p2c(u)))}}}}p.save();p.translate(t.left,t.top);p.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(0<d&&0<e){p.lineWidth=e;p.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;b(a.datapoints,Math.sin(c)*(d/2+e/2),Math.cos(c)*(d/2+e/2),a.xaxis,a.yaxis);p.lineWidth=e/2;b(a.datapoints,Math.sin(c)*
(d/2+e/4),Math.cos(c)*(d/2+e/4),a.xaxis,a.yaxis)}p.lineWidth=d;p.strokeStyle=a.color;if(e=S(a.lines,a.color,0,V))p.fillStyle=e,l(a.datapoints,a.xaxis,a.yaxis);0<d&&b(a.datapoints,0,0,a.xaxis,a.yaxis);p.restore()}function R(a){function b(a,n,d,e,l,c,s,g){var k=a.points;a=a.pointsize;for(var m=0;m<k.length;m+=a){var f=k[m],h=k[m+1];null==f||(f<c.min||f>c.max||h<s.min||h>s.max)||(p.beginPath(),f=c.p2c(f),h=s.p2c(h)+e,"circle"==g?p.arc(f,h,n,0,l?Math.PI:2*Math.PI,!1):g(p,f,h,n,l),p.closePath(),d&&(p.fillStyle=
d,p.fill()),p.stroke())}}p.save();p.translate(t.left,t.top);var d=a.points.lineWidth,e=a.shadowSize,c=a.points.radius,g=a.points.symbol;0==d&&(d=1E-4);0<d&&0<e&&(e/=2,p.lineWidth=e,p.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,c,null,e+e/2,!0,a.xaxis,a.yaxis,g),p.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,c,null,e/2,!0,a.xaxis,a.yaxis,g));p.lineWidth=d;p.strokeStyle=a.color;b(a.datapoints,c,S(a.points,a.color),0,!1,a.xaxis,a.yaxis,g);p.restore()}function ea(a,b,d,e,c,g,k,m,f,h,p,q){var C,r,x,t;
p?(t=r=x=!0,C=!1,p=d,d=b+e,c=b+c,a<p&&(b=a,a=p,p=b,C=!0,r=!1)):(C=r=x=!0,t=!1,p=a+e,a+=c,c=d,d=b,d<c&&(b=d,d=c,c=b,t=!0,x=!1));a<m.min||(p>m.max||d<f.min||c>f.max)||(p<m.min&&(p=m.min,C=!1),a>m.max&&(a=m.max,r=!1),c<f.min&&(c=f.min,t=!1),d>f.max&&(d=f.max,x=!1),p=m.p2c(p),c=f.p2c(c),a=m.p2c(a),d=f.p2c(d),k&&(h.beginPath(),h.moveTo(p,c),h.lineTo(p,d),h.lineTo(a,d),h.lineTo(a,c),h.fillStyle=k(c,d),h.fill()),0<q&&(C||r||x||t)&&(h.beginPath(),h.moveTo(p,c+g),C?h.lineTo(p,d+g):h.moveTo(p,d+g),x?h.lineTo(a,
d+g):h.moveTo(a,d+g),r?h.lineTo(a,c+g):h.moveTo(a,c+g),t?h.lineTo(p,c+g):h.moveTo(p,c+g),h.stroke()))}function ga(a){p.save();p.translate(t.left,t.top);p.lineWidth=a.bars.lineWidth;p.strokeStyle=a.color;var b;switch(a.bars.align){case "left":b=0;break;case "right":b=-a.bars.barWidth;break;case "center":b=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(b,d,e,c,g,m,h){var k=b.points;b=b.pointsize;for(var f=0;f<k.length;f+=b)null!=k[f]&&ea(k[f],k[f+1],
k[f+2],d,e,c,g,m,h,p,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?function(b,d){return S(a.bars,a.color,b,d)}:null,a.xaxis,a.yaxis);p.restore()}function S(a,b,e,c){var g=a.fill;if(!g)return null;if(a.fillColor)return pa(a.fillColor,e,c,b);a=d.color.parse(b);a.a="number"==typeof g?g:0.4;a.normalize();return a.toString()}function B(){a.find(".legend").remove();if(m.legend.show){for(var b=[],c=[],l=!1,g=m.legend.labelFormatter,k,h,f=0;f<F.length;++f)k=F[f],k.label&&
(h=g?g(k.label,k):k.label)&&c.push({label:h,color:k.color});if(m.legend.sorted)if(d.isFunction(m.legend.sorted))c.sort(m.legend.sorted);else if("reverse"==m.legend.sorted)c.reverse();else{var p="descending"!=m.legend.sorted;c.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=p?1:-1})}for(f=0;f<c.length;++f)g=c[f],0==f%m.legend.noColumns&&(l&&b.push("</tr>"),b.push("<tr>"),l=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+m.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+
g.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+g.label+"</td>");l&&b.push("</tr>");0!=b.length&&(c='<table style="font-size:smaller;color:'+m.grid.color+'">'+b.join("")+"</table>",null!=m.legend.container?d(m.legend.container).html(c):(b="",l=m.legend.position,f=m.legend.margin,null==f[0]&&(f=[f,f]),"n"==l.charAt(0)?b+="top:"+(f[1]+t.top)+"px;":"s"==l.charAt(0)&&(b+="bottom:"+(f[1]+t.bottom)+"px;"),"e"==l.charAt(1)?b+="right:"+(f[0]+t.right)+"px;":"w"==l.charAt(1)&&(b+="left:"+
(f[0]+t.left)+"px;"),c=d('<div class="legend">'+c.replace('style="','style="position:absolute;'+b+";")+"</div>").appendTo(a),0!=m.legend.backgroundOpacity&&(l=m.legend.backgroundColor,null==l&&(l=(l=m.grid.backgroundColor)&&"string"==typeof l?d.color.parse(l):d.color.extract(c,"background-color"),l.a=1,l=l.toString()),f=c.children(),d('<div style="position:absolute;width:'+f.width()+"px;height:"+f.height()+"px;"+b+"background-color:"+l+';"> </div>').prependTo(c).css("opacity",m.legend.backgroundOpacity))))}}
function qa(a){m.grid.hoverable&&Y("plothover",a,function(a){return!1!=a.hoverable})}function ra(a){m.grid.hoverable&&Y("plothover",a,function(a){return!1})}function da(a){Y("plotclick",a,function(a){return!1!=a.clickable})}function Y(b,d,c){var f=Z.offset(),g=d.pageX-f.left-t.left,k=d.pageY-f.top-t.top,h=r({left:g,top:k});h.pageX=d.pageX;h.pageY=d.pageY;d=m.grid.mouseActiveRadius;var p=d*d+1,q=null,C,x,y;for(C=F.length-1;0<=C;--C)if(c(F[C])){var R=F[C],z=R.xaxis,w=R.yaxis,B=R.datapoints.points,L=
z.c2p(g),D=w.c2p(k),ga=d/z.scale,ea=d/w.scale;y=R.datapoints.pointsize;z.options.inverseTransform&&(ga=Number.MAX_VALUE);w.options.inverseTransform&&(ea=Number.MAX_VALUE);if(R.lines.show||R.points.show)for(x=0;x<B.length;x+=y){var Q=B[x],N=B[x+1];null==Q||(Q-L>ga||Q-L<-ga||N-D>ea||N-D<-ea)||(Q=Math.abs(z.p2c(Q)-g),N=Math.abs(w.p2c(N)-k),N=Q*Q+N*N,N<p&&(p=N,q=[C,x/y]))}if(R.bars.show&&!q)for(z="left"==R.bars.align?0:-R.bars.barWidth/2,R=z+R.bars.barWidth,x=0;x<B.length;x+=y)Q=B[x],N=B[x+1],w=B[x+2],
null!=Q&&(F[C].bars.horizontal?L<=Math.max(w,Q)&&L>=Math.min(w,Q)&&D>=N+z&&D<=N+R:L>=Q+z&&L<=Q+R&&D>=Math.min(w,N)&&D<=Math.max(w,N))&&(q=[C,x/y])}q?(C=q[0],x=q[1],y=F[C].datapoints.pointsize,c={datapoint:F[C].datapoints.points.slice(x*y,(x+1)*y),dataIndex:x,series:F[C],seriesIndex:C}):c=null;c&&(c.pageX=parseInt(c.series.xaxis.p2c(c.datapoint[0])+f.left+t.left,10),c.pageY=parseInt(c.series.yaxis.p2c(c.datapoint[1])+f.top+t.top,10));if(m.grid.autoHighlight){for(f=0;f<$.length;++f)g=$[f],g.auto!=b||
c&&g.series==c.series&&g.point[0]==c.datapoint[0]&&g.point[1]==c.datapoint[1]||ia(g.series,g.point);c&&ja(c.series,c.datapoint,b)}a.trigger(b,[h,c])}function ca(){var a=m.interaction.redrawOverlayInterval;-1==a?ka():ha||(ha=setTimeout(ka,a))}function ka(){ha=null;T.save();fa.clear();T.translate(t.left,t.top);var a,b;for(a=0;a<$.length;++a)if(b=$[a],b.series.bars.show)na(b.series,b.point);else{var c=b.series,e=b.point;b=e[0];var e=e[1],g=c.xaxis,k=c.yaxis,h="string"===typeof c.highlightColor?c.highlightColor:
d.color.parse(c.color).scale("a",0.5).toString();if(!(b<g.min||b>g.max||e<k.min||e>k.max)){var m=c.points.radius+c.points.lineWidth/2;T.lineWidth=m;T.strokeStyle=h;h=1.5*m;b=g.p2c(b);e=k.p2c(e);T.beginPath();"circle"==c.points.symbol?T.arc(b,e,h,0,2*Math.PI,!1):c.points.symbol(T,b,e,h,!1);T.closePath();T.stroke()}}T.restore();f(U.drawOverlay,[T])}function ja(a,b,d){"number"==typeof a&&(a=F[a]);if("number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}c=la(a,b);-1==
c?($.push({series:a,point:b,auto:d}),ca()):d||($[c].auto=!1)}function ia(a,b){if(null==a&&null==b)$=[],ca();else{"number"==typeof a&&(a=F[a]);if("number"==typeof b){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}d=la(a,b);-1!=d&&($.splice(d,1),ca())}}function la(a,b){for(var d=0;d<$.length;++d){var c=$[d];if(c.series==a&&c.point[0]==b[0]&&c.point[1]==b[1])return d}return-1}function na(a,b){var c="string"===typeof a.highlightColor?a.highlightColor:d.color.parse(a.color).scale("a",
0.5).toString(),e="left"==a.bars.align?0:-a.bars.barWidth/2;T.lineWidth=a.bars.lineWidth;T.strokeStyle=c;ea(b[0],b[1],b[2]||0,e,e+a.bars.barWidth,0,function(){return c},a.xaxis,a.yaxis,T,a.bars.horizontal,a.bars.lineWidth)}function pa(a,b,c,e){if("string"==typeof a)return a;b=p.createLinearGradient(0,c,0,b);c=0;for(var g=a.colors.length;c<g;++c){var f=a.colors[c];if("string"!=typeof f){var k=d.color.parse(e);null!=f.brightness&&(k=k.scale("rgb",f.brightness));null!=f.opacity&&(k.a*=f.opacity);f=k.toString()}b.addColorStop(c/
(g-1),f)}return b}var F=[],m={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,
alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,
margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},K=null,fa=null,Z=null,p=null,T=null,O=[],W=[],t={left:0,right:0,top:0,bottom:0},X=0,V=0,U={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},H=this;
H.setData=g;H.setupGrid=w;H.draw=C;H.getPlaceholder=function(){return a};H.getCanvas=function(){return K.element};H.getPlotOffset=function(){return t};H.width=function(){return X};H.height=function(){return V};H.offset=function(){var a=Z.offset();a.left+=t.left;a.top+=t.top;return a};H.getData=function(){return F};H.getAxes=function(){var a={};d.each(O.concat(W),function(b,d){d&&(a[d.direction+(1!=d.n?d.n:"")+"axis"]=d)});return a};H.getXAxes=function(){return O};H.getYAxes=function(){return W};H.c2p=
r;H.p2c=function(a){var b={},d,c,e;for(d=0;d<O.length;++d)if((c=O[d])&&c.used&&(e="x"+c.n,null==a[e]&&1==c.n&&(e="x"),null!=a[e])){b.left=c.p2c(a[e]);break}for(d=0;d<W.length;++d)if((c=W[d])&&c.used&&(e="y"+c.n,null==a[e]&&1==c.n&&(e="y"),null!=a[e])){b.top=c.p2c(a[e]);break}return b};H.getOptions=function(){return m};H.highlight=ja;H.unhighlight=ia;H.triggerRedrawOverlay=ca;H.pointOffset=function(a){return{left:parseInt(O[h(a,"x")-1].p2c(+a.x)+t.left,10),top:parseInt(W[h(a,"y")-1].p2c(+a.y)+t.top,
10)}};H.shutdown=function(){ha&&clearTimeout(ha);Z.unbind("mousemove",qa);Z.unbind("mouseleave",ra);Z.unbind("click",da);f(U.shutdown,[Z])};H.resize=function(){var b=a.width(),d=a.height();K.resize(b,d);fa.resize(b,d)};H.hooks=U;(function(){for(var a={Canvas:E},b=0;b<k.length;++b){var c=k[b];c.init(H,a);c.options&&d.extend(!0,m,c.options)}})(H);(function(b){d.extend(!0,m,b);b&&b.colors&&(m.colors=b.colors);null==m.xaxis.color&&(m.xaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());
null==m.yaxis.color&&(m.yaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());null==m.xaxis.tickColor&&(m.xaxis.tickColor=m.grid.tickColor||m.xaxis.color);null==m.yaxis.tickColor&&(m.yaxis.tickColor=m.grid.tickColor||m.yaxis.color);null==m.grid.borderColor&&(m.grid.borderColor=m.grid.color);null==m.grid.tickColor&&(m.grid.tickColor=d.color.parse(m.grid.color).scale("a",0.22).toString());var c,g,k={style:a.css("font-style"),size:Math.round(0.8*(+a.css("font-size").replace("px","")||13)),
variant:a.css("font-variant"),weight:a.css("font-weight"),family:a.css("font-family")};k.lineHeight=1.15*k.size;g=m.xaxes.length||1;for(b=0;b<g;++b)(c=m.xaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},m.xaxis,c),m.xaxes[b]=c,c.font&&(c.font=d.extend({},k,c.font),c.font.color||(c.font.color=c.color));g=m.yaxes.length||1;for(b=0;b<g;++b)(c=m.yaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},m.yaxis,c),m.yaxes[b]=c,c.font&&(c.font=d.extend({},k,c.font),c.font.color||(c.font.color=
c.color));m.xaxis.noTicks&&null==m.xaxis.ticks&&(m.xaxis.ticks=m.xaxis.noTicks);m.yaxis.noTicks&&null==m.yaxis.ticks&&(m.yaxis.ticks=m.yaxis.noTicks);m.x2axis&&(m.xaxes[1]=d.extend(!0,{},m.xaxis,m.x2axis),m.xaxes[1].position="top");m.y2axis&&(m.yaxes[1]=d.extend(!0,{},m.yaxis,m.y2axis),m.yaxes[1].position="right");m.grid.coloredAreas&&(m.grid.markings=m.grid.coloredAreas);m.grid.coloredAreasColor&&(m.grid.markingsColor=m.grid.coloredAreasColor);m.lines&&d.extend(!0,m.series.lines,m.lines);m.points&&
d.extend(!0,m.series.points,m.points);m.bars&&d.extend(!0,m.series.bars,m.bars);null!=m.shadowSize&&(m.series.shadowSize=m.shadowSize);null!=m.highlightColor&&(m.series.highlightColor=m.highlightColor);for(b=0;b<m.xaxes.length;++b)z(O,b+1).options=m.xaxes[b];for(b=0;b<m.yaxes.length;++b)z(W,b+1).options=m.yaxes[b];for(var h in U)m.hooks[h]&&m.hooks[h].length&&(U[h]=U[h].concat(m.hooks[h]));f(U.processOptions,[m])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();
"static"==a.css("position")&&a.css("position","relative");K=new E("flot-base",a);fa=new E("flot-overlay",a);p=K.context;T=fa.context;Z=d(fa.element).unbind();var b=a.data("plot");b&&(b.shutdown(),fa.clear());a.data("plot",H)})();g(c);w();C();m.grid.hoverable&&(Z.mousemove(qa),Z.bind("mouseleave",ra));m.grid.clickable&&Z.click(da);f(U.bindEvents,[Z]);var $=[],ha=null}var a=Object.prototype.hasOwnProperty;E.prototype.resize=function(a,c){if(0>=a||0>=c)throw Error("Invalid dimensions for plot, width = "+
a+", height = "+c);var b=this.element,d=this.context,f=this.pixelRatio;this.width!=a&&(b.width=a*f,b.style.width=a+"px",this.width=a);this.height!=c&&(b.height=c*f,b.style.height=c+"px",this.height=c);d.restore();d.save();d.scale(f,f)};E.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};E.prototype.render=function(){var d=this._textCache,c;for(c in d)if(a.call(d,c)){var b=this.getTextLayer(c),k=d[c];b.hide();for(var f in k)if(a.call(k,f)){var g=k[f],h;for(h in g)if(a.call(g,
h)){for(var q=g[h].positions,r=0,z;z=q[r];r++)z.active?z.rendered||(b.append(z.element),z.rendered=!0):(q.splice(r--,1),z.rendered&&z.element.detach());0==q.length&&delete g[h]}}b.show()}};E.prototype.getTextLayer=function(a){var c=this.text[a];null==c&&(null==this.textContainer&&(this.textContainer=d("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[a]=d("<div></div>").addClass(a).css({position:"absolute",
top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer));return c};E.prototype.getTextInfo=function(a,c,b,k,f){var g,h;c=""+c;k="object"===typeof b?b.style+" "+b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;g=this._textCache[a];null==g&&(g=this._textCache[a]={});h=g[k];null==h&&(h=g[k]={});g=h[c];null==g&&(a=d("<div></div>").html(c).css({position:"absolute","max-width":f,top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:k,color:b.color}):"string"===
typeof b&&a.addClass(b),g=h[c]={width:a.outerWidth(!0),height:a.outerHeight(!0),element:a,positions:[]},a.detach());return g};E.prototype.addText=function(a,c,b,d,f,g,h,q,r){a=this.getTextInfo(a,d,f,g,h);d=a.positions;"center"==q?c-=a.width/2:"right"==q&&(c-=a.width);"middle"==r?b-=a.height/2:"bottom"==r&&(b-=a.height);for(r=0;f=d[r];r++)if(f.x==c&&f.y==b){f.active=!0;return}f={active:!0,rendered:!1,element:d.length?a.element.clone():a.element,x:c,y:b};d.push(f);f.element.css({top:Math.round(b),left:Math.round(c),
"text-align":q})};E.prototype.removeText=function(d,c,b,k,f,g){if(null==k){if(c=this._textCache[d],null!=c)for(var h in c)if(a.call(c,h)){b=c[h];for(var q in b)if(a.call(b,q))for(d=b[q].positions,k=0;f=d[k];k++)f.active=!1}}else for(d=this.getTextInfo(d,k,f,g).positions,k=0;f=d[k];k++)f.x==c&&f.y==b&&(f.active=!1)};d.plot=function(a,c,b){return new A(d(a),c,b,d.plot.plugins)};d.plot.version="0.8.1";d.plot.plugins=[];d.fn.plot=function(a,c){return this.each(function(){d.plot(this,a,c)})}})(jQuery);
(function(d){var E=10,A=0.95,a={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:0.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(a,d){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+d.color+";'>"+a+"<br/>"+Math.round(d.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};d.plot.plugins.push({init:function(e){function c(b){for(var c=
0,e=0,g=0,f=a.series.pie.combine.color,k=[],h=0;h<b.length;++h){var q=b[h].data;d.isArray(q)&&1==q.length&&(q=q[0]);d.isArray(q)?!isNaN(parseFloat(q[1]))&&isFinite(q[1])?q[1]=+q[1]:q[1]=0:q=!isNaN(parseFloat(q))&&isFinite(q)?[1,+q]:[1,0];b[h].data=[q]}for(h=0;h<b.length;++h)c+=b[h].data[0][1];for(h=0;h<b.length;++h)q=b[h].data[0][1],q/c<=a.series.pie.combine.threshold&&(e+=q,g++,f||(f=b[h].color));for(h=0;h<b.length;++h)q=b[h].data[0][1],(2>g||q/c>a.series.pie.combine.threshold)&&k.push({data:[[1,
q]],color:b[h].color,label:b[h].label,angle:2*q*Math.PI/c,percent:q/(c/100)});1<g&&k.push({data:[[1,e]],color:f,label:a.series.pie.combine.label,angle:2*e*Math.PI/c,percent:e/(c/100)});return k}function b(b,c){function e(){w.clearRect(0,0,h,q);z.children().filter(".pieLabel, .pieLabelBackground").remove()}function g(){var b=a.series.pie.shadow.left,d=a.series.pie.shadow.top,c=a.series.pie.shadow.alpha,e=1<a.series.pie.radius?a.series.pie.radius:y*a.series.pie.radius;if(!(e>=h/2-b||e*a.series.pie.tilt>=
q/2-d||10>=e)){w.save();w.translate(b,d);w.globalAlpha=c;w.fillStyle="#000";w.translate(D,ba);w.scale(1,a.series.pie.tilt);for(b=1;10>=b;b++)w.beginPath(),w.arc(0,0,e,0,2*Math.PI,!1),w.fill(),e-=b;w.restore()}}function f(){function b(a,d,c){0>=a||isNaN(a)||(c?w.fillStyle=d:(w.strokeStyle=d,w.lineJoin="round"),w.beginPath(),1E-9<Math.abs(a-2*Math.PI)&&w.moveTo(0,0),w.arc(0,0,g,r,r+a/2,!1),w.arc(0,0,g,r+a/2,r+a,!1),w.closePath(),r+=a,c?w.fill():w.stroke())}function c(){for(var b=e,g=1<a.series.pie.label.radius?
a.series.pie.label.radius:y*a.series.pie.label.radius,f=0;f<S.length;++f){if(S[f].percent>=100*a.series.pie.label.threshold){var k;k=S[f];var r=b,x=f;if(0==k.data[0][1])k=!0;else{var C=a.legend.labelFormatter,m=void 0,w=a.series.pie.label.formatter,m=C?C(k.label,k):k.label;w&&(m=w(m,k));C=(r+k.angle+r)/2;r=D+Math.round(Math.cos(C)*g);C=ba+Math.round(Math.sin(C)*g)*a.series.pie.tilt;z.append("<span class='pieLabel' id='pieLabel"+x+"' style='position:absolute;top:"+C+"px;left:"+r+"px;'>"+m+"</span>");
x=z.children("#pieLabel"+x);m=C-x.height()/2;C=r-x.width()/2;x.css("top",m);x.css("left",C);0<0-m||0<0-C||0>q-(m+x.height())||0>h-(C+x.width())?k=!1:(0!=a.series.pie.label.background.opacity&&(r=a.series.pie.label.background.color,null==r&&(r=k.color),k="top:"+m+"px;left:"+C+"px;",d("<div class='pieLabelBackground' style='position:absolute;width:"+x.width()+"px;height:"+x.height()+"px;"+k+"background-color:"+r+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(x)),k=!0)}if(!k)return!1}b+=
S[f].angle}return!0}var e=Math.PI*a.series.pie.startAngle,g=1<a.series.pie.radius?a.series.pie.radius:y*a.series.pie.radius;w.save();w.translate(D,ba);w.scale(1,a.series.pie.tilt);w.save();for(var r=e,x=0;x<S.length;++x)S[x].startAngle=r,b(S[x].angle,S[x].color,!0);w.restore();if(0<a.series.pie.stroke.width){w.save();w.lineWidth=a.series.pie.stroke.width;r=e;for(x=0;x<S.length;++x)b(S[x].angle,a.series.pie.stroke.color,!1);w.restore()}k(w);w.restore();return a.series.pie.label.show?c():!0}if(z){var h=
b.getPlaceholder().width(),q=b.getPlaceholder().height(),r=z.children().filter(".legend").children().width()||0;w=c;J=!1;y=Math.min(h,q/a.series.pie.tilt)/2;ba=q/2+a.series.pie.offset.top;D=h/2;D="auto"==a.series.pie.offset.left?a.legend.position.match("w")?D+r/2:D-r/2:D+a.series.pie.offset.left;D<y?D=y:D>h-y&&(D=h-y);var S=b.getData(),r=0;do 0<r&&(y*=A),r+=1,e(),0.8>=a.series.pie.tilt&&g();while(!f()&&r<E);r>=E&&(e(),z.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));
b.setSeries&&b.insertLegend&&(b.setSeries(S),b.insertLegend())}}function k(b){if(0<a.series.pie.innerRadius){b.save();var d=1<a.series.pie.innerRadius?a.series.pie.innerRadius:y*a.series.pie.innerRadius;b.globalCompositeOperation="destination-out";b.beginPath();b.fillStyle=a.series.pie.stroke.color;b.arc(0,0,d,0,2*Math.PI,!1);b.fill();b.closePath();b.restore();b.save();b.beginPath();b.strokeStyle=a.series.pie.stroke.color;b.arc(0,0,d,0,2*Math.PI,!1);b.stroke();b.closePath();b.restore()}}function f(a){h("plothover",
a)}function g(a){h("plotclick",a)}function h(b,d){var c=e.offset(),g=parseInt(d.pageX-c.left);a:{for(var c=parseInt(d.pageY-c.top),f=e.getData(),h=e.getOptions(),h=1<h.series.pie.radius?h.series.pie.radius:y*h.series.pie.radius,k,r,A=0;A<f.length;++A){var B=f[A];if(B.pie.show){w.save();w.beginPath();w.moveTo(0,0);w.arc(0,0,h,B.startAngle,B.startAngle+B.angle/2,!1);w.arc(0,0,h,B.startAngle+B.angle/2,B.startAngle+B.angle,!1);w.closePath();k=g-D;r=c-ba;if(w.isPointInPath){if(w.isPointInPath(g-D,c-ba)){w.restore();
g={datapoint:[B.percent,B.data],dataIndex:0,series:B,seriesIndex:A};break a}}else{var J=h*Math.cos(B.startAngle),E=h*Math.sin(B.startAngle),da=h*Math.cos(B.startAngle+B.angle/4),Y=h*Math.sin(B.startAngle+B.angle/4),ca=h*Math.cos(B.startAngle+B.angle/2),ka=h*Math.sin(B.startAngle+B.angle/2),ja=h*Math.cos(B.startAngle+B.angle/1.5),ia=h*Math.sin(B.startAngle+B.angle/1.5),la=h*Math.cos(B.startAngle+B.angle),na=h*Math.sin(B.startAngle+B.angle),J=[[0,0],[J,E],[da,Y],[ca,ka],[ja,ia],[la,na]];k=[k,r];r=!1;
E=-1;da=J.length;for(Y=da-1;++E<da;Y=E)(J[E][1]<=k[1]&&k[1]<J[Y][1]||J[Y][1]<=k[1]&&k[1]<J[E][1])&&k[0]<(J[Y][0]-J[E][0])*(k[1]-J[E][1])/(J[Y][1]-J[E][1])+J[E][0]&&(r=!r);if(r){w.restore();g={datapoint:[B.percent,B.data],dataIndex:0,series:B,seriesIndex:A};break a}}w.restore()}}g=null}if(a.grid.autoHighlight)for(c=0;c<P.length;++c)f=P[c],f.auto!=b||g&&f.series==g.series||(f=f.series,null==f&&(P=[],e.triggerRedrawOverlay()),f=q(f),-1!=f&&(P.splice(f,1),e.triggerRedrawOverlay()));g&&(c=g.series,f=q(c),
-1==f?(P.push({series:c,auto:b}),e.triggerRedrawOverlay()):b||(P[f].auto=!1));z.trigger(b,[{pageX:d.pageX,pageY:d.pageY},g])}function q(a){for(var b=0;b<P.length;++b)if(P[b].series==a)return b;return-1}var r=null,z=null,y=null,D=null,ba=null,J=!1,w=null,P=[];e.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt?
b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});e.hooks.bindEvents.push(function(a,b){var d=a.getOptions();d.series.pie.show&&(d.grid.hoverable&&b.unbind("mousemove").mousemove(f),d.grid.clickable&&b.unbind("click").click(g))});e.hooks.processDatapoints.push(function(b,e,f,g){b.getOptions().series.pie.show&&!J&&(J=!0,r=b.getCanvas(),z=d(r).parent(),a=b.getOptions(),b.setData(c(b.getData())))});e.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var d=a.getOptions(),
c=1<d.series.pie.radius?d.series.pie.radius:y*d.series.pie.radius;b.save();b.translate(D,ba);b.scale(1,d.series.pie.tilt);for(var e=0;e<P.length;++e){var f=P[e].series;0>=f.angle||isNaN(f.angle)||(b.fillStyle="rgba(255, 255, 255, "+d.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(f.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,c,f.startAngle,f.startAngle+f.angle/2,!1),b.arc(0,0,c,f.startAngle+f.angle/2,f.startAngle+f.angle,!1),b.closePath(),b.fill())}k(b);b.restore()}});e.hooks.draw.push(function(a,
d){a.getOptions().series.pie.show&&b(a,d)})},options:a,name:"pie",version:"1.1"})})(jQuery);
(function(d,E){var A=0;d.widget("s3.pivottable",{options:{showTotals:!0,ajaxURL:null,defaultChart:{type:"breakdown",axis:"rows"},renderFilter:!0,renderOptions:!0,renderChart:!0,renderTable:!0,collapseFilter:!1,collapseOptions:!0,collapseChart:!0,collapseTable:!1,exploreChart:!1,autoSubmit:1E3},_create:function(){this.id=A;A+=1;this.chart=this.table=null},_init:function(){var a=this.element;this.table=this.data=null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};
this.table_options={hidden:!1};var e=d(a).find(".pt-chart");this.chart=e.length?e.first():null;this.options.renderFilter||this.options.renderOptions?(e=d(a).attr("id"),this.options.renderOptions?(d("#"+e+"-options").show(),this.options.collapseOptions&&(d("#"+e+"-options legend").siblings().toggle(),d("#"+e+"-options legend").children().toggle())):d("#"+e+"-options").hide(),this.options.renderFilter?(d("#"+e+"-filters").show(),this.options.collapseFilter&&(d("#"+e+"-filters legend").siblings().toggle(),
d("#"+e+"-filters legend").children().toggle())):d("#"+e+"-options").hide()):d(a).find(".pt-form-container").hide();this.options.collapseTable&&(this.table_options.hidden=!0,d(a).find(".pt-table").hide(),d(a).find(".pt-show-table").show(),d(a).find(".pt-hide-table").hide());this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var a=this.element,e=null;this._unbindEvents();var c=d(a).find('input[type="hidden"][name="pivotdata"]');c.length&&
(e=JSON.parse(d(c).first().val()));e||(e={empty:!0},d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide());this.data=e;e.nodata?(d(a).find(".pt-table").first().empty().append(d('<div class="pt-no-data">'+e.nodata+"</div>")),d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();e.empty?d(a).find(".pt-empty").show():d(a).find(".pt-empty").hide();this.options.autoSubmit?d(a).find(".pt-submit").hide():
d(a).find(".pt-submit").show();this._bindEvents();d(a).find(".pt-throbber").hide()},_renderTable:function(){var a=this.element,e=d(a).find(".pt-table").first().empty();this.table=null;var c=this.data;if(!c.empty)if(this.options.renderTable){var b=c.cells,k=c.cols,f=c.rows,g=c.total,h=c.labels,c=this._renderHeader(k,h);c.append(this._renderColumns(k,h));b=this._renderRows(f,k,h,b);k=this._renderFooter(f,k,h,g);f=d('<table class="dataTable display report"/>').append(c).append(b);null!==k&&f.append(k);
this.table=d(f);d(e).append(this.table);this.table_options.hidden?(d(a).find(".pt-show-table").show(),d(a).find(".pt-hide-table").hide()):(d(a).find(".pt-show-table").hide(),d(a).find(".pt-hide-table").show())}else d(a).find(".pt-show-table").hide(),d(a).find(".pt-hide-table").hide()},_renderHeader:function(a,e){var c=d("<tr>");colspan="__other__"==a[a.length-1][0]?a.length-1:a.length;c.append(d('<th scope="col">'+e.layer+"</th>"));(1<a.length||a[0][4])&&c.append(d('<th scope="col" colspan="'+colspan+
'">'+e.cols+"</th>"));this.options.showTotals&&c.append(d('<th class="totals_header row_totals" scope="col" rowspan="2">'+e.total+"</th>"));return d("<thead>").append(c)},_renderColumns:function(a,e){var c=d("<tr>"),b;c.append(d('<th scope="col">'+e.rows+"</th>"));for(var k=1==a.length&&null===a[0][4]?!0:!1,f=0;f<a.length;f++)"__other__"==a[f][0]||k&&this.options.showTotals||(b=k?"":a[f][4],c.append(d('<th scope="col">'+b+"</th>")));return c},_renderRows:function(a,e,c,b){for(var k=d("<tbody>"),f=
this.options.showTotals,g=1==a.length&&null===a[0][4]?!0:!1,h,q,r=0;r<b.length;r++)h=a[r],"__other__"==h[0]||g&&this.options.showTotals||(q=g?"":a[r][4],q=d('<tr class="'+(r%2?"odd":"even")+'"><td>'+q+"</td></tr>").append(this._renderCells(b[r],e,c)),f&&q.append(d("<td>"+h[2]+"</td>")),k.append(q));return k},_renderCells:function(a,e,c){for(var b,k=c.none,f=1==e.length&&null===e[0][4]?!0:!1,g=[],h,q,r=0;r<a.length;r++)if(!("__other__"==e[r][0]||f&&this.options.showTotals)){b=a[r];c=b.items;h=d("<td>");
if(null===c)q=d('<div class="pt-cell-value">'+k+"</div>");else if(d.isArray(c)){q=d('<div class="pt-cell-value">');list=d("<ul>");for(var z=0;z<c.length;z++)list.append(d("<li>"+c[z]+"</li>"));q.append(list)}else q=d('<div class="pt-cell-value">'+c+"</div>");h.append(q);b=b.keys;c&&(b&&b.length)&&h.data("records",b).append(d('<div class="pt-cell-zoom"></div>'));g.push(h)}return g},_renderFooter:function(a,e,c,b){var k=1==e.length&&null===e[0][4]?!0:!1;if(this.options.showTotals){var f,g;g=f=0;for(len=
a.length;f<len;f++)"__other__"!=a[f][0]&&g++;a=d('<tr class="'+(g%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+c.total+"</th></tr>");for(f=0;f<e.length;f++)"__other__"==e[f][0]||k||a.append(d("<td>"+e[f][2]+"</td>"));a.append(d("<td>"+b+"</td>"));return d("<tfoot>").append(a)}return null},_renderChartOptions:function(){var a=this.element,e=d(a).find(".pt-chart-controls").first().empty(),c=this.data;if(!c.empty&&this.options.renderChart){var c=c.labels,b=d(a).attr("id"),a=
c.layer,k=c.rows,f=c.cols,g=c.per,h=d('<div class="pt-chart-opts">'),q=b+"-pchart-rows",r=b+"-vchart-rows",z=b+"-hchart-rows",y=b+"-pchart-cols",D=b+"-vchart-cols",b=b+"-hchart-cols";a&&d(h).append(d('<span class="pt-chart-label">'+a+"</span>"));k&&d(h).append(d('<div id="'+q+'" class="pt-chart-icon pt-pchart"/><div id="'+r+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+g+" "+k+"</span>"));f&&d(h).append(d('<div id="'+y+'" class="pt-chart-icon pt-pchart"/><div id="'+D+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+
g+" "+f+"</span>"));k&&f&&d(h).append(d('<span class="pt-chart-label">| '+c.breakdown+'</span><div id="'+z+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,k,"&amp;",f].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,f,"&amp;",k].join(" ")+"</span>"));d(e).append(h)}},_truncateLabel:function(a,d){return a.length>d?a.substring(0,d-3).replace(/\s+$/g,"")+"...":a},_renderChart:function(a){var e=this.data;d(this.element).find(".pt-chart-contents").hide();
var c=this.chart;if(c&&(d(c).unbind("plothover").unbind("plotclick").empty(),!e.empty&&this.options.renderChart))if(!1===a)this.options.collapseChart=!0;else{c=this.options.collapseChart;if("undefined"==typeof a||!a){if(c)return;a=this.chart_options.currentChart}if("undefined"==typeof a||!a){if(c)return;a=this.options.defaultChart}if("undefined"!=typeof a&&a){this.options.collapseChart=!1;this.chart_options.currentChart=a;c=a.type;a=a.axis;var b=e.labels,k=b.per,f=b.layer+" "+k+" "+b.rows,b=b.layer+
" "+k+" "+b.cols,k=e.filter,g=k[0],h=k[1],q=k[2];"piechart"==c?"rows"==a?this._renderPieChart(e.rows,f,g,h):this._renderPieChart(e.cols,b,g,q):"barchart"==c?"rows"==a?this._renderBarChart(e.rows,f,g,h):this._renderBarChart(e.cols,b,g,q):"breakdown"==c&&("rows"==a?this._renderBreakDown(e,0,f,k):this._renderBreakDown(e,1,b,k))}}},_renderPieChart:function(a,e,c,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"800px"});d(k).css({height:"360px"});for(var f=[],g=0;g<a.length;g++){var h=
a[g];h[1]||f.push({label:h[4],data:h[2],key:h[3]})}e?d(k).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),f,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});var q=this;this.chart_options.currentDataIndex=null;d(k).bind("plothover",function(a,b,c){if(c){if(q.chart_options.currentDataIndex!=c.seriesIndex){q._removeChartTooltip();q.chart_options.currentDataIndex=c.seriesIndex;
a=c.series.data[0][1];var e=c.series.percent.toFixed(1),f='<div class="pt-tooltip-label">'+c.series.label+"</div>";q._renderChartTooltip(b.pageX,b.pageY,f+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));d(".pt-tooltip-label").css({color:c.series.color})}}else q._removeChartTooltip()});this.options.exploreChart&&c&&b&&d(k).bind("plotclick",function(a,d,e){if(e){try{var g=[[b,f[e.seriesIndex].key]]}catch(h){return}a=q._updateURL(c,g);window.open(a,"_blank")}})}},_renderBarChart:function(a,e,
c,b){var k=this.chart,f=this._truncateLabel;if(k){d(k).closest(".pt-chart-contents").show().css({width:"96%"});d(k).css({height:"360px"});for(var g=[],h=[],q=0,r=0;r<a.length;r++){var z=a[r];z[1]||(g.push({label:z[4],data:[[q+1,z[2]]],key:z[3]}),h.push([q+1,f(z[4],16)]),q++)}e?d(k).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),g,{series:{bars:{show:!0,barWidth:0.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,
clickable:!0},xaxis:{ticks:h,min:0,max:g.length+1,tickLength:0}});var y=this;this.chart_options.currentDataIndex=null;d(k).bind("plothover",function(a,b,c){c?y.chart_options.currentDataIndex!=c.seriesIndex&&(y._removeChartTooltip(),y.chart_options.currentDataIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+c.series.label+"</div>",a+='<div class="pt-tooltip-text">'+c.series.data[0][1]+"</div>",y._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({color:c.series.color})):y._removeChartTooltip()});
this.options.exploreChart&&c&&b&&d(k).bind("plotclick",function(a,d,e){if(e){try{var f=[[b,g[e.seriesIndex].key]]}catch(h){return}a=y._updateURL(c,f);window.open(a,"_blank")}})}},_renderBreakDown:function(a,e,c,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"96%"});var f=b[0],g,h,q=a.cells,r,z=[],y=[];0===e?(e=a.rows,r=a.cols,a=function(a,b){return q[z[a]][y[b]].value},g=b[1],h=b[2]):(e=a.cols,r=a.rows,a=function(a,b){return q[y[b]][z[a]].value},g=b[2],h=b[1]);var D=
[],A=[];b=0;for(len=e.length;b<len;b++)e[b][1]||(D.push(e[b]),z.push(b));b=0;for(len=r.length;b<len;b++)r[b][1]||(A.push(r[b]),y.push(b));b=Math.max(D.length*Math.max(16*(A.length+1),50)+70,360);d(k).css({height:b+"px"});b=[];for(var E=e=0;E<A.length;E++){for(var w={label:A[E][4]},P=[],C,x=0;x<D.length;x++)r=(D.length-x)*(A.length+1)-E,C=a(x,E),C>e&&(e=C),P.push([C,r]);w.data=P;b.push(w)}a=[];for(x=0;x<D.length;x++)E=D[x][4],r=(D.length-x)*(A.length+1)+1,a.push([r,E]);c?d(k).siblings(".pt-chart-title").html("<h4>"+
c+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),b,{series:{bars:{show:!0,barWidth:0.8,align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:a,labelWidth:120,max:D.length*(A.length+1)+1},xaxis:{max:1.1*e},grid:{hoverable:!0,clickable:!0}});d(".flot-y-axis .tickLabel").css({"padding-top":"20px",left:"0px",width:"120px"});var L=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;d(k).bind("plothover",function(a,
b,c){if(c){if(L.chart_options.currentDataIndex!=c.dataIndex||L.chart_options.currentSeriesIndex!=c.seriesIndex)L._removeChartTooltip(),L.chart_options.currentDataIndex=c.dataIndex,L.chart_options.currentSeriesIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+D[c.dataIndex][4]+"</div>",a+='<div class="pt-tooltip-text">'+c.series.label+' : <span class="pt-tooltip-value">'+c.datapoint[0]+"</span></div>",L._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({"padding-bottom":"8px"}),
d(".pt-tooltip-text").css({color:c.series.color}),d(".pt-tooltip-value").css({"font-weight":"bold"})}else L._removeChartTooltip()});this.options.exploreChart&&f&&(g&&h)&&d(k).bind("plotclick",function(a,b,c){if(c){try{var d=[[g,D[c.dataIndex][3]],[h,A[c.seriesIndex][3]]]}catch(e){return}a=L._updateURL(f,d);window.open(a,"_blank")}})}},_renderChartTooltip:function(a,e,c){d('<div class="pt-chart-tooltip">'+c+"</div>").css({position:"absolute",display:"none",top:e-50,left:a+10,border:"1px solid #999",
padding:"10px","min-height":"50px","max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:0.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){d(".pt-chart-tooltip").remove();this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var a="#"+d(this.element).attr("id");return{rows:d(a+"-rows").val(),cols:d(a+"-cols").val(),fact:d(a+"-fact").val(),totals:d(a+"-totals").is(":checked")?1:0}},_getFilters:function(){var a=
"#"+d(this.element).attr("id"),a=d(a+"-filters");try{return a.length?S3.search.getCurrentFilters(a.first()):null}catch(e){}},_updateURL:function(a,d){var c,b,k=[],f={};c={};var g,h,q;if(d)for(g=0,len=d.length;g<len;g++)c=d[g],q=c[0],f[q]=!0,k.push(q+"="+c[1]);c=this.options.ajaxURL.split("?");if(1<c.length){b=c[1].split("&");c={};g=0;for(len=b.length;g<len;g++)h=b[g].split("="),1<h.length&&(q=decodeURIComponent(h[0]),f[q]||(k.push(q+"="+decodeURIComponent(h[1])),c[q]=!0));for(q in c)f[q]=!0}c=a.split("?");
if(1<c.length)for(b=c[1].split("&"),g=0,len=b.length;g<len;g++)h=b[g].split("="),1<h.length&&(q=decodeURIComponent(h[0]),f[q]||k.push(q+"="+decodeURIComponent(h[1])));k=k.join("&");f=c[0];k&&(f=f+"?"+k);return f},_updateAjaxURL:function(a,e){var c=this.options.ajaxURL.split("?"),b=null,b=[],k=!1,f;1<c.length?(f=c[1],f=f.split("&")):f=[];var g,h;if(a)for(g in a)newopt=a[g],h=g+"="+newopt,"totals"==g?this.options.showTotals=newopt?!0:!1:k||-1!=d.inArray(h,f)||(k=!0),b.push(h);g={};var q={},r,z,y;if(e)for(r=
0,z=e.length;r<z;r++)h=e[r],y=h[0],h=h[1],null===h?g[y]||(q[y]=!0):(q[y]&&(q[y]=!1),g[y]?g[y].push(y+"="+h):g[y]=[y+"="+h]);r=0;for(z=f.length;r<z;r++)h=f[r].split("="),1<h.length&&(y=decodeURIComponent(h[0]),h=decodeURIComponent(h[1]),q[y]?k=!0:g[y]?k||-1!=d.inArray(y+"="+h,g[y])||(k=!0):"aggregate"!=y&&(a&&a.hasOwnProperty(y)||b.push(f[r])));for(y in g)for(r=0,z=g[y].length;r<z;r++)k||-1!=d.inArray(g[y][r],f)||(k=!0),b.push(g[y][r]);b=b.join("&");c=c[0];b&&(c=c+"?"+b);this.options.ajaxURL=c;return k},
reload:function(a,e,c){c="undefined"!=typeof c?c:!0;"undefined"==typeof e&&(e=this._getFilters());var b=this,k=this.element,f,g=d(k).find('input[type="hidden"][name="pivotdata"]');if(g.length){if(a||e)f=this._updateAjaxURL(a,e);f||c?(a=this.options.ajaxURL,d(k).find(".pt-throbber").show(),d(k).find(".pt-empty").hide(),d.ajax({url:a,dataType:"json"}).done(function(a){g.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText;console.log(msg)})):
(d(k).find(".pt-throbber").show(),b.refresh())}},_bindEvents:function(a){var e=this,c=this.element;a=this.data;var b=d(c).attr("id");d("#"+b+"-options legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d("#"+b+"-filters legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d(c).find(".pt-hide-table").click(function(){e.table_options.hidden=!0;d(c).find(".pt-table").hide();d(this).siblings(".pt-show-table").show();d(this).hide()});d(c).find(".pt-show-table").click(function(){e.table_options.hidden=
!1;d(c).find(".pt-table").show();d(this).siblings(".pt-hide-table").show();d(this).hide()});d("#"+b+"-totals").click(function(){var a=d(this).is(":checked");e.options.showTotals!=a&&e.reload({totals:a},null,!1)});d("#"+b+"-rows, #"+b+"-cols, #"+b+"-fact").on("change.autosubmit",function(){d(c).find(".pt-form").trigger("optionChanged")});if(this.options.autoSubmit){var k=this.options.autoSubmit;d(c).find(".pt-form").on("optionChanged",function(){var a=d(this);if(!a.data("noAutoSubmit")){var b=a.data("autoSubmitTimeout");
b&&clearTimeout(b);b=setTimeout(function(){var a=e._getOptions(),b=e._getFilters();e.reload(a,b,!1)},k);a.data("autoSubmitTimeout",b)}})}else d(c).find("input.pt-submit").click(function(){var a=e._getOptions(),b=e._getFilters();e.reload(a,b,!1)});d("#"+b+" div.pt-table div.pt-cell-zoom").click(function(b){b=d(b.currentTarget);var c=b.closest("td"),e=c.find(".pt-cell-records");if(0<e.length)e.remove(),b.removeClass("opened");else{for(var k=c.data("records"),e=d("<div/>").addClass("pt-cell-records"),
r=d("<ul/>"),z=0;z<k.length;z++)r.append("<li>"+a.lookup[k[z]]+"</li>");e.append(r);c.append(e);b.addClass("opened")}});d("#"+b+"-pchart-rows").click(function(){e._renderChart({type:"piechart",axis:"rows"})});d("#"+b+"-vchart-rows").click(function(){e._renderChart({type:"barchart",axis:"rows"})});d("#"+b+"-pchart-cols").click(function(){e._renderChart({type:"piechart",axis:"cols"})});d("#"+b+"-vchart-cols").click(function(){e._renderChart({type:"barchart",axis:"cols"})});d("#"+b+"-hchart-rows").click(function(){e._renderChart({type:"breakdown",
axis:"rows"})});d("#"+b+"-hchart-cols").click(function(){e._renderChart({type:"breakdown",axis:"cols"})});d(c).find(".pt-hide-chart").click(function(){e._renderChart(!1)})},_unbindEvents:function(){var a=this.element,e=d(a).attr("id");d("#"+e+" div.pt-table div.pt-cell-zoom").unbind("click");d("#"+e+"-options legend").unbind("click");d("#"+e+"-filters legend").unbind("click");d(e+"-totals").unbind("click");d("#"+e+"-rows, #"+e+"-cols, #"+e+"-fact").unbind("change.autosubmit");d(a).find(".pt-form").unbind("optionChanged");
d(a).find("input.pt-submit").unbind("click");d("#"+e+"-pchart-rows").unbind("click");d("#"+e+"-vchart-rows").unbind("click");d("#"+e+"-pchart-cols").unbind("click");d("#"+e+"-vchart-cols").unbind("click");d(a).find(".pt-hide-table").unbind("click");d(a).find(".pt-show-table").unbind("click");d(a).find(".pt-hide-chart").unbind("click")}})})(jQuery);
