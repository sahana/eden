$(function(){function d(){$(".embedded > td > input").removeAttr("disabled");$(".embedded > td > select").removeAttr("disabled");$(".embedded > td > textarea").removeAttr("disabled")}function k(){$(".embedded > td > input").attr("disabled",!0);$(".embedded > td > select").attr("disabled",!0);$(".embedded > td > textarea").attr("disabled",!0)}$("#select_from_registry_row").attr("controller");var h=$("#select_from_registry_row").attr("component"),l=$("#select_from_registry_row").attr("url"),e=$("#select_from_registry_row").attr("value"),
i=$("#select_from_registry_row").attr("field"),c="#"+i,a="#dummy_"+i,f=$(c).val();$(a).addClass("hide");0<f&&($("#clear_form_link").removeClass("hide"),$("#edit_selected_link").removeClass("hide"),k());$("#select_from_registry").click(function(){$("#select_from_registry_row").addClass("hide");$("#component_autocomplete_row").removeClass("hide");$(a).removeClass("hide");$("#component_autocomplete_label").removeClass("hide");$(a).focus()});$(a).focusout(function(){f=$(c).val();$(a).addClass("hide");
$("#component_autocomplete_label").addClass("hide");$("#select_from_registry_row").removeClass("hide");f>0&&$("#clear_form_link").removeClass("hide")});clear_component_form=function(){d();$(c).val("");$(".embedded > td > input").val("");$(".embedded > td > select").val("");$(".embedded > td > textarea").val("");$("#clear_form_link").addClass("hide");$("#edit_selected_link").addClass("hide")};edit_selected_form=function(){d();$("#edit_selected_link").addClass("hide")};select_component=function(a){$("#select_from_registry").addClass("hide");
$("#clear_form_link").addClass("hide");$("#load_throbber").removeClass("hide");clear_component_form();$.getJSONS3(l+a+".s3json?show_ids=true",function(b){try{var a=b["$_"+h][0];k();$(c).val(a["@id"]);var d=/^[$|@].*/,e=/^[$]k_.*/;for(j in a){if(j.match(d))if(j.match(e))var g="#"+h+"_"+j.slice(3);else continue;else g="#"+h+"_"+j;try{b=a[j];if(b.hasOwnProperty("@id")){var f=eval(b["@id"]);$(g).val(f)}else if(b.hasOwnProperty("@value")){try{val=JSON.parse(b["@value"])}catch(i){val=b["@value"]}$(g).val(val)}else $(g).val(b)}catch(l){}}}catch(m){$(c).val("")}$("#load_throbber").addClass("hide");
$("#select_from_registry").removeClass("hide");$("#clear_form_link").removeClass("hide");$("#edit_selected_link").removeClass("hide")});$("#component_autocomplete_row").addClass("hide");$("#select_from_registry_row").removeClass("hide")};"None"!=e&&($(c).val(e),select_component(e));$("form").submit(function(){S3ClearNavigateAwayConfirm();d();return true})});
