(function(){var g=function(b){var a=new jQuery.Deferred,d=S3.gis;setTimeout(function e(){void 0!=d.maps&&void 0!=d.maps[b]?a.resolve("loaded"):"pending"===a.state()&&(a.notify("waiting for JS to load..."),setTimeout(e,500))},1);return a.promise()},h=function(b,a){var d=S3.gis,f=d.proj4326,e=b.layer.map.getProjectionObject(),c=b.geometry;"OpenLayers.Geometry.Point"!=c.CLASS_NAME?(c.transform(e,f),a=S3.Ap.concat("/"+a.c+"/"+a.f+"/create.popup?refresh_layer="+a.i+"&wkt="+c.toString()),c.transform(f,
e)):(c=c.getBounds().getCenterLonLat(),c.transform(e,f),a=S3.Ap.concat("/"+a.c+"/"+a.f+"/create.popup?refresh_layer="+a.i+"&lat="+c.lat+"&lon="+c.lon),c.transform(f,e));d.maps.default_map.s3.westPanelContainer.collapse();d.addPopup(b,a,void 0,!0)};$(document).ready(function(){$.when(g("default_map")).then(function(b){S3.gis.maps.default_map.s3.pointPlaced=h},function(b){s3_debug(b)},function(b){s3_debug(b)})})})(jQuery);
