*** Settings ***
Documentation  Run using "python web2py.py --no-banner -M -S eden -R applications/eden/tests/edentest_runner.py -A SSF
...            Test cases for project module
Resource  ../../resources/main.txt

*** Variables ***
${PROJECT URL}          http://${BASEURL}/project

${ProjectTextFilter}    project-project_project_name-project_project_code-project_project_description-text-filter
${ProjectOrgSelector}   project_project_organisation_id
${ProjectNameField}     project_project_name

${MilestoneNameFiled}   project_milestone_name
${MilestoneProjectSelector}   project_milestone_project_id     

${TaskNameFiled}        project_task_name
${TaskProjectSelector}  sub_defaulttask_project_defaulttask_project_i_project_id_edit_none
${TaskMilestoneSelector}      sub_defaulttask_milestone_defaulttask_milestone_i_milestone_id_edit_none

*** Test Cases ***

Create a project
    Login To Eden If Not Logged In  ${VALID USER}  ${VALID PASSWORD}
    Go To  ${PROJECT URL}/project/create
    Select From List  ${ProjectOrgSelector}  Sahana Software Foundation (SSF)
    Input Text  ${ProjectNameField}  Test Project
    Submit CRUD Form 
    Should Show Confirmation
   
Serach a Project
    Login To Eden If Not Logged In  ${VALID USER}  ${VALID PASSWORD} 
    Go To  ${PROJECT URL}/project   	
    Input Text  ${PorjecTextFilter}  Test Pro
    Wait For Filter Result
    Should Give X Results  1
    DataTable Row Should Contain  1  Name  Test Project
	
Create a milestone under the project
    Login To Eden If Not Logged In  ${VALID USER}  ${VALID PASSWORD}
    Go To  ${PROJECT URL}/milestone/create 
    Select Option  ${MilestoneProjectSelector}  Test Project
    Intput Text ${MilestoneNameField}  Its Demo Milestone  
    Submit CRUD Form
    Should Show Confirmation

Create a task within the project with the above milestone
    Login To Eden If Not Logged In  ${VALID USER}  ${VALID PASSWORD}
    Go To  ${PROJECT URL}/task/create
    Select Option  ${TaskProjectSelector}  Test Project	
    Click Element  rheader_tab_task
    Wait Until Page Contains Element  xpath=//div[@class='form-container']
    Select Option  ${TaskMilestoneSelector}  Its Demo Milestone
    Input Text  ${TaskNameField}  Test Task
    Submit CRUD Form
    Should Show Confirmation
    
